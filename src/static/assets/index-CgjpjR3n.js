var j8=Object.defineProperty;var R2=t=>{throw TypeError(t)};var M8=(t,e,r)=>e in t?j8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var an=(t,e,r)=>M8(t,typeof e!="symbol"?e+"":e,r),tx=(t,e,r)=>e.has(t)||R2("Cannot "+r);var me=(t,e,r)=>(tx(t,e,"read from private field"),r?r.call(t):e.get(t)),St=(t,e,r)=>e.has(t)?R2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),lt=(t,e,r,n)=>(tx(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),Ln=(t,e,r)=>(tx(t,e,"access private method"),r);var Ff=(t,e,r,n)=>({set _(s){lt(t,e,s,r)},get _(){return me(t,e,n)}});function cI(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(n,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var uI={exports:{}},Cp={},dI={exports:{}},At={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xh=Symbol.for("react.element"),O8=Symbol.for("react.portal"),F8=Symbol.for("react.fragment"),B8=Symbol.for("react.strict_mode"),U8=Symbol.for("react.profiler"),$8=Symbol.for("react.provider"),V8=Symbol.for("react.context"),G8=Symbol.for("react.forward_ref"),H8=Symbol.for("react.suspense"),z8=Symbol.for("react.memo"),W8=Symbol.for("react.lazy"),_2=Symbol.iterator;function K8(t){return t===null||typeof t!="object"?null:(t=_2&&t[_2]||t["@@iterator"],typeof t=="function"?t:null)}var hI={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fI=Object.assign,mI={};function Bu(t,e,r){this.props=t,this.context=e,this.refs=mI,this.updater=r||hI}Bu.prototype.isReactComponent={};Bu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Bu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function pI(){}pI.prototype=Bu.prototype;function sw(t,e,r){this.props=t,this.context=e,this.refs=mI,this.updater=r||hI}var iw=sw.prototype=new pI;iw.constructor=sw;fI(iw,Bu.prototype);iw.isPureReactComponent=!0;var L2=Array.isArray,gI=Object.prototype.hasOwnProperty,aw={current:null},xI={key:!0,ref:!0,__self:!0,__source:!0};function yI(t,e,r){var n,s={},i=null,a=null;if(e!=null)for(n in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)gI.call(e,n)&&!xI.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var d=Array(l),u=0;u<l;u++)d[u]=arguments[u+2];s.children=d}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:Xh,type:t,key:i,ref:a,props:s,_owner:aw.current}}function Y8(t,e){return{$$typeof:Xh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ow(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xh}function q8(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var P2=/\/+/g;function rx(t,e){return typeof t=="object"&&t!==null&&t.key!=null?q8(""+t.key):e.toString(36)}function Dm(t,e,r,n,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Xh:case O8:a=!0}}if(a)return a=t,s=s(a),t=n===""?"."+rx(a,0):n,L2(s)?(r="",t!=null&&(r=t.replace(P2,"$&/")+"/"),Dm(s,e,r,"",function(u){return u})):s!=null&&(ow(s)&&(s=Y8(s,r+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(P2,"$&/")+"/")+t)),e.push(s)),1;if(a=0,n=n===""?".":n+":",L2(t))for(var l=0;l<t.length;l++){i=t[l];var d=n+rx(i,l);a+=Dm(i,e,r,d,s)}else if(d=K8(t),typeof d=="function")for(t=d.call(t),l=0;!(i=t.next()).done;)i=i.value,d=n+rx(i,l++),a+=Dm(i,e,r,d,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Bf(t,e,r){if(t==null)return t;var n=[],s=0;return Dm(t,n,"","",function(i){return e.call(r,i,s++)}),n}function X8(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Yn={current:null},km={transition:null},Q8={ReactCurrentDispatcher:Yn,ReactCurrentBatchConfig:km,ReactCurrentOwner:aw};function vI(){throw Error("act(...) is not supported in production builds of React.")}At.Children={map:Bf,forEach:function(t,e,r){Bf(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Bf(t,function(){e++}),e},toArray:function(t){return Bf(t,function(e){return e})||[]},only:function(t){if(!ow(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};At.Component=Bu;At.Fragment=F8;At.Profiler=U8;At.PureComponent=sw;At.StrictMode=B8;At.Suspense=H8;At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q8;At.act=vI;At.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=fI({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=aw.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(d in e)gI.call(e,d)&&!xI.hasOwnProperty(d)&&(n[d]=e[d]===void 0&&l!==void 0?l[d]:e[d])}var d=arguments.length-2;if(d===1)n.children=r;else if(1<d){l=Array(d);for(var u=0;u<d;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:Xh,type:t.type,key:s,ref:i,props:n,_owner:a}};At.createContext=function(t){return t={$$typeof:V8,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:$8,_context:t},t.Consumer=t};At.createElement=yI;At.createFactory=function(t){var e=yI.bind(null,t);return e.type=t,e};At.createRef=function(){return{current:null}};At.forwardRef=function(t){return{$$typeof:G8,render:t}};At.isValidElement=ow;At.lazy=function(t){return{$$typeof:W8,_payload:{_status:-1,_result:t},_init:X8}};At.memo=function(t,e){return{$$typeof:z8,type:t,compare:e===void 0?null:e}};At.startTransition=function(t){var e=km.transition;km.transition={};try{t()}finally{km.transition=e}};At.unstable_act=vI;At.useCallback=function(t,e){return Yn.current.useCallback(t,e)};At.useContext=function(t){return Yn.current.useContext(t)};At.useDebugValue=function(){};At.useDeferredValue=function(t){return Yn.current.useDeferredValue(t)};At.useEffect=function(t,e){return Yn.current.useEffect(t,e)};At.useId=function(){return Yn.current.useId()};At.useImperativeHandle=function(t,e,r){return Yn.current.useImperativeHandle(t,e,r)};At.useInsertionEffect=function(t,e){return Yn.current.useInsertionEffect(t,e)};At.useLayoutEffect=function(t,e){return Yn.current.useLayoutEffect(t,e)};At.useMemo=function(t,e){return Yn.current.useMemo(t,e)};At.useReducer=function(t,e,r){return Yn.current.useReducer(t,e,r)};At.useRef=function(t){return Yn.current.useRef(t)};At.useState=function(t){return Yn.current.useState(t)};At.useSyncExternalStore=function(t,e,r){return Yn.current.useSyncExternalStore(t,e,r)};At.useTransition=function(){return Yn.current.useTransition()};At.version="18.3.1";dI.exports=At;var C=dI.exports;const Fe=nw(C),lw=cI({__proto__:null,default:Fe},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Z8=C,J8=Symbol.for("react.element"),e6=Symbol.for("react.fragment"),t6=Object.prototype.hasOwnProperty,r6=Z8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n6={key:!0,ref:!0,__self:!0,__source:!0};function wI(t,e,r){var n,s={},i=null,a=null;r!==void 0&&(i=""+r),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(n in e)t6.call(e,n)&&!n6.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:J8,type:t,key:i,ref:a,props:s,_owner:r6.current}}Cp.Fragment=e6;Cp.jsx=wI;Cp.jsxs=wI;uI.exports=Cp;var o=uI.exports,bI={exports:{}},ks={},EI={exports:{}},SI={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(q,K){var ae=q.length;q.push(K);e:for(;0<ae;){var Q=ae-1>>>1,re=q[Q];if(0<s(re,K))q[Q]=K,q[ae]=re,ae=Q;else break e}}function r(q){return q.length===0?null:q[0]}function n(q){if(q.length===0)return null;var K=q[0],ae=q.pop();if(ae!==K){q[0]=ae;e:for(var Q=0,re=q.length,Ee=re>>>1;Q<Ee;){var ie=2*(Q+1)-1,se=q[ie],oe=ie+1,fe=q[oe];if(0>s(se,ae))oe<re&&0>s(fe,se)?(q[Q]=fe,q[oe]=ae,Q=oe):(q[Q]=se,q[ie]=ae,Q=ie);else if(oe<re&&0>s(fe,ae))q[Q]=fe,q[oe]=ae,Q=oe;else break e}}return K}function s(q,K){var ae=q.sortIndex-K.sortIndex;return ae!==0?ae:q.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var d=[],u=[],f=1,p=null,y=3,v=!1,E=!1,b=!1,T=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(q){for(var K=r(u);K!==null;){if(K.callback===null)n(u);else if(K.startTime<=q)n(u),K.sortIndex=K.expirationTime,e(d,K);else break;K=r(u)}}function L(q){if(b=!1,A(q),!E)if(r(d)!==null)E=!0,Z(P);else{var K=r(u);K!==null&&ee(L,K.startTime-q)}}function P(q,K){E=!1,b&&(b=!1,I(O),O=-1),v=!0;var ae=y;try{for(A(K),p=r(d);p!==null&&(!(p.expirationTime>K)||q&&!G());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,y=p.priorityLevel;var re=Q(p.expirationTime<=K);K=t.unstable_now(),typeof re=="function"?p.callback=re:p===r(d)&&n(d),A(K)}else n(d);p=r(d)}if(p!==null)var Ee=!0;else{var ie=r(u);ie!==null&&ee(L,ie.startTime-K),Ee=!1}return Ee}finally{p=null,y=ae,v=!1}}var k=!1,D=null,O=-1,F=5,$=-1;function G(){return!(t.unstable_now()-$<F)}function Y(){if(D!==null){var q=t.unstable_now();$=q;var K=!0;try{K=D(!0,q)}finally{K?ne():(k=!1,D=null)}}else k=!1}var ne;if(typeof N=="function")ne=function(){N(Y)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,z=X.port2;X.port1.onmessage=Y,ne=function(){z.postMessage(null)}}else ne=function(){T(Y,0)};function Z(q){D=q,k||(k=!0,ne())}function ee(q,K){O=T(function(){q(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(q){q.callback=null},t.unstable_continueExecution=function(){E||v||(E=!0,Z(P))},t.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<q?Math.floor(1e3/q):5},t.unstable_getCurrentPriorityLevel=function(){return y},t.unstable_getFirstCallbackNode=function(){return r(d)},t.unstable_next=function(q){switch(y){case 1:case 2:case 3:var K=3;break;default:K=y}var ae=y;y=K;try{return q()}finally{y=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(q,K){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ae=y;y=q;try{return K()}finally{y=ae}},t.unstable_scheduleCallback=function(q,K,ae){var Q=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Q+ae:Q):ae=Q,q){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=ae+re,q={id:f++,callback:K,priorityLevel:q,startTime:ae,expirationTime:re,sortIndex:-1},ae>Q?(q.sortIndex=ae,e(u,q),r(d)===null&&q===r(u)&&(b?(I(O),O=-1):b=!0,ee(L,ae-Q))):(q.sortIndex=re,e(d,q),E||v||(E=!0,Z(P))),q},t.unstable_shouldYield=G,t.unstable_wrapCallback=function(q){var K=y;return function(){var ae=y;y=K;try{return q.apply(this,arguments)}finally{y=ae}}}})(SI);EI.exports=SI;var s6=EI.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i6=C,Ls=s6;function De(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var TI=new Set,nh={};function Ql(t,e){wu(t,e),wu(t+"Capture",e)}function wu(t,e){for(nh[t]=e,t=0;t<e.length;t++)TI.add(e[t])}var Ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),F1=Object.prototype.hasOwnProperty,a6=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,D2={},k2={};function o6(t){return F1.call(k2,t)?!0:F1.call(D2,t)?!1:a6.test(t)?k2[t]=!0:(D2[t]=!0,!1)}function l6(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function c6(t,e,r,n){if(e===null||typeof e>"u"||l6(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qn(t,e,r,n,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var An={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){An[t]=new qn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];An[e]=new qn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){An[t]=new qn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){An[t]=new qn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){An[t]=new qn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){An[t]=new qn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){An[t]=new qn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){An[t]=new qn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){An[t]=new qn(t,5,!1,t.toLowerCase(),null,!1,!1)});var cw=/[\-:]([a-z])/g;function uw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cw,uw);An[e]=new qn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cw,uw);An[e]=new qn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cw,uw);An[e]=new qn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){An[t]=new qn(t,1,!1,t.toLowerCase(),null,!1,!1)});An.xlinkHref=new qn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){An[t]=new qn(t,1,!1,t.toLowerCase(),null,!0,!0)});function dw(t,e,r,n){var s=An.hasOwnProperty(e)?An[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(c6(e,r,s,n)&&(r=null),n||s===null?o6(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Ma=i6.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Uf=Symbol.for("react.element"),_c=Symbol.for("react.portal"),Lc=Symbol.for("react.fragment"),hw=Symbol.for("react.strict_mode"),B1=Symbol.for("react.profiler"),CI=Symbol.for("react.provider"),AI=Symbol.for("react.context"),fw=Symbol.for("react.forward_ref"),U1=Symbol.for("react.suspense"),$1=Symbol.for("react.suspense_list"),mw=Symbol.for("react.memo"),to=Symbol.for("react.lazy"),NI=Symbol.for("react.offscreen"),j2=Symbol.iterator;function gd(t){return t===null||typeof t!="object"?null:(t=j2&&t[j2]||t["@@iterator"],typeof t=="function"?t:null)}var vr=Object.assign,nx;function Ld(t){if(nx===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);nx=e&&e[1]||""}return`
`+nx+t}var sx=!1;function ix(t,e){if(!t||sx)return"";sx=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=n.stack.split(`
`),a=s.length-1,l=i.length-1;1<=a&&0<=l&&s[a]!==i[l];)l--;for(;1<=a&&0<=l;a--,l--)if(s[a]!==i[l]){if(a!==1||l!==1)do if(a--,l--,0>l||s[a]!==i[l]){var d=`
`+s[a].replace(" at new "," at ");return t.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",t.displayName)),d}while(1<=a&&0<=l);break}}}finally{sx=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ld(t):""}function u6(t){switch(t.tag){case 5:return Ld(t.type);case 16:return Ld("Lazy");case 13:return Ld("Suspense");case 19:return Ld("SuspenseList");case 0:case 2:case 15:return t=ix(t.type,!1),t;case 11:return t=ix(t.type.render,!1),t;case 1:return t=ix(t.type,!0),t;default:return""}}function V1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Lc:return"Fragment";case _c:return"Portal";case B1:return"Profiler";case hw:return"StrictMode";case U1:return"Suspense";case $1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AI:return(t.displayName||"Context")+".Consumer";case CI:return(t._context.displayName||"Context")+".Provider";case fw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mw:return e=t.displayName||null,e!==null?e:V1(t.type)||"Memo";case to:e=t._payload,t=t._init;try{return V1(t(e))}catch{}}return null}function d6(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V1(e);case 8:return e===hw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function No(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function II(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function h6(t){var e=II(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,i=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){n=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function $f(t){t._valueTracker||(t._valueTracker=h6(t))}function RI(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=II(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function f0(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function G1(t,e){var r=e.checked;return vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function M2(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=No(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _I(t,e){e=e.checked,e!=null&&dw(t,"checked",e,!1)}function H1(t,e){_I(t,e);var r=No(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?z1(t,e.type,r):e.hasOwnProperty("defaultValue")&&z1(t,e.type,No(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function O2(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function z1(t,e,r){(e!=="number"||f0(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Pd=Array.isArray;function Xc(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+No(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function W1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(De(91));return vr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function F2(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(De(92));if(Pd(r)){if(1<r.length)throw Error(De(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:No(r)}}function LI(t,e){var r=No(e.value),n=No(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function B2(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function PI(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function K1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?PI(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Vf,DI=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Vf=Vf||document.createElement("div"),Vf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Vf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function sh(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Bd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},f6=["Webkit","ms","Moz","O"];Object.keys(Bd).forEach(function(t){f6.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Bd[e]=Bd[t]})});function kI(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Bd.hasOwnProperty(t)&&Bd[t]?(""+e).trim():e+"px"}function jI(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=kI(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var m6=vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Y1(t,e){if(e){if(m6[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(De(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(De(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(De(61))}if(e.style!=null&&typeof e.style!="object")throw Error(De(62))}}function q1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var X1=null;function pw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Q1=null,Qc=null,Zc=null;function U2(t){if(t=Jh(t)){if(typeof Q1!="function")throw Error(De(280));var e=t.stateNode;e&&(e=_p(e),Q1(t.stateNode,t.type,e))}}function MI(t){Qc?Zc?Zc.push(t):Zc=[t]:Qc=t}function OI(){if(Qc){var t=Qc,e=Zc;if(Zc=Qc=null,U2(t),e)for(t=0;t<e.length;t++)U2(e[t])}}function FI(t,e){return t(e)}function BI(){}var ax=!1;function UI(t,e,r){if(ax)return t(e,r);ax=!0;try{return FI(t,e,r)}finally{ax=!1,(Qc!==null||Zc!==null)&&(BI(),OI())}}function ih(t,e){var r=t.stateNode;if(r===null)return null;var n=_p(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(De(231,e,typeof r));return r}var Z1=!1;if(Ia)try{var xd={};Object.defineProperty(xd,"passive",{get:function(){Z1=!0}}),window.addEventListener("test",xd,xd),window.removeEventListener("test",xd,xd)}catch{Z1=!1}function p6(t,e,r,n,s,i,a,l,d){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(f){this.onError(f)}}var Ud=!1,m0=null,p0=!1,J1=null,g6={onError:function(t){Ud=!0,m0=t}};function x6(t,e,r,n,s,i,a,l,d){Ud=!1,m0=null,p6.apply(g6,arguments)}function y6(t,e,r,n,s,i,a,l,d){if(x6.apply(this,arguments),Ud){if(Ud){var u=m0;Ud=!1,m0=null}else throw Error(De(198));p0||(p0=!0,J1=u)}}function Zl(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function $I(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function $2(t){if(Zl(t)!==t)throw Error(De(188))}function v6(t){var e=t.alternate;if(!e){if(e=Zl(t),e===null)throw Error(De(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var i=s.alternate;if(i===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===r)return $2(s),t;if(i===n)return $2(s),e;i=i.sibling}throw Error(De(188))}if(r.return!==n.return)r=s,n=i;else{for(var a=!1,l=s.child;l;){if(l===r){a=!0,r=s,n=i;break}if(l===n){a=!0,n=s,r=i;break}l=l.sibling}if(!a){for(l=i.child;l;){if(l===r){a=!0,r=i,n=s;break}if(l===n){a=!0,n=i,r=s;break}l=l.sibling}if(!a)throw Error(De(189))}}if(r.alternate!==n)throw Error(De(190))}if(r.tag!==3)throw Error(De(188));return r.stateNode.current===r?t:e}function VI(t){return t=v6(t),t!==null?GI(t):null}function GI(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=GI(t);if(e!==null)return e;t=t.sibling}return null}var HI=Ls.unstable_scheduleCallback,V2=Ls.unstable_cancelCallback,w6=Ls.unstable_shouldYield,b6=Ls.unstable_requestPaint,Mr=Ls.unstable_now,E6=Ls.unstable_getCurrentPriorityLevel,gw=Ls.unstable_ImmediatePriority,zI=Ls.unstable_UserBlockingPriority,g0=Ls.unstable_NormalPriority,S6=Ls.unstable_LowPriority,WI=Ls.unstable_IdlePriority,Ap=null,Ji=null;function T6(t){if(Ji&&typeof Ji.onCommitFiberRoot=="function")try{Ji.onCommitFiberRoot(Ap,t,void 0,(t.current.flags&128)===128)}catch{}}var Ei=Math.clz32?Math.clz32:N6,C6=Math.log,A6=Math.LN2;function N6(t){return t>>>=0,t===0?32:31-(C6(t)/A6|0)|0}var Gf=64,Hf=4194304;function Dd(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function x0(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,i=t.pingedLanes,a=r&268435455;if(a!==0){var l=a&~s;l!==0?n=Dd(l):(i&=a,i!==0&&(n=Dd(i)))}else a=r&~s,a!==0?n=Dd(a):i!==0&&(n=Dd(i));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ei(e),s=1<<r,n|=t[r],e&=~s;return n}function I6(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function R6(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Ei(i),l=1<<a,d=s[a];d===-1?(!(l&r)||l&n)&&(s[a]=I6(l,e)):d<=e&&(t.expiredLanes|=l),i&=~l}}function ey(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KI(){var t=Gf;return Gf<<=1,!(Gf&4194240)&&(Gf=64),t}function ox(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function Qh(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ei(e),t[e]=r}function _6(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ei(r),i=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~i}}function xw(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ei(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Gt=0;function YI(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qI,yw,XI,QI,ZI,ty=!1,zf=[],xo=null,yo=null,vo=null,ah=new Map,oh=new Map,io=[],L6="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function G2(t,e){switch(t){case"focusin":case"focusout":xo=null;break;case"dragenter":case"dragleave":yo=null;break;case"mouseover":case"mouseout":vo=null;break;case"pointerover":case"pointerout":ah.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":oh.delete(e.pointerId)}}function yd(t,e,r,n,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Jh(e),e!==null&&yw(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function P6(t,e,r,n,s){switch(e){case"focusin":return xo=yd(xo,t,e,r,n,s),!0;case"dragenter":return yo=yd(yo,t,e,r,n,s),!0;case"mouseover":return vo=yd(vo,t,e,r,n,s),!0;case"pointerover":var i=s.pointerId;return ah.set(i,yd(ah.get(i)||null,t,e,r,n,s)),!0;case"gotpointercapture":return i=s.pointerId,oh.set(i,yd(oh.get(i)||null,t,e,r,n,s)),!0}return!1}function JI(t){var e=hl(t.target);if(e!==null){var r=Zl(e);if(r!==null){if(e=r.tag,e===13){if(e=$I(r),e!==null){t.blockedOn=e,ZI(t.priority,function(){XI(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jm(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=ry(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);X1=n,r.target.dispatchEvent(n),X1=null}else return e=Jh(r),e!==null&&yw(e),t.blockedOn=r,!1;e.shift()}return!0}function H2(t,e,r){jm(t)&&r.delete(e)}function D6(){ty=!1,xo!==null&&jm(xo)&&(xo=null),yo!==null&&jm(yo)&&(yo=null),vo!==null&&jm(vo)&&(vo=null),ah.forEach(H2),oh.forEach(H2)}function vd(t,e){t.blockedOn===e&&(t.blockedOn=null,ty||(ty=!0,Ls.unstable_scheduleCallback(Ls.unstable_NormalPriority,D6)))}function lh(t){function e(s){return vd(s,t)}if(0<zf.length){vd(zf[0],t);for(var r=1;r<zf.length;r++){var n=zf[r];n.blockedOn===t&&(n.blockedOn=null)}}for(xo!==null&&vd(xo,t),yo!==null&&vd(yo,t),vo!==null&&vd(vo,t),ah.forEach(e),oh.forEach(e),r=0;r<io.length;r++)n=io[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<io.length&&(r=io[0],r.blockedOn===null);)JI(r),r.blockedOn===null&&io.shift()}var Jc=Ma.ReactCurrentBatchConfig,y0=!0;function k6(t,e,r,n){var s=Gt,i=Jc.transition;Jc.transition=null;try{Gt=1,vw(t,e,r,n)}finally{Gt=s,Jc.transition=i}}function j6(t,e,r,n){var s=Gt,i=Jc.transition;Jc.transition=null;try{Gt=4,vw(t,e,r,n)}finally{Gt=s,Jc.transition=i}}function vw(t,e,r,n){if(y0){var s=ry(t,e,r,n);if(s===null)xx(t,e,n,v0,r),G2(t,n);else if(P6(s,t,e,r,n))n.stopPropagation();else if(G2(t,n),e&4&&-1<L6.indexOf(t)){for(;s!==null;){var i=Jh(s);if(i!==null&&qI(i),i=ry(t,e,r,n),i===null&&xx(t,e,n,v0,r),i===s)break;s=i}s!==null&&n.stopPropagation()}else xx(t,e,n,null,r)}}var v0=null;function ry(t,e,r,n){if(v0=null,t=pw(n),t=hl(t),t!==null)if(e=Zl(t),e===null)t=null;else if(r=e.tag,r===13){if(t=$I(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return v0=t,null}function eR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(E6()){case gw:return 1;case zI:return 4;case g0:case S6:return 16;case WI:return 536870912;default:return 16}default:return 16}}var mo=null,ww=null,Mm=null;function tR(){if(Mm)return Mm;var t,e=ww,r=e.length,n,s="value"in mo?mo.value:mo.textContent,i=s.length;for(t=0;t<r&&e[t]===s[t];t++);var a=r-t;for(n=1;n<=a&&e[r-n]===s[i-n];n++);return Mm=s.slice(t,1<n?1-n:void 0)}function Om(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wf(){return!0}function z2(){return!1}function js(t){function e(r,n,s,i,a){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wf:z2,this.isPropagationStopped=z2,this}return vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Wf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Wf)},persist:function(){},isPersistent:Wf}),e}var Uu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bw=js(Uu),Zh=vr({},Uu,{view:0,detail:0}),M6=js(Zh),lx,cx,wd,Np=vr({},Zh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ew,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==wd&&(wd&&t.type==="mousemove"?(lx=t.screenX-wd.screenX,cx=t.screenY-wd.screenY):cx=lx=0,wd=t),lx)},movementY:function(t){return"movementY"in t?t.movementY:cx}}),W2=js(Np),O6=vr({},Np,{dataTransfer:0}),F6=js(O6),B6=vr({},Zh,{relatedTarget:0}),ux=js(B6),U6=vr({},Uu,{animationName:0,elapsedTime:0,pseudoElement:0}),$6=js(U6),V6=vr({},Uu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),G6=js(V6),H6=vr({},Uu,{data:0}),K2=js(H6),z6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},K6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Y6(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=K6[t])?!!e[t]:!1}function Ew(){return Y6}var q6=vr({},Zh,{key:function(t){if(t.key){var e=z6[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Om(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?W6[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ew,charCode:function(t){return t.type==="keypress"?Om(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Om(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),X6=js(q6),Q6=vr({},Np,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Y2=js(Q6),Z6=vr({},Zh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ew}),J6=js(Z6),e5=vr({},Uu,{propertyName:0,elapsedTime:0,pseudoElement:0}),t5=js(e5),r5=vr({},Np,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),n5=js(r5),s5=[9,13,27,32],Sw=Ia&&"CompositionEvent"in window,$d=null;Ia&&"documentMode"in document&&($d=document.documentMode);var i5=Ia&&"TextEvent"in window&&!$d,rR=Ia&&(!Sw||$d&&8<$d&&11>=$d),q2=" ",X2=!1;function nR(t,e){switch(t){case"keyup":return s5.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pc=!1;function a5(t,e){switch(t){case"compositionend":return sR(e);case"keypress":return e.which!==32?null:(X2=!0,q2);case"textInput":return t=e.data,t===q2&&X2?null:t;default:return null}}function o5(t,e){if(Pc)return t==="compositionend"||!Sw&&nR(t,e)?(t=tR(),Mm=ww=mo=null,Pc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return rR&&e.locale!=="ko"?null:e.data;default:return null}}var l5={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Q2(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!l5[t.type]:e==="textarea"}function iR(t,e,r,n){MI(n),e=w0(e,"onChange"),0<e.length&&(r=new bw("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Vd=null,ch=null;function c5(t){gR(t,0)}function Ip(t){var e=jc(t);if(RI(e))return t}function u5(t,e){if(t==="change")return e}var aR=!1;if(Ia){var dx;if(Ia){var hx="oninput"in document;if(!hx){var Z2=document.createElement("div");Z2.setAttribute("oninput","return;"),hx=typeof Z2.oninput=="function"}dx=hx}else dx=!1;aR=dx&&(!document.documentMode||9<document.documentMode)}function J2(){Vd&&(Vd.detachEvent("onpropertychange",oR),ch=Vd=null)}function oR(t){if(t.propertyName==="value"&&Ip(ch)){var e=[];iR(e,ch,t,pw(t)),UI(c5,e)}}function d5(t,e,r){t==="focusin"?(J2(),Vd=e,ch=r,Vd.attachEvent("onpropertychange",oR)):t==="focusout"&&J2()}function h5(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ip(ch)}function f5(t,e){if(t==="click")return Ip(e)}function m5(t,e){if(t==="input"||t==="change")return Ip(e)}function p5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ci=typeof Object.is=="function"?Object.is:p5;function uh(t,e){if(Ci(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!F1.call(e,s)||!Ci(t[s],e[s]))return!1}return!0}function eS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function tS(t,e){var r=eS(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=eS(r)}}function lR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?lR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function cR(){for(var t=window,e=f0();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=f0(t.document)}return e}function Tw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function g5(t){var e=cR(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&lR(r.ownerDocument.documentElement,r)){if(n!==null&&Tw(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,i=Math.min(n.start,s);n=n.end===void 0?i:Math.min(n.end,s),!t.extend&&i>n&&(s=n,n=i,i=s),s=tS(r,i);var a=tS(r,n);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>n?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var x5=Ia&&"documentMode"in document&&11>=document.documentMode,Dc=null,ny=null,Gd=null,sy=!1;function rS(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sy||Dc==null||Dc!==f0(n)||(n=Dc,"selectionStart"in n&&Tw(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Gd&&uh(Gd,n)||(Gd=n,n=w0(ny,"onSelect"),0<n.length&&(e=new bw("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Dc)))}function Kf(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var kc={animationend:Kf("Animation","AnimationEnd"),animationiteration:Kf("Animation","AnimationIteration"),animationstart:Kf("Animation","AnimationStart"),transitionend:Kf("Transition","TransitionEnd")},fx={},uR={};Ia&&(uR=document.createElement("div").style,"AnimationEvent"in window||(delete kc.animationend.animation,delete kc.animationiteration.animation,delete kc.animationstart.animation),"TransitionEvent"in window||delete kc.transitionend.transition);function Rp(t){if(fx[t])return fx[t];if(!kc[t])return t;var e=kc[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in uR)return fx[t]=e[r];return t}var dR=Rp("animationend"),hR=Rp("animationiteration"),fR=Rp("animationstart"),mR=Rp("transitionend"),pR=new Map,nS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $o(t,e){pR.set(t,e),Ql(e,[t])}for(var mx=0;mx<nS.length;mx++){var px=nS[mx],y5=px.toLowerCase(),v5=px[0].toUpperCase()+px.slice(1);$o(y5,"on"+v5)}$o(dR,"onAnimationEnd");$o(hR,"onAnimationIteration");$o(fR,"onAnimationStart");$o("dblclick","onDoubleClick");$o("focusin","onFocus");$o("focusout","onBlur");$o(mR,"onTransitionEnd");wu("onMouseEnter",["mouseout","mouseover"]);wu("onMouseLeave",["mouseout","mouseover"]);wu("onPointerEnter",["pointerout","pointerover"]);wu("onPointerLeave",["pointerout","pointerover"]);Ql("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ql("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ql("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ql("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ql("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ql("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w5=new Set("cancel close invalid load scroll toggle".split(" ").concat(kd));function sS(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,y6(n,e,void 0,t),t.currentTarget=null}function gR(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var i=void 0;if(e)for(var a=n.length-1;0<=a;a--){var l=n[a],d=l.instance,u=l.currentTarget;if(l=l.listener,d!==i&&s.isPropagationStopped())break e;sS(s,l,u),i=d}else for(a=0;a<n.length;a++){if(l=n[a],d=l.instance,u=l.currentTarget,l=l.listener,d!==i&&s.isPropagationStopped())break e;sS(s,l,u),i=d}}}if(p0)throw t=J1,p0=!1,J1=null,t}function rr(t,e){var r=e[cy];r===void 0&&(r=e[cy]=new Set);var n=t+"__bubble";r.has(n)||(xR(e,t,2,!1),r.add(n))}function gx(t,e,r){var n=0;e&&(n|=4),xR(r,t,n,e)}var Yf="_reactListening"+Math.random().toString(36).slice(2);function dh(t){if(!t[Yf]){t[Yf]=!0,TI.forEach(function(r){r!=="selectionchange"&&(w5.has(r)||gx(r,!1,t),gx(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Yf]||(e[Yf]=!0,gx("selectionchange",!1,e))}}function xR(t,e,r,n){switch(eR(e)){case 1:var s=k6;break;case 4:s=j6;break;default:s=vw}r=s.bind(null,e,r,t),s=void 0,!Z1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function xx(t,e,r,n,s){var i=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(a===4)for(a=n.return;a!==null;){var d=a.tag;if((d===3||d===4)&&(d=a.stateNode.containerInfo,d===s||d.nodeType===8&&d.parentNode===s))return;a=a.return}for(;l!==null;){if(a=hl(l),a===null)return;if(d=a.tag,d===5||d===6){n=i=a;continue e}l=l.parentNode}}n=n.return}UI(function(){var u=i,f=pw(r),p=[];e:{var y=pR.get(t);if(y!==void 0){var v=bw,E=t;switch(t){case"keypress":if(Om(r)===0)break e;case"keydown":case"keyup":v=X6;break;case"focusin":E="focus",v=ux;break;case"focusout":E="blur",v=ux;break;case"beforeblur":case"afterblur":v=ux;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=W2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=F6;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=J6;break;case dR:case hR:case fR:v=$6;break;case mR:v=t5;break;case"scroll":v=M6;break;case"wheel":v=n5;break;case"copy":case"cut":case"paste":v=G6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Y2}var b=(e&4)!==0,T=!b&&t==="scroll",I=b?y!==null?y+"Capture":null:y;b=[];for(var N=u,A;N!==null;){A=N;var L=A.stateNode;if(A.tag===5&&L!==null&&(A=L,I!==null&&(L=ih(N,I),L!=null&&b.push(hh(N,L,A)))),T)break;N=N.return}0<b.length&&(y=new v(y,E,null,r,f),p.push({event:y,listeners:b}))}}if(!(e&7)){e:{if(y=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",y&&r!==X1&&(E=r.relatedTarget||r.fromElement)&&(hl(E)||E[Ra]))break e;if((v||y)&&(y=f.window===f?f:(y=f.ownerDocument)?y.defaultView||y.parentWindow:window,v?(E=r.relatedTarget||r.toElement,v=u,E=E?hl(E):null,E!==null&&(T=Zl(E),E!==T||E.tag!==5&&E.tag!==6)&&(E=null)):(v=null,E=u),v!==E)){if(b=W2,L="onMouseLeave",I="onMouseEnter",N="mouse",(t==="pointerout"||t==="pointerover")&&(b=Y2,L="onPointerLeave",I="onPointerEnter",N="pointer"),T=v==null?y:jc(v),A=E==null?y:jc(E),y=new b(L,N+"leave",v,r,f),y.target=T,y.relatedTarget=A,L=null,hl(f)===u&&(b=new b(I,N+"enter",E,r,f),b.target=A,b.relatedTarget=T,L=b),T=L,v&&E)t:{for(b=v,I=E,N=0,A=b;A;A=vc(A))N++;for(A=0,L=I;L;L=vc(L))A++;for(;0<N-A;)b=vc(b),N--;for(;0<A-N;)I=vc(I),A--;for(;N--;){if(b===I||I!==null&&b===I.alternate)break t;b=vc(b),I=vc(I)}b=null}else b=null;v!==null&&iS(p,y,v,b,!1),E!==null&&T!==null&&iS(p,T,E,b,!0)}}e:{if(y=u?jc(u):window,v=y.nodeName&&y.nodeName.toLowerCase(),v==="select"||v==="input"&&y.type==="file")var P=u5;else if(Q2(y))if(aR)P=m5;else{P=h5;var k=d5}else(v=y.nodeName)&&v.toLowerCase()==="input"&&(y.type==="checkbox"||y.type==="radio")&&(P=f5);if(P&&(P=P(t,u))){iR(p,P,r,f);break e}k&&k(t,y,u),t==="focusout"&&(k=y._wrapperState)&&k.controlled&&y.type==="number"&&z1(y,"number",y.value)}switch(k=u?jc(u):window,t){case"focusin":(Q2(k)||k.contentEditable==="true")&&(Dc=k,ny=u,Gd=null);break;case"focusout":Gd=ny=Dc=null;break;case"mousedown":sy=!0;break;case"contextmenu":case"mouseup":case"dragend":sy=!1,rS(p,r,f);break;case"selectionchange":if(x5)break;case"keydown":case"keyup":rS(p,r,f)}var D;if(Sw)e:{switch(t){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Pc?nR(t,r)&&(O="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(rR&&r.locale!=="ko"&&(Pc||O!=="onCompositionStart"?O==="onCompositionEnd"&&Pc&&(D=tR()):(mo=f,ww="value"in mo?mo.value:mo.textContent,Pc=!0)),k=w0(u,O),0<k.length&&(O=new K2(O,t,null,r,f),p.push({event:O,listeners:k}),D?O.data=D:(D=sR(r),D!==null&&(O.data=D)))),(D=i5?a5(t,r):o5(t,r))&&(u=w0(u,"onBeforeInput"),0<u.length&&(f=new K2("onBeforeInput","beforeinput",null,r,f),p.push({event:f,listeners:u}),f.data=D))}gR(p,e)})}function hh(t,e,r){return{instance:t,listener:e,currentTarget:r}}function w0(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=ih(t,r),i!=null&&n.unshift(hh(t,i,s)),i=ih(t,e),i!=null&&n.push(hh(t,i,s))),t=t.return}return n}function vc(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function iS(t,e,r,n,s){for(var i=e._reactName,a=[];r!==null&&r!==n;){var l=r,d=l.alternate,u=l.stateNode;if(d!==null&&d===n)break;l.tag===5&&u!==null&&(l=u,s?(d=ih(r,i),d!=null&&a.unshift(hh(r,d,l))):s||(d=ih(r,i),d!=null&&a.push(hh(r,d,l)))),r=r.return}a.length!==0&&t.push({event:e,listeners:a})}var b5=/\r\n?/g,E5=/\u0000|\uFFFD/g;function aS(t){return(typeof t=="string"?t:""+t).replace(b5,`
`).replace(E5,"")}function qf(t,e,r){if(e=aS(e),aS(t)!==e&&r)throw Error(De(425))}function b0(){}var iy=null,ay=null;function oy(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var ly=typeof setTimeout=="function"?setTimeout:void 0,S5=typeof clearTimeout=="function"?clearTimeout:void 0,oS=typeof Promise=="function"?Promise:void 0,T5=typeof queueMicrotask=="function"?queueMicrotask:typeof oS<"u"?function(t){return oS.resolve(null).then(t).catch(C5)}:ly;function C5(t){setTimeout(function(){throw t})}function yx(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),lh(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);lh(e)}function wo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function lS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var $u=Math.random().toString(36).slice(2),Ki="__reactFiber$"+$u,fh="__reactProps$"+$u,Ra="__reactContainer$"+$u,cy="__reactEvents$"+$u,A5="__reactListeners$"+$u,N5="__reactHandles$"+$u;function hl(t){var e=t[Ki];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Ra]||r[Ki]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=lS(t);t!==null;){if(r=t[Ki])return r;t=lS(t)}return e}t=r,r=t.parentNode}return null}function Jh(t){return t=t[Ki]||t[Ra],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function jc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(De(33))}function _p(t){return t[fh]||null}var uy=[],Mc=-1;function Vo(t){return{current:t}}function sr(t){0>Mc||(t.current=uy[Mc],uy[Mc]=null,Mc--)}function Jt(t,e){Mc++,uy[Mc]=t.current,t.current=e}var Io={},Fn=Vo(Io),cs=Vo(!1),kl=Io;function bu(t,e){var r=t.type.contextTypes;if(!r)return Io;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in r)s[i]=e[i];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function us(t){return t=t.childContextTypes,t!=null}function E0(){sr(cs),sr(Fn)}function cS(t,e,r){if(Fn.current!==Io)throw Error(De(168));Jt(Fn,e),Jt(cs,r)}function yR(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(De(108,d6(t)||"Unknown",s));return vr({},r,n)}function S0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Io,kl=Fn.current,Jt(Fn,t),Jt(cs,cs.current),!0}function uS(t,e,r){var n=t.stateNode;if(!n)throw Error(De(169));r?(t=yR(t,e,kl),n.__reactInternalMemoizedMergedChildContext=t,sr(cs),sr(Fn),Jt(Fn,t)):sr(cs),Jt(cs,r)}var ba=null,Lp=!1,vx=!1;function vR(t){ba===null?ba=[t]:ba.push(t)}function I5(t){Lp=!0,vR(t)}function Go(){if(!vx&&ba!==null){vx=!0;var t=0,e=Gt;try{var r=ba;for(Gt=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}ba=null,Lp=!1}catch(s){throw ba!==null&&(ba=ba.slice(t+1)),HI(gw,Go),s}finally{Gt=e,vx=!1}}return null}var Oc=[],Fc=0,T0=null,C0=0,Ws=[],Ks=0,jl=null,Ta=1,Ca="";function ll(t,e){Oc[Fc++]=C0,Oc[Fc++]=T0,T0=t,C0=e}function wR(t,e,r){Ws[Ks++]=Ta,Ws[Ks++]=Ca,Ws[Ks++]=jl,jl=t;var n=Ta;t=Ca;var s=32-Ei(n)-1;n&=~(1<<s),r+=1;var i=32-Ei(e)+s;if(30<i){var a=s-s%5;i=(n&(1<<a)-1).toString(32),n>>=a,s-=a,Ta=1<<32-Ei(e)+s|r<<s|n,Ca=i+t}else Ta=1<<i|r<<s|n,Ca=t}function Cw(t){t.return!==null&&(ll(t,1),wR(t,1,0))}function Aw(t){for(;t===T0;)T0=Oc[--Fc],Oc[Fc]=null,C0=Oc[--Fc],Oc[Fc]=null;for(;t===jl;)jl=Ws[--Ks],Ws[Ks]=null,Ca=Ws[--Ks],Ws[Ks]=null,Ta=Ws[--Ks],Ws[Ks]=null}var Is=null,Ns=null,lr=!1,bi=null;function bR(t,e){var r=Ys(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function dS(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Is=t,Ns=wo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Is=t,Ns=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=jl!==null?{id:Ta,overflow:Ca}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Ys(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Is=t,Ns=null,!0):!1;default:return!1}}function dy(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hy(t){if(lr){var e=Ns;if(e){var r=e;if(!dS(t,e)){if(dy(t))throw Error(De(418));e=wo(r.nextSibling);var n=Is;e&&dS(t,e)?bR(n,r):(t.flags=t.flags&-4097|2,lr=!1,Is=t)}}else{if(dy(t))throw Error(De(418));t.flags=t.flags&-4097|2,lr=!1,Is=t}}}function hS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Is=t}function Xf(t){if(t!==Is)return!1;if(!lr)return hS(t),lr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!oy(t.type,t.memoizedProps)),e&&(e=Ns)){if(dy(t))throw ER(),Error(De(418));for(;e;)bR(t,e),e=wo(e.nextSibling)}if(hS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(De(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Ns=wo(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Ns=null}}else Ns=Is?wo(t.stateNode.nextSibling):null;return!0}function ER(){for(var t=Ns;t;)t=wo(t.nextSibling)}function Eu(){Ns=Is=null,lr=!1}function Nw(t){bi===null?bi=[t]:bi.push(t)}var R5=Ma.ReactCurrentBatchConfig;function bd(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(De(309));var n=r.stateNode}if(!n)throw Error(De(147,t));var s=n,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var l=s.refs;a===null?delete l[i]:l[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(De(284));if(!r._owner)throw Error(De(290,t))}return t}function Qf(t,e){throw t=Object.prototype.toString.call(e),Error(De(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function fS(t){var e=t._init;return e(t._payload)}function SR(t){function e(I,N){if(t){var A=I.deletions;A===null?(I.deletions=[N],I.flags|=16):A.push(N)}}function r(I,N){if(!t)return null;for(;N!==null;)e(I,N),N=N.sibling;return null}function n(I,N){for(I=new Map;N!==null;)N.key!==null?I.set(N.key,N):I.set(N.index,N),N=N.sibling;return I}function s(I,N){return I=To(I,N),I.index=0,I.sibling=null,I}function i(I,N,A){return I.index=A,t?(A=I.alternate,A!==null?(A=A.index,A<N?(I.flags|=2,N):A):(I.flags|=2,N)):(I.flags|=1048576,N)}function a(I){return t&&I.alternate===null&&(I.flags|=2),I}function l(I,N,A,L){return N===null||N.tag!==6?(N=Ax(A,I.mode,L),N.return=I,N):(N=s(N,A),N.return=I,N)}function d(I,N,A,L){var P=A.type;return P===Lc?f(I,N,A.props.children,L,A.key):N!==null&&(N.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===to&&fS(P)===N.type)?(L=s(N,A.props),L.ref=bd(I,N,A),L.return=I,L):(L=Hm(A.type,A.key,A.props,null,I.mode,L),L.ref=bd(I,N,A),L.return=I,L)}function u(I,N,A,L){return N===null||N.tag!==4||N.stateNode.containerInfo!==A.containerInfo||N.stateNode.implementation!==A.implementation?(N=Nx(A,I.mode,L),N.return=I,N):(N=s(N,A.children||[]),N.return=I,N)}function f(I,N,A,L,P){return N===null||N.tag!==7?(N=Il(A,I.mode,L,P),N.return=I,N):(N=s(N,A),N.return=I,N)}function p(I,N,A){if(typeof N=="string"&&N!==""||typeof N=="number")return N=Ax(""+N,I.mode,A),N.return=I,N;if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Uf:return A=Hm(N.type,N.key,N.props,null,I.mode,A),A.ref=bd(I,null,N),A.return=I,A;case _c:return N=Nx(N,I.mode,A),N.return=I,N;case to:var L=N._init;return p(I,L(N._payload),A)}if(Pd(N)||gd(N))return N=Il(N,I.mode,A,null),N.return=I,N;Qf(I,N)}return null}function y(I,N,A,L){var P=N!==null?N.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return P!==null?null:l(I,N,""+A,L);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Uf:return A.key===P?d(I,N,A,L):null;case _c:return A.key===P?u(I,N,A,L):null;case to:return P=A._init,y(I,N,P(A._payload),L)}if(Pd(A)||gd(A))return P!==null?null:f(I,N,A,L,null);Qf(I,A)}return null}function v(I,N,A,L,P){if(typeof L=="string"&&L!==""||typeof L=="number")return I=I.get(A)||null,l(N,I,""+L,P);if(typeof L=="object"&&L!==null){switch(L.$$typeof){case Uf:return I=I.get(L.key===null?A:L.key)||null,d(N,I,L,P);case _c:return I=I.get(L.key===null?A:L.key)||null,u(N,I,L,P);case to:var k=L._init;return v(I,N,A,k(L._payload),P)}if(Pd(L)||gd(L))return I=I.get(A)||null,f(N,I,L,P,null);Qf(N,L)}return null}function E(I,N,A,L){for(var P=null,k=null,D=N,O=N=0,F=null;D!==null&&O<A.length;O++){D.index>O?(F=D,D=null):F=D.sibling;var $=y(I,D,A[O],L);if($===null){D===null&&(D=F);break}t&&D&&$.alternate===null&&e(I,D),N=i($,N,O),k===null?P=$:k.sibling=$,k=$,D=F}if(O===A.length)return r(I,D),lr&&ll(I,O),P;if(D===null){for(;O<A.length;O++)D=p(I,A[O],L),D!==null&&(N=i(D,N,O),k===null?P=D:k.sibling=D,k=D);return lr&&ll(I,O),P}for(D=n(I,D);O<A.length;O++)F=v(D,I,O,A[O],L),F!==null&&(t&&F.alternate!==null&&D.delete(F.key===null?O:F.key),N=i(F,N,O),k===null?P=F:k.sibling=F,k=F);return t&&D.forEach(function(G){return e(I,G)}),lr&&ll(I,O),P}function b(I,N,A,L){var P=gd(A);if(typeof P!="function")throw Error(De(150));if(A=P.call(A),A==null)throw Error(De(151));for(var k=P=null,D=N,O=N=0,F=null,$=A.next();D!==null&&!$.done;O++,$=A.next()){D.index>O?(F=D,D=null):F=D.sibling;var G=y(I,D,$.value,L);if(G===null){D===null&&(D=F);break}t&&D&&G.alternate===null&&e(I,D),N=i(G,N,O),k===null?P=G:k.sibling=G,k=G,D=F}if($.done)return r(I,D),lr&&ll(I,O),P;if(D===null){for(;!$.done;O++,$=A.next())$=p(I,$.value,L),$!==null&&(N=i($,N,O),k===null?P=$:k.sibling=$,k=$);return lr&&ll(I,O),P}for(D=n(I,D);!$.done;O++,$=A.next())$=v(D,I,O,$.value,L),$!==null&&(t&&$.alternate!==null&&D.delete($.key===null?O:$.key),N=i($,N,O),k===null?P=$:k.sibling=$,k=$);return t&&D.forEach(function(Y){return e(I,Y)}),lr&&ll(I,O),P}function T(I,N,A,L){if(typeof A=="object"&&A!==null&&A.type===Lc&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Uf:e:{for(var P=A.key,k=N;k!==null;){if(k.key===P){if(P=A.type,P===Lc){if(k.tag===7){r(I,k.sibling),N=s(k,A.props.children),N.return=I,I=N;break e}}else if(k.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===to&&fS(P)===k.type){r(I,k.sibling),N=s(k,A.props),N.ref=bd(I,k,A),N.return=I,I=N;break e}r(I,k);break}else e(I,k);k=k.sibling}A.type===Lc?(N=Il(A.props.children,I.mode,L,A.key),N.return=I,I=N):(L=Hm(A.type,A.key,A.props,null,I.mode,L),L.ref=bd(I,N,A),L.return=I,I=L)}return a(I);case _c:e:{for(k=A.key;N!==null;){if(N.key===k)if(N.tag===4&&N.stateNode.containerInfo===A.containerInfo&&N.stateNode.implementation===A.implementation){r(I,N.sibling),N=s(N,A.children||[]),N.return=I,I=N;break e}else{r(I,N);break}else e(I,N);N=N.sibling}N=Nx(A,I.mode,L),N.return=I,I=N}return a(I);case to:return k=A._init,T(I,N,k(A._payload),L)}if(Pd(A))return E(I,N,A,L);if(gd(A))return b(I,N,A,L);Qf(I,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,N!==null&&N.tag===6?(r(I,N.sibling),N=s(N,A),N.return=I,I=N):(r(I,N),N=Ax(A,I.mode,L),N.return=I,I=N),a(I)):r(I,N)}return T}var Su=SR(!0),TR=SR(!1),A0=Vo(null),N0=null,Bc=null,Iw=null;function Rw(){Iw=Bc=N0=null}function _w(t){var e=A0.current;sr(A0),t._currentValue=e}function fy(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function eu(t,e){N0=t,Iw=Bc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(is=!0),t.firstContext=null)}function ei(t){var e=t._currentValue;if(Iw!==t)if(t={context:t,memoizedValue:e,next:null},Bc===null){if(N0===null)throw Error(De(308));Bc=t,N0.dependencies={lanes:0,firstContext:t}}else Bc=Bc.next=t;return e}var fl=null;function Lw(t){fl===null?fl=[t]:fl.push(t)}function CR(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Lw(e)):(r.next=s.next,s.next=r),e.interleaved=r,_a(t,n)}function _a(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var ro=!1;function Pw(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function AR(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Aa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function bo(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,jt&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,_a(t,r)}return s=n.interleaved,s===null?(e.next=e,Lw(n)):(e.next=s.next,s.next=e),n.interleaved=e,_a(t,r)}function Fm(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,xw(t,r)}}function mS(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?s=i=a:i=i.next=a,r=r.next}while(r!==null);i===null?s=i=e:i=i.next=e}else s=i=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function I0(t,e,r,n){var s=t.updateQueue;ro=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var d=l,u=d.next;d.next=null,a===null?i=u:a.next=u,a=d;var f=t.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==a&&(l===null?f.firstBaseUpdate=u:l.next=u,f.lastBaseUpdate=d))}if(i!==null){var p=s.baseState;a=0,f=u=d=null,l=i;do{var y=l.lane,v=l.eventTime;if((n&y)===y){f!==null&&(f=f.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var E=t,b=l;switch(y=e,v=r,b.tag){case 1:if(E=b.payload,typeof E=="function"){p=E.call(v,p,y);break e}p=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=b.payload,y=typeof E=="function"?E.call(v,p,y):E,y==null)break e;p=vr({},p,y);break e;case 2:ro=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,y=s.effects,y===null?s.effects=[l]:y.push(l))}else v={eventTime:v,lane:y,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(u=f=v,d=p):f=f.next=v,a|=y;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;y=l,l=y.next,y.next=null,s.lastBaseUpdate=y,s.shared.pending=null}}while(!0);if(f===null&&(d=p),s.baseState=d,s.firstBaseUpdate=u,s.lastBaseUpdate=f,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Ol|=a,t.lanes=a,t.memoizedState=p}}function pS(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(De(191,s));s.call(n)}}}var ef={},ea=Vo(ef),mh=Vo(ef),ph=Vo(ef);function ml(t){if(t===ef)throw Error(De(174));return t}function Dw(t,e){switch(Jt(ph,e),Jt(mh,t),Jt(ea,ef),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:K1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=K1(e,t)}sr(ea),Jt(ea,e)}function Tu(){sr(ea),sr(mh),sr(ph)}function NR(t){ml(ph.current);var e=ml(ea.current),r=K1(e,t.type);e!==r&&(Jt(mh,t),Jt(ea,r))}function kw(t){mh.current===t&&(sr(ea),sr(mh))}var hr=Vo(0);function R0(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wx=[];function jw(){for(var t=0;t<wx.length;t++)wx[t]._workInProgressVersionPrimary=null;wx.length=0}var Bm=Ma.ReactCurrentDispatcher,bx=Ma.ReactCurrentBatchConfig,Ml=0,xr=null,Jr=null,ln=null,_0=!1,Hd=!1,gh=0,_5=0;function Pn(){throw Error(De(321))}function Mw(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Ci(t[r],e[r]))return!1;return!0}function Ow(t,e,r,n,s,i){if(Ml=i,xr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Bm.current=t===null||t.memoizedState===null?k5:j5,t=r(n,s),Hd){i=0;do{if(Hd=!1,gh=0,25<=i)throw Error(De(301));i+=1,ln=Jr=null,e.updateQueue=null,Bm.current=M5,t=r(n,s)}while(Hd)}if(Bm.current=L0,e=Jr!==null&&Jr.next!==null,Ml=0,ln=Jr=xr=null,_0=!1,e)throw Error(De(300));return t}function Fw(){var t=gh!==0;return gh=0,t}function $i(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?xr.memoizedState=ln=t:ln=ln.next=t,ln}function ti(){if(Jr===null){var t=xr.alternate;t=t!==null?t.memoizedState:null}else t=Jr.next;var e=ln===null?xr.memoizedState:ln.next;if(e!==null)ln=e,Jr=t;else{if(t===null)throw Error(De(310));Jr=t,t={memoizedState:Jr.memoizedState,baseState:Jr.baseState,baseQueue:Jr.baseQueue,queue:Jr.queue,next:null},ln===null?xr.memoizedState=ln=t:ln=ln.next=t}return ln}function xh(t,e){return typeof e=="function"?e(t):e}function Ex(t){var e=ti(),r=e.queue;if(r===null)throw Error(De(311));r.lastRenderedReducer=t;var n=Jr,s=n.baseQueue,i=r.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}n.baseQueue=s=i,r.pending=null}if(s!==null){i=s.next,n=n.baseState;var l=a=null,d=null,u=i;do{var f=u.lane;if((Ml&f)===f)d!==null&&(d=d.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};d===null?(l=d=p,a=n):d=d.next=p,xr.lanes|=f,Ol|=f}u=u.next}while(u!==null&&u!==i);d===null?a=n:d.next=l,Ci(n,e.memoizedState)||(is=!0),e.memoizedState=n,e.baseState=a,e.baseQueue=d,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do i=s.lane,xr.lanes|=i,Ol|=i,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Sx(t){var e=ti(),r=e.queue;if(r===null)throw Error(De(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,i=e.memoizedState;if(s!==null){r.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);Ci(i,e.memoizedState)||(is=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),r.lastRenderedState=i}return[i,n]}function IR(){}function RR(t,e){var r=xr,n=ti(),s=e(),i=!Ci(n.memoizedState,s);if(i&&(n.memoizedState=s,is=!0),n=n.queue,Bw(PR.bind(null,r,n,t),[t]),n.getSnapshot!==e||i||ln!==null&&ln.memoizedState.tag&1){if(r.flags|=2048,yh(9,LR.bind(null,r,n,s,e),void 0,null),un===null)throw Error(De(349));Ml&30||_R(r,e,s)}return s}function _R(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=xr.updateQueue,e===null?(e={lastEffect:null,stores:null},xr.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function LR(t,e,r,n){e.value=r,e.getSnapshot=n,DR(e)&&kR(t)}function PR(t,e,r){return r(function(){DR(e)&&kR(t)})}function DR(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Ci(t,r)}catch{return!0}}function kR(t){var e=_a(t,1);e!==null&&Si(e,t,1,-1)}function gS(t){var e=$i();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xh,lastRenderedState:t},e.queue=t,t=t.dispatch=D5.bind(null,xr,t),[e.memoizedState,t]}function yh(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=xr.updateQueue,e===null?(e={lastEffect:null,stores:null},xr.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function jR(){return ti().memoizedState}function Um(t,e,r,n){var s=$i();xr.flags|=t,s.memoizedState=yh(1|e,r,void 0,n===void 0?null:n)}function Pp(t,e,r,n){var s=ti();n=n===void 0?null:n;var i=void 0;if(Jr!==null){var a=Jr.memoizedState;if(i=a.destroy,n!==null&&Mw(n,a.deps)){s.memoizedState=yh(e,r,i,n);return}}xr.flags|=t,s.memoizedState=yh(1|e,r,i,n)}function xS(t,e){return Um(8390656,8,t,e)}function Bw(t,e){return Pp(2048,8,t,e)}function MR(t,e){return Pp(4,2,t,e)}function OR(t,e){return Pp(4,4,t,e)}function FR(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function BR(t,e,r){return r=r!=null?r.concat([t]):null,Pp(4,4,FR.bind(null,e,t),r)}function Uw(){}function UR(t,e){var r=ti();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Mw(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function $R(t,e){var r=ti();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Mw(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function VR(t,e,r){return Ml&21?(Ci(r,e)||(r=KI(),xr.lanes|=r,Ol|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,is=!0),t.memoizedState=r)}function L5(t,e){var r=Gt;Gt=r!==0&&4>r?r:4,t(!0);var n=bx.transition;bx.transition={};try{t(!1),e()}finally{Gt=r,bx.transition=n}}function GR(){return ti().memoizedState}function P5(t,e,r){var n=So(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},HR(t))zR(e,r);else if(r=CR(t,e,r,n),r!==null){var s=Kn();Si(r,t,n,s),WR(r,e,n)}}function D5(t,e,r){var n=So(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(HR(t))zR(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,l=i(a,r);if(s.hasEagerState=!0,s.eagerState=l,Ci(l,a)){var d=e.interleaved;d===null?(s.next=s,Lw(e)):(s.next=d.next,d.next=s),e.interleaved=s;return}}catch{}finally{}r=CR(t,e,s,n),r!==null&&(s=Kn(),Si(r,t,n,s),WR(r,e,n))}}function HR(t){var e=t.alternate;return t===xr||e!==null&&e===xr}function zR(t,e){Hd=_0=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function WR(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,xw(t,r)}}var L0={readContext:ei,useCallback:Pn,useContext:Pn,useEffect:Pn,useImperativeHandle:Pn,useInsertionEffect:Pn,useLayoutEffect:Pn,useMemo:Pn,useReducer:Pn,useRef:Pn,useState:Pn,useDebugValue:Pn,useDeferredValue:Pn,useTransition:Pn,useMutableSource:Pn,useSyncExternalStore:Pn,useId:Pn,unstable_isNewReconciler:!1},k5={readContext:ei,useCallback:function(t,e){return $i().memoizedState=[t,e===void 0?null:e],t},useContext:ei,useEffect:xS,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Um(4194308,4,FR.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Um(4194308,4,t,e)},useInsertionEffect:function(t,e){return Um(4,2,t,e)},useMemo:function(t,e){var r=$i();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=$i();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=P5.bind(null,xr,t),[n.memoizedState,t]},useRef:function(t){var e=$i();return t={current:t},e.memoizedState=t},useState:gS,useDebugValue:Uw,useDeferredValue:function(t){return $i().memoizedState=t},useTransition:function(){var t=gS(!1),e=t[0];return t=L5.bind(null,t[1]),$i().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=xr,s=$i();if(lr){if(r===void 0)throw Error(De(407));r=r()}else{if(r=e(),un===null)throw Error(De(349));Ml&30||_R(n,e,r)}s.memoizedState=r;var i={value:r,getSnapshot:e};return s.queue=i,xS(PR.bind(null,n,i,t),[t]),n.flags|=2048,yh(9,LR.bind(null,n,i,r,e),void 0,null),r},useId:function(){var t=$i(),e=un.identifierPrefix;if(lr){var r=Ca,n=Ta;r=(n&~(1<<32-Ei(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=gh++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=_5++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},j5={readContext:ei,useCallback:UR,useContext:ei,useEffect:Bw,useImperativeHandle:BR,useInsertionEffect:MR,useLayoutEffect:OR,useMemo:$R,useReducer:Ex,useRef:jR,useState:function(){return Ex(xh)},useDebugValue:Uw,useDeferredValue:function(t){var e=ti();return VR(e,Jr.memoizedState,t)},useTransition:function(){var t=Ex(xh)[0],e=ti().memoizedState;return[t,e]},useMutableSource:IR,useSyncExternalStore:RR,useId:GR,unstable_isNewReconciler:!1},M5={readContext:ei,useCallback:UR,useContext:ei,useEffect:Bw,useImperativeHandle:BR,useInsertionEffect:MR,useLayoutEffect:OR,useMemo:$R,useReducer:Sx,useRef:jR,useState:function(){return Sx(xh)},useDebugValue:Uw,useDeferredValue:function(t){var e=ti();return Jr===null?e.memoizedState=t:VR(e,Jr.memoizedState,t)},useTransition:function(){var t=Sx(xh)[0],e=ti().memoizedState;return[t,e]},useMutableSource:IR,useSyncExternalStore:RR,useId:GR,unstable_isNewReconciler:!1};function gi(t,e){if(t&&t.defaultProps){e=vr({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function my(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:vr({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Dp={isMounted:function(t){return(t=t._reactInternals)?Zl(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Kn(),s=So(t),i=Aa(n,s);i.payload=e,r!=null&&(i.callback=r),e=bo(t,i,s),e!==null&&(Si(e,t,s,n),Fm(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Kn(),s=So(t),i=Aa(n,s);i.tag=1,i.payload=e,r!=null&&(i.callback=r),e=bo(t,i,s),e!==null&&(Si(e,t,s,n),Fm(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Kn(),n=So(t),s=Aa(r,n);s.tag=2,e!=null&&(s.callback=e),e=bo(t,s,n),e!==null&&(Si(e,t,n,r),Fm(e,t,n))}};function yS(t,e,r,n,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,i,a):e.prototype&&e.prototype.isPureReactComponent?!uh(r,n)||!uh(s,i):!0}function KR(t,e,r){var n=!1,s=Io,i=e.contextType;return typeof i=="object"&&i!==null?i=ei(i):(s=us(e)?kl:Fn.current,n=e.contextTypes,i=(n=n!=null)?bu(t,s):Io),e=new e(r,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Dp,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function vS(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Dp.enqueueReplaceState(e,e.state,null)}function py(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Pw(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ei(i):(i=us(e)?kl:Fn.current,s.context=bu(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(my(t,e,i,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Dp.enqueueReplaceState(s,s.state,null),I0(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Cu(t,e){try{var r="",n=e;do r+=u6(n),n=n.return;while(n);var s=r}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Tx(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function gy(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var O5=typeof WeakMap=="function"?WeakMap:Map;function YR(t,e,r){r=Aa(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){D0||(D0=!0,Ay=n),gy(t,e)},r}function qR(t,e,r){r=Aa(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){gy(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){gy(t,e),typeof n!="function"&&(Eo===null?Eo=new Set([this]):Eo.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),r}function wS(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new O5;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Q5.bind(null,t,e,r),e.then(t,t))}function bS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function ES(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Aa(-1,1),e.tag=2,bo(r,e,1))),r.lanes|=1),t)}var F5=Ma.ReactCurrentOwner,is=!1;function Gn(t,e,r,n){e.child=t===null?TR(e,null,r,n):Su(e,t.child,r,n)}function SS(t,e,r,n,s){r=r.render;var i=e.ref;return eu(e,s),n=Ow(t,e,r,n,i,s),r=Fw(),t!==null&&!is?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,La(t,e,s)):(lr&&r&&Cw(e),e.flags|=1,Gn(t,e,n,s),e.child)}function TS(t,e,r,n,s){if(t===null){var i=r.type;return typeof i=="function"&&!Yw(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=i,XR(t,e,i,n,s)):(t=Hm(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(r=r.compare,r=r!==null?r:uh,r(a,n)&&t.ref===e.ref)return La(t,e,s)}return e.flags|=1,t=To(i,n),t.ref=e.ref,t.return=e,e.child=t}function XR(t,e,r,n,s){if(t!==null){var i=t.memoizedProps;if(uh(i,n)&&t.ref===e.ref)if(is=!1,e.pendingProps=n=i,(t.lanes&s)!==0)t.flags&131072&&(is=!0);else return e.lanes=t.lanes,La(t,e,s)}return xy(t,e,r,n,s)}function QR(t,e,r){var n=e.pendingProps,s=n.children,i=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt($c,Ss),Ss|=r;else{if(!(r&1073741824))return t=i!==null?i.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Jt($c,Ss),Ss|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=i!==null?i.baseLanes:r,Jt($c,Ss),Ss|=n}else i!==null?(n=i.baseLanes|r,e.memoizedState=null):n=r,Jt($c,Ss),Ss|=n;return Gn(t,e,s,r),e.child}function ZR(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function xy(t,e,r,n,s){var i=us(r)?kl:Fn.current;return i=bu(e,i),eu(e,s),r=Ow(t,e,r,n,i,s),n=Fw(),t!==null&&!is?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,La(t,e,s)):(lr&&n&&Cw(e),e.flags|=1,Gn(t,e,r,s),e.child)}function CS(t,e,r,n,s){if(us(r)){var i=!0;S0(e)}else i=!1;if(eu(e,s),e.stateNode===null)$m(t,e),KR(e,r,n),py(e,r,n,s),n=!0;else if(t===null){var a=e.stateNode,l=e.memoizedProps;a.props=l;var d=a.context,u=r.contextType;typeof u=="object"&&u!==null?u=ei(u):(u=us(r)?kl:Fn.current,u=bu(e,u));var f=r.getDerivedStateFromProps,p=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";p||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==n||d!==u)&&vS(e,a,n,u),ro=!1;var y=e.memoizedState;a.state=y,I0(e,n,a,s),d=e.memoizedState,l!==n||y!==d||cs.current||ro?(typeof f=="function"&&(my(e,r,f,n),d=e.memoizedState),(l=ro||yS(e,r,l,n,y,d,u))?(p||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=d),a.props=n,a.state=d,a.context=u,n=l):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{a=e.stateNode,AR(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:gi(e.type,l),a.props=u,p=e.pendingProps,y=a.context,d=r.contextType,typeof d=="object"&&d!==null?d=ei(d):(d=us(r)?kl:Fn.current,d=bu(e,d));var v=r.getDerivedStateFromProps;(f=typeof v=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(l!==p||y!==d)&&vS(e,a,n,d),ro=!1,y=e.memoizedState,a.state=y,I0(e,n,a,s);var E=e.memoizedState;l!==p||y!==E||cs.current||ro?(typeof v=="function"&&(my(e,r,v,n),E=e.memoizedState),(u=ro||yS(e,r,u,n,y,E,d)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,E,d),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,E,d)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=E),a.props=n,a.state=E,a.context=d,n=u):(typeof a.componentDidUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&y===t.memoizedState||(e.flags|=1024),n=!1)}return yy(t,e,r,n,i,s)}function yy(t,e,r,n,s,i){ZR(t,e);var a=(e.flags&128)!==0;if(!n&&!a)return s&&uS(e,r,!1),La(t,e,i);n=e.stateNode,F5.current=e;var l=a&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&a?(e.child=Su(e,t.child,null,i),e.child=Su(e,null,l,i)):Gn(t,e,l,i),e.memoizedState=n.state,s&&uS(e,r,!0),e.child}function JR(t){var e=t.stateNode;e.pendingContext?cS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&cS(t,e.context,!1),Dw(t,e.containerInfo)}function AS(t,e,r,n,s){return Eu(),Nw(s),e.flags|=256,Gn(t,e,r,n),e.child}var vy={dehydrated:null,treeContext:null,retryLane:0};function wy(t){return{baseLanes:t,cachePool:null,transitions:null}}function e_(t,e,r){var n=e.pendingProps,s=hr.current,i=!1,a=(e.flags&128)!==0,l;if((l=a)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Jt(hr,s&1),t===null)return hy(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=n.children,t=n.fallback,i?(n=e.mode,i=e.child,a={mode:"hidden",children:a},!(n&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Mp(a,n,0,null),t=Il(t,n,r,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=wy(r),e.memoizedState=vy,t):$w(e,a));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return B5(t,e,a,n,l,s,r);if(i){i=n.fallback,a=e.mode,s=t.child,l=s.sibling;var d={mode:"hidden",children:n.children};return!(a&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=d,e.deletions=null):(n=To(s,d),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=To(l,i):(i=Il(i,a,r,null),i.flags|=2),i.return=e,n.return=e,n.sibling=i,e.child=n,n=i,i=e.child,a=t.child.memoizedState,a=a===null?wy(r):{baseLanes:a.baseLanes|r,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=t.childLanes&~r,e.memoizedState=vy,n}return i=t.child,t=i.sibling,n=To(i,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function $w(t,e){return e=Mp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Zf(t,e,r,n){return n!==null&&Nw(n),Su(e,t.child,null,r),t=$w(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function B5(t,e,r,n,s,i,a){if(r)return e.flags&256?(e.flags&=-257,n=Tx(Error(De(422))),Zf(t,e,a,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=n.fallback,s=e.mode,n=Mp({mode:"visible",children:n.children},s,0,null),i=Il(i,s,a,null),i.flags|=2,n.return=e,i.return=e,n.sibling=i,e.child=n,e.mode&1&&Su(e,t.child,null,a),e.child.memoizedState=wy(a),e.memoizedState=vy,i);if(!(e.mode&1))return Zf(t,e,a,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,i=Error(De(419)),n=Tx(i,n,void 0),Zf(t,e,a,n)}if(l=(a&t.childLanes)!==0,is||l){if(n=un,n!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,_a(t,s),Si(n,t,s,-1))}return Kw(),n=Tx(Error(De(421))),Zf(t,e,a,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Z5.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ns=wo(s.nextSibling),Is=e,lr=!0,bi=null,t!==null&&(Ws[Ks++]=Ta,Ws[Ks++]=Ca,Ws[Ks++]=jl,Ta=t.id,Ca=t.overflow,jl=e),e=$w(e,n.children),e.flags|=4096,e)}function NS(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),fy(t.return,e,r)}function Cx(t,e,r,n,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=r,i.tailMode=s)}function t_(t,e,r){var n=e.pendingProps,s=n.revealOrder,i=n.tail;if(Gn(t,e,n.children,r),n=hr.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&NS(t,r,e);else if(t.tag===19)NS(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Jt(hr,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&R0(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Cx(e,!1,s,r,i);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&R0(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Cx(e,!0,r,null,i);break;case"together":Cx(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $m(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function La(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Ol|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(De(153));if(e.child!==null){for(t=e.child,r=To(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=To(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function U5(t,e,r){switch(e.tag){case 3:JR(e),Eu();break;case 5:NR(e);break;case 1:us(e.type)&&S0(e);break;case 4:Dw(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Jt(A0,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Jt(hr,hr.current&1),e.flags|=128,null):r&e.child.childLanes?e_(t,e,r):(Jt(hr,hr.current&1),t=La(t,e,r),t!==null?t.sibling:null);Jt(hr,hr.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return t_(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Jt(hr,hr.current),n)break;return null;case 22:case 23:return e.lanes=0,QR(t,e,r)}return La(t,e,r)}var r_,by,n_,s_;r_=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};by=function(){};n_=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,ml(ea.current);var i=null;switch(r){case"input":s=G1(t,s),n=G1(t,n),i=[];break;case"select":s=vr({},s,{value:void 0}),n=vr({},n,{value:void 0}),i=[];break;case"textarea":s=W1(t,s),n=W1(t,n),i=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=b0)}Y1(r,n);var a;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(a in l)l.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(nh.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in n){var d=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&d!==l&&(d!=null||l!=null))if(u==="style")if(l){for(a in l)!l.hasOwnProperty(a)||d&&d.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in d)d.hasOwnProperty(a)&&l[a]!==d[a]&&(r||(r={}),r[a]=d[a])}else r||(i||(i=[]),i.push(u,r)),r=d;else u==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(i=i||[]).push(u,d)):u==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(u,""+d):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(nh.hasOwnProperty(u)?(d!=null&&u==="onScroll"&&rr("scroll",t),i||l===d||(i=[])):(i=i||[]).push(u,d))}r&&(i=i||[]).push("style",r);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};s_=function(t,e,r,n){r!==n&&(e.flags|=4)};function Ed(t,e){if(!lr)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Dn(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function $5(t,e,r){var n=e.pendingProps;switch(Aw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dn(e),null;case 1:return us(e.type)&&E0(),Dn(e),null;case 3:return n=e.stateNode,Tu(),sr(cs),sr(Fn),jw(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Xf(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bi!==null&&(Ry(bi),bi=null))),by(t,e),Dn(e),null;case 5:kw(e);var s=ml(ph.current);if(r=e.type,t!==null&&e.stateNode!=null)n_(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(De(166));return Dn(e),null}if(t=ml(ea.current),Xf(e)){n=e.stateNode,r=e.type;var i=e.memoizedProps;switch(n[Ki]=e,n[fh]=i,t=(e.mode&1)!==0,r){case"dialog":rr("cancel",n),rr("close",n);break;case"iframe":case"object":case"embed":rr("load",n);break;case"video":case"audio":for(s=0;s<kd.length;s++)rr(kd[s],n);break;case"source":rr("error",n);break;case"img":case"image":case"link":rr("error",n),rr("load",n);break;case"details":rr("toggle",n);break;case"input":M2(n,i),rr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},rr("invalid",n);break;case"textarea":F2(n,i),rr("invalid",n)}Y1(r,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];a==="children"?typeof l=="string"?n.textContent!==l&&(i.suppressHydrationWarning!==!0&&qf(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&qf(n.textContent,l,t),s=["children",""+l]):nh.hasOwnProperty(a)&&l!=null&&a==="onScroll"&&rr("scroll",n)}switch(r){case"input":$f(n),O2(n,i,!0);break;case"textarea":$f(n),B2(n);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(n.onclick=b0)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=PI(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=a.createElement(r,{is:n.is}):(t=a.createElement(r),r==="select"&&(a=t,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):t=a.createElementNS(t,r),t[Ki]=e,t[fh]=n,r_(t,e,!1,!1),e.stateNode=t;e:{switch(a=q1(r,n),r){case"dialog":rr("cancel",t),rr("close",t),s=n;break;case"iframe":case"object":case"embed":rr("load",t),s=n;break;case"video":case"audio":for(s=0;s<kd.length;s++)rr(kd[s],t);s=n;break;case"source":rr("error",t),s=n;break;case"img":case"image":case"link":rr("error",t),rr("load",t),s=n;break;case"details":rr("toggle",t),s=n;break;case"input":M2(t,n),s=G1(t,n),rr("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=vr({},n,{value:void 0}),rr("invalid",t);break;case"textarea":F2(t,n),s=W1(t,n),rr("invalid",t);break;default:s=n}Y1(r,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="style"?jI(t,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&DI(t,d)):i==="children"?typeof d=="string"?(r!=="textarea"||d!=="")&&sh(t,d):typeof d=="number"&&sh(t,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(nh.hasOwnProperty(i)?d!=null&&i==="onScroll"&&rr("scroll",t):d!=null&&dw(t,i,d,a))}switch(r){case"input":$f(t),O2(t,n,!1);break;case"textarea":$f(t),B2(t);break;case"option":n.value!=null&&t.setAttribute("value",""+No(n.value));break;case"select":t.multiple=!!n.multiple,i=n.value,i!=null?Xc(t,!!n.multiple,i,!1):n.defaultValue!=null&&Xc(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=b0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Dn(e),null;case 6:if(t&&e.stateNode!=null)s_(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(De(166));if(r=ml(ph.current),ml(ea.current),Xf(e)){if(n=e.stateNode,r=e.memoizedProps,n[Ki]=e,(i=n.nodeValue!==r)&&(t=Is,t!==null))switch(t.tag){case 3:qf(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qf(n.nodeValue,r,(t.mode&1)!==0)}i&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ki]=e,e.stateNode=n}return Dn(e),null;case 13:if(sr(hr),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(lr&&Ns!==null&&e.mode&1&&!(e.flags&128))ER(),Eu(),e.flags|=98560,i=!1;else if(i=Xf(e),n!==null&&n.dehydrated!==null){if(t===null){if(!i)throw Error(De(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(De(317));i[Ki]=e}else Eu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Dn(e),i=!1}else bi!==null&&(Ry(bi),bi=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||hr.current&1?tn===0&&(tn=3):Kw())),e.updateQueue!==null&&(e.flags|=4),Dn(e),null);case 4:return Tu(),by(t,e),t===null&&dh(e.stateNode.containerInfo),Dn(e),null;case 10:return _w(e.type._context),Dn(e),null;case 17:return us(e.type)&&E0(),Dn(e),null;case 19:if(sr(hr),i=e.memoizedState,i===null)return Dn(e),null;if(n=(e.flags&128)!==0,a=i.rendering,a===null)if(n)Ed(i,!1);else{if(tn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=R0(t),a!==null){for(e.flags|=128,Ed(i,!1),n=a.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)i=r,t=n,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Jt(hr,hr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Mr()>Au&&(e.flags|=128,n=!0,Ed(i,!1),e.lanes=4194304)}else{if(!n)if(t=R0(a),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),Ed(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!lr)return Dn(e),null}else 2*Mr()-i.renderingStartTime>Au&&r!==1073741824&&(e.flags|=128,n=!0,Ed(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(r=i.last,r!==null?r.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Mr(),e.sibling=null,r=hr.current,Jt(hr,n?r&1|2:r&1),e):(Dn(e),null);case 22:case 23:return Ww(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ss&1073741824&&(Dn(e),e.subtreeFlags&6&&(e.flags|=8192)):Dn(e),null;case 24:return null;case 25:return null}throw Error(De(156,e.tag))}function V5(t,e){switch(Aw(e),e.tag){case 1:return us(e.type)&&E0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tu(),sr(cs),sr(Fn),jw(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return kw(e),null;case 13:if(sr(hr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(De(340));Eu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return sr(hr),null;case 4:return Tu(),null;case 10:return _w(e.type._context),null;case 22:case 23:return Ww(),null;case 24:return null;default:return null}}var Jf=!1,jn=!1,G5=typeof WeakSet=="function"?WeakSet:Set,qe=null;function Uc(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nr(t,e,n)}else r.current=null}function Ey(t,e,r){try{r()}catch(n){Nr(t,e,n)}}var IS=!1;function H5(t,e){if(iy=y0,t=cR(),Tw(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var a=0,l=-1,d=-1,u=0,f=0,p=t,y=null;t:for(;;){for(var v;p!==r||s!==0&&p.nodeType!==3||(l=a+s),p!==i||n!==0&&p.nodeType!==3||(d=a+n),p.nodeType===3&&(a+=p.nodeValue.length),(v=p.firstChild)!==null;)y=p,p=v;for(;;){if(p===t)break t;if(y===r&&++u===s&&(l=a),y===i&&++f===n&&(d=a),(v=p.nextSibling)!==null)break;p=y,y=p.parentNode}p=v}r=l===-1||d===-1?null:{start:l,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(ay={focusedElem:t,selectionRange:r},y0=!1,qe=e;qe!==null;)if(e=qe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,qe=t;else for(;qe!==null;){e=qe;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var b=E.memoizedProps,T=E.memoizedState,I=e.stateNode,N=I.getSnapshotBeforeUpdate(e.elementType===e.type?b:gi(e.type,b),T);I.__reactInternalSnapshotBeforeUpdate=N}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(De(163))}}catch(L){Nr(e,e.return,L)}if(t=e.sibling,t!==null){t.return=e.return,qe=t;break}qe=e.return}return E=IS,IS=!1,E}function zd(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Ey(e,r,i)}s=s.next}while(s!==n)}}function kp(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Sy(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function i_(t){var e=t.alternate;e!==null&&(t.alternate=null,i_(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ki],delete e[fh],delete e[cy],delete e[A5],delete e[N5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function a_(t){return t.tag===5||t.tag===3||t.tag===4}function RS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||a_(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Ty(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=b0));else if(n!==4&&(t=t.child,t!==null))for(Ty(t,e,r),t=t.sibling;t!==null;)Ty(t,e,r),t=t.sibling}function Cy(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Cy(t,e,r),t=t.sibling;t!==null;)Cy(t,e,r),t=t.sibling}var xn=null,wi=!1;function Ka(t,e,r){for(r=r.child;r!==null;)o_(t,e,r),r=r.sibling}function o_(t,e,r){if(Ji&&typeof Ji.onCommitFiberUnmount=="function")try{Ji.onCommitFiberUnmount(Ap,r)}catch{}switch(r.tag){case 5:jn||Uc(r,e);case 6:var n=xn,s=wi;xn=null,Ka(t,e,r),xn=n,wi=s,xn!==null&&(wi?(t=xn,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):xn.removeChild(r.stateNode));break;case 18:xn!==null&&(wi?(t=xn,r=r.stateNode,t.nodeType===8?yx(t.parentNode,r):t.nodeType===1&&yx(t,r),lh(t)):yx(xn,r.stateNode));break;case 4:n=xn,s=wi,xn=r.stateNode.containerInfo,wi=!0,Ka(t,e,r),xn=n,wi=s;break;case 0:case 11:case 14:case 15:if(!jn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Ey(r,e,a),s=s.next}while(s!==n)}Ka(t,e,r);break;case 1:if(!jn&&(Uc(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Nr(r,e,l)}Ka(t,e,r);break;case 21:Ka(t,e,r);break;case 22:r.mode&1?(jn=(n=jn)||r.memoizedState!==null,Ka(t,e,r),jn=n):Ka(t,e,r);break;default:Ka(t,e,r)}}function _S(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new G5),e.forEach(function(n){var s=J5.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function ci(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var i=t,a=e,l=a;e:for(;l!==null;){switch(l.tag){case 5:xn=l.stateNode,wi=!1;break e;case 3:xn=l.stateNode.containerInfo,wi=!0;break e;case 4:xn=l.stateNode.containerInfo,wi=!0;break e}l=l.return}if(xn===null)throw Error(De(160));o_(i,a,s),xn=null,wi=!1;var d=s.alternate;d!==null&&(d.return=null),s.return=null}catch(u){Nr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)l_(e,t),e=e.sibling}function l_(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ci(e,t),Oi(t),n&4){try{zd(3,t,t.return),kp(3,t)}catch(b){Nr(t,t.return,b)}try{zd(5,t,t.return)}catch(b){Nr(t,t.return,b)}}break;case 1:ci(e,t),Oi(t),n&512&&r!==null&&Uc(r,r.return);break;case 5:if(ci(e,t),Oi(t),n&512&&r!==null&&Uc(r,r.return),t.flags&32){var s=t.stateNode;try{sh(s,"")}catch(b){Nr(t,t.return,b)}}if(n&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,a=r!==null?r.memoizedProps:i,l=t.type,d=t.updateQueue;if(t.updateQueue=null,d!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&_I(s,i),q1(l,a);var u=q1(l,i);for(a=0;a<d.length;a+=2){var f=d[a],p=d[a+1];f==="style"?jI(s,p):f==="dangerouslySetInnerHTML"?DI(s,p):f==="children"?sh(s,p):dw(s,f,p,u)}switch(l){case"input":H1(s,i);break;case"textarea":LI(s,i);break;case"select":var y=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?Xc(s,!!i.multiple,v,!1):y!==!!i.multiple&&(i.defaultValue!=null?Xc(s,!!i.multiple,i.defaultValue,!0):Xc(s,!!i.multiple,i.multiple?[]:"",!1))}s[fh]=i}catch(b){Nr(t,t.return,b)}}break;case 6:if(ci(e,t),Oi(t),n&4){if(t.stateNode===null)throw Error(De(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(b){Nr(t,t.return,b)}}break;case 3:if(ci(e,t),Oi(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{lh(e.containerInfo)}catch(b){Nr(t,t.return,b)}break;case 4:ci(e,t),Oi(t);break;case 13:ci(e,t),Oi(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Hw=Mr())),n&4&&_S(t);break;case 22:if(f=r!==null&&r.memoizedState!==null,t.mode&1?(jn=(u=jn)||f,ci(e,t),jn=u):ci(e,t),Oi(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!f&&t.mode&1)for(qe=t,f=t.child;f!==null;){for(p=qe=f;qe!==null;){switch(y=qe,v=y.child,y.tag){case 0:case 11:case 14:case 15:zd(4,y,y.return);break;case 1:Uc(y,y.return);var E=y.stateNode;if(typeof E.componentWillUnmount=="function"){n=y,r=y.return;try{e=n,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(b){Nr(n,r,b)}}break;case 5:Uc(y,y.return);break;case 22:if(y.memoizedState!==null){PS(p);continue}}v!==null?(v.return=y,qe=v):PS(p)}f=f.sibling}e:for(f=null,p=t;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,d=p.memoizedProps.style,a=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=kI("display",a))}catch(b){Nr(t,t.return,b)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(b){Nr(t,t.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:ci(e,t),Oi(t),n&4&&_S(t);break;case 21:break;default:ci(e,t),Oi(t)}}function Oi(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(a_(r)){var n=r;break e}r=r.return}throw Error(De(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(sh(s,""),n.flags&=-33);var i=RS(t);Cy(t,i,s);break;case 3:case 4:var a=n.stateNode.containerInfo,l=RS(t);Ty(t,l,a);break;default:throw Error(De(161))}}catch(d){Nr(t,t.return,d)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function z5(t,e,r){qe=t,c_(t)}function c_(t,e,r){for(var n=(t.mode&1)!==0;qe!==null;){var s=qe,i=s.child;if(s.tag===22&&n){var a=s.memoizedState!==null||Jf;if(!a){var l=s.alternate,d=l!==null&&l.memoizedState!==null||jn;l=Jf;var u=jn;if(Jf=a,(jn=d)&&!u)for(qe=s;qe!==null;)a=qe,d=a.child,a.tag===22&&a.memoizedState!==null?DS(s):d!==null?(d.return=a,qe=d):DS(s);for(;i!==null;)qe=i,c_(i),i=i.sibling;qe=s,Jf=l,jn=u}LS(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,qe=i):LS(t)}}function LS(t){for(;qe!==null;){var e=qe;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jn||kp(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!jn)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:gi(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&pS(e,i,n);break;case 3:var a=e.updateQueue;if(a!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}pS(e,a,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var d=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&lh(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(De(163))}jn||e.flags&512&&Sy(e)}catch(y){Nr(e,e.return,y)}}if(e===t){qe=null;break}if(r=e.sibling,r!==null){r.return=e.return,qe=r;break}qe=e.return}}function PS(t){for(;qe!==null;){var e=qe;if(e===t){qe=null;break}var r=e.sibling;if(r!==null){r.return=e.return,qe=r;break}qe=e.return}}function DS(t){for(;qe!==null;){var e=qe;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{kp(4,e)}catch(d){Nr(e,r,d)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(d){Nr(e,s,d)}}var i=e.return;try{Sy(e)}catch(d){Nr(e,i,d)}break;case 5:var a=e.return;try{Sy(e)}catch(d){Nr(e,a,d)}}}catch(d){Nr(e,e.return,d)}if(e===t){qe=null;break}var l=e.sibling;if(l!==null){l.return=e.return,qe=l;break}qe=e.return}}var W5=Math.ceil,P0=Ma.ReactCurrentDispatcher,Vw=Ma.ReactCurrentOwner,Qs=Ma.ReactCurrentBatchConfig,jt=0,un=null,Gr=null,Tn=0,Ss=0,$c=Vo(0),tn=0,vh=null,Ol=0,jp=0,Gw=0,Wd=null,ss=null,Hw=0,Au=1/0,ya=null,D0=!1,Ay=null,Eo=null,em=!1,po=null,k0=0,Kd=0,Ny=null,Vm=-1,Gm=0;function Kn(){return jt&6?Mr():Vm!==-1?Vm:Vm=Mr()}function So(t){return t.mode&1?jt&2&&Tn!==0?Tn&-Tn:R5.transition!==null?(Gm===0&&(Gm=KI()),Gm):(t=Gt,t!==0||(t=window.event,t=t===void 0?16:eR(t.type)),t):1}function Si(t,e,r,n){if(50<Kd)throw Kd=0,Ny=null,Error(De(185));Qh(t,r,n),(!(jt&2)||t!==un)&&(t===un&&(!(jt&2)&&(jp|=r),tn===4&&ao(t,Tn)),ds(t,n),r===1&&jt===0&&!(e.mode&1)&&(Au=Mr()+500,Lp&&Go()))}function ds(t,e){var r=t.callbackNode;R6(t,e);var n=x0(t,t===un?Tn:0);if(n===0)r!==null&&V2(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&V2(r),e===1)t.tag===0?I5(kS.bind(null,t)):vR(kS.bind(null,t)),T5(function(){!(jt&6)&&Go()}),r=null;else{switch(YI(n)){case 1:r=gw;break;case 4:r=zI;break;case 16:r=g0;break;case 536870912:r=WI;break;default:r=g0}r=x_(r,u_.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function u_(t,e){if(Vm=-1,Gm=0,jt&6)throw Error(De(327));var r=t.callbackNode;if(tu()&&t.callbackNode!==r)return null;var n=x0(t,t===un?Tn:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=j0(t,n);else{e=n;var s=jt;jt|=2;var i=h_();(un!==t||Tn!==e)&&(ya=null,Au=Mr()+500,Nl(t,e));do try{q5();break}catch(l){d_(t,l)}while(!0);Rw(),P0.current=i,jt=s,Gr!==null?e=0:(un=null,Tn=0,e=tn)}if(e!==0){if(e===2&&(s=ey(t),s!==0&&(n=s,e=Iy(t,s))),e===1)throw r=vh,Nl(t,0),ao(t,n),ds(t,Mr()),r;if(e===6)ao(t,n);else{if(s=t.current.alternate,!(n&30)&&!K5(s)&&(e=j0(t,n),e===2&&(i=ey(t),i!==0&&(n=i,e=Iy(t,i))),e===1))throw r=vh,Nl(t,0),ao(t,n),ds(t,Mr()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(De(345));case 2:cl(t,ss,ya);break;case 3:if(ao(t,n),(n&130023424)===n&&(e=Hw+500-Mr(),10<e)){if(x0(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Kn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=ly(cl.bind(null,t,ss,ya),e);break}cl(t,ss,ya);break;case 4:if(ao(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var a=31-Ei(n);i=1<<a,a=e[a],a>s&&(s=a),n&=~i}if(n=s,n=Mr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*W5(n/1960))-n,10<n){t.timeoutHandle=ly(cl.bind(null,t,ss,ya),n);break}cl(t,ss,ya);break;case 5:cl(t,ss,ya);break;default:throw Error(De(329))}}}return ds(t,Mr()),t.callbackNode===r?u_.bind(null,t):null}function Iy(t,e){var r=Wd;return t.current.memoizedState.isDehydrated&&(Nl(t,e).flags|=256),t=j0(t,e),t!==2&&(e=ss,ss=r,e!==null&&Ry(e)),t}function Ry(t){ss===null?ss=t:ss.push.apply(ss,t)}function K5(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],i=s.getSnapshot;s=s.value;try{if(!Ci(i(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ao(t,e){for(e&=~Gw,e&=~jp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ei(e),n=1<<r;t[r]=-1,e&=~n}}function kS(t){if(jt&6)throw Error(De(327));tu();var e=x0(t,0);if(!(e&1))return ds(t,Mr()),null;var r=j0(t,e);if(t.tag!==0&&r===2){var n=ey(t);n!==0&&(e=n,r=Iy(t,n))}if(r===1)throw r=vh,Nl(t,0),ao(t,e),ds(t,Mr()),r;if(r===6)throw Error(De(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,cl(t,ss,ya),ds(t,Mr()),null}function zw(t,e){var r=jt;jt|=1;try{return t(e)}finally{jt=r,jt===0&&(Au=Mr()+500,Lp&&Go())}}function Fl(t){po!==null&&po.tag===0&&!(jt&6)&&tu();var e=jt;jt|=1;var r=Qs.transition,n=Gt;try{if(Qs.transition=null,Gt=1,t)return t()}finally{Gt=n,Qs.transition=r,jt=e,!(jt&6)&&Go()}}function Ww(){Ss=$c.current,sr($c)}function Nl(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,S5(r)),Gr!==null)for(r=Gr.return;r!==null;){var n=r;switch(Aw(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&E0();break;case 3:Tu(),sr(cs),sr(Fn),jw();break;case 5:kw(n);break;case 4:Tu();break;case 13:sr(hr);break;case 19:sr(hr);break;case 10:_w(n.type._context);break;case 22:case 23:Ww()}r=r.return}if(un=t,Gr=t=To(t.current,null),Tn=Ss=e,tn=0,vh=null,Gw=jp=Ol=0,ss=Wd=null,fl!==null){for(e=0;e<fl.length;e++)if(r=fl[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,i=r.pending;if(i!==null){var a=i.next;i.next=s,n.next=a}r.pending=n}fl=null}return t}function d_(t,e){do{var r=Gr;try{if(Rw(),Bm.current=L0,_0){for(var n=xr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}_0=!1}if(Ml=0,ln=Jr=xr=null,Hd=!1,gh=0,Vw.current=null,r===null||r.return===null){tn=1,vh=e,Gr=null;break}e:{var i=t,a=r.return,l=r,d=e;if(e=Tn,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var u=d,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var y=f.alternate;y?(f.updateQueue=y.updateQueue,f.memoizedState=y.memoizedState,f.lanes=y.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=bS(a);if(v!==null){v.flags&=-257,ES(v,a,l,i,e),v.mode&1&&wS(i,u,e),e=v,d=u;var E=e.updateQueue;if(E===null){var b=new Set;b.add(d),e.updateQueue=b}else E.add(d);break e}else{if(!(e&1)){wS(i,u,e),Kw();break e}d=Error(De(426))}}else if(lr&&l.mode&1){var T=bS(a);if(T!==null){!(T.flags&65536)&&(T.flags|=256),ES(T,a,l,i,e),Nw(Cu(d,l));break e}}i=d=Cu(d,l),tn!==4&&(tn=2),Wd===null?Wd=[i]:Wd.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=YR(i,d,e);mS(i,I);break e;case 1:l=d;var N=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof N.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(Eo===null||!Eo.has(A)))){i.flags|=65536,e&=-e,i.lanes|=e;var L=qR(i,l,e);mS(i,L);break e}}i=i.return}while(i!==null)}m_(r)}catch(P){e=P,Gr===r&&r!==null&&(Gr=r=r.return);continue}break}while(!0)}function h_(){var t=P0.current;return P0.current=L0,t===null?L0:t}function Kw(){(tn===0||tn===3||tn===2)&&(tn=4),un===null||!(Ol&268435455)&&!(jp&268435455)||ao(un,Tn)}function j0(t,e){var r=jt;jt|=2;var n=h_();(un!==t||Tn!==e)&&(ya=null,Nl(t,e));do try{Y5();break}catch(s){d_(t,s)}while(!0);if(Rw(),jt=r,P0.current=n,Gr!==null)throw Error(De(261));return un=null,Tn=0,tn}function Y5(){for(;Gr!==null;)f_(Gr)}function q5(){for(;Gr!==null&&!w6();)f_(Gr)}function f_(t){var e=g_(t.alternate,t,Ss);t.memoizedProps=t.pendingProps,e===null?m_(t):Gr=e,Vw.current=null}function m_(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=V5(r,e),r!==null){r.flags&=32767,Gr=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{tn=6,Gr=null;return}}else if(r=$5(r,e,Ss),r!==null){Gr=r;return}if(e=e.sibling,e!==null){Gr=e;return}Gr=e=t}while(e!==null);tn===0&&(tn=5)}function cl(t,e,r){var n=Gt,s=Qs.transition;try{Qs.transition=null,Gt=1,X5(t,e,r,n)}finally{Qs.transition=s,Gt=n}return null}function X5(t,e,r,n){do tu();while(po!==null);if(jt&6)throw Error(De(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(De(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(_6(t,i),t===un&&(Gr=un=null,Tn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||em||(em=!0,x_(g0,function(){return tu(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Qs.transition,Qs.transition=null;var a=Gt;Gt=1;var l=jt;jt|=4,Vw.current=null,H5(t,r),l_(r,t),g5(ay),y0=!!iy,ay=iy=null,t.current=r,z5(r),b6(),jt=l,Gt=a,Qs.transition=i}else t.current=r;if(em&&(em=!1,po=t,k0=s),i=t.pendingLanes,i===0&&(Eo=null),T6(r.stateNode),ds(t,Mr()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(D0)throw D0=!1,t=Ay,Ay=null,t;return k0&1&&t.tag!==0&&tu(),i=t.pendingLanes,i&1?t===Ny?Kd++:(Kd=0,Ny=t):Kd=0,Go(),null}function tu(){if(po!==null){var t=YI(k0),e=Qs.transition,r=Gt;try{if(Qs.transition=null,Gt=16>t?16:t,po===null)var n=!1;else{if(t=po,po=null,k0=0,jt&6)throw Error(De(331));var s=jt;for(jt|=4,qe=t.current;qe!==null;){var i=qe,a=i.child;if(qe.flags&16){var l=i.deletions;if(l!==null){for(var d=0;d<l.length;d++){var u=l[d];for(qe=u;qe!==null;){var f=qe;switch(f.tag){case 0:case 11:case 15:zd(8,f,i)}var p=f.child;if(p!==null)p.return=f,qe=p;else for(;qe!==null;){f=qe;var y=f.sibling,v=f.return;if(i_(f),f===u){qe=null;break}if(y!==null){y.return=v,qe=y;break}qe=v}}}var E=i.alternate;if(E!==null){var b=E.child;if(b!==null){E.child=null;do{var T=b.sibling;b.sibling=null,b=T}while(b!==null)}}qe=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,qe=a;else e:for(;qe!==null;){if(i=qe,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zd(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,qe=I;break e}qe=i.return}}var N=t.current;for(qe=N;qe!==null;){a=qe;var A=a.child;if(a.subtreeFlags&2064&&A!==null)A.return=a,qe=A;else e:for(a=N;qe!==null;){if(l=qe,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:kp(9,l)}}catch(P){Nr(l,l.return,P)}if(l===a){qe=null;break e}var L=l.sibling;if(L!==null){L.return=l.return,qe=L;break e}qe=l.return}}if(jt=s,Go(),Ji&&typeof Ji.onPostCommitFiberRoot=="function")try{Ji.onPostCommitFiberRoot(Ap,t)}catch{}n=!0}return n}finally{Gt=r,Qs.transition=e}}return!1}function jS(t,e,r){e=Cu(r,e),e=YR(t,e,1),t=bo(t,e,1),e=Kn(),t!==null&&(Qh(t,1,e),ds(t,e))}function Nr(t,e,r){if(t.tag===3)jS(t,t,r);else for(;e!==null;){if(e.tag===3){jS(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Eo===null||!Eo.has(n))){t=Cu(r,t),t=qR(e,t,1),e=bo(e,t,1),t=Kn(),e!==null&&(Qh(e,1,t),ds(e,t));break}}e=e.return}}function Q5(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Kn(),t.pingedLanes|=t.suspendedLanes&r,un===t&&(Tn&r)===r&&(tn===4||tn===3&&(Tn&130023424)===Tn&&500>Mr()-Hw?Nl(t,0):Gw|=r),ds(t,e)}function p_(t,e){e===0&&(t.mode&1?(e=Hf,Hf<<=1,!(Hf&130023424)&&(Hf=4194304)):e=1);var r=Kn();t=_a(t,e),t!==null&&(Qh(t,e,r),ds(t,r))}function Z5(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),p_(t,r)}function J5(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(De(314))}n!==null&&n.delete(e),p_(t,r)}var g_;g_=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||cs.current)is=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return is=!1,U5(t,e,r);is=!!(t.flags&131072)}else is=!1,lr&&e.flags&1048576&&wR(e,C0,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;$m(t,e),t=e.pendingProps;var s=bu(e,Fn.current);eu(e,r),s=Ow(null,e,n,t,s,r);var i=Fw();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,us(n)?(i=!0,S0(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Pw(e),s.updater=Dp,e.stateNode=s,s._reactInternals=e,py(e,n,t,r),e=yy(null,e,n,!0,i,r)):(e.tag=0,lr&&i&&Cw(e),Gn(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch($m(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=tF(n),t=gi(n,t),s){case 0:e=xy(null,e,n,t,r);break e;case 1:e=CS(null,e,n,t,r);break e;case 11:e=SS(null,e,n,t,r);break e;case 14:e=TS(null,e,n,gi(n.type,t),r);break e}throw Error(De(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:gi(n,s),xy(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:gi(n,s),CS(t,e,n,s,r);case 3:e:{if(JR(e),t===null)throw Error(De(387));n=e.pendingProps,i=e.memoizedState,s=i.element,AR(t,e),I0(e,n,null,r);var a=e.memoizedState;if(n=a.element,i.isDehydrated)if(i={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Cu(Error(De(423)),e),e=AS(t,e,n,r,s);break e}else if(n!==s){s=Cu(Error(De(424)),e),e=AS(t,e,n,r,s);break e}else for(Ns=wo(e.stateNode.containerInfo.firstChild),Is=e,lr=!0,bi=null,r=TR(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Eu(),n===s){e=La(t,e,r);break e}Gn(t,e,n,r)}e=e.child}return e;case 5:return NR(e),t===null&&hy(e),n=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,oy(n,s)?a=null:i!==null&&oy(n,i)&&(e.flags|=32),ZR(t,e),Gn(t,e,a,r),e.child;case 6:return t===null&&hy(e),null;case 13:return e_(t,e,r);case 4:return Dw(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Su(e,null,n,r):Gn(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:gi(n,s),SS(t,e,n,s,r);case 7:return Gn(t,e,e.pendingProps,r),e.child;case 8:return Gn(t,e,e.pendingProps.children,r),e.child;case 12:return Gn(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Jt(A0,n._currentValue),n._currentValue=a,i!==null)if(Ci(i.value,a)){if(i.children===s.children&&!cs.current){e=La(t,e,r);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){a=i.child;for(var d=l.firstContext;d!==null;){if(d.context===n){if(i.tag===1){d=Aa(-1,r&-r),d.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?d.next=d:(d.next=f.next,f.next=d),u.pending=d}}i.lanes|=r,d=i.alternate,d!==null&&(d.lanes|=r),fy(i.return,r,e),l.lanes|=r;break}d=d.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(De(341));a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),fy(a,r,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Gn(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,eu(e,r),s=ei(s),n=n(s),e.flags|=1,Gn(t,e,n,r),e.child;case 14:return n=e.type,s=gi(n,e.pendingProps),s=gi(n.type,s),TS(t,e,n,s,r);case 15:return XR(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:gi(n,s),$m(t,e),e.tag=1,us(n)?(t=!0,S0(e)):t=!1,eu(e,r),KR(e,n,s),py(e,n,s,r),yy(null,e,n,!0,t,r);case 19:return t_(t,e,r);case 22:return QR(t,e,r)}throw Error(De(156,e.tag))};function x_(t,e){return HI(t,e)}function eF(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ys(t,e,r,n){return new eF(t,e,r,n)}function Yw(t){return t=t.prototype,!(!t||!t.isReactComponent)}function tF(t){if(typeof t=="function")return Yw(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fw)return 11;if(t===mw)return 14}return 2}function To(t,e){var r=t.alternate;return r===null?(r=Ys(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Hm(t,e,r,n,s,i){var a=2;if(n=t,typeof t=="function")Yw(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Lc:return Il(r.children,s,i,e);case hw:a=8,s|=8;break;case B1:return t=Ys(12,r,e,s|2),t.elementType=B1,t.lanes=i,t;case U1:return t=Ys(13,r,e,s),t.elementType=U1,t.lanes=i,t;case $1:return t=Ys(19,r,e,s),t.elementType=$1,t.lanes=i,t;case NI:return Mp(r,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case CI:a=10;break e;case AI:a=9;break e;case fw:a=11;break e;case mw:a=14;break e;case to:a=16,n=null;break e}throw Error(De(130,t==null?t:typeof t,""))}return e=Ys(a,r,e,s),e.elementType=t,e.type=n,e.lanes=i,e}function Il(t,e,r,n){return t=Ys(7,t,n,e),t.lanes=r,t}function Mp(t,e,r,n){return t=Ys(22,t,n,e),t.elementType=NI,t.lanes=r,t.stateNode={isHidden:!1},t}function Ax(t,e,r){return t=Ys(6,t,null,e),t.lanes=r,t}function Nx(t,e,r){return e=Ys(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function rF(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ox(0),this.expirationTimes=ox(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ox(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function qw(t,e,r,n,s,i,a,l,d){return t=new rF(t,e,r,l,d),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ys(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Pw(i),t}function nF(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_c,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function y_(t){if(!t)return Io;t=t._reactInternals;e:{if(Zl(t)!==t||t.tag!==1)throw Error(De(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(us(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(De(171))}if(t.tag===1){var r=t.type;if(us(r))return yR(t,r,e)}return e}function v_(t,e,r,n,s,i,a,l,d){return t=qw(r,n,!0,t,s,i,a,l,d),t.context=y_(null),r=t.current,n=Kn(),s=So(r),i=Aa(n,s),i.callback=e??null,bo(r,i,s),t.current.lanes=s,Qh(t,s,n),ds(t,n),t}function Op(t,e,r,n){var s=e.current,i=Kn(),a=So(s);return r=y_(r),e.context===null?e.context=r:e.pendingContext=r,e=Aa(i,a),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=bo(s,e,a),t!==null&&(Si(t,s,a,i),Fm(t,s,a)),a}function M0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function MS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Xw(t,e){MS(t,e),(t=t.alternate)&&MS(t,e)}function sF(){return null}var w_=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qw(t){this._internalRoot=t}Fp.prototype.render=Qw.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(De(409));Op(t,e,null,null)};Fp.prototype.unmount=Qw.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Fl(function(){Op(null,t,null,null)}),e[Ra]=null}};function Fp(t){this._internalRoot=t}Fp.prototype.unstable_scheduleHydration=function(t){if(t){var e=QI();t={blockedOn:null,target:t,priority:e};for(var r=0;r<io.length&&e!==0&&e<io[r].priority;r++);io.splice(r,0,t),r===0&&JI(t)}};function Zw(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Bp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function OS(){}function iF(t,e,r,n,s){if(s){if(typeof n=="function"){var i=n;n=function(){var u=M0(a);i.call(u)}}var a=v_(e,n,t,0,null,!1,!1,"",OS);return t._reactRootContainer=a,t[Ra]=a.current,dh(t.nodeType===8?t.parentNode:t),Fl(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=M0(d);l.call(u)}}var d=qw(t,0,!1,null,null,!1,!1,"",OS);return t._reactRootContainer=d,t[Ra]=d.current,dh(t.nodeType===8?t.parentNode:t),Fl(function(){Op(e,d,r,n)}),d}function Up(t,e,r,n,s){var i=r._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var l=s;s=function(){var d=M0(a);l.call(d)}}Op(e,a,t,s)}else a=iF(r,e,t,s,n);return M0(a)}qI=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Dd(e.pendingLanes);r!==0&&(xw(e,r|1),ds(e,Mr()),!(jt&6)&&(Au=Mr()+500,Go()))}break;case 13:Fl(function(){var n=_a(t,1);if(n!==null){var s=Kn();Si(n,t,1,s)}}),Xw(t,1)}};yw=function(t){if(t.tag===13){var e=_a(t,134217728);if(e!==null){var r=Kn();Si(e,t,134217728,r)}Xw(t,134217728)}};XI=function(t){if(t.tag===13){var e=So(t),r=_a(t,e);if(r!==null){var n=Kn();Si(r,t,e,n)}Xw(t,e)}};QI=function(){return Gt};ZI=function(t,e){var r=Gt;try{return Gt=t,e()}finally{Gt=r}};Q1=function(t,e,r){switch(e){case"input":if(H1(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=_p(n);if(!s)throw Error(De(90));RI(n),H1(n,s)}}}break;case"textarea":LI(t,r);break;case"select":e=r.value,e!=null&&Xc(t,!!r.multiple,e,!1)}};FI=zw;BI=Fl;var aF={usingClientEntryPoint:!1,Events:[Jh,jc,_p,MI,OI,zw]},Sd={findFiberByHostInstance:hl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oF={bundleType:Sd.bundleType,version:Sd.version,rendererPackageName:Sd.rendererPackageName,rendererConfig:Sd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ma.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=VI(t),t===null?null:t.stateNode},findFiberByHostInstance:Sd.findFiberByHostInstance||sF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tm.isDisabled&&tm.supportsFiber)try{Ap=tm.inject(oF),Ji=tm}catch{}}ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=aF;ks.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zw(e))throw Error(De(200));return nF(t,e,null,r)};ks.createRoot=function(t,e){if(!Zw(t))throw Error(De(299));var r=!1,n="",s=w_;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=qw(t,1,!1,null,null,r,!1,n,s),t[Ra]=e.current,dh(t.nodeType===8?t.parentNode:t),new Qw(e)};ks.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(De(188)):(t=Object.keys(t).join(","),Error(De(268,t)));return t=VI(e),t=t===null?null:t.stateNode,t};ks.flushSync=function(t){return Fl(t)};ks.hydrate=function(t,e,r){if(!Bp(e))throw Error(De(200));return Up(null,t,e,!0,r)};ks.hydrateRoot=function(t,e,r){if(!Zw(t))throw Error(De(405));var n=r!=null&&r.hydratedSources||null,s=!1,i="",a=w_;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),e=v_(e,null,t,1,r??null,s,!1,i,a),t[Ra]=e.current,dh(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new Fp(e)};ks.render=function(t,e,r){if(!Bp(e))throw Error(De(200));return Up(null,t,e,!1,r)};ks.unmountComponentAtNode=function(t){if(!Bp(t))throw Error(De(40));return t._reactRootContainer?(Fl(function(){Up(null,null,t,!1,function(){t._reactRootContainer=null,t[Ra]=null})}),!0):!1};ks.unstable_batchedUpdates=zw;ks.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Bp(r))throw Error(De(200));if(t==null||t._reactInternals===void 0)throw Error(De(38));return Up(t,e,r,!1,n)};ks.version="18.3.1-next-f1338f8080-20240426";function b_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(b_)}catch(t){console.error(t)}}b_(),bI.exports=ks;var Jl=bI.exports;const E_=nw(Jl);var S_,FS=Jl;S_=FS.createRoot,FS.hydrateRoot;const lF=1,cF=1e6;let Ix=0;function uF(){return Ix=(Ix+1)%Number.MAX_SAFE_INTEGER,Ix.toString()}const Rx=new Map,BS=t=>{if(Rx.has(t))return;const e=setTimeout(()=>{Rx.delete(t),Yd({type:"REMOVE_TOAST",toastId:t})},cF);Rx.set(t,e)},dF=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,lF)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?BS(r):t.toasts.forEach(n=>{BS(n.id)}),{...t,toasts:t.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},zm=[];let Wm={toasts:[]};function Yd(t){Wm=dF(Wm,t),zm.forEach(e=>{e(Wm)})}function hF({...t}){const e=uF(),r=s=>Yd({type:"UPDATE_TOAST",toast:{...s,id:e}}),n=()=>Yd({type:"DISMISS_TOAST",toastId:e});return Yd({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:s=>{s||n()}}}),{id:e,dismiss:n,update:r}}function la(){const[t,e]=C.useState(Wm);return C.useEffect(()=>(zm.push(e),()=>{const r=zm.indexOf(e);r>-1&&zm.splice(r,1)}),[t]),{...t,toast:hF,dismiss:r=>Yd({type:"DISMISS_TOAST",toastId:r})}}function Re(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t==null||t(s),r===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function US(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function $p(...t){return e=>{let r=!1;const n=t.map(s=>{const i=US(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():US(t[s],null)}}}}function st(...t){return C.useCallback($p(...t),t)}function fF(t,e){const r=C.createContext(e),n=i=>{const{children:a,...l}=i,d=C.useMemo(()=>l,Object.values(l));return o.jsx(r.Provider,{value:d,children:a})};n.displayName=t+"Provider";function s(i){const a=C.useContext(r);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[n,s]}function hn(t,e=[]){let r=[];function n(i,a){const l=C.createContext(a),d=r.length;r=[...r,a];const u=p=>{var I;const{scope:y,children:v,...E}=p,b=((I=y==null?void 0:y[t])==null?void 0:I[d])||l,T=C.useMemo(()=>E,Object.values(E));return o.jsx(b.Provider,{value:T,children:v})};u.displayName=i+"Provider";function f(p,y){var b;const v=((b=y==null?void 0:y[t])==null?void 0:b[d])||l,E=C.useContext(v);if(E)return E;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${i}\``)}return[u,f]}const s=()=>{const i=r.map(a=>C.createContext(a));return function(l){const d=(l==null?void 0:l[t])||i;return C.useMemo(()=>({[`__scope${t}`]:{...l,[t]:d}}),[l,d])}};return s.scopeName=t,[n,mF(s,...e)]}function mF(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=n.reduce((l,{useScope:d,scopeName:u})=>{const p=d(i)[`__scope${u}`];return{...l,...p}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return r.scopeName=e.scopeName,r}function Ro(t){const e=gF(t),r=C.forwardRef((n,s)=>{const{children:i,...a}=n,l=C.Children.toArray(i),d=l.find(yF);if(d){const u=d.props.children,f=l.map(p=>p===d?C.Children.count(u)>1?C.Children.only(null):C.isValidElement(u)?u.props.children:null:p);return o.jsx(e,{...a,ref:s,children:C.isValidElement(u)?C.cloneElement(u,void 0,f):null})}return o.jsx(e,{...a,ref:s,children:i})});return r.displayName=`${t}.Slot`,r}var pF=Ro("Slot");function gF(t){const e=C.forwardRef((r,n)=>{const{children:s,...i}=r;if(C.isValidElement(s)){const a=wF(s),l=vF(i,s.props);return s.type!==C.Fragment&&(l.ref=n?$p(n,a):a),C.cloneElement(s,l)}return C.Children.count(s)>1?C.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var T_=Symbol("radix.slottable");function xF(t){const e=({children:r})=>o.jsx(o.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=T_,e}function yF(t){return C.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===T_}function vF(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...l)=>{const d=i(...l);return s(...l),d}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function wF(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function tf(t){const e=t+"CollectionProvider",[r,n]=hn(e),[s,i]=r(e,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:T,children:I}=b,N=Fe.useRef(null),A=Fe.useRef(new Map).current;return o.jsx(s,{scope:T,itemMap:A,collectionRef:N,children:I})};a.displayName=e;const l=t+"CollectionSlot",d=Ro(l),u=Fe.forwardRef((b,T)=>{const{scope:I,children:N}=b,A=i(l,I),L=st(T,A.collectionRef);return o.jsx(d,{ref:L,children:N})});u.displayName=l;const f=t+"CollectionItemSlot",p="data-radix-collection-item",y=Ro(f),v=Fe.forwardRef((b,T)=>{const{scope:I,children:N,...A}=b,L=Fe.useRef(null),P=st(T,L),k=i(f,I);return Fe.useEffect(()=>(k.itemMap.set(L,{ref:L,...A}),()=>void k.itemMap.delete(L))),o.jsx(y,{[p]:"",ref:P,children:N})});v.displayName=f;function E(b){const T=i(t+"CollectionConsumer",b);return Fe.useCallback(()=>{const N=T.collectionRef.current;if(!N)return[];const A=Array.from(N.querySelectorAll(`[${p}]`));return Array.from(T.itemMap.values()).sort((k,D)=>A.indexOf(k.ref.current)-A.indexOf(D.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:a,Slot:u,ItemSlot:v},E,n]}var bF=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],He=bF.reduce((t,e)=>{const r=Ro(`Primitive.${e}`),n=C.forwardRef((s,i)=>{const{asChild:a,...l}=s,d=a?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),o.jsx(d,{...l,ref:i})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Jw(t,e){t&&Jl.flushSync(()=>t.dispatchEvent(e))}function Lr(t){const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...r)=>{var n;return(n=e.current)==null?void 0:n.call(e,...r)},[])}function EF(t,e=globalThis==null?void 0:globalThis.document){const r=Lr(t);C.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var SF="DismissableLayer",_y="dismissableLayer.update",TF="dismissableLayer.pointerDownOutside",CF="dismissableLayer.focusOutside",$S,C_=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),ec=C.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:l,...d}=t,u=C.useContext(C_),[f,p]=C.useState(null),y=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,v]=C.useState({}),E=st(e,D=>p(D)),b=Array.from(u.layers),[T]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),I=b.indexOf(T),N=f?b.indexOf(f):-1,A=u.layersWithOutsidePointerEventsDisabled.size>0,L=N>=I,P=NF(D=>{const O=D.target,F=[...u.branches].some($=>$.contains(O));!L||F||(s==null||s(D),a==null||a(D),D.defaultPrevented||l==null||l())},y),k=IF(D=>{const O=D.target;[...u.branches].some($=>$.contains(O))||(i==null||i(D),a==null||a(D),D.defaultPrevented||l==null||l())},y);return EF(D=>{N===u.layers.size-1&&(n==null||n(D),!D.defaultPrevented&&l&&(D.preventDefault(),l()))},y),C.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&($S=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),VS(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(y.body.style.pointerEvents=$S)}},[f,y,r,u]),C.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),VS())},[f,u]),C.useEffect(()=>{const D=()=>v({});return document.addEventListener(_y,D),()=>document.removeEventListener(_y,D)},[]),o.jsx(He.div,{...d,ref:E,style:{pointerEvents:A?L?"auto":"none":void 0,...t.style},onFocusCapture:Re(t.onFocusCapture,k.onFocusCapture),onBlurCapture:Re(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Re(t.onPointerDownCapture,P.onPointerDownCapture)})});ec.displayName=SF;var AF="DismissableLayerBranch",A_=C.forwardRef((t,e)=>{const r=C.useContext(C_),n=C.useRef(null),s=st(e,n);return C.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),o.jsx(He.div,{...t,ref:s})});A_.displayName=AF;function NF(t,e=globalThis==null?void 0:globalThis.document){const r=Lr(t),n=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const i=l=>{if(l.target&&!n.current){let d=function(){N_(TF,r,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=d,e.addEventListener("click",s.current,{once:!0})):d()}else e.removeEventListener("click",s.current);n.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function IF(t,e=globalThis==null?void 0:globalThis.document){const r=Lr(t),n=C.useRef(!1);return C.useEffect(()=>{const s=i=>{i.target&&!n.current&&N_(CF,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function VS(){const t=new CustomEvent(_y);document.dispatchEvent(t)}function N_(t,e,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?Jw(s,i):s.dispatchEvent(i)}var RF=ec,_F=A_,Br=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},LF="Portal",Vu=C.forwardRef((t,e)=>{var l;const{container:r,...n}=t,[s,i]=C.useState(!1);Br(()=>i(!0),[]);const a=r||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return a?E_.createPortal(o.jsx(He.div,{...n,ref:e}),a):null});Vu.displayName=LF;function PF(t,e){return C.useReducer((r,n)=>e[r][n]??r,t)}var fn=t=>{const{present:e,children:r}=t,n=DF(e),s=typeof r=="function"?r({present:n.isPresent}):C.Children.only(r),i=st(n.ref,kF(s));return typeof r=="function"||n.isPresent?C.cloneElement(s,{ref:i}):null};fn.displayName="Presence";function DF(t){const[e,r]=C.useState(),n=C.useRef(null),s=C.useRef(t),i=C.useRef("none"),a=t?"mounted":"unmounted",[l,d]=PF(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const u=rm(n.current);i.current=l==="mounted"?u:"none"},[l]),Br(()=>{const u=n.current,f=s.current;if(f!==t){const y=i.current,v=rm(u);t?d("MOUNT"):v==="none"||(u==null?void 0:u.display)==="none"?d("UNMOUNT"):d(f&&y!==v?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,d]),Br(()=>{if(e){let u;const f=e.ownerDocument.defaultView??window,p=v=>{const b=rm(n.current).includes(v.animationName);if(v.target===e&&b&&(d("ANIMATION_END"),!s.current)){const T=e.style.animationFillMode;e.style.animationFillMode="forwards",u=f.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=T)})}},y=v=>{v.target===e&&(i.current=rm(n.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{f.clearTimeout(u),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else d("ANIMATION_END")},[e,d]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:C.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function rm(t){return(t==null?void 0:t.animationName)||"none"}function kF(t){var n,s;let e=(n=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:n.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var jF=lw[" useInsertionEffect ".trim().toString()]||Br;function Ai({prop:t,defaultProp:e,onChange:r=()=>{},caller:n}){const[s,i,a]=MF({defaultProp:e,onChange:r}),l=t!==void 0,d=l?t:s;{const f=C.useRef(t!==void 0);C.useEffect(()=>{const p=f.current;p!==l&&console.warn(`${n} is changing from ${p?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=l},[l,n])}const u=C.useCallback(f=>{var p;if(l){const y=OF(f)?f(t):f;y!==t&&((p=a.current)==null||p.call(a,y))}else i(f)},[l,t,i,a]);return[d,u]}function MF({defaultProp:t,onChange:e}){const[r,n]=C.useState(t),s=C.useRef(r),i=C.useRef(e);return jF(()=>{i.current=e},[e]),C.useEffect(()=>{var a;s.current!==r&&((a=i.current)==null||a.call(i,r),s.current=r)},[r,s]),[r,n,i]}function OF(t){return typeof t=="function"}var I_=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),FF="VisuallyHidden",Vp=C.forwardRef((t,e)=>o.jsx(He.span,{...t,ref:e,style:{...I_,...t.style}}));Vp.displayName=FF;var BF=Vp,eb="ToastProvider",[tb,UF,$F]=tf("Toast"),[R_,Eae]=hn("Toast",[$F]),[VF,Gp]=R_(eb),__=t=>{const{__scopeToast:e,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:a}=t,[l,d]=C.useState(null),[u,f]=C.useState(0),p=C.useRef(!1),y=C.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${eb}\`. Expected non-empty \`string\`.`),o.jsx(tb.Provider,{scope:e,children:o.jsx(VF,{scope:e,label:r,duration:n,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:d,onToastAdd:C.useCallback(()=>f(v=>v+1),[]),onToastRemove:C.useCallback(()=>f(v=>v-1),[]),isFocusedToastEscapeKeyDownRef:p,isClosePausedRef:y,children:a})})};__.displayName=eb;var L_="ToastViewport",GF=["F8"],Ly="toast.viewportPause",Py="toast.viewportResume",P_=C.forwardRef((t,e)=>{const{__scopeToast:r,hotkey:n=GF,label:s="Notifications ({hotkey})",...i}=t,a=Gp(L_,r),l=UF(r),d=C.useRef(null),u=C.useRef(null),f=C.useRef(null),p=C.useRef(null),y=st(e,p,a.onViewportChange),v=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),E=a.toastCount>0;C.useEffect(()=>{const T=I=>{var A;n.length!==0&&n.every(L=>I[L]||I.code===L)&&((A=p.current)==null||A.focus())};return document.addEventListener("keydown",T),()=>document.removeEventListener("keydown",T)},[n]),C.useEffect(()=>{const T=d.current,I=p.current;if(E&&T&&I){const N=()=>{if(!a.isClosePausedRef.current){const k=new CustomEvent(Ly);I.dispatchEvent(k),a.isClosePausedRef.current=!0}},A=()=>{if(a.isClosePausedRef.current){const k=new CustomEvent(Py);I.dispatchEvent(k),a.isClosePausedRef.current=!1}},L=k=>{!T.contains(k.relatedTarget)&&A()},P=()=>{T.contains(document.activeElement)||A()};return T.addEventListener("focusin",N),T.addEventListener("focusout",L),T.addEventListener("pointermove",N),T.addEventListener("pointerleave",P),window.addEventListener("blur",N),window.addEventListener("focus",A),()=>{T.removeEventListener("focusin",N),T.removeEventListener("focusout",L),T.removeEventListener("pointermove",N),T.removeEventListener("pointerleave",P),window.removeEventListener("blur",N),window.removeEventListener("focus",A)}}},[E,a.isClosePausedRef]);const b=C.useCallback(({tabbingDirection:T})=>{const N=l().map(A=>{const L=A.ref.current,P=[L,...rB(L)];return T==="forwards"?P:P.reverse()});return(T==="forwards"?N.reverse():N).flat()},[l]);return C.useEffect(()=>{const T=p.current;if(T){const I=N=>{var P,k,D;const A=N.altKey||N.ctrlKey||N.metaKey;if(N.key==="Tab"&&!A){const O=document.activeElement,F=N.shiftKey;if(N.target===T&&F){(P=u.current)==null||P.focus();return}const Y=b({tabbingDirection:F?"backwards":"forwards"}),ne=Y.findIndex(X=>X===O);_x(Y.slice(ne+1))?N.preventDefault():F?(k=u.current)==null||k.focus():(D=f.current)==null||D.focus()}};return T.addEventListener("keydown",I),()=>T.removeEventListener("keydown",I)}},[l,b]),o.jsxs(_F,{ref:d,role:"region","aria-label":s.replace("{hotkey}",v),tabIndex:-1,style:{pointerEvents:E?void 0:"none"},children:[E&&o.jsx(Dy,{ref:u,onFocusFromOutsideViewport:()=>{const T=b({tabbingDirection:"forwards"});_x(T)}}),o.jsx(tb.Slot,{scope:r,children:o.jsx(He.ol,{tabIndex:-1,...i,ref:y})}),E&&o.jsx(Dy,{ref:f,onFocusFromOutsideViewport:()=>{const T=b({tabbingDirection:"backwards"});_x(T)}})]})});P_.displayName=L_;var D_="ToastFocusProxy",Dy=C.forwardRef((t,e)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=t,i=Gp(D_,r);return o.jsx(Vp,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:a=>{var u;const l=a.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&n()}})});Dy.displayName=D_;var rf="Toast",HF="toast.swipeStart",zF="toast.swipeMove",WF="toast.swipeCancel",KF="toast.swipeEnd",k_=C.forwardRef((t,e)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:i,...a}=t,[l,d]=Ai({prop:n,defaultProp:s??!0,onChange:i,caller:rf});return o.jsx(fn,{present:r||l,children:o.jsx(XF,{open:l,...a,ref:e,onClose:()=>d(!1),onPause:Lr(t.onPause),onResume:Lr(t.onResume),onSwipeStart:Re(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Re(t.onSwipeMove,u=>{const{x:f,y:p}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${p}px`)}),onSwipeCancel:Re(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Re(t.onSwipeEnd,u=>{const{x:f,y:p}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${p}px`),d(!1)})})})});k_.displayName=rf;var[YF,qF]=R_(rf,{onClose(){}}),XF=C.forwardRef((t,e)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:i,onClose:a,onEscapeKeyDown:l,onPause:d,onResume:u,onSwipeStart:f,onSwipeMove:p,onSwipeCancel:y,onSwipeEnd:v,...E}=t,b=Gp(rf,r),[T,I]=C.useState(null),N=st(e,X=>I(X)),A=C.useRef(null),L=C.useRef(null),P=s||b.duration,k=C.useRef(0),D=C.useRef(P),O=C.useRef(0),{onToastAdd:F,onToastRemove:$}=b,G=Lr(()=>{var z;(T==null?void 0:T.contains(document.activeElement))&&((z=b.viewport)==null||z.focus()),a()}),Y=C.useCallback(X=>{!X||X===1/0||(window.clearTimeout(O.current),k.current=new Date().getTime(),O.current=window.setTimeout(G,X))},[G]);C.useEffect(()=>{const X=b.viewport;if(X){const z=()=>{Y(D.current),u==null||u()},Z=()=>{const ee=new Date().getTime()-k.current;D.current=D.current-ee,window.clearTimeout(O.current),d==null||d()};return X.addEventListener(Ly,Z),X.addEventListener(Py,z),()=>{X.removeEventListener(Ly,Z),X.removeEventListener(Py,z)}}},[b.viewport,P,d,u,Y]),C.useEffect(()=>{i&&!b.isClosePausedRef.current&&Y(P)},[i,P,b.isClosePausedRef,Y]),C.useEffect(()=>(F(),()=>$()),[F,$]);const ne=C.useMemo(()=>T?$_(T):null,[T]);return b.viewport?o.jsxs(o.Fragment,{children:[ne&&o.jsx(QF,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite","aria-atomic":!0,children:ne}),o.jsx(YF,{scope:r,onClose:G,children:Jl.createPortal(o.jsx(tb.ItemSlot,{scope:r,children:o.jsx(RF,{asChild:!0,onEscapeKeyDown:Re(l,()=>{b.isFocusedToastEscapeKeyDownRef.current||G(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:o.jsx(He.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":b.swipeDirection,...E,ref:N,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Re(t.onKeyDown,X=>{X.key==="Escape"&&(l==null||l(X.nativeEvent),X.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,G()))}),onPointerDown:Re(t.onPointerDown,X=>{X.button===0&&(A.current={x:X.clientX,y:X.clientY})}),onPointerMove:Re(t.onPointerMove,X=>{if(!A.current)return;const z=X.clientX-A.current.x,Z=X.clientY-A.current.y,ee=!!L.current,q=["left","right"].includes(b.swipeDirection),K=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,ae=q?K(0,z):0,Q=q?0:K(0,Z),re=X.pointerType==="touch"?10:2,Ee={x:ae,y:Q},ie={originalEvent:X,delta:Ee};ee?(L.current=Ee,nm(zF,p,ie,{discrete:!1})):GS(Ee,b.swipeDirection,re)?(L.current=Ee,nm(HF,f,ie,{discrete:!1}),X.target.setPointerCapture(X.pointerId)):(Math.abs(z)>re||Math.abs(Z)>re)&&(A.current=null)}),onPointerUp:Re(t.onPointerUp,X=>{const z=L.current,Z=X.target;if(Z.hasPointerCapture(X.pointerId)&&Z.releasePointerCapture(X.pointerId),L.current=null,A.current=null,z){const ee=X.currentTarget,q={originalEvent:X,delta:z};GS(z,b.swipeDirection,b.swipeThreshold)?nm(KF,v,q,{discrete:!0}):nm(WF,y,q,{discrete:!0}),ee.addEventListener("click",K=>K.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),QF=t=>{const{__scopeToast:e,children:r,...n}=t,s=Gp(rf,e),[i,a]=C.useState(!1),[l,d]=C.useState(!1);return eB(()=>a(!0)),C.useEffect(()=>{const u=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:o.jsx(Vu,{asChild:!0,children:o.jsx(Vp,{...n,children:i&&o.jsxs(o.Fragment,{children:[s.label," ",r]})})})},ZF="ToastTitle",j_=C.forwardRef((t,e)=>{const{__scopeToast:r,...n}=t;return o.jsx(He.div,{...n,ref:e})});j_.displayName=ZF;var JF="ToastDescription",M_=C.forwardRef((t,e)=>{const{__scopeToast:r,...n}=t;return o.jsx(He.div,{...n,ref:e})});M_.displayName=JF;var O_="ToastAction",F_=C.forwardRef((t,e)=>{const{altText:r,...n}=t;return r.trim()?o.jsx(U_,{altText:r,asChild:!0,children:o.jsx(rb,{...n,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${O_}\`. Expected non-empty \`string\`.`),null)});F_.displayName=O_;var B_="ToastClose",rb=C.forwardRef((t,e)=>{const{__scopeToast:r,...n}=t,s=qF(B_,r);return o.jsx(U_,{asChild:!0,children:o.jsx(He.button,{type:"button",...n,ref:e,onClick:Re(t.onClick,s.onClose)})})});rb.displayName=B_;var U_=C.forwardRef((t,e)=>{const{__scopeToast:r,altText:n,...s}=t;return o.jsx(He.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:e})});function $_(t){const e=[];return Array.from(t.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&e.push(n.textContent),tB(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",i=n.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const a=n.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...$_(n))}}),e}function nm(t,e,r,{discrete:n}){const s=r.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?Jw(s,i):s.dispatchEvent(i)}var GS=(t,e,r=0)=>{const n=Math.abs(t.x),s=Math.abs(t.y),i=n>s;return e==="left"||e==="right"?i&&n>r:!i&&s>r};function eB(t=()=>{}){const e=Lr(t);Br(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[e])}function tB(t){return t.nodeType===t.ELEMENT_NODE}function rB(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function _x(t){const e=document.activeElement;return t.some(r=>r===e?!0:(r.focus(),document.activeElement!==e))}var nB=__,V_=P_,G_=k_,H_=j_,z_=M_,W_=F_,K_=rb;function Y_(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=Y_(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function q_(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=Y_(t))&&(n&&(n+=" "),n+=e);return n}const HS=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,zS=q_,nf=(t,e)=>r=>{var n;if((e==null?void 0:e.variants)==null)return zS(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(u=>{const f=r==null?void 0:r[u],p=i==null?void 0:i[u];if(f===null)return null;const y=HS(f)||HS(p);return s[u][y]}),l=r&&Object.entries(r).reduce((u,f)=>{let[p,y]=f;return y===void 0||(u[p]=y),u},{}),d=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:p,className:y,...v}=f;return Object.entries(v).every(E=>{let[b,T]=E;return Array.isArray(T)?T.includes({...i,...l}[b]):{...i,...l}[b]===T})?[...u,p,y]:u},[]);return zS(t,a,d,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),X_=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var iB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=C.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:i,iconNode:a,...l},d)=>C.createElement("svg",{ref:d,...iB,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:X_("lucide",s),...l},[...a.map(([u,f])=>C.createElement(u,f)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=(t,e)=>{const r=C.forwardRef(({className:n,...s},i)=>C.createElement(aB,{ref:i,iconNode:e,className:X_(`lucide-${sB(t)}`,n),...s}));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nb=Ae("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=Ae("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=Ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const of=Ae("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ky=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sb=Ae("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=Ae("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=Ae("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=Ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ib=Ae("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=Ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q_=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=Ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=Ae("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=Ae("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z_=Ae("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=Ae("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J_=Ae("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=Ae("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=Ae("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ob=Ae("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=Ae("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=Ae("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ul=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=Ae("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lx=Ae("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lf=Ae("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WS=Ae("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Th=Ae("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=Ae("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eL=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tL=Ae("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wp=Ae("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rL=Ae("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nL=Ae("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=Ae("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=Ae("HeartOff",[["line",{x1:"2",y1:"2",x2:"22",y2:"22",key:"1w4vcy"}],["path",{d:"M16.5 16.5 12 21l-7-7c-1.5-1.45-3-3.2-3-5.5a5.5 5.5 0 0 1 2.14-4.35",key:"3mpagl"}],["path",{d:"M8.76 3.1c1.15.22 2.13.78 3.24 1.9 1.5-1.5 2.74-2 4.5-2A5.5 5.5 0 0 1 22 8.5c0 2.12-1.3 3.78-2.67 5.17",key:"1gh3v3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sL=Ae("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=Ae("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lb=Ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=Ae("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iL=Ae("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=Ae("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=Ae("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=Ae("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=Ae("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=Ae("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rl=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cb=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lo=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Ae("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aL=Ae("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=Ae("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kp=Ae("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=Ae("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=Ae("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Ae("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=Ae("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=Ae("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ub=Ae("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const db=Ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=Ae("Rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hb=Ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=Ae("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ch=Ae("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oL=Ae("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=Ae("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lL=Ae("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cL=Ae("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yp=Ae("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=Ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=Ae("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=Ae("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=Ae("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=Ae("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uL=Ae("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Td=Ae("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=Ae("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dL=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=Ae("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hL=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ru=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=Ae("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=Ae("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=Ae("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=Ae("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=Ae("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),fb="-",LB=t=>{const e=DB(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:a=>{const l=a.split(fb);return l[0]===""&&l.length!==1&&l.shift(),fL(l,e)||PB(a)},getConflictingClassGroupIds:(a,l)=>{const d=r[a]||[];return l&&n[a]?[...d,...n[a]]:d}}},fL=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),s=n?fL(t.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(fb);return(a=e.validators.find(({validator:l})=>l(i)))==null?void 0:a.classGroupId},YS=/^\[(.+)\]$/,PB=t=>{if(YS.test(t)){const e=YS.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},DB=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return jB(Object.entries(t.classGroups),r).forEach(([i,a])=>{Oy(a,n,i,e)}),n},Oy=(t,e,r,n)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:qS(e,s);i.classGroupId=r;return}if(typeof s=="function"){if(kB(s)){Oy(s(n),e,r,n);return}e.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,a])=>{Oy(a,qS(e,i),r,n)})})},qS=(t,e)=>{let r=t;return e.split(fb).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},kB=t=>t.isThemeGetter,jB=(t,e)=>e?t.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,l])=>[e+a,l])):i);return[r,s]}):t,MB=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const s=(i,a)=>{r.set(i,a),e++,e>t&&(e=0,n=r,r=new Map)};return{get(i){let a=r.get(i);if(a!==void 0)return a;if((a=n.get(i))!==void 0)return s(i,a),a},set(i,a){r.has(i)?r.set(i,a):s(i,a)}}},mL="!",OB=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,s=e[0],i=e.length,a=l=>{const d=[];let u=0,f=0,p;for(let T=0;T<l.length;T++){let I=l[T];if(u===0){if(I===s&&(n||l.slice(T,T+i)===e)){d.push(l.slice(f,T)),f=T+i;continue}if(I==="/"){p=T;continue}}I==="["?u++:I==="]"&&u--}const y=d.length===0?l:l.substring(f),v=y.startsWith(mL),E=v?y.substring(1):y,b=p&&p>f?p-f:void 0;return{modifiers:d,hasImportantModifier:v,baseClassName:E,maybePostfixModifierPosition:b}};return r?l=>r({className:l,parseClassName:a}):a},FB=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},BB=t=>({cache:MB(t.cacheSize),parseClassName:OB(t),...LB(t)}),UB=/\s+/,$B=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],a=t.trim().split(UB);let l="";for(let d=a.length-1;d>=0;d-=1){const u=a[d],{modifiers:f,hasImportantModifier:p,baseClassName:y,maybePostfixModifierPosition:v}=r(u);let E=!!v,b=n(E?y.substring(0,v):y);if(!b){if(!E){l=u+(l.length>0?" "+l:l);continue}if(b=n(y),!b){l=u+(l.length>0?" "+l:l);continue}E=!1}const T=FB(f).join(":"),I=p?T+mL:T,N=I+b;if(i.includes(N))continue;i.push(N);const A=s(b,E);for(let L=0;L<A.length;++L){const P=A[L];i.push(I+P)}l=u+(l.length>0?" "+l:l)}return l};function VB(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=pL(e))&&(n&&(n+=" "),n+=r);return n}const pL=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=pL(t[n]))&&(r&&(r+=" "),r+=e);return r};function GB(t,...e){let r,n,s,i=a;function a(d){const u=e.reduce((f,p)=>p(f),t());return r=BB(u),n=r.cache.get,s=r.cache.set,i=l,l(d)}function l(d){const u=n(d);if(u)return u;const f=$B(d,r);return s(d,f),f}return function(){return i(VB.apply(null,arguments))}}const tr=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},gL=/^\[(?:([a-z-]+):)?(.+)\]$/i,HB=/^\d+\/\d+$/,zB=new Set(["px","full","screen"]),WB=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,KB=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,YB=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,qB=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,XB=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ha=t=>nu(t)||zB.has(t)||HB.test(t),Ya=t=>zu(t,"length",s7),nu=t=>!!t&&!Number.isNaN(Number(t)),Px=t=>zu(t,"number",nu),Cd=t=>!!t&&Number.isInteger(Number(t)),QB=t=>t.endsWith("%")&&nu(t.slice(0,-1)),xt=t=>gL.test(t),qa=t=>WB.test(t),ZB=new Set(["length","size","percentage"]),JB=t=>zu(t,ZB,xL),e7=t=>zu(t,"position",xL),t7=new Set(["image","url"]),r7=t=>zu(t,t7,a7),n7=t=>zu(t,"",i7),Ad=()=>!0,zu=(t,e,r)=>{const n=gL.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},s7=t=>KB.test(t)&&!YB.test(t),xL=()=>!1,i7=t=>qB.test(t),a7=t=>XB.test(t),o7=()=>{const t=tr("colors"),e=tr("spacing"),r=tr("blur"),n=tr("brightness"),s=tr("borderColor"),i=tr("borderRadius"),a=tr("borderSpacing"),l=tr("borderWidth"),d=tr("contrast"),u=tr("grayscale"),f=tr("hueRotate"),p=tr("invert"),y=tr("gap"),v=tr("gradientColorStops"),E=tr("gradientColorStopPositions"),b=tr("inset"),T=tr("margin"),I=tr("opacity"),N=tr("padding"),A=tr("saturate"),L=tr("scale"),P=tr("sepia"),k=tr("skew"),D=tr("space"),O=tr("translate"),F=()=>["auto","contain","none"],$=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto",xt,e],Y=()=>[xt,e],ne=()=>["",ha,Ya],X=()=>["auto",nu,xt],z=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Z=()=>["solid","dashed","dotted","double","none"],ee=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],q=()=>["start","end","center","between","around","evenly","stretch"],K=()=>["","0",xt],ae=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Q=()=>[nu,xt];return{cacheSize:500,separator:":",theme:{colors:[Ad],spacing:[ha,Ya],blur:["none","",qa,xt],brightness:Q(),borderColor:[t],borderRadius:["none","","full",qa,xt],borderSpacing:Y(),borderWidth:ne(),contrast:Q(),grayscale:K(),hueRotate:Q(),invert:K(),gap:Y(),gradientColorStops:[t],gradientColorStopPositions:[QB,Ya],inset:G(),margin:G(),opacity:Q(),padding:Y(),saturate:Q(),scale:Q(),sepia:K(),skew:Q(),space:Y(),translate:Y()},classGroups:{aspect:[{aspect:["auto","square","video",xt]}],container:["container"],columns:[{columns:[qa]}],"break-after":[{"break-after":ae()}],"break-before":[{"break-before":ae()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...z(),xt]}],overflow:[{overflow:$()}],"overflow-x":[{"overflow-x":$()}],"overflow-y":[{"overflow-y":$()}],overscroll:[{overscroll:F()}],"overscroll-x":[{"overscroll-x":F()}],"overscroll-y":[{"overscroll-y":F()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Cd,xt]}],basis:[{basis:G()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",xt]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",Cd,xt]}],"grid-cols":[{"grid-cols":[Ad]}],"col-start-end":[{col:["auto",{span:["full",Cd,xt]},xt]}],"col-start":[{"col-start":X()}],"col-end":[{"col-end":X()}],"grid-rows":[{"grid-rows":[Ad]}],"row-start-end":[{row:["auto",{span:[Cd,xt]},xt]}],"row-start":[{"row-start":X()}],"row-end":[{"row-end":X()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",xt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",xt]}],gap:[{gap:[y]}],"gap-x":[{"gap-x":[y]}],"gap-y":[{"gap-y":[y]}],"justify-content":[{justify:["normal",...q()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...q(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...q(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[N]}],px:[{px:[N]}],py:[{py:[N]}],ps:[{ps:[N]}],pe:[{pe:[N]}],pt:[{pt:[N]}],pr:[{pr:[N]}],pb:[{pb:[N]}],pl:[{pl:[N]}],m:[{m:[T]}],mx:[{mx:[T]}],my:[{my:[T]}],ms:[{ms:[T]}],me:[{me:[T]}],mt:[{mt:[T]}],mr:[{mr:[T]}],mb:[{mb:[T]}],ml:[{ml:[T]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",xt,e]}],"min-w":[{"min-w":[xt,e,"min","max","fit"]}],"max-w":[{"max-w":[xt,e,"none","full","min","max","fit","prose",{screen:[qa]},qa]}],h:[{h:[xt,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[xt,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[xt,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[xt,e,"auto","min","max","fit"]}],"font-size":[{text:["base",qa,Ya]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Px]}],"font-family":[{font:[Ad]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",xt]}],"line-clamp":[{"line-clamp":["none",nu,Px]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ha,xt]}],"list-image":[{"list-image":["none",xt]}],"list-style-type":[{list:["none","disc","decimal",xt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[I]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[I]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ha,Ya]}],"underline-offset":[{"underline-offset":["auto",ha,xt]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Y()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[I]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...z(),e7]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",JB]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},r7]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[E]}],"gradient-via-pos":[{via:[E]}],"gradient-to-pos":[{to:[E]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[I]}],"border-style":[{border:[...Z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[I]}],"divide-style":[{divide:Z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Z()]}],"outline-offset":[{"outline-offset":[ha,xt]}],"outline-w":[{outline:[ha,Ya]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:ne()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[I]}],"ring-offset-w":[{"ring-offset":[ha,Ya]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",qa,n7]}],"shadow-color":[{shadow:[Ad]}],opacity:[{opacity:[I]}],"mix-blend":[{"mix-blend":[...ee(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ee()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",qa,xt]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[p]}],saturate:[{saturate:[A]}],sepia:[{sepia:[P]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[p]}],"backdrop-opacity":[{"backdrop-opacity":[I]}],"backdrop-saturate":[{"backdrop-saturate":[A]}],"backdrop-sepia":[{"backdrop-sepia":[P]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",xt]}],duration:[{duration:Q()}],ease:[{ease:["linear","in","out","in-out",xt]}],delay:[{delay:Q()}],animate:[{animate:["none","spin","ping","pulse","bounce",xt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[L]}],"scale-x":[{"scale-x":[L]}],"scale-y":[{"scale-y":[L]}],rotate:[{rotate:[Cd,xt]}],"translate-x":[{"translate-x":[O]}],"translate-y":[{"translate-y":[O]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",xt]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xt]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Y()}],"scroll-mx":[{"scroll-mx":Y()}],"scroll-my":[{"scroll-my":Y()}],"scroll-ms":[{"scroll-ms":Y()}],"scroll-me":[{"scroll-me":Y()}],"scroll-mt":[{"scroll-mt":Y()}],"scroll-mr":[{"scroll-mr":Y()}],"scroll-mb":[{"scroll-mb":Y()}],"scroll-ml":[{"scroll-ml":Y()}],"scroll-p":[{"scroll-p":Y()}],"scroll-px":[{"scroll-px":Y()}],"scroll-py":[{"scroll-py":Y()}],"scroll-ps":[{"scroll-ps":Y()}],"scroll-pe":[{"scroll-pe":Y()}],"scroll-pt":[{"scroll-pt":Y()}],"scroll-pr":[{"scroll-pr":Y()}],"scroll-pb":[{"scroll-pb":Y()}],"scroll-pl":[{"scroll-pl":Y()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xt]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[ha,Ya,Px]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},l7=GB(o7);function Ye(...t){return l7(q_(t))}const c7=nB,yL=C.forwardRef(({className:t,...e},r)=>o.jsx(V_,{ref:r,className:Ye("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));yL.displayName=V_.displayName;const u7=nf("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),vL=C.forwardRef(({className:t,variant:e,...r},n)=>o.jsx(G_,{ref:n,className:Ye(u7({variant:e}),t),...r}));vL.displayName=G_.displayName;const d7=C.forwardRef(({className:t,...e},r)=>o.jsx(W_,{ref:r,className:Ye("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));d7.displayName=W_.displayName;const wL=C.forwardRef(({className:t,...e},r)=>o.jsx(K_,{ref:r,className:Ye("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:o.jsx(tc,{className:"h-4 w-4"})}));wL.displayName=K_.displayName;const bL=C.forwardRef(({className:t,...e},r)=>o.jsx(H_,{ref:r,className:Ye("text-sm font-semibold",t),...e}));bL.displayName=H_.displayName;const EL=C.forwardRef(({className:t,...e},r)=>o.jsx(z_,{ref:r,className:Ye("text-sm opacity-90",t),...e}));EL.displayName=z_.displayName;function h7(){const{toasts:t}=la();return o.jsxs(c7,{children:[t.map(function({id:e,title:r,description:n,action:s,...i}){return o.jsxs(vL,{...i,children:[o.jsxs("div",{className:"grid gap-1",children:[r&&o.jsx(bL,{children:r}),n&&o.jsx(EL,{children:n})]}),s,o.jsx(wL,{})]},e)}),o.jsx(yL,{})]})}var F0=["light","dark"],mb="(prefers-color-scheme: dark)",f7=typeof window>"u",pb=C.createContext(void 0),m7={setTheme:t=>{},themes:[]},p7=()=>{var t;return(t=C.useContext(pb))!=null?t:m7},g7=t=>C.useContext(pb)?t.children:C.createElement(y7,{...t}),x7=["light","dark"],y7=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:r=!0,enableColorScheme:n=!0,storageKey:s="theme",themes:i=x7,defaultTheme:a=r?"system":"light",attribute:l="data-theme",value:d,children:u,nonce:f})=>{let[p,y]=C.useState(()=>XS(s,a)),[v,E]=C.useState(()=>XS(s)),b=d?Object.values(d):i,T=C.useCallback(L=>{let P=L;if(!P)return;L==="system"&&r&&(P=QS());let k=d?d[P]:P,D=e?w7():null,O=document.documentElement;if(l==="class"?(O.classList.remove(...b),k&&O.classList.add(k)):k?O.setAttribute(l,k):O.removeAttribute(l),n){let F=F0.includes(a)?a:null,$=F0.includes(P)?P:F;O.style.colorScheme=$}D==null||D()},[]),I=C.useCallback(L=>{let P=typeof L=="function"?L(L):L;y(P);try{localStorage.setItem(s,P)}catch{}},[t]),N=C.useCallback(L=>{let P=QS(L);E(P),p==="system"&&r&&!t&&T("system")},[p,t]);C.useEffect(()=>{let L=window.matchMedia(mb);return L.addListener(N),N(L),()=>L.removeListener(N)},[N]),C.useEffect(()=>{let L=P=>{if(P.key!==s)return;let k=P.newValue||a;I(k)};return window.addEventListener("storage",L),()=>window.removeEventListener("storage",L)},[I]),C.useEffect(()=>{T(t??p)},[t,p]);let A=C.useMemo(()=>({theme:p,setTheme:I,forcedTheme:t,resolvedTheme:p==="system"?v:p,themes:r?[...i,"system"]:i,systemTheme:r?v:void 0}),[p,I,t,v,r,i]);return C.createElement(pb.Provider,{value:A},C.createElement(v7,{forcedTheme:t,disableTransitionOnChange:e,enableSystem:r,enableColorScheme:n,storageKey:s,themes:i,defaultTheme:a,attribute:l,value:d,children:u,attrs:b,nonce:f}),u)},v7=C.memo(({forcedTheme:t,storageKey:e,attribute:r,enableSystem:n,enableColorScheme:s,defaultTheme:i,value:a,attrs:l,nonce:d})=>{let u=i==="system",f=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(E=>`'${E}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,p=s?F0.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",y=(E,b=!1,T=!0)=>{let I=a?a[E]:E,N=b?E+"|| ''":`'${I}'`,A="";return s&&T&&!b&&F0.includes(E)&&(A+=`d.style.colorScheme = '${E}';`),r==="class"?b||I?A+=`c.add(${N})`:A+="null":I&&(A+=`d[s](n,${N})`),A},v=t?`!function(){${f}${y(t)}}()`:n?`!function(){try{${f}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${mb}',m=window.matchMedia(t);if(m.media!==t||m.matches){${y("dark")}}else{${y("light")}}}else if(e){${a?`var x=${JSON.stringify(a)};`:""}${y(a?"x[e]":"e",!0)}}${u?"":"else{"+y(i,!1,!1)+"}"}${p}}catch(e){}}()`:`!function(){try{${f}var e=localStorage.getItem('${e}');if(e){${a?`var x=${JSON.stringify(a)};`:""}${y(a?"x[e]":"e",!0)}}else{${y(i,!1,!1)};}${p}}catch(t){}}();`;return C.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:v}})}),XS=(t,e)=>{if(f7)return;let r;try{r=localStorage.getItem(t)||void 0}catch{}return r||e},w7=()=>{let t=document.createElement("style");return t.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},QS=t=>(t||(t=window.matchMedia(mb)),t.matches?"dark":"light"),b7=t=>{switch(t){case"success":return T7;case"info":return A7;case"warning":return C7;case"error":return N7;default:return null}},E7=Array(12).fill(0),S7=({visible:t,className:e})=>Fe.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},Fe.createElement("div",{className:"sonner-spinner"},E7.map((r,n)=>Fe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),T7=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),C7=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),A7=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),N7=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Fe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),I7=Fe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Fe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Fe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),R7=()=>{let[t,e]=Fe.useState(document.hidden);return Fe.useEffect(()=>{let r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},Fy=1,_7=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:r,...n}=t,s=typeof(t==null?void 0:t.id)=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:Fy++,i=this.toasts.find(l=>l.id===s),a=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),i?this.toasts=this.toasts.map(l=>l.id===s?(this.publish({...l,...t,id:s,title:r}),{...l,...t,id:s,dismissible:a,title:r}):l):this.addToast({title:r,...n,dismissible:a,id:s}),s},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(e=>{this.subscribers.forEach(r=>r({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let r;e.loading!==void 0&&(r=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let n=t instanceof Promise?t:t(),s=r!==void 0,i,a=n.then(async d=>{if(i=["resolve",d],Fe.isValidElement(d))s=!1,this.create({id:r,type:"default",message:d});else if(P7(d)&&!d.ok){s=!1;let u=typeof e.error=="function"?await e.error(`HTTP error! status: ${d.status}`):e.error,f=typeof e.description=="function"?await e.description(`HTTP error! status: ${d.status}`):e.description;this.create({id:r,type:"error",message:u,description:f})}else if(e.success!==void 0){s=!1;let u=typeof e.success=="function"?await e.success(d):e.success,f=typeof e.description=="function"?await e.description(d):e.description;this.create({id:r,type:"success",message:u,description:f})}}).catch(async d=>{if(i=["reject",d],e.error!==void 0){s=!1;let u=typeof e.error=="function"?await e.error(d):e.error,f=typeof e.description=="function"?await e.description(d):e.description;this.create({id:r,type:"error",message:u,description:f})}}).finally(()=>{var d;s&&(this.dismiss(r),r=void 0),(d=e.finally)==null||d.call(e)}),l=()=>new Promise((d,u)=>a.then(()=>i[0]==="reject"?u(i[1]):d(i[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,e)=>{let r=(e==null?void 0:e.id)||Fy++;return this.create({jsx:t(r),id:r,...e}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ns=new _7,L7=(t,e)=>{let r=(e==null?void 0:e.id)||Fy++;return ns.addToast({title:t,...e,id:r}),r},P7=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",D7=L7,k7=()=>ns.toasts,j7=()=>ns.getActiveToasts(),Ge=Object.assign(D7,{success:ns.success,info:ns.info,warning:ns.warning,error:ns.error,custom:ns.custom,message:ns.message,promise:ns.promise,dismiss:ns.dismiss,loading:ns.loading},{getHistory:k7,getToasts:j7});function M7(t,{insertAt:e}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}M7(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function sm(t){return t.label!==void 0}var O7=3,F7="32px",B7="16px",ZS=4e3,U7=356,$7=14,V7=20,G7=200;function ui(...t){return t.filter(Boolean).join(" ")}function H7(t){let[e,r]=t.split("-"),n=[];return e&&n.push(e),r&&n.push(r),n}var z7=t=>{var e,r,n,s,i,a,l,d,u,f,p;let{invert:y,toast:v,unstyled:E,interacting:b,setHeights:T,visibleToasts:I,heights:N,index:A,toasts:L,expanded:P,removeToast:k,defaultRichColors:D,closeButton:O,style:F,cancelButtonStyle:$,actionButtonStyle:G,className:Y="",descriptionClassName:ne="",duration:X,position:z,gap:Z,loadingIcon:ee,expandByDefault:q,classNames:K,icons:ae,closeButtonAriaLabel:Q="Close toast",pauseWhenPageIsHidden:re}=t,[Ee,ie]=Fe.useState(null),[se,oe]=Fe.useState(null),[fe,Le]=Fe.useState(!1),[_e,ce]=Fe.useState(!1),[Se,Pe]=Fe.useState(!1),[Be,tt]=Fe.useState(!1),[we,Ne]=Fe.useState(!1),[Je,Xe]=Fe.useState(0),[at,Wr]=Fe.useState(0),$e=Fe.useRef(v.duration||X||ZS),Bn=Fe.useRef(null),gs=Fe.useRef(null),In=A===0,Ua=A+1<=I,Ft=v.type,Ms=v.dismissible!==!1,Os=v.className||"",Ur=v.descriptionClassName||"",Li=Fe.useMemo(()=>N.findIndex(et=>et.toastId===v.id)||0,[N,v.id]),Fs=Fe.useMemo(()=>{var et;return(et=v.closeButton)!=null?et:O},[v.closeButton,O]),If=Fe.useMemo(()=>v.duration||X||ZS,[v.duration,X]),ir=Fe.useRef(0),Oe=Fe.useRef(0),wr=Fe.useRef(0),Lt=Fe.useRef(null),[ar,el]=z.split("-"),uc=Fe.useMemo(()=>N.reduce((et,Mt,gt)=>gt>=Li?et:et+Mt.height,0),[N,Li]),ad=R7(),Pt=v.invert||y,ai=Ft==="loading";Oe.current=Fe.useMemo(()=>Li*Z+uc,[Li,uc]),Fe.useEffect(()=>{$e.current=If},[If]),Fe.useEffect(()=>{Le(!0)},[]),Fe.useEffect(()=>{let et=gs.current;if(et){let Mt=et.getBoundingClientRect().height;return Wr(Mt),T(gt=>[{toastId:v.id,height:Mt,position:v.position},...gt]),()=>T(gt=>gt.filter(rn=>rn.toastId!==v.id))}},[T,v.id]),Fe.useLayoutEffect(()=>{if(!fe)return;let et=gs.current,Mt=et.style.height;et.style.height="auto";let gt=et.getBoundingClientRect().height;et.style.height=Mt,Wr(gt),T(rn=>rn.find(Rn=>Rn.toastId===v.id)?rn.map(Rn=>Rn.toastId===v.id?{...Rn,height:gt}:Rn):[{toastId:v.id,height:gt,position:v.position},...rn])},[fe,v.title,v.description,T,v.id]);let oi=Fe.useCallback(()=>{ce(!0),Xe(Oe.current),T(et=>et.filter(Mt=>Mt.toastId!==v.id)),setTimeout(()=>{k(v)},G7)},[v,k,T,Oe]);Fe.useEffect(()=>{if(v.promise&&Ft==="loading"||v.duration===1/0||v.type==="loading")return;let et;return P||b||re&&ad?(()=>{if(wr.current<ir.current){let Mt=new Date().getTime()-ir.current;$e.current=$e.current-Mt}wr.current=new Date().getTime()})():$e.current!==1/0&&(ir.current=new Date().getTime(),et=setTimeout(()=>{var Mt;(Mt=v.onAutoClose)==null||Mt.call(v,v),oi()},$e.current)),()=>clearTimeout(et)},[P,b,v,Ft,re,ad,oi]),Fe.useEffect(()=>{v.delete&&oi()},[oi,v.delete]);function Rf(){var et,Mt,gt;return ae!=null&&ae.loading?Fe.createElement("div",{className:ui(K==null?void 0:K.loader,(et=v==null?void 0:v.classNames)==null?void 0:et.loader,"sonner-loader"),"data-visible":Ft==="loading"},ae.loading):ee?Fe.createElement("div",{className:ui(K==null?void 0:K.loader,(Mt=v==null?void 0:v.classNames)==null?void 0:Mt.loader,"sonner-loader"),"data-visible":Ft==="loading"},ee):Fe.createElement(S7,{className:ui(K==null?void 0:K.loader,(gt=v==null?void 0:v.classNames)==null?void 0:gt.loader),visible:Ft==="loading"})}return Fe.createElement("li",{tabIndex:0,ref:gs,className:ui(Y,Os,K==null?void 0:K.toast,(e=v==null?void 0:v.classNames)==null?void 0:e.toast,K==null?void 0:K.default,K==null?void 0:K[Ft],(r=v==null?void 0:v.classNames)==null?void 0:r[Ft]),"data-sonner-toast":"","data-rich-colors":(n=v.richColors)!=null?n:D,"data-styled":!(v.jsx||v.unstyled||E),"data-mounted":fe,"data-promise":!!v.promise,"data-swiped":we,"data-removed":_e,"data-visible":Ua,"data-y-position":ar,"data-x-position":el,"data-index":A,"data-front":In,"data-swiping":Se,"data-dismissible":Ms,"data-type":Ft,"data-invert":Pt,"data-swipe-out":Be,"data-swipe-direction":se,"data-expanded":!!(P||q&&fe),style:{"--index":A,"--toasts-before":A,"--z-index":L.length-A,"--offset":`${_e?Je:Oe.current}px`,"--initial-height":q?"auto":`${at}px`,...F,...v.style},onDragEnd:()=>{Pe(!1),ie(null),Lt.current=null},onPointerDown:et=>{ai||!Ms||(Bn.current=new Date,Xe(Oe.current),et.target.setPointerCapture(et.pointerId),et.target.tagName!=="BUTTON"&&(Pe(!0),Lt.current={x:et.clientX,y:et.clientY}))},onPointerUp:()=>{var et,Mt,gt,rn;if(Be||!Ms)return;Lt.current=null;let Rn=Number(((et=gs.current)==null?void 0:et.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Kr=Number(((Mt=gs.current)==null?void 0:Mt.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),da=new Date().getTime()-((gt=Bn.current)==null?void 0:gt.getTime()),Yr=Ee==="x"?Rn:Kr,Bs=Math.abs(Yr)/da;if(Math.abs(Yr)>=V7||Bs>.11){Xe(Oe.current),(rn=v.onDismiss)==null||rn.call(v,v),oe(Ee==="x"?Rn>0?"right":"left":Kr>0?"down":"up"),oi(),tt(!0),Ne(!1);return}Pe(!1),ie(null)},onPointerMove:et=>{var Mt,gt,rn,Rn;if(!Lt.current||!Ms||((Mt=window.getSelection())==null?void 0:Mt.toString().length)>0)return;let Kr=et.clientY-Lt.current.y,da=et.clientX-Lt.current.x,Yr=(gt=t.swipeDirections)!=null?gt:H7(z);!Ee&&(Math.abs(da)>1||Math.abs(Kr)>1)&&ie(Math.abs(da)>Math.abs(Kr)?"x":"y");let Bs={x:0,y:0};Ee==="y"?(Yr.includes("top")||Yr.includes("bottom"))&&(Yr.includes("top")&&Kr<0||Yr.includes("bottom")&&Kr>0)&&(Bs.y=Kr):Ee==="x"&&(Yr.includes("left")||Yr.includes("right"))&&(Yr.includes("left")&&da<0||Yr.includes("right")&&da>0)&&(Bs.x=da),(Math.abs(Bs.x)>0||Math.abs(Bs.y)>0)&&Ne(!0),(rn=gs.current)==null||rn.style.setProperty("--swipe-amount-x",`${Bs.x}px`),(Rn=gs.current)==null||Rn.style.setProperty("--swipe-amount-y",`${Bs.y}px`)}},Fs&&!v.jsx?Fe.createElement("button",{"aria-label":Q,"data-disabled":ai,"data-close-button":!0,onClick:ai||!Ms?()=>{}:()=>{var et;oi(),(et=v.onDismiss)==null||et.call(v,v)},className:ui(K==null?void 0:K.closeButton,(s=v==null?void 0:v.classNames)==null?void 0:s.closeButton)},(i=ae==null?void 0:ae.close)!=null?i:I7):null,v.jsx||C.isValidElement(v.title)?v.jsx?v.jsx:typeof v.title=="function"?v.title():v.title:Fe.createElement(Fe.Fragment,null,Ft||v.icon||v.promise?Fe.createElement("div",{"data-icon":"",className:ui(K==null?void 0:K.icon,(a=v==null?void 0:v.classNames)==null?void 0:a.icon)},v.promise||v.type==="loading"&&!v.icon?v.icon||Rf():null,v.type!=="loading"?v.icon||(ae==null?void 0:ae[Ft])||b7(Ft):null):null,Fe.createElement("div",{"data-content":"",className:ui(K==null?void 0:K.content,(l=v==null?void 0:v.classNames)==null?void 0:l.content)},Fe.createElement("div",{"data-title":"",className:ui(K==null?void 0:K.title,(d=v==null?void 0:v.classNames)==null?void 0:d.title)},typeof v.title=="function"?v.title():v.title),v.description?Fe.createElement("div",{"data-description":"",className:ui(ne,Ur,K==null?void 0:K.description,(u=v==null?void 0:v.classNames)==null?void 0:u.description)},typeof v.description=="function"?v.description():v.description):null),C.isValidElement(v.cancel)?v.cancel:v.cancel&&sm(v.cancel)?Fe.createElement("button",{"data-button":!0,"data-cancel":!0,style:v.cancelButtonStyle||$,onClick:et=>{var Mt,gt;sm(v.cancel)&&Ms&&((gt=(Mt=v.cancel).onClick)==null||gt.call(Mt,et),oi())},className:ui(K==null?void 0:K.cancelButton,(f=v==null?void 0:v.classNames)==null?void 0:f.cancelButton)},v.cancel.label):null,C.isValidElement(v.action)?v.action:v.action&&sm(v.action)?Fe.createElement("button",{"data-button":!0,"data-action":!0,style:v.actionButtonStyle||G,onClick:et=>{var Mt,gt;sm(v.action)&&((gt=(Mt=v.action).onClick)==null||gt.call(Mt,et),!et.defaultPrevented&&oi())},className:ui(K==null?void 0:K.actionButton,(p=v==null?void 0:v.classNames)==null?void 0:p.actionButton)},v.action.label):null))};function JS(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function W7(t,e){let r={};return[t,e].forEach((n,s)=>{let i=s===1,a=i?"--mobile-offset":"--offset",l=i?B7:F7;function d(u){["top","right","bottom","left"].forEach(f=>{r[`${a}-${f}`]=typeof u=="number"?`${u}px`:u})}typeof n=="number"||typeof n=="string"?d(n):typeof n=="object"?["top","right","bottom","left"].forEach(u=>{n[u]===void 0?r[`${a}-${u}`]=l:r[`${a}-${u}`]=typeof n[u]=="number"?`${n[u]}px`:n[u]}):d(l)}),r}var K7=C.forwardRef(function(t,e){let{invert:r,position:n="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:a,className:l,offset:d,mobileOffset:u,theme:f="light",richColors:p,duration:y,style:v,visibleToasts:E=O7,toastOptions:b,dir:T=JS(),gap:I=$7,loadingIcon:N,icons:A,containerAriaLabel:L="Notifications",pauseWhenPageIsHidden:P}=t,[k,D]=Fe.useState([]),O=Fe.useMemo(()=>Array.from(new Set([n].concat(k.filter(re=>re.position).map(re=>re.position)))),[k,n]),[F,$]=Fe.useState([]),[G,Y]=Fe.useState(!1),[ne,X]=Fe.useState(!1),[z,Z]=Fe.useState(f!=="system"?f:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),ee=Fe.useRef(null),q=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=Fe.useRef(null),ae=Fe.useRef(!1),Q=Fe.useCallback(re=>{D(Ee=>{var ie;return(ie=Ee.find(se=>se.id===re.id))!=null&&ie.delete||ns.dismiss(re.id),Ee.filter(({id:se})=>se!==re.id)})},[]);return Fe.useEffect(()=>ns.subscribe(re=>{if(re.dismiss){D(Ee=>Ee.map(ie=>ie.id===re.id?{...ie,delete:!0}:ie));return}setTimeout(()=>{E_.flushSync(()=>{D(Ee=>{let ie=Ee.findIndex(se=>se.id===re.id);return ie!==-1?[...Ee.slice(0,ie),{...Ee[ie],...re},...Ee.slice(ie+1)]:[re,...Ee]})})})}),[]),Fe.useEffect(()=>{if(f!=="system"){Z(f);return}if(f==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?Z("dark"):Z("light")),typeof window>"u")return;let re=window.matchMedia("(prefers-color-scheme: dark)");try{re.addEventListener("change",({matches:Ee})=>{Z(Ee?"dark":"light")})}catch{re.addListener(({matches:ie})=>{try{Z(ie?"dark":"light")}catch(se){console.error(se)}})}},[f]),Fe.useEffect(()=>{k.length<=1&&Y(!1)},[k]),Fe.useEffect(()=>{let re=Ee=>{var ie,se;s.every(oe=>Ee[oe]||Ee.code===oe)&&(Y(!0),(ie=ee.current)==null||ie.focus()),Ee.code==="Escape"&&(document.activeElement===ee.current||(se=ee.current)!=null&&se.contains(document.activeElement))&&Y(!1)};return document.addEventListener("keydown",re),()=>document.removeEventListener("keydown",re)},[s]),Fe.useEffect(()=>{if(ee.current)return()=>{K.current&&(K.current.focus({preventScroll:!0}),K.current=null,ae.current=!1)}},[ee.current]),Fe.createElement("section",{ref:e,"aria-label":`${L} ${q}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},O.map((re,Ee)=>{var ie;let[se,oe]=re.split("-");return k.length?Fe.createElement("ol",{key:re,dir:T==="auto"?JS():T,tabIndex:-1,ref:ee,className:l,"data-sonner-toaster":!0,"data-theme":z,"data-y-position":se,"data-lifted":G&&k.length>1&&!i,"data-x-position":oe,style:{"--front-toast-height":`${((ie=F[0])==null?void 0:ie.height)||0}px`,"--width":`${U7}px`,"--gap":`${I}px`,...v,...W7(d,u)},onBlur:fe=>{ae.current&&!fe.currentTarget.contains(fe.relatedTarget)&&(ae.current=!1,K.current&&(K.current.focus({preventScroll:!0}),K.current=null))},onFocus:fe=>{fe.target instanceof HTMLElement&&fe.target.dataset.dismissible==="false"||ae.current||(ae.current=!0,K.current=fe.relatedTarget)},onMouseEnter:()=>Y(!0),onMouseMove:()=>Y(!0),onMouseLeave:()=>{ne||Y(!1)},onDragEnd:()=>Y(!1),onPointerDown:fe=>{fe.target instanceof HTMLElement&&fe.target.dataset.dismissible==="false"||X(!0)},onPointerUp:()=>X(!1)},k.filter(fe=>!fe.position&&Ee===0||fe.position===re).map((fe,Le)=>{var _e,ce;return Fe.createElement(z7,{key:fe.id,icons:A,index:Le,toast:fe,defaultRichColors:p,duration:(_e=b==null?void 0:b.duration)!=null?_e:y,className:b==null?void 0:b.className,descriptionClassName:b==null?void 0:b.descriptionClassName,invert:r,visibleToasts:E,closeButton:(ce=b==null?void 0:b.closeButton)!=null?ce:a,interacting:ne,position:re,style:b==null?void 0:b.style,unstyled:b==null?void 0:b.unstyled,classNames:b==null?void 0:b.classNames,cancelButtonStyle:b==null?void 0:b.cancelButtonStyle,actionButtonStyle:b==null?void 0:b.actionButtonStyle,removeToast:Q,toasts:k.filter(Se=>Se.position==fe.position),heights:F.filter(Se=>Se.position==fe.position),setHeights:$,expandByDefault:i,gap:I,loadingIcon:N,expanded:G,pauseWhenPageIsHidden:P,swipeDirections:t.swipeDirections})})):null}))});const Y7=({...t})=>{const{theme:e="system"}=p7();return o.jsx(K7,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var q7=lw[" useId ".trim().toString()]||(()=>{}),X7=0;function Ti(t){const[e,r]=C.useState(q7());return Br(()=>{r(n=>n??String(X7++))},[t]),e?`radix-${e}`:""}const Q7=["top","right","bottom","left"],Do=Math.min,Cs=Math.max,B0=Math.round,im=Math.floor,ta=t=>({x:t,y:t}),Z7={left:"right",right:"left",bottom:"top",top:"bottom"},J7={start:"end",end:"start"};function By(t,e,r){return Cs(t,Do(e,r))}function Pa(t,e){return typeof t=="function"?t(e):t}function Da(t){return t.split("-")[0]}function Wu(t){return t.split("-")[1]}function gb(t){return t==="x"?"y":"x"}function xb(t){return t==="y"?"height":"width"}const e9=new Set(["top","bottom"]);function qi(t){return e9.has(Da(t))?"y":"x"}function yb(t){return gb(qi(t))}function t9(t,e,r){r===void 0&&(r=!1);const n=Wu(t),s=yb(t),i=xb(s);let a=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=U0(a)),[a,U0(a)]}function r9(t){const e=U0(t);return[Uy(t),e,Uy(e)]}function Uy(t){return t.replace(/start|end/g,e=>J7[e])}const eT=["left","right"],tT=["right","left"],n9=["top","bottom"],s9=["bottom","top"];function i9(t,e,r){switch(t){case"top":case"bottom":return r?e?tT:eT:e?eT:tT;case"left":case"right":return e?n9:s9;default:return[]}}function a9(t,e,r,n){const s=Wu(t);let i=i9(Da(t),r==="start",n);return s&&(i=i.map(a=>a+"-"+s),e&&(i=i.concat(i.map(Uy)))),i}function U0(t){return t.replace(/left|right|bottom|top/g,e=>Z7[e])}function o9(t){return{top:0,right:0,bottom:0,left:0,...t}}function SL(t){return typeof t!="number"?o9(t):{top:t,right:t,bottom:t,left:t}}function $0(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function rT(t,e,r){let{reference:n,floating:s}=t;const i=qi(e),a=yb(e),l=xb(a),d=Da(e),u=i==="y",f=n.x+n.width/2-s.width/2,p=n.y+n.height/2-s.height/2,y=n[l]/2-s[l]/2;let v;switch(d){case"top":v={x:f,y:n.y-s.height};break;case"bottom":v={x:f,y:n.y+n.height};break;case"right":v={x:n.x+n.width,y:p};break;case"left":v={x:n.x-s.width,y:p};break;default:v={x:n.x,y:n.y}}switch(Wu(e)){case"start":v[a]-=y*(r&&u?-1:1);break;case"end":v[a]+=y*(r&&u?-1:1);break}return v}const l9=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:a}=r,l=i.filter(Boolean),d=await(a.isRTL==null?void 0:a.isRTL(e));let u=await a.getElementRects({reference:t,floating:e,strategy:s}),{x:f,y:p}=rT(u,n,d),y=n,v={},E=0;for(let b=0;b<l.length;b++){const{name:T,fn:I}=l[b],{x:N,y:A,data:L,reset:P}=await I({x:f,y:p,initialPlacement:n,placement:y,strategy:s,middlewareData:v,rects:u,platform:a,elements:{reference:t,floating:e}});f=N??f,p=A??p,v={...v,[T]:{...v[T],...L}},P&&E<=50&&(E++,typeof P=="object"&&(P.placement&&(y=P.placement),P.rects&&(u=P.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:s}):P.rects),{x:f,y:p}=rT(u,y,d)),b=-1)}return{x:f,y:p,placement:y,strategy:s,middlewareData:v}};async function Ah(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:a,elements:l,strategy:d}=t,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:p="floating",altBoundary:y=!1,padding:v=0}=Pa(e,t),E=SL(v),T=l[y?p==="floating"?"reference":"floating":p],I=$0(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(T)))==null||r?T:T.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:f,strategy:d})),N=p==="floating"?{x:n,y:s,width:a.floating.width,height:a.floating.height}:a.reference,A=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),L=await(i.isElement==null?void 0:i.isElement(A))?await(i.getScale==null?void 0:i.getScale(A))||{x:1,y:1}:{x:1,y:1},P=$0(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:N,offsetParent:A,strategy:d}):N);return{top:(I.top-P.top+E.top)/L.y,bottom:(P.bottom-I.bottom+E.bottom)/L.y,left:(I.left-P.left+E.left)/L.x,right:(P.right-I.right+E.right)/L.x}}const c9=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:i,platform:a,elements:l,middlewareData:d}=e,{element:u,padding:f=0}=Pa(t,e)||{};if(u==null)return{};const p=SL(f),y={x:r,y:n},v=yb(s),E=xb(v),b=await a.getDimensions(u),T=v==="y",I=T?"top":"left",N=T?"bottom":"right",A=T?"clientHeight":"clientWidth",L=i.reference[E]+i.reference[v]-y[v]-i.floating[E],P=y[v]-i.reference[v],k=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let D=k?k[A]:0;(!D||!await(a.isElement==null?void 0:a.isElement(k)))&&(D=l.floating[A]||i.floating[E]);const O=L/2-P/2,F=D/2-b[E]/2-1,$=Do(p[I],F),G=Do(p[N],F),Y=$,ne=D-b[E]-G,X=D/2-b[E]/2+O,z=By(Y,X,ne),Z=!d.arrow&&Wu(s)!=null&&X!==z&&i.reference[E]/2-(X<Y?$:G)-b[E]/2<0,ee=Z?X<Y?X-Y:X-ne:0;return{[v]:y[v]+ee,data:{[v]:z,centerOffset:X-z-ee,...Z&&{alignmentOffset:ee}},reset:Z}}}),u9=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:i,rects:a,initialPlacement:l,platform:d,elements:u}=e,{mainAxis:f=!0,crossAxis:p=!0,fallbackPlacements:y,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:E="none",flipAlignment:b=!0,...T}=Pa(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const I=Da(s),N=qi(l),A=Da(l)===l,L=await(d.isRTL==null?void 0:d.isRTL(u.floating)),P=y||(A||!b?[U0(l)]:r9(l)),k=E!=="none";!y&&k&&P.push(...a9(l,b,E,L));const D=[l,...P],O=await Ah(e,T),F=[];let $=((n=i.flip)==null?void 0:n.overflows)||[];if(f&&F.push(O[I]),p){const X=t9(s,a,L);F.push(O[X[0]],O[X[1]])}if($=[...$,{placement:s,overflows:F}],!F.every(X=>X<=0)){var G,Y;const X=(((G=i.flip)==null?void 0:G.index)||0)+1,z=D[X];if(z&&(!(p==="alignment"?N!==qi(z):!1)||$.every(q=>q.overflows[0]>0&&qi(q.placement)===N)))return{data:{index:X,overflows:$},reset:{placement:z}};let Z=(Y=$.filter(ee=>ee.overflows[0]<=0).sort((ee,q)=>ee.overflows[1]-q.overflows[1])[0])==null?void 0:Y.placement;if(!Z)switch(v){case"bestFit":{var ne;const ee=(ne=$.filter(q=>{if(k){const K=qi(q.placement);return K===N||K==="y"}return!0}).map(q=>[q.placement,q.overflows.filter(K=>K>0).reduce((K,ae)=>K+ae,0)]).sort((q,K)=>q[1]-K[1])[0])==null?void 0:ne[0];ee&&(Z=ee);break}case"initialPlacement":Z=l;break}if(s!==Z)return{reset:{placement:Z}}}return{}}}};function nT(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function sT(t){return Q7.some(e=>t[e]>=0)}const d9=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=Pa(t,e);switch(n){case"referenceHidden":{const i=await Ah(e,{...s,elementContext:"reference"}),a=nT(i,r.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:sT(a)}}}case"escaped":{const i=await Ah(e,{...s,altBoundary:!0}),a=nT(i,r.floating);return{data:{escapedOffsets:a,escaped:sT(a)}}}default:return{}}}}},TL=new Set(["left","top"]);async function h9(t,e){const{placement:r,platform:n,elements:s}=t,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),a=Da(r),l=Wu(r),d=qi(r)==="y",u=TL.has(a)?-1:1,f=i&&d?-1:1,p=Pa(e,t);let{mainAxis:y,crossAxis:v,alignmentAxis:E}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&typeof E=="number"&&(v=l==="end"?E*-1:E),d?{x:v*f,y:y*u}:{x:y*u,y:v*f}}const f9=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:i,placement:a,middlewareData:l}=e,d=await h9(e,t);return a===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:s+d.x,y:i+d.y,data:{...d,placement:a}}}}},m9=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:l={fn:T=>{let{x:I,y:N}=T;return{x:I,y:N}}},...d}=Pa(t,e),u={x:r,y:n},f=await Ah(e,d),p=qi(Da(s)),y=gb(p);let v=u[y],E=u[p];if(i){const T=y==="y"?"top":"left",I=y==="y"?"bottom":"right",N=v+f[T],A=v-f[I];v=By(N,v,A)}if(a){const T=p==="y"?"top":"left",I=p==="y"?"bottom":"right",N=E+f[T],A=E-f[I];E=By(N,E,A)}const b=l.fn({...e,[y]:v,[p]:E});return{...b,data:{x:b.x-r,y:b.y-n,enabled:{[y]:i,[p]:a}}}}}},p9=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:i,middlewareData:a}=e,{offset:l=0,mainAxis:d=!0,crossAxis:u=!0}=Pa(t,e),f={x:r,y:n},p=qi(s),y=gb(p);let v=f[y],E=f[p];const b=Pa(l,e),T=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(d){const A=y==="y"?"height":"width",L=i.reference[y]-i.floating[A]+T.mainAxis,P=i.reference[y]+i.reference[A]-T.mainAxis;v<L?v=L:v>P&&(v=P)}if(u){var I,N;const A=y==="y"?"width":"height",L=TL.has(Da(s)),P=i.reference[p]-i.floating[A]+(L&&((I=a.offset)==null?void 0:I[p])||0)+(L?0:T.crossAxis),k=i.reference[p]+i.reference[A]+(L?0:((N=a.offset)==null?void 0:N[p])||0)-(L?T.crossAxis:0);E<P?E=P:E>k&&(E=k)}return{[y]:v,[p]:E}}}},g9=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:i,platform:a,elements:l}=e,{apply:d=()=>{},...u}=Pa(t,e),f=await Ah(e,u),p=Da(s),y=Wu(s),v=qi(s)==="y",{width:E,height:b}=i.floating;let T,I;p==="top"||p==="bottom"?(T=p,I=y===(await(a.isRTL==null?void 0:a.isRTL(l.floating))?"start":"end")?"left":"right"):(I=p,T=y==="end"?"top":"bottom");const N=b-f.top-f.bottom,A=E-f.left-f.right,L=Do(b-f[T],N),P=Do(E-f[I],A),k=!e.middlewareData.shift;let D=L,O=P;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(O=A),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(D=N),k&&!y){const $=Cs(f.left,0),G=Cs(f.right,0),Y=Cs(f.top,0),ne=Cs(f.bottom,0);v?O=E-2*($!==0||G!==0?$+G:Cs(f.left,f.right)):D=b-2*(Y!==0||ne!==0?Y+ne:Cs(f.top,f.bottom))}await d({...e,availableWidth:O,availableHeight:D});const F=await a.getDimensions(l.floating);return E!==F.width||b!==F.height?{reset:{rects:!0}}:{}}}};function Xp(){return typeof window<"u"}function Ku(t){return CL(t)?(t.nodeName||"").toLowerCase():"#document"}function Rs(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ca(t){var e;return(e=(CL(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function CL(t){return Xp()?t instanceof Node||t instanceof Rs(t).Node:!1}function Ni(t){return Xp()?t instanceof Element||t instanceof Rs(t).Element:!1}function ia(t){return Xp()?t instanceof HTMLElement||t instanceof Rs(t).HTMLElement:!1}function iT(t){return!Xp()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Rs(t).ShadowRoot}const x9=new Set(["inline","contents"]);function df(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=Ii(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!x9.has(s)}const y9=new Set(["table","td","th"]);function v9(t){return y9.has(Ku(t))}const w9=[":popover-open",":modal"];function Qp(t){return w9.some(e=>{try{return t.matches(e)}catch{return!1}})}const b9=["transform","translate","scale","rotate","perspective"],E9=["transform","translate","scale","rotate","perspective","filter"],S9=["paint","layout","strict","content"];function vb(t){const e=wb(),r=Ni(t)?Ii(t):t;return b9.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||E9.some(n=>(r.willChange||"").includes(n))||S9.some(n=>(r.contain||"").includes(n))}function T9(t){let e=ko(t);for(;ia(e)&&!Iu(e);){if(vb(e))return e;if(Qp(e))return null;e=ko(e)}return null}function wb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const C9=new Set(["html","body","#document"]);function Iu(t){return C9.has(Ku(t))}function Ii(t){return Rs(t).getComputedStyle(t)}function Zp(t){return Ni(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ko(t){if(Ku(t)==="html")return t;const e=t.assignedSlot||t.parentNode||iT(t)&&t.host||ca(t);return iT(e)?e.host:e}function AL(t){const e=ko(t);return Iu(e)?t.ownerDocument?t.ownerDocument.body:t.body:ia(e)&&df(e)?e:AL(e)}function Nh(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=AL(t),i=s===((n=t.ownerDocument)==null?void 0:n.body),a=Rs(s);if(i){const l=$y(a);return e.concat(a,a.visualViewport||[],df(s)?s:[],l&&r?Nh(l):[])}return e.concat(s,Nh(s,[],r))}function $y(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function NL(t){const e=Ii(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=ia(t),i=s?t.offsetWidth:r,a=s?t.offsetHeight:n,l=B0(r)!==i||B0(n)!==a;return l&&(r=i,n=a),{width:r,height:n,$:l}}function bb(t){return Ni(t)?t:t.contextElement}function su(t){const e=bb(t);if(!ia(e))return ta(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:i}=NL(e);let a=(i?B0(r.width):r.width)/n,l=(i?B0(r.height):r.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const A9=ta(0);function IL(t){const e=Rs(t);return!wb()||!e.visualViewport?A9:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function N9(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Rs(t)?!1:e}function Gl(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=bb(t);let a=ta(1);e&&(n?Ni(n)&&(a=su(n)):a=su(t));const l=N9(i,r,n)?IL(i):ta(0);let d=(s.left+l.x)/a.x,u=(s.top+l.y)/a.y,f=s.width/a.x,p=s.height/a.y;if(i){const y=Rs(i),v=n&&Ni(n)?Rs(n):n;let E=y,b=$y(E);for(;b&&n&&v!==E;){const T=su(b),I=b.getBoundingClientRect(),N=Ii(b),A=I.left+(b.clientLeft+parseFloat(N.paddingLeft))*T.x,L=I.top+(b.clientTop+parseFloat(N.paddingTop))*T.y;d*=T.x,u*=T.y,f*=T.x,p*=T.y,d+=A,u+=L,E=Rs(b),b=$y(E)}}return $0({width:f,height:p,x:d,y:u})}function Eb(t,e){const r=Zp(t).scrollLeft;return e?e.left+r:Gl(ca(t)).left+r}function RL(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-(r?0:Eb(t,n)),i=n.top+e.scrollTop;return{x:s,y:i}}function I9(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const i=s==="fixed",a=ca(n),l=e?Qp(e.floating):!1;if(n===a||l&&i)return r;let d={scrollLeft:0,scrollTop:0},u=ta(1);const f=ta(0),p=ia(n);if((p||!p&&!i)&&((Ku(n)!=="body"||df(a))&&(d=Zp(n)),ia(n))){const v=Gl(n);u=su(n),f.x=v.x+n.clientLeft,f.y=v.y+n.clientTop}const y=a&&!p&&!i?RL(a,d,!0):ta(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-d.scrollLeft*u.x+f.x+y.x,y:r.y*u.y-d.scrollTop*u.y+f.y+y.y}}function R9(t){return Array.from(t.getClientRects())}function _9(t){const e=ca(t),r=Zp(t),n=t.ownerDocument.body,s=Cs(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=Cs(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-r.scrollLeft+Eb(t);const l=-r.scrollTop;return Ii(n).direction==="rtl"&&(a+=Cs(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:a,y:l}}function L9(t,e){const r=Rs(t),n=ca(t),s=r.visualViewport;let i=n.clientWidth,a=n.clientHeight,l=0,d=0;if(s){i=s.width,a=s.height;const u=wb();(!u||u&&e==="fixed")&&(l=s.offsetLeft,d=s.offsetTop)}return{width:i,height:a,x:l,y:d}}const P9=new Set(["absolute","fixed"]);function D9(t,e){const r=Gl(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,i=ia(t)?su(t):ta(1),a=t.clientWidth*i.x,l=t.clientHeight*i.y,d=s*i.x,u=n*i.y;return{width:a,height:l,x:d,y:u}}function aT(t,e,r){let n;if(e==="viewport")n=L9(t,r);else if(e==="document")n=_9(ca(t));else if(Ni(e))n=D9(e,r);else{const s=IL(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return $0(n)}function _L(t,e){const r=ko(t);return r===e||!Ni(r)||Iu(r)?!1:Ii(r).position==="fixed"||_L(r,e)}function k9(t,e){const r=e.get(t);if(r)return r;let n=Nh(t,[],!1).filter(l=>Ni(l)&&Ku(l)!=="body"),s=null;const i=Ii(t).position==="fixed";let a=i?ko(t):t;for(;Ni(a)&&!Iu(a);){const l=Ii(a),d=vb(a);!d&&l.position==="fixed"&&(s=null),(i?!d&&!s:!d&&l.position==="static"&&!!s&&P9.has(s.position)||df(a)&&!d&&_L(t,a))?n=n.filter(f=>f!==a):s=l,a=ko(a)}return e.set(t,n),n}function j9(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const a=[...r==="clippingAncestors"?Qp(e)?[]:k9(e,this._c):[].concat(r),n],l=a[0],d=a.reduce((u,f)=>{const p=aT(e,f,s);return u.top=Cs(p.top,u.top),u.right=Do(p.right,u.right),u.bottom=Do(p.bottom,u.bottom),u.left=Cs(p.left,u.left),u},aT(e,l,s));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function M9(t){const{width:e,height:r}=NL(t);return{width:e,height:r}}function O9(t,e,r){const n=ia(e),s=ca(e),i=r==="fixed",a=Gl(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const d=ta(0);function u(){d.x=Eb(s)}if(n||!n&&!i)if((Ku(e)!=="body"||df(s))&&(l=Zp(e)),n){const v=Gl(e,!0,i,e);d.x=v.x+e.clientLeft,d.y=v.y+e.clientTop}else s&&u();i&&!n&&s&&u();const f=s&&!n&&!i?RL(s,l):ta(0),p=a.left+l.scrollLeft-d.x-f.x,y=a.top+l.scrollTop-d.y-f.y;return{x:p,y,width:a.width,height:a.height}}function Dx(t){return Ii(t).position==="static"}function oT(t,e){if(!ia(t)||Ii(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return ca(t)===r&&(r=r.ownerDocument.body),r}function LL(t,e){const r=Rs(t);if(Qp(t))return r;if(!ia(t)){let s=ko(t);for(;s&&!Iu(s);){if(Ni(s)&&!Dx(s))return s;s=ko(s)}return r}let n=oT(t,e);for(;n&&v9(n)&&Dx(n);)n=oT(n,e);return n&&Iu(n)&&Dx(n)&&!vb(n)?r:n||T9(t)||r}const F9=async function(t){const e=this.getOffsetParent||LL,r=this.getDimensions,n=await r(t.floating);return{reference:O9(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function B9(t){return Ii(t).direction==="rtl"}const U9={convertOffsetParentRelativeRectToViewportRelativeRect:I9,getDocumentElement:ca,getClippingRect:j9,getOffsetParent:LL,getElementRects:F9,getClientRects:R9,getDimensions:M9,getScale:su,isElement:Ni,isRTL:B9};function PL(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function $9(t,e){let r=null,n;const s=ca(t);function i(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function a(l,d){l===void 0&&(l=!1),d===void 0&&(d=1),i();const u=t.getBoundingClientRect(),{left:f,top:p,width:y,height:v}=u;if(l||e(),!y||!v)return;const E=im(p),b=im(s.clientWidth-(f+y)),T=im(s.clientHeight-(p+v)),I=im(f),A={rootMargin:-E+"px "+-b+"px "+-T+"px "+-I+"px",threshold:Cs(0,Do(1,d))||1};let L=!0;function P(k){const D=k[0].intersectionRatio;if(D!==d){if(!L)return a();D?a(!1,D):n=setTimeout(()=>{a(!1,1e-7)},1e3)}D===1&&!PL(u,t.getBoundingClientRect())&&a(),L=!1}try{r=new IntersectionObserver(P,{...A,root:s.ownerDocument})}catch{r=new IntersectionObserver(P,A)}r.observe(t)}return a(!0),i}function V9(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:d=!1}=n,u=bb(t),f=s||i?[...u?Nh(u):[],...Nh(e)]:[];f.forEach(I=>{s&&I.addEventListener("scroll",r,{passive:!0}),i&&I.addEventListener("resize",r)});const p=u&&l?$9(u,r):null;let y=-1,v=null;a&&(v=new ResizeObserver(I=>{let[N]=I;N&&N.target===u&&v&&(v.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var A;(A=v)==null||A.observe(e)})),r()}),u&&!d&&v.observe(u),v.observe(e));let E,b=d?Gl(t):null;d&&T();function T(){const I=Gl(t);b&&!PL(b,I)&&r(),b=I,E=requestAnimationFrame(T)}return r(),()=>{var I;f.forEach(N=>{s&&N.removeEventListener("scroll",r),i&&N.removeEventListener("resize",r)}),p==null||p(),(I=v)==null||I.disconnect(),v=null,d&&cancelAnimationFrame(E)}}const G9=f9,H9=m9,z9=u9,W9=g9,K9=d9,lT=c9,Y9=p9,q9=(t,e,r)=>{const n=new Map,s={platform:U9,...r},i={...s.platform,_c:n};return l9(t,e,{...s,platform:i})};var X9=typeof document<"u",Q9=function(){},Km=X9?C.useLayoutEffect:Q9;function V0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!V0(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&t.$$typeof)&&!V0(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function DL(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function cT(t,e){const r=DL(t);return Math.round(e*r)/r}function kx(t){const e=C.useRef(t);return Km(()=>{e.current=t}),e}function Z9(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:a}={},transform:l=!0,whileElementsMounted:d,open:u}=t,[f,p]=C.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[y,v]=C.useState(n);V0(y,n)||v(n);const[E,b]=C.useState(null),[T,I]=C.useState(null),N=C.useCallback(q=>{q!==k.current&&(k.current=q,b(q))},[]),A=C.useCallback(q=>{q!==D.current&&(D.current=q,I(q))},[]),L=i||E,P=a||T,k=C.useRef(null),D=C.useRef(null),O=C.useRef(f),F=d!=null,$=kx(d),G=kx(s),Y=kx(u),ne=C.useCallback(()=>{if(!k.current||!D.current)return;const q={placement:e,strategy:r,middleware:y};G.current&&(q.platform=G.current),q9(k.current,D.current,q).then(K=>{const ae={...K,isPositioned:Y.current!==!1};X.current&&!V0(O.current,ae)&&(O.current=ae,Jl.flushSync(()=>{p(ae)}))})},[y,e,r,G,Y]);Km(()=>{u===!1&&O.current.isPositioned&&(O.current.isPositioned=!1,p(q=>({...q,isPositioned:!1})))},[u]);const X=C.useRef(!1);Km(()=>(X.current=!0,()=>{X.current=!1}),[]),Km(()=>{if(L&&(k.current=L),P&&(D.current=P),L&&P){if($.current)return $.current(L,P,ne);ne()}},[L,P,ne,$,F]);const z=C.useMemo(()=>({reference:k,floating:D,setReference:N,setFloating:A}),[N,A]),Z=C.useMemo(()=>({reference:L,floating:P}),[L,P]),ee=C.useMemo(()=>{const q={position:r,left:0,top:0};if(!Z.floating)return q;const K=cT(Z.floating,f.x),ae=cT(Z.floating,f.y);return l?{...q,transform:"translate("+K+"px, "+ae+"px)",...DL(Z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:K,top:ae}},[r,l,Z.floating,f.x,f.y]);return C.useMemo(()=>({...f,update:ne,refs:z,elements:Z,floatingStyles:ee}),[f,ne,z,Z,ee])}const J9=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?lT({element:n.current,padding:s}).fn(r):{}:n?lT({element:n,padding:s}).fn(r):{}}}},eU=(t,e)=>({...G9(t),options:[t,e]}),tU=(t,e)=>({...H9(t),options:[t,e]}),rU=(t,e)=>({...Y9(t),options:[t,e]}),nU=(t,e)=>({...z9(t),options:[t,e]}),sU=(t,e)=>({...W9(t),options:[t,e]}),iU=(t,e)=>({...K9(t),options:[t,e]}),aU=(t,e)=>({...J9(t),options:[t,e]});var oU="Arrow",kL=C.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...i}=t;return o.jsx(He.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:o.jsx("polygon",{points:"0,0 30,0 15,10"})})});kL.displayName=oU;var lU=kL;function Jp(t){const[e,r]=C.useState(void 0);return Br(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,l;if("borderBoxSize"in i){const d=i.borderBoxSize,u=Array.isArray(d)?d[0]:d;a=u.inlineSize,l=u.blockSize}else a=t.offsetWidth,l=t.offsetHeight;r({width:a,height:l})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var Sb="Popper",[jL,zo]=hn(Sb),[cU,ML]=jL(Sb),OL=t=>{const{__scopePopper:e,children:r}=t,[n,s]=C.useState(null);return o.jsx(cU,{scope:e,anchor:n,onAnchorChange:s,children:r})};OL.displayName=Sb;var FL="PopperAnchor",BL=C.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,i=ML(FL,r),a=C.useRef(null),l=st(e,a);return C.useEffect(()=>{i.onAnchorChange((n==null?void 0:n.current)||a.current)}),n?null:o.jsx(He.div,{...s,ref:l})});BL.displayName=FL;var Tb="PopperContent",[uU,dU]=jL(Tb),UL=C.forwardRef((t,e)=>{var fe,Le,_e,ce,Se,Pe;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:l=0,avoidCollisions:d=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:p="partial",hideWhenDetached:y=!1,updatePositionStrategy:v="optimized",onPlaced:E,...b}=t,T=ML(Tb,r),[I,N]=C.useState(null),A=st(e,Be=>N(Be)),[L,P]=C.useState(null),k=Jp(L),D=(k==null?void 0:k.width)??0,O=(k==null?void 0:k.height)??0,F=n+(i!=="center"?"-"+i:""),$=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},G=Array.isArray(u)?u:[u],Y=G.length>0,ne={padding:$,boundary:G.filter(fU),altBoundary:Y},{refs:X,floatingStyles:z,placement:Z,isPositioned:ee,middlewareData:q}=Z9({strategy:"fixed",placement:F,whileElementsMounted:(...Be)=>V9(...Be,{animationFrame:v==="always"}),elements:{reference:T.anchor},middleware:[eU({mainAxis:s+O,alignmentAxis:a}),d&&tU({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?rU():void 0,...ne}),d&&nU({...ne}),sU({...ne,apply:({elements:Be,rects:tt,availableWidth:we,availableHeight:Ne})=>{const{width:Je,height:Xe}=tt.reference,at=Be.floating.style;at.setProperty("--radix-popper-available-width",`${we}px`),at.setProperty("--radix-popper-available-height",`${Ne}px`),at.setProperty("--radix-popper-anchor-width",`${Je}px`),at.setProperty("--radix-popper-anchor-height",`${Xe}px`)}}),L&&aU({element:L,padding:l}),mU({arrowWidth:D,arrowHeight:O}),y&&iU({strategy:"referenceHidden",...ne})]}),[K,ae]=GL(Z),Q=Lr(E);Br(()=>{ee&&(Q==null||Q())},[ee,Q]);const re=(fe=q.arrow)==null?void 0:fe.x,Ee=(Le=q.arrow)==null?void 0:Le.y,ie=((_e=q.arrow)==null?void 0:_e.centerOffset)!==0,[se,oe]=C.useState();return Br(()=>{I&&oe(window.getComputedStyle(I).zIndex)},[I]),o.jsx("div",{ref:X.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:ee?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:se,"--radix-popper-transform-origin":[(ce=q.transformOrigin)==null?void 0:ce.x,(Se=q.transformOrigin)==null?void 0:Se.y].join(" "),...((Pe=q.hide)==null?void 0:Pe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:o.jsx(uU,{scope:r,placedSide:K,onArrowChange:P,arrowX:re,arrowY:Ee,shouldHideArrow:ie,children:o.jsx(He.div,{"data-side":K,"data-align":ae,...b,ref:A,style:{...b.style,animation:ee?void 0:"none"}})})})});UL.displayName=Tb;var $L="PopperArrow",hU={top:"bottom",right:"left",bottom:"top",left:"right"},VL=C.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,i=dU($L,n),a=hU[i.placedSide];return o.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:o.jsx(lU,{...s,ref:r,style:{...s.style,display:"block"}})})});VL.displayName=$L;function fU(t){return t!==null}var mU=t=>({name:"transformOrigin",options:t,fn(e){var T,I,N;const{placement:r,rects:n,middlewareData:s}=e,a=((T=s.arrow)==null?void 0:T.centerOffset)!==0,l=a?0:t.arrowWidth,d=a?0:t.arrowHeight,[u,f]=GL(r),p={start:"0%",center:"50%",end:"100%"}[f],y=(((I=s.arrow)==null?void 0:I.x)??0)+l/2,v=(((N=s.arrow)==null?void 0:N.y)??0)+d/2;let E="",b="";return u==="bottom"?(E=a?p:`${y}px`,b=`${-d}px`):u==="top"?(E=a?p:`${y}px`,b=`${n.floating.height+d}px`):u==="right"?(E=`${-d}px`,b=a?p:`${v}px`):u==="left"&&(E=`${n.floating.width+d}px`,b=a?p:`${v}px`),{data:{x:E,y:b}}}});function GL(t){const[e,r="center"]=t.split("-");return[e,r]}var Cb=OL,hf=BL,eg=UL,tg=VL,[rg,Sae]=hn("Tooltip",[zo]),Ab=zo(),HL="TooltipProvider",pU=700,uT="tooltip.open",[gU,zL]=rg(HL),WL=t=>{const{__scopeTooltip:e,delayDuration:r=pU,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=t,a=C.useRef(!0),l=C.useRef(!1),d=C.useRef(0);return C.useEffect(()=>{const u=d.current;return()=>window.clearTimeout(u)},[]),o.jsx(gU,{scope:e,isOpenDelayedRef:a,delayDuration:r,onOpen:C.useCallback(()=>{window.clearTimeout(d.current),a.current=!1},[]),onClose:C.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>a.current=!0,n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:C.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};WL.displayName=HL;var KL="Tooltip",[Tae,ng]=rg(KL),Vy="TooltipTrigger",xU=C.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=ng(Vy,r),i=zL(Vy,r),a=Ab(r),l=C.useRef(null),d=st(e,l,s.onTriggerChange),u=C.useRef(!1),f=C.useRef(!1),p=C.useCallback(()=>u.current=!1,[]);return C.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),o.jsx(hf,{asChild:!0,...a,children:o.jsx(He.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:d,onPointerMove:Re(t.onPointerMove,y=>{y.pointerType!=="touch"&&!f.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),f.current=!0)}),onPointerLeave:Re(t.onPointerLeave,()=>{s.onTriggerLeave(),f.current=!1}),onPointerDown:Re(t.onPointerDown,()=>{s.open&&s.onClose(),u.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:Re(t.onFocus,()=>{u.current||s.onOpen()}),onBlur:Re(t.onBlur,s.onClose),onClick:Re(t.onClick,s.onClose)})})});xU.displayName=Vy;var yU="TooltipPortal",[Cae,vU]=rg(yU,{forceMount:void 0}),Ru="TooltipContent",YL=C.forwardRef((t,e)=>{const r=vU(Ru,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=t,a=ng(Ru,t.__scopeTooltip);return o.jsx(fn,{present:n||a.open,children:a.disableHoverableContent?o.jsx(qL,{side:s,...i,ref:e}):o.jsx(wU,{side:s,...i,ref:e})})}),wU=C.forwardRef((t,e)=>{const r=ng(Ru,t.__scopeTooltip),n=zL(Ru,t.__scopeTooltip),s=C.useRef(null),i=st(e,s),[a,l]=C.useState(null),{trigger:d,onClose:u}=r,f=s.current,{onPointerInTransitChange:p}=n,y=C.useCallback(()=>{l(null),p(!1)},[p]),v=C.useCallback((E,b)=>{const T=E.currentTarget,I={x:E.clientX,y:E.clientY},N=CU(I,T.getBoundingClientRect()),A=AU(I,N),L=NU(b.getBoundingClientRect()),P=RU([...A,...L]);l(P),p(!0)},[p]);return C.useEffect(()=>()=>y(),[y]),C.useEffect(()=>{if(d&&f){const E=T=>v(T,f),b=T=>v(T,d);return d.addEventListener("pointerleave",E),f.addEventListener("pointerleave",b),()=>{d.removeEventListener("pointerleave",E),f.removeEventListener("pointerleave",b)}}},[d,f,v,y]),C.useEffect(()=>{if(a){const E=b=>{const T=b.target,I={x:b.clientX,y:b.clientY},N=(d==null?void 0:d.contains(T))||(f==null?void 0:f.contains(T)),A=!IU(I,a);N?y():A&&(y(),u())};return document.addEventListener("pointermove",E),()=>document.removeEventListener("pointermove",E)}},[d,f,a,u,y]),o.jsx(qL,{...t,ref:i})}),[bU,EU]=rg(KL,{isInside:!1}),SU=xF("TooltipContent"),qL=C.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...l}=t,d=ng(Ru,r),u=Ab(r),{onClose:f}=d;return C.useEffect(()=>(document.addEventListener(uT,f),()=>document.removeEventListener(uT,f)),[f]),C.useEffect(()=>{if(d.trigger){const p=y=>{const v=y.target;v!=null&&v.contains(d.trigger)&&f()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[d.trigger,f]),o.jsx(ec,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:p=>p.preventDefault(),onDismiss:f,children:o.jsxs(eg,{"data-state":d.stateAttribute,...u,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[o.jsx(SU,{children:n}),o.jsx(bU,{scope:r,isInside:!0,children:o.jsx(BF,{id:d.contentId,role:"tooltip",children:s||n})})]})})});YL.displayName=Ru;var XL="TooltipArrow",TU=C.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=Ab(r);return EU(XL,r).isInside?null:o.jsx(tg,{...s,...n,ref:e})});TU.displayName=XL;function CU(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function AU(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function NU(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function IU(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const l=e[i],d=e[a],u=l.x,f=l.y,p=d.x,y=d.y;f>n!=y>n&&r<(p-u)*(n-f)/(y-f)+u&&(s=!s)}return s}function RU(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),_U(e)}function _U(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const i=e[e.length-1],a=e[e.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],a=r[r.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var LU=WL,QL=YL;const PU=LU,DU=C.forwardRef(({className:t,sideOffset:e=4,...r},n)=>o.jsx(QL,{ref:n,sideOffset:e,className:Ye("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));DU.displayName=QL.displayName;var sg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ig=typeof window>"u"||"Deno"in globalThis;function xi(){}function kU(t,e){return typeof t=="function"?t(e):t}function jU(t){return typeof t=="number"&&t>=0&&t!==1/0}function MU(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Gy(t,e){return typeof t=="function"?t(e):t}function OU(t,e){return typeof t=="function"?t(e):t}function dT(t,e){const{type:r="all",exact:n,fetchStatus:s,predicate:i,queryKey:a,stale:l}=t;if(a){if(n){if(e.queryHash!==Nb(a,e.options))return!1}else if(!Rh(e.queryKey,a))return!1}if(r!=="all"){const d=e.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||s&&s!==e.state.fetchStatus||i&&!i(e))}function hT(t,e){const{exact:r,status:n,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(r){if(Ih(e.options.mutationKey)!==Ih(i))return!1}else if(!Rh(e.options.mutationKey,i))return!1}return!(n&&e.state.status!==n||s&&!s(e))}function Nb(t,e){return((e==null?void 0:e.queryKeyHashFn)||Ih)(t)}function Ih(t){return JSON.stringify(t,(e,r)=>Hy(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Rh(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>Rh(t[r],e[r])):!1}function ZL(t,e){if(t===e)return t;const r=fT(t)&&fT(e);if(r||Hy(t)&&Hy(e)){const n=r?t:Object.keys(t),s=n.length,i=r?e:Object.keys(e),a=i.length,l=r?[]:{},d=new Set(n);let u=0;for(let f=0;f<a;f++){const p=r?f:i[f];(!r&&d.has(p)||r)&&t[p]===void 0&&e[p]===void 0?(l[p]=void 0,u++):(l[p]=ZL(t[p],e[p]),l[p]===t[p]&&t[p]!==void 0&&u++)}return s===a&&u===s?t:l}return e}function fT(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Hy(t){if(!mT(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!mT(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function mT(t){return Object.prototype.toString.call(t)==="[object Object]"}function FU(t){return new Promise(e=>{setTimeout(e,t)})}function BU(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?ZL(t,e):e}function UU(t,e,r=0){const n=[...t,e];return r&&n.length>r?n.slice(1):n}function $U(t,e,r=0){const n=[e,...t];return r&&n.length>r?n.slice(0,-1):n}var Ib=Symbol();function JL(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Ib?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var vl,oo,hu,tI,VU=(tI=class extends sg{constructor(){super();St(this,vl);St(this,oo);St(this,hu);lt(this,hu,e=>{if(!ig&&window.addEventListener){const r=()=>e();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){me(this,oo)||this.setEventListener(me(this,hu))}onUnsubscribe(){var e;this.hasListeners()||((e=me(this,oo))==null||e.call(this),lt(this,oo,void 0))}setEventListener(e){var r;lt(this,hu,e),(r=me(this,oo))==null||r.call(this),lt(this,oo,e(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(e){me(this,vl)!==e&&(lt(this,vl,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(r=>{r(e)})}isFocused(){var e;return typeof me(this,vl)=="boolean"?me(this,vl):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},vl=new WeakMap,oo=new WeakMap,hu=new WeakMap,tI),eP=new VU,fu,lo,mu,rI,GU=(rI=class extends sg{constructor(){super();St(this,fu,!0);St(this,lo);St(this,mu);lt(this,mu,e=>{if(!ig&&window.addEventListener){const r=()=>e(!0),n=()=>e(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){me(this,lo)||this.setEventListener(me(this,mu))}onUnsubscribe(){var e;this.hasListeners()||((e=me(this,lo))==null||e.call(this),lt(this,lo,void 0))}setEventListener(e){var r;lt(this,mu,e),(r=me(this,lo))==null||r.call(this),lt(this,lo,e(this.setOnline.bind(this)))}setOnline(e){me(this,fu)!==e&&(lt(this,fu,e),this.listeners.forEach(n=>{n(e)}))}isOnline(){return me(this,fu)}},fu=new WeakMap,lo=new WeakMap,mu=new WeakMap,rI),G0=new GU;function HU(){let t,e;const r=new Promise((s,i)=>{t=s,e=i});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),t(s)},r.reject=s=>{n({status:"rejected",reason:s}),e(s)},r}function zU(t){return Math.min(1e3*2**t,3e4)}function tP(t){return(t??"online")==="online"?G0.isOnline():!0}var rP=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function jx(t){return t instanceof rP}function nP(t){let e=!1,r=0,n=!1,s;const i=HU(),a=b=>{var T;n||(y(new rP(b)),(T=t.abort)==null||T.call(t))},l=()=>{e=!0},d=()=>{e=!1},u=()=>eP.isFocused()&&(t.networkMode==="always"||G0.isOnline())&&t.canRun(),f=()=>tP(t.networkMode)&&t.canRun(),p=b=>{var T;n||(n=!0,(T=t.onSuccess)==null||T.call(t,b),s==null||s(),i.resolve(b))},y=b=>{var T;n||(n=!0,(T=t.onError)==null||T.call(t,b),s==null||s(),i.reject(b))},v=()=>new Promise(b=>{var T;s=I=>{(n||u())&&b(I)},(T=t.onPause)==null||T.call(t)}).then(()=>{var b;s=void 0,n||(b=t.onContinue)==null||b.call(t)}),E=()=>{if(n)return;let b;const T=r===0?t.initialPromise:void 0;try{b=T??t.fn()}catch(I){b=Promise.reject(I)}Promise.resolve(b).then(p).catch(I=>{var k;if(n)return;const N=t.retry??(ig?0:3),A=t.retryDelay??zU,L=typeof A=="function"?A(r,I):A,P=N===!0||typeof N=="number"&&r<N||typeof N=="function"&&N(r,I);if(e||!P){y(I);return}r++,(k=t.onFail)==null||k.call(t,r,I),FU(L).then(()=>u()?void 0:v()).then(()=>{e?y(I):E()})})};return{promise:i,cancel:a,continue:()=>(s==null||s(),i),cancelRetry:l,continueRetry:d,canStart:f,start:()=>(f()?E():v().then(E),i)}}var WU=t=>setTimeout(t,0);function KU(){let t=[],e=0,r=l=>{l()},n=l=>{l()},s=WU;const i=l=>{e?t.push(l):s(()=>{r(l)})},a=()=>{const l=t;t=[],l.length&&s(()=>{n(()=>{l.forEach(d=>{r(d)})})})};return{batch:l=>{let d;e++;try{d=l()}finally{e--,e||a()}return d},batchCalls:l=>(...d)=>{i(()=>{l(...d)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{s=l}}}var Hn=KU(),wl,nI,sP=(nI=class{constructor(){St(this,wl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),jU(this.gcTime)&&lt(this,wl,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(ig?1/0:5*60*1e3))}clearGcTimeout(){me(this,wl)&&(clearTimeout(me(this,wl)),lt(this,wl,void 0))}},wl=new WeakMap,nI),pu,bl,zs,El,kn,Yh,Sl,yi,ga,sI,YU=(sI=class extends sP{constructor(e){super();St(this,yi);St(this,pu);St(this,bl);St(this,zs);St(this,El);St(this,kn);St(this,Yh);St(this,Sl);lt(this,Sl,!1),lt(this,Yh,e.defaultOptions),this.setOptions(e.options),this.observers=[],lt(this,El,e.client),lt(this,zs,me(this,El).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,lt(this,pu,XU(this.options)),this.state=e.state??me(this,pu),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=me(this,kn))==null?void 0:e.promise}setOptions(e){this.options={...me(this,Yh),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&me(this,zs).remove(this)}setData(e,r){const n=BU(this.state.data,e,this.options);return Ln(this,yi,ga).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(e,r){Ln(this,yi,ga).call(this,{type:"setState",state:e,setStateOptions:r})}cancel(e){var n,s;const r=(n=me(this,kn))==null?void 0:n.promise;return(s=me(this,kn))==null||s.cancel(e),r?r.then(xi).catch(xi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(me(this,pu))}isActive(){return this.observers.some(e=>OU(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ib||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Gy(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!MU(this.state.dataUpdatedAt,e)}onFocus(){var r;const e=this.observers.find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(r=me(this,kn))==null||r.continue()}onOnline(){var r;const e=this.observers.find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(r=me(this,kn))==null||r.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),me(this,zs).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(r=>r!==e),this.observers.length||(me(this,kn)&&(me(this,Sl)?me(this,kn).cancel({revert:!0}):me(this,kn).cancelRetry()),this.scheduleGc()),me(this,zs).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ln(this,yi,ga).call(this,{type:"invalidate"})}fetch(e,r){var u,f,p;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(me(this,kn))return me(this,kn).continueRetry(),me(this,kn).promise}if(e&&this.setOptions(e),!this.options.queryFn){const y=this.observers.find(v=>v.options.queryFn);y&&this.setOptions(y.options)}const n=new AbortController,s=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(lt(this,Sl,!0),n.signal)})},i=()=>{const y=JL(this.options,r),E=(()=>{const b={client:me(this,El),queryKey:this.queryKey,meta:this.meta};return s(b),b})();return lt(this,Sl,!1),this.options.persister?this.options.persister(y,E,this):y(E)},l=(()=>{const y={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:me(this,El),state:this.state,fetchFn:i};return s(y),y})();(u=this.options.behavior)==null||u.onFetch(l,this),lt(this,bl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&Ln(this,yi,ga).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta});const d=y=>{var v,E,b,T;jx(y)&&y.silent||Ln(this,yi,ga).call(this,{type:"error",error:y}),jx(y)||((E=(v=me(this,zs).config).onError)==null||E.call(v,y,this),(T=(b=me(this,zs).config).onSettled)==null||T.call(b,this.state.data,y,this)),this.scheduleGc()};return lt(this,kn,nP({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:y=>{var v,E,b,T;if(y===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(y)}catch(I){d(I);return}(E=(v=me(this,zs).config).onSuccess)==null||E.call(v,y,this),(T=(b=me(this,zs).config).onSettled)==null||T.call(b,y,this.state.error,this),this.scheduleGc()},onError:d,onFail:(y,v)=>{Ln(this,yi,ga).call(this,{type:"failed",failureCount:y,error:v})},onPause:()=>{Ln(this,yi,ga).call(this,{type:"pause"})},onContinue:()=>{Ln(this,yi,ga).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),me(this,kn).start()}},pu=new WeakMap,bl=new WeakMap,zs=new WeakMap,El=new WeakMap,kn=new WeakMap,Yh=new WeakMap,Sl=new WeakMap,yi=new WeakSet,ga=function(e){const r=n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...qU(n.data,this.options),fetchMeta:e.meta??null};case"success":return lt(this,bl,void 0),{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=e.error;return jx(s)&&s.revert&&me(this,bl)?{...me(this,bl),fetchStatus:"idle"}:{...n,error:s,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}};this.state=r(this.state),Hn.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),me(this,zs).notify({query:this,type:"updated",action:e})})},sI);function qU(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:tP(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function XU(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,n=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Gi,iI,QU=(iI=class extends sg{constructor(e={}){super();St(this,Gi);this.config=e,lt(this,Gi,new Map)}build(e,r,n){const s=r.queryKey,i=r.queryHash??Nb(s,r);let a=this.get(i);return a||(a=new YU({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(r),state:n,defaultOptions:e.getQueryDefaults(s)}),this.add(a)),a}add(e){me(this,Gi).has(e.queryHash)||(me(this,Gi).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const r=me(this,Gi).get(e.queryHash);r&&(e.destroy(),r===e&&me(this,Gi).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Hn.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return me(this,Gi).get(e)}getAll(){return[...me(this,Gi).values()]}find(e){const r={exact:!0,...e};return this.getAll().find(n=>dT(r,n))}findAll(e={}){const r=this.getAll();return Object.keys(e).length>0?r.filter(n=>dT(e,n)):r}notify(e){Hn.batch(()=>{this.listeners.forEach(r=>{r(e)})})}onFocus(){Hn.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Hn.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Gi=new WeakMap,iI),Hi,$n,Tl,zi,Za,aI,ZU=(aI=class extends sP{constructor(e){super();St(this,zi);St(this,Hi);St(this,$n);St(this,Tl);this.mutationId=e.mutationId,lt(this,$n,e.mutationCache),lt(this,Hi,[]),this.state=e.state||JU(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){me(this,Hi).includes(e)||(me(this,Hi).push(e),this.clearGcTimeout(),me(this,$n).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){lt(this,Hi,me(this,Hi).filter(r=>r!==e)),this.scheduleGc(),me(this,$n).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){me(this,Hi).length||(this.state.status==="pending"?this.scheduleGc():me(this,$n).remove(this))}continue(){var e;return((e=me(this,Tl))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var i,a,l,d,u,f,p,y,v,E,b,T,I,N,A,L,P,k,D,O;const r=()=>{Ln(this,zi,Za).call(this,{type:"continue"})};lt(this,Tl,nP({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(F,$)=>{Ln(this,zi,Za).call(this,{type:"failed",failureCount:F,error:$})},onPause:()=>{Ln(this,zi,Za).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>me(this,$n).canRun(this)}));const n=this.state.status==="pending",s=!me(this,Tl).canStart();try{if(n)r();else{Ln(this,zi,Za).call(this,{type:"pending",variables:e,isPaused:s}),await((a=(i=me(this,$n).config).onMutate)==null?void 0:a.call(i,e,this));const $=await((d=(l=this.options).onMutate)==null?void 0:d.call(l,e));$!==this.state.context&&Ln(this,zi,Za).call(this,{type:"pending",context:$,variables:e,isPaused:s})}const F=await me(this,Tl).start();return await((f=(u=me(this,$n).config).onSuccess)==null?void 0:f.call(u,F,e,this.state.context,this)),await((y=(p=this.options).onSuccess)==null?void 0:y.call(p,F,e,this.state.context)),await((E=(v=me(this,$n).config).onSettled)==null?void 0:E.call(v,F,null,this.state.variables,this.state.context,this)),await((T=(b=this.options).onSettled)==null?void 0:T.call(b,F,null,e,this.state.context)),Ln(this,zi,Za).call(this,{type:"success",data:F}),F}catch(F){try{throw await((N=(I=me(this,$n).config).onError)==null?void 0:N.call(I,F,e,this.state.context,this)),await((L=(A=this.options).onError)==null?void 0:L.call(A,F,e,this.state.context)),await((k=(P=me(this,$n).config).onSettled)==null?void 0:k.call(P,void 0,F,this.state.variables,this.state.context,this)),await((O=(D=this.options).onSettled)==null?void 0:O.call(D,void 0,F,e,this.state.context)),F}finally{Ln(this,zi,Za).call(this,{type:"error",error:F})}}finally{me(this,$n).runNext(this)}}},Hi=new WeakMap,$n=new WeakMap,Tl=new WeakMap,zi=new WeakSet,Za=function(e){const r=n=>{switch(e.type){case"failed":return{...n,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...n,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:e.error,failureCount:n.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Hn.batch(()=>{me(this,Hi).forEach(n=>{n.onMutationUpdate(e)}),me(this,$n).notify({mutation:this,type:"updated",action:e})})},aI);function JU(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Ea,vi,qh,oI,e$=(oI=class extends sg{constructor(e={}){super();St(this,Ea);St(this,vi);St(this,qh);this.config=e,lt(this,Ea,new Set),lt(this,vi,new Map),lt(this,qh,0)}build(e,r,n){const s=new ZU({mutationCache:this,mutationId:++Ff(this,qh)._,options:e.defaultMutationOptions(r),state:n});return this.add(s),s}add(e){me(this,Ea).add(e);const r=am(e);if(typeof r=="string"){const n=me(this,vi).get(r);n?n.push(e):me(this,vi).set(r,[e])}this.notify({type:"added",mutation:e})}remove(e){if(me(this,Ea).delete(e)){const r=am(e);if(typeof r=="string"){const n=me(this,vi).get(r);if(n)if(n.length>1){const s=n.indexOf(e);s!==-1&&n.splice(s,1)}else n[0]===e&&me(this,vi).delete(r)}}this.notify({type:"removed",mutation:e})}canRun(e){const r=am(e);if(typeof r=="string"){const n=me(this,vi).get(r),s=n==null?void 0:n.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var n;const r=am(e);if(typeof r=="string"){const s=(n=me(this,vi).get(r))==null?void 0:n.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Hn.batch(()=>{me(this,Ea).forEach(e=>{this.notify({type:"removed",mutation:e})}),me(this,Ea).clear(),me(this,vi).clear()})}getAll(){return Array.from(me(this,Ea))}find(e){const r={exact:!0,...e};return this.getAll().find(n=>hT(r,n))}findAll(e={}){return this.getAll().filter(r=>hT(e,r))}notify(e){Hn.batch(()=>{this.listeners.forEach(r=>{r(e)})})}resumePausedMutations(){const e=this.getAll().filter(r=>r.state.isPaused);return Hn.batch(()=>Promise.all(e.map(r=>r.continue().catch(xi))))}},Ea=new WeakMap,vi=new WeakMap,qh=new WeakMap,oI);function am(t){var e;return(e=t.options.scope)==null?void 0:e.id}function pT(t){return{onFetch:(e,r)=>{var f,p,y,v,E;const n=e.options,s=(y=(p=(f=e.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:y.direction,i=((v=e.state.data)==null?void 0:v.pages)||[],a=((E=e.state.data)==null?void 0:E.pageParams)||[];let l={pages:[],pageParams:[]},d=0;const u=async()=>{let b=!1;const T=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>(e.signal.aborted?b=!0:e.signal.addEventListener("abort",()=>{b=!0}),e.signal)})},I=JL(e.options,e.fetchOptions),N=async(A,L,P)=>{if(b)return Promise.reject();if(L==null&&A.pages.length)return Promise.resolve(A);const D=(()=>{const G={client:e.client,queryKey:e.queryKey,pageParam:L,direction:P?"backward":"forward",meta:e.options.meta};return T(G),G})(),O=await I(D),{maxPages:F}=e.options,$=P?$U:UU;return{pages:$(A.pages,O,F),pageParams:$(A.pageParams,L,F)}};if(s&&i.length){const A=s==="backward",L=A?t$:gT,P={pages:i,pageParams:a},k=L(n,P);l=await N(P,k,A)}else{const A=t??i.length;do{const L=d===0?a[0]??n.initialPageParam:gT(n,l);if(d>0&&L==null)break;l=await N(l,L),d++}while(d<A)}return l};e.options.persister?e.fetchFn=()=>{var b,T;return(T=(b=e.options).persister)==null?void 0:T.call(b,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r)}:e.fetchFn=u}}}function gT(t,{pages:e,pageParams:r}){const n=e.length-1;return e.length>0?t.getNextPageParam(e[n],e,r[n],r):void 0}function t$(t,{pages:e,pageParams:r}){var n;return e.length>0?(n=t.getPreviousPageParam)==null?void 0:n.call(t,e[0],e,r[0],r):void 0}var Tr,co,uo,gu,xu,ho,yu,vu,lI,r$=(lI=class{constructor(t={}){St(this,Tr);St(this,co);St(this,uo);St(this,gu);St(this,xu);St(this,ho);St(this,yu);St(this,vu);lt(this,Tr,t.queryCache||new QU),lt(this,co,t.mutationCache||new e$),lt(this,uo,t.defaultOptions||{}),lt(this,gu,new Map),lt(this,xu,new Map),lt(this,ho,0)}mount(){Ff(this,ho)._++,me(this,ho)===1&&(lt(this,yu,eP.subscribe(async t=>{t&&(await this.resumePausedMutations(),me(this,Tr).onFocus())})),lt(this,vu,G0.subscribe(async t=>{t&&(await this.resumePausedMutations(),me(this,Tr).onOnline())})))}unmount(){var t,e;Ff(this,ho)._--,me(this,ho)===0&&((t=me(this,yu))==null||t.call(this),lt(this,yu,void 0),(e=me(this,vu))==null||e.call(this),lt(this,vu,void 0))}isFetching(t){return me(this,Tr).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return me(this,co).findAll({...t,status:"pending"}).length}getQueryData(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=me(this,Tr).get(e.queryHash))==null?void 0:r.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=me(this,Tr).build(this,e),n=r.state.data;return n===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Gy(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(t){return me(this,Tr).findAll(t).map(({queryKey:e,state:r})=>{const n=r.data;return[e,n]})}setQueryData(t,e,r){const n=this.defaultQueryOptions({queryKey:t}),s=me(this,Tr).get(n.queryHash),i=s==null?void 0:s.state.data,a=kU(e,i);if(a!==void 0)return me(this,Tr).build(this,n).setData(a,{...r,manual:!0})}setQueriesData(t,e,r){return Hn.batch(()=>me(this,Tr).findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,r)]))}getQueryState(t){var r;const e=this.defaultQueryOptions({queryKey:t});return(r=me(this,Tr).get(e.queryHash))==null?void 0:r.state}removeQueries(t){const e=me(this,Tr);Hn.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=me(this,Tr);return Hn.batch(()=>(r.findAll(t).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},n=Hn.batch(()=>me(this,Tr).findAll(t).map(s=>s.cancel(r)));return Promise.all(n).then(xi).catch(xi)}invalidateQueries(t,e={}){return Hn.batch(()=>(me(this,Tr).findAll(t).forEach(r=>{r.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},n=Hn.batch(()=>me(this,Tr).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,r);return r.throwOnError||(i=i.catch(xi)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(xi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=me(this,Tr).build(this,e);return r.isStaleByTime(Gy(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(xi).catch(xi)}fetchInfiniteQuery(t){return t.behavior=pT(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(xi).catch(xi)}ensureInfiniteQueryData(t){return t.behavior=pT(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return G0.isOnline()?me(this,co).resumePausedMutations():Promise.resolve()}getQueryCache(){return me(this,Tr)}getMutationCache(){return me(this,co)}getDefaultOptions(){return me(this,uo)}setDefaultOptions(t){lt(this,uo,t)}setQueryDefaults(t,e){me(this,gu).set(Ih(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...me(this,gu).values()],r={};return e.forEach(n=>{Rh(t,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(t,e){me(this,xu).set(Ih(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...me(this,xu).values()],r={};return e.forEach(n=>{Rh(t,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...me(this,uo).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Nb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ib&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...me(this,uo).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){me(this,Tr).clear(),me(this,co).clear()}},Tr=new WeakMap,co=new WeakMap,uo=new WeakMap,gu=new WeakMap,xu=new WeakMap,ho=new WeakMap,yu=new WeakMap,vu=new WeakMap,lI),n$=C.createContext(void 0),s$=({client:t,children:e})=>(C.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),o.jsx(n$.Provider,{value:t,children:e}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _h(){return _h=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},_h.apply(this,arguments)}var go;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(go||(go={}));const xT="popstate";function i$(t){t===void 0&&(t={});function e(n,s){let{pathname:i,search:a,hash:l}=n.location;return zy("",{pathname:i,search:a,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:H0(s)}return o$(e,r,null,t)}function Fr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function iP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function a$(){return Math.random().toString(36).substr(2,8)}function yT(t,e){return{usr:t.state,key:t.key,idx:e}}function zy(t,e,r,n){return r===void 0&&(r=null),_h({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Yu(e):e,{state:r,key:e&&e.key||n||a$()})}function H0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Yu(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function o$(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:i=!1}=n,a=s.history,l=go.Pop,d=null,u=f();u==null&&(u=0,a.replaceState(_h({},a.state,{idx:u}),""));function f(){return(a.state||{idx:null}).idx}function p(){l=go.Pop;let T=f(),I=T==null?null:T-u;u=T,d&&d({action:l,location:b.location,delta:I})}function y(T,I){l=go.Push;let N=zy(b.location,T,I);u=f()+1;let A=yT(N,u),L=b.createHref(N);try{a.pushState(A,"",L)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;s.location.assign(L)}i&&d&&d({action:l,location:b.location,delta:1})}function v(T,I){l=go.Replace;let N=zy(b.location,T,I);u=f();let A=yT(N,u),L=b.createHref(N);a.replaceState(A,"",L),i&&d&&d({action:l,location:b.location,delta:0})}function E(T){let I=s.location.origin!=="null"?s.location.origin:s.location.href,N=typeof T=="string"?T:H0(T);return N=N.replace(/ $/,"%20"),Fr(I,"No window.location.(origin|href) available to create URL for href: "+N),new URL(N,I)}let b={get action(){return l},get location(){return t(s,a)},listen(T){if(d)throw new Error("A history only accepts one active listener");return s.addEventListener(xT,p),d=T,()=>{s.removeEventListener(xT,p),d=null}},createHref(T){return e(s,T)},createURL:E,encodeLocation(T){let I=E(T);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:y,replace:v,go(T){return a.go(T)}};return b}var vT;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(vT||(vT={}));function l$(t,e,r){return r===void 0&&(r="/"),c$(t,e,r,!1)}function c$(t,e,r,n){let s=typeof e=="string"?Yu(e):e,i=Rb(s.pathname||"/",r);if(i==null)return null;let a=aP(t);u$(a);let l=null;for(let d=0;l==null&&d<a.length;++d){let u=b$(i);l=v$(a[d],u,n)}return l}function aP(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(i,a,l)=>{let d={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};d.relativePath.startsWith("/")&&(Fr(d.relativePath.startsWith(n),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(n.length));let u=Co([n,d.relativePath]),f=r.concat(d);i.children&&i.children.length>0&&(Fr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),aP(i.children,e,f,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:x$(u,i.index),routesMeta:f})};return t.forEach((i,a)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,a);else for(let d of oP(i.path))s(i,a,d)}),e}function oP(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),i=r.replace(/\?$/,"");if(n.length===0)return s?[i,""]:[i];let a=oP(n.join("/")),l=[];return l.push(...a.map(d=>d===""?i:[i,d].join("/"))),s&&l.push(...a),l.map(d=>t.startsWith("/")&&d===""?"/":d)}function u$(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:y$(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const d$=/^:[\w-]+$/,h$=3,f$=2,m$=1,p$=10,g$=-2,wT=t=>t==="*";function x$(t,e){let r=t.split("/"),n=r.length;return r.some(wT)&&(n+=g$),e&&(n+=f$),r.filter(s=>!wT(s)).reduce((s,i)=>s+(d$.test(i)?h$:i===""?m$:p$),n)}function y$(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function v$(t,e,r){let{routesMeta:n}=t,s={},i="/",a=[];for(let l=0;l<n.length;++l){let d=n[l],u=l===n.length-1,f=i==="/"?e:e.slice(i.length)||"/",p=bT({path:d.relativePath,caseSensitive:d.caseSensitive,end:u},f),y=d.route;if(!p&&u&&r&&!n[n.length-1].route.index&&(p=bT({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},f)),!p)return null;Object.assign(s,p.params),a.push({params:s,pathname:Co([i,p.pathname]),pathnameBase:C$(Co([i,p.pathnameBase])),route:y}),p.pathnameBase!=="/"&&(i=Co([i,p.pathnameBase]))}return a}function bT(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=w$(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,f,p)=>{let{paramName:y,isOptional:v}=f;if(y==="*"){let b=l[p]||"";a=i.slice(0,i.length-b.length).replace(/(.)\/+$/,"$1")}const E=l[p];return v&&!E?u[y]=void 0:u[y]=(E||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:a,pattern:t}}function w$(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),iP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,l,d)=>(n.push({paramName:l,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function b$(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return iP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Rb(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function E$(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Yu(t):t;return{pathname:r?r.startsWith("/")?r:S$(r,e):e,search:A$(n),hash:N$(s)}}function S$(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Mx(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function T$(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function _b(t,e){let r=T$(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Lb(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Yu(t):(s=_h({},t),Fr(!s.pathname||!s.pathname.includes("?"),Mx("?","pathname","search",s)),Fr(!s.pathname||!s.pathname.includes("#"),Mx("#","pathname","hash",s)),Fr(!s.search||!s.search.includes("#"),Mx("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,l;if(a==null)l=r;else{let p=e.length-1;if(!n&&a.startsWith("..")){let y=a.split("/");for(;y[0]==="..";)y.shift(),p-=1;s.pathname=y.join("/")}l=p>=0?e[p]:"/"}let d=E$(s,l),u=a&&a!=="/"&&a.endsWith("/"),f=(i||a===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(u||f)&&(d.pathname+="/"),d}const Co=t=>t.join("/").replace(/\/\/+/g,"/"),C$=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),A$=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,N$=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function I$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const lP=["post","put","patch","delete"];new Set(lP);const R$=["get",...lP];new Set(R$);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Lh(){return Lh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Lh.apply(this,arguments)}const Pb=C.createContext(null),_$=C.createContext(null),Wo=C.createContext(null),ag=C.createContext(null),Ko=C.createContext({outlet:null,matches:[],isDataRoute:!1}),cP=C.createContext(null);function L$(t,e){let{relative:r}=e===void 0?{}:e;qu()||Fr(!1);let{basename:n,navigator:s}=C.useContext(Wo),{hash:i,pathname:a,search:l}=dP(t,{relative:r}),d=a;return n!=="/"&&(d=a==="/"?n:Co([n,a])),s.createHref({pathname:d,search:l,hash:i})}function qu(){return C.useContext(ag)!=null}function Ba(){return qu()||Fr(!1),C.useContext(ag).location}function uP(t){C.useContext(Wo).static||C.useLayoutEffect(t)}function ni(){let{isDataRoute:t}=C.useContext(Ko);return t?H$():P$()}function P$(){qu()||Fr(!1);let t=C.useContext(Pb),{basename:e,future:r,navigator:n}=C.useContext(Wo),{matches:s}=C.useContext(Ko),{pathname:i}=Ba(),a=JSON.stringify(_b(s,r.v7_relativeSplatPath)),l=C.useRef(!1);return uP(()=>{l.current=!0}),C.useCallback(function(u,f){if(f===void 0&&(f={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let p=Lb(u,JSON.parse(a),i,f.relative==="path");t==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:Co([e,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[e,n,a,i,t])}function dP(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=C.useContext(Wo),{matches:s}=C.useContext(Ko),{pathname:i}=Ba(),a=JSON.stringify(_b(s,n.v7_relativeSplatPath));return C.useMemo(()=>Lb(t,JSON.parse(a),i,r==="path"),[t,a,i,r])}function D$(t,e){return k$(t,e)}function k$(t,e,r,n){qu()||Fr(!1);let{navigator:s}=C.useContext(Wo),{matches:i}=C.useContext(Ko),a=i[i.length-1],l=a?a.params:{};a&&a.pathname;let d=a?a.pathnameBase:"/";a&&a.route;let u=Ba(),f;if(e){var p;let T=typeof e=="string"?Yu(e):e;d==="/"||(p=T.pathname)!=null&&p.startsWith(d)||Fr(!1),f=T}else f=u;let y=f.pathname||"/",v=y;if(d!=="/"){let T=d.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let E=l$(t,{pathname:v}),b=B$(E&&E.map(T=>Object.assign({},T,{params:Object.assign({},l,T.params),pathname:Co([d,s.encodeLocation?s.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?d:Co([d,s.encodeLocation?s.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),i,r,n);return e&&b?C.createElement(ag.Provider,{value:{location:Lh({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:go.Pop}},b):b}function j$(){let t=G$(),e=I$(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),r?C.createElement("pre",{style:s},r):null,null)}const M$=C.createElement(j$,null);class O$ extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?C.createElement(Ko.Provider,{value:this.props.routeContext},C.createElement(cP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function F$(t){let{routeContext:e,match:r,children:n}=t,s=C.useContext(Pb);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(Ko.Provider,{value:e},n)}function B$(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var i;if(!r)return null;if(r.errors)t=r.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let f=a.findIndex(p=>p.route.id&&(l==null?void 0:l[p.route.id])!==void 0);f>=0||Fr(!1),a=a.slice(0,Math.min(a.length,f+1))}let d=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<a.length;f++){let p=a[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=f),p.route.id){let{loaderData:y,errors:v}=r,E=p.route.loader&&y[p.route.id]===void 0&&(!v||v[p.route.id]===void 0);if(p.route.lazy||E){d=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((f,p,y)=>{let v,E=!1,b=null,T=null;r&&(v=l&&p.route.id?l[p.route.id]:void 0,b=p.route.errorElement||M$,d&&(u<0&&y===0?(E=!0,T=null):u===y&&(E=!0,T=p.route.hydrateFallbackElement||null)));let I=e.concat(a.slice(0,y+1)),N=()=>{let A;return v?A=b:E?A=T:p.route.Component?A=C.createElement(p.route.Component,null):p.route.element?A=p.route.element:A=f,C.createElement(F$,{match:p,routeContext:{outlet:f,matches:I,isDataRoute:r!=null},children:A})};return r&&(p.route.ErrorBoundary||p.route.errorElement||y===0)?C.createElement(O$,{location:r.location,revalidation:r.revalidation,component:b,error:v,children:N(),routeContext:{outlet:null,matches:I,isDataRoute:!0}}):N()},null)}var hP=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(hP||{}),z0=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(z0||{});function U$(t){let e=C.useContext(Pb);return e||Fr(!1),e}function $$(t){let e=C.useContext(_$);return e||Fr(!1),e}function V$(t){let e=C.useContext(Ko);return e||Fr(!1),e}function fP(t){let e=V$(),r=e.matches[e.matches.length-1];return r.route.id||Fr(!1),r.route.id}function G$(){var t;let e=C.useContext(cP),r=$$(z0.UseRouteError),n=fP(z0.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function H$(){let{router:t}=U$(hP.UseNavigateStable),e=fP(z0.UseNavigateStable),r=C.useRef(!1);return uP(()=>{r.current=!0}),C.useCallback(function(s,i){i===void 0&&(i={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Lh({fromRouteId:e},i)))},[t,e])}function z$(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Nd(t){let{to:e,replace:r,state:n,relative:s}=t;qu()||Fr(!1);let{future:i,static:a}=C.useContext(Wo),{matches:l}=C.useContext(Ko),{pathname:d}=Ba(),u=ni(),f=Lb(e,_b(l,i.v7_relativeSplatPath),d,s==="path"),p=JSON.stringify(f);return C.useEffect(()=>u(JSON.parse(p),{replace:r,state:n,relative:s}),[u,p,s,r,n]),null}function $r(t){Fr(!1)}function W$(t){let{basename:e="/",children:r=null,location:n,navigationType:s=go.Pop,navigator:i,static:a=!1,future:l}=t;qu()&&Fr(!1);let d=e.replace(/^\/*/,"/"),u=C.useMemo(()=>({basename:d,navigator:i,static:a,future:Lh({v7_relativeSplatPath:!1},l)}),[d,l,i,a]);typeof n=="string"&&(n=Yu(n));let{pathname:f="/",search:p="",hash:y="",state:v=null,key:E="default"}=n,b=C.useMemo(()=>{let T=Rb(f,d);return T==null?null:{location:{pathname:T,search:p,hash:y,state:v,key:E},navigationType:s}},[d,f,p,y,v,E,s]);return b==null?null:C.createElement(Wo.Provider,{value:u},C.createElement(ag.Provider,{children:r,value:b}))}function K$(t){let{children:e,location:r}=t;return D$(Wy(e),r)}new Promise(()=>{});function Wy(t,e){e===void 0&&(e=[]);let r=[];return C.Children.forEach(t,(n,s)=>{if(!C.isValidElement(n))return;let i=[...e,s];if(n.type===C.Fragment){r.push.apply(r,Wy(n.props.children,i));return}n.type!==$r&&Fr(!1),!n.props.index||!n.props.children||Fr(!1);let a={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=Wy(n.props.children,i)),r.push(a)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ky(){return Ky=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ky.apply(this,arguments)}function Y$(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function q$(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function X$(t,e){return t.button===0&&(!e||e==="_self")&&!q$(t)}function Yy(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,r)=>{let n=t[r];return e.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function Q$(t,e){let r=Yy(t);return e&&e.forEach((n,s)=>{r.has(s)||e.getAll(s).forEach(i=>{r.append(s,i)})}),r}const Z$=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],J$="6";try{window.__reactRouterVersion=J$}catch{}const eV="startTransition",ET=lw[eV];function tV(t){let{basename:e,children:r,future:n,window:s}=t,i=C.useRef();i.current==null&&(i.current=i$({window:s,v5Compat:!0}));let a=i.current,[l,d]=C.useState({action:a.action,location:a.location}),{v7_startTransition:u}=n||{},f=C.useCallback(p=>{u&&ET?ET(()=>d(p)):d(p)},[d,u]);return C.useLayoutEffect(()=>a.listen(f),[a,f]),C.useEffect(()=>z$(n),[n]),C.createElement(W$,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:a,future:n})}const rV=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nV=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pr=C.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:i,replace:a,state:l,target:d,to:u,preventScrollReset:f,viewTransition:p}=e,y=Y$(e,Z$),{basename:v}=C.useContext(Wo),E,b=!1;if(typeof u=="string"&&nV.test(u)&&(E=u,rV))try{let A=new URL(window.location.href),L=u.startsWith("//")?new URL(A.protocol+u):new URL(u),P=Rb(L.pathname,v);L.origin===A.origin&&P!=null?u=P+L.search+L.hash:b=!0}catch{}let T=L$(u,{relative:s}),I=sV(u,{replace:a,state:l,target:d,preventScrollReset:f,relative:s,viewTransition:p});function N(A){n&&n(A),A.defaultPrevented||I(A)}return C.createElement("a",Ky({},y,{href:E||T,onClick:b||i?n:N,ref:r,target:d}))});var ST;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ST||(ST={}));var TT;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(TT||(TT={}));function sV(t,e){let{target:r,replace:n,state:s,preventScrollReset:i,relative:a,viewTransition:l}=e===void 0?{}:e,d=ni(),u=Ba(),f=dP(t,{relative:a});return C.useCallback(p=>{if(X$(p,r)){p.preventDefault();let y=n!==void 0?n:H0(u)===H0(f);d(t,{replace:y,state:s,preventScrollReset:i,relative:a,viewTransition:l})}},[u,d,f,n,s,r,t,i,a,l])}function iV(t){let e=C.useRef(Yy(t)),r=C.useRef(!1),n=Ba(),s=C.useMemo(()=>Q$(n.search,r.current?null:e.current),[n.search]),i=ni(),a=C.useCallback((l,d)=>{const u=Yy(typeof l=="function"?l(s):l);r.current=!0,i("?"+u,d)},[i,s]);return[s,a]}const mP=C.createContext(void 0);function aV({children:t}){const[e,r]=C.useState(()=>{if(typeof window<"u"){const s=localStorage.getItem("theme");return s||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}return"dark"});C.useEffect(()=>{const s=window.document.documentElement;s.classList.remove("light","dark"),s.classList.add(e),localStorage.setItem("theme",e)},[e]);const n=()=>{r(s=>s==="dark"?"light":"dark")};return o.jsx(mP.Provider,{value:{theme:e,toggleTheme:n,setTheme:r},children:t})}function pP(){const t=C.useContext(mP);if(t===void 0)throw new Error("useTheme must be used within a ThemeProvider");return t}function gP(t,e){return function(){return t.apply(e,arguments)}}const{toString:oV}=Object.prototype,{getPrototypeOf:Db}=Object,{iterator:og,toStringTag:xP}=Symbol,lg=(t=>e=>{const r=oV.call(e);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Ri=t=>(t=t.toLowerCase(),e=>lg(e)===t),cg=t=>e=>typeof e===t,{isArray:Xu}=Array,_u=cg("undefined");function ff(t){return t!==null&&!_u(t)&&t.constructor!==null&&!_u(t.constructor)&&fs(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const yP=Ri("ArrayBuffer");function lV(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&yP(t.buffer),e}const cV=cg("string"),fs=cg("function"),vP=cg("number"),mf=t=>t!==null&&typeof t=="object",uV=t=>t===!0||t===!1,Ym=t=>{if(lg(t)!=="object")return!1;const e=Db(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(xP in t)&&!(og in t)},dV=t=>{if(!mf(t)||ff(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},hV=Ri("Date"),fV=Ri("File"),mV=Ri("Blob"),pV=Ri("FileList"),gV=t=>mf(t)&&fs(t.pipe),xV=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||fs(t.append)&&((e=lg(t))==="formdata"||e==="object"&&fs(t.toString)&&t.toString()==="[object FormData]"))},yV=Ri("URLSearchParams"),[vV,wV,bV,EV]=["ReadableStream","Request","Response","Headers"].map(Ri),SV=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pf(t,e,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let n,s;if(typeof t!="object"&&(t=[t]),Xu(t))for(n=0,s=t.length;n<s;n++)e.call(null,t[n],n,t);else{if(ff(t))return;const i=r?Object.getOwnPropertyNames(t):Object.keys(t),a=i.length;let l;for(n=0;n<a;n++)l=i[n],e.call(null,t[l],l,t)}}function wP(t,e){if(ff(t))return null;e=e.toLowerCase();const r=Object.keys(t);let n=r.length,s;for(;n-- >0;)if(s=r[n],e===s.toLowerCase())return s;return null}const pl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,bP=t=>!_u(t)&&t!==pl;function qy(){const{caseless:t,skipUndefined:e}=bP(this)&&this||{},r={},n=(s,i)=>{const a=t&&wP(r,i)||i;Ym(r[a])&&Ym(s)?r[a]=qy(r[a],s):Ym(s)?r[a]=qy({},s):Xu(s)?r[a]=s.slice():(!e||!_u(s))&&(r[a]=s)};for(let s=0,i=arguments.length;s<i;s++)arguments[s]&&pf(arguments[s],n);return r}const TV=(t,e,r,{allOwnKeys:n}={})=>(pf(e,(s,i)=>{r&&fs(s)?t[i]=gP(s,r):t[i]=s},{allOwnKeys:n}),t),CV=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),AV=(t,e,r,n)=>{t.prototype=Object.create(e.prototype,n),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),r&&Object.assign(t.prototype,r)},NV=(t,e,r,n)=>{let s,i,a;const l={};if(e=e||{},t==null)return e;do{for(s=Object.getOwnPropertyNames(t),i=s.length;i-- >0;)a=s[i],(!n||n(a,t,e))&&!l[a]&&(e[a]=t[a],l[a]=!0);t=r!==!1&&Db(t)}while(t&&(!r||r(t,e))&&t!==Object.prototype);return e},IV=(t,e,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=e.length;const n=t.indexOf(e,r);return n!==-1&&n===r},RV=t=>{if(!t)return null;if(Xu(t))return t;let e=t.length;if(!vP(e))return null;const r=new Array(e);for(;e-- >0;)r[e]=t[e];return r},_V=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Db(Uint8Array)),LV=(t,e)=>{const n=(t&&t[og]).call(t);let s;for(;(s=n.next())&&!s.done;){const i=s.value;e.call(t,i[0],i[1])}},PV=(t,e)=>{let r;const n=[];for(;(r=t.exec(e))!==null;)n.push(r);return n},DV=Ri("HTMLFormElement"),kV=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),CT=(({hasOwnProperty:t})=>(e,r)=>t.call(e,r))(Object.prototype),jV=Ri("RegExp"),EP=(t,e)=>{const r=Object.getOwnPropertyDescriptors(t),n={};pf(r,(s,i)=>{let a;(a=e(s,i,t))!==!1&&(n[i]=a||s)}),Object.defineProperties(t,n)},MV=t=>{EP(t,(e,r)=>{if(fs(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=t[r];if(fs(n)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},OV=(t,e)=>{const r={},n=s=>{s.forEach(i=>{r[i]=!0})};return Xu(t)?n(t):n(String(t).split(e)),r},FV=()=>{},BV=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function UV(t){return!!(t&&fs(t.append)&&t[xP]==="FormData"&&t[og])}const $V=t=>{const e=new Array(10),r=(n,s)=>{if(mf(n)){if(e.indexOf(n)>=0)return;if(ff(n))return n;if(!("toJSON"in n)){e[s]=n;const i=Xu(n)?[]:{};return pf(n,(a,l)=>{const d=r(a,s+1);!_u(d)&&(i[l]=d)}),e[s]=void 0,i}}return n};return r(t,0)},VV=Ri("AsyncFunction"),GV=t=>t&&(mf(t)||fs(t))&&fs(t.then)&&fs(t.catch),SP=((t,e)=>t?setImmediate:e?((r,n)=>(pl.addEventListener("message",({source:s,data:i})=>{s===pl&&i===r&&n.length&&n.shift()()},!1),s=>{n.push(s),pl.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",fs(pl.postMessage)),HV=typeof queueMicrotask<"u"?queueMicrotask.bind(pl):typeof process<"u"&&process.nextTick||SP,zV=t=>t!=null&&fs(t[og]),ge={isArray:Xu,isArrayBuffer:yP,isBuffer:ff,isFormData:xV,isArrayBufferView:lV,isString:cV,isNumber:vP,isBoolean:uV,isObject:mf,isPlainObject:Ym,isEmptyObject:dV,isReadableStream:vV,isRequest:wV,isResponse:bV,isHeaders:EV,isUndefined:_u,isDate:hV,isFile:fV,isBlob:mV,isRegExp:jV,isFunction:fs,isStream:gV,isURLSearchParams:yV,isTypedArray:_V,isFileList:pV,forEach:pf,merge:qy,extend:TV,trim:SV,stripBOM:CV,inherits:AV,toFlatObject:NV,kindOf:lg,kindOfTest:Ri,endsWith:IV,toArray:RV,forEachEntry:LV,matchAll:PV,isHTMLForm:DV,hasOwnProperty:CT,hasOwnProp:CT,reduceDescriptors:EP,freezeMethods:MV,toObjectSet:OV,toCamelCase:kV,noop:FV,toFiniteNumber:BV,findKey:wP,global:pl,isContextDefined:bP,isSpecCompliantForm:UV,toJSONObject:$V,isAsyncFn:VV,isThenable:GV,setImmediate:SP,asap:HV,isIterable:zV};function pt(t,e,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}ge.inherits(pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.status}}});const TP=pt.prototype,CP={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{CP[t]={value:t}});Object.defineProperties(pt,CP);Object.defineProperty(TP,"isAxiosError",{value:!0});pt.from=(t,e,r,n,s,i)=>{const a=Object.create(TP);ge.toFlatObject(t,a,function(f){return f!==Error.prototype},u=>u!=="isAxiosError");const l=t&&t.message?t.message:"Error",d=e==null&&t?t.code:e;return pt.call(a,l,d,r,n,s),t&&a.cause==null&&Object.defineProperty(a,"cause",{value:t,configurable:!0}),a.name=t&&t.name||"Error",i&&Object.assign(a,i),a};const WV=null;function Xy(t){return ge.isPlainObject(t)||ge.isArray(t)}function AP(t){return ge.endsWith(t,"[]")?t.slice(0,-2):t}function AT(t,e,r){return t?t.concat(e).map(function(s,i){return s=AP(s),!r&&i?"["+s+"]":s}).join(r?".":""):e}function KV(t){return ge.isArray(t)&&!t.some(Xy)}const YV=ge.toFlatObject(ge,{},null,function(e){return/^is[A-Z]/.test(e)});function ug(t,e,r){if(!ge.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,r=ge.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,T){return!ge.isUndefined(T[b])});const n=r.metaTokens,s=r.visitor||f,i=r.dots,a=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(e);if(!ge.isFunction(s))throw new TypeError("visitor must be a function");function u(E){if(E===null)return"";if(ge.isDate(E))return E.toISOString();if(ge.isBoolean(E))return E.toString();if(!d&&ge.isBlob(E))throw new pt("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(E)||ge.isTypedArray(E)?d&&typeof Blob=="function"?new Blob([E]):Buffer.from(E):E}function f(E,b,T){let I=E;if(E&&!T&&typeof E=="object"){if(ge.endsWith(b,"{}"))b=n?b:b.slice(0,-2),E=JSON.stringify(E);else if(ge.isArray(E)&&KV(E)||(ge.isFileList(E)||ge.endsWith(b,"[]"))&&(I=ge.toArray(E)))return b=AP(b),I.forEach(function(A,L){!(ge.isUndefined(A)||A===null)&&e.append(a===!0?AT([b],L,i):a===null?b:b+"[]",u(A))}),!1}return Xy(E)?!0:(e.append(AT(T,b,i),u(E)),!1)}const p=[],y=Object.assign(YV,{defaultVisitor:f,convertValue:u,isVisitable:Xy});function v(E,b){if(!ge.isUndefined(E)){if(p.indexOf(E)!==-1)throw Error("Circular reference detected in "+b.join("."));p.push(E),ge.forEach(E,function(I,N){(!(ge.isUndefined(I)||I===null)&&s.call(e,I,ge.isString(N)?N.trim():N,b,y))===!0&&v(I,b?b.concat(N):[N])}),p.pop()}}if(!ge.isObject(t))throw new TypeError("data must be an object");return v(t),e}function NT(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(n){return e[n]})}function kb(t,e){this._pairs=[],t&&ug(t,this,e)}const NP=kb.prototype;NP.append=function(e,r){this._pairs.push([e,r])};NP.toString=function(e){const r=e?function(n){return e.call(this,n,NT)}:NT;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function qV(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function IP(t,e,r){if(!e)return t;const n=r&&r.encode||qV;ge.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let i;if(s?i=s(e,r):i=ge.isURLSearchParams(e)?e.toString():new kb(e,r).toString(n),i){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+i}return t}class IT{constructor(){this.handlers=[]}use(e,r,n){return this.handlers.push({fulfilled:e,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){ge.forEach(this.handlers,function(n){n!==null&&e(n)})}}const RP={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},XV=typeof URLSearchParams<"u"?URLSearchParams:kb,QV=typeof FormData<"u"?FormData:null,ZV=typeof Blob<"u"?Blob:null,JV={isBrowser:!0,classes:{URLSearchParams:XV,FormData:QV,Blob:ZV},protocols:["http","https","file","blob","url","data"]},jb=typeof window<"u"&&typeof document<"u",Qy=typeof navigator=="object"&&navigator||void 0,eG=jb&&(!Qy||["ReactNative","NativeScript","NS"].indexOf(Qy.product)<0),tG=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",rG=jb&&window.location.href||"http://localhost",nG=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:jb,hasStandardBrowserEnv:eG,hasStandardBrowserWebWorkerEnv:tG,navigator:Qy,origin:rG},Symbol.toStringTag,{value:"Module"})),Mn={...nG,...JV};function sG(t,e){return ug(t,new Mn.classes.URLSearchParams,{visitor:function(r,n,s,i){return Mn.isNode&&ge.isBuffer(r)?(this.append(n,r.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...e})}function iG(t){return ge.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function aG(t){const e={},r=Object.keys(t);let n;const s=r.length;let i;for(n=0;n<s;n++)i=r[n],e[i]=t[i];return e}function _P(t){function e(r,n,s,i){let a=r[i++];if(a==="__proto__")return!0;const l=Number.isFinite(+a),d=i>=r.length;return a=!a&&ge.isArray(s)?s.length:a,d?(ge.hasOwnProp(s,a)?s[a]=[s[a],n]:s[a]=n,!l):((!s[a]||!ge.isObject(s[a]))&&(s[a]=[]),e(r,n,s[a],i)&&ge.isArray(s[a])&&(s[a]=aG(s[a])),!l)}if(ge.isFormData(t)&&ge.isFunction(t.entries)){const r={};return ge.forEachEntry(t,(n,s)=>{e(iG(n),s,r,0)}),r}return null}function oG(t,e,r){if(ge.isString(t))try{return(e||JSON.parse)(t),ge.trim(t)}catch(n){if(n.name!=="SyntaxError")throw n}return(0,JSON.stringify)(t)}const gf={transitional:RP,adapter:["xhr","http","fetch"],transformRequest:[function(e,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,i=ge.isObject(e);if(i&&ge.isHTMLForm(e)&&(e=new FormData(e)),ge.isFormData(e))return s?JSON.stringify(_P(e)):e;if(ge.isArrayBuffer(e)||ge.isBuffer(e)||ge.isStream(e)||ge.isFile(e)||ge.isBlob(e)||ge.isReadableStream(e))return e;if(ge.isArrayBufferView(e))return e.buffer;if(ge.isURLSearchParams(e))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return sG(e,this.formSerializer).toString();if((l=ge.isFileList(e))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return ug(l?{"files[]":e}:e,d&&new d,this.formSerializer)}}return i||s?(r.setContentType("application/json",!1),oG(e)):e}],transformResponse:[function(e){const r=this.transitional||gf.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(ge.isResponse(e)||ge.isReadableStream(e))return e;if(e&&ge.isString(e)&&(n&&!this.responseType||s)){const a=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(e,this.parseReviver)}catch(l){if(a)throw l.name==="SyntaxError"?pt.from(l,pt.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Mn.classes.FormData,Blob:Mn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],t=>{gf.headers[t]={}});const lG=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),cG=t=>{const e={};let r,n,s;return t&&t.split(`
`).forEach(function(a){s=a.indexOf(":"),r=a.substring(0,s).trim().toLowerCase(),n=a.substring(s+1).trim(),!(!r||e[r]&&lG[r])&&(r==="set-cookie"?e[r]?e[r].push(n):e[r]=[n]:e[r]=e[r]?e[r]+", "+n:n)}),e},RT=Symbol("internals");function Id(t){return t&&String(t).trim().toLowerCase()}function qm(t){return t===!1||t==null?t:ge.isArray(t)?t.map(qm):String(t)}function uG(t){const e=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(t);)e[n[1]]=n[2];return e}const dG=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ox(t,e,r,n,s){if(ge.isFunction(n))return n.call(this,e,r);if(s&&(e=r),!!ge.isString(e)){if(ge.isString(n))return e.indexOf(n)!==-1;if(ge.isRegExp(n))return n.test(e)}}function hG(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,r,n)=>r.toUpperCase()+n)}function fG(t,e){const r=ge.toCamelCase(" "+e);["get","set","has"].forEach(n=>{Object.defineProperty(t,n+r,{value:function(s,i,a){return this[n].call(this,e,s,i,a)},configurable:!0})})}class ms{constructor(e){e&&this.set(e)}set(e,r,n){const s=this;function i(l,d,u){const f=Id(d);if(!f)throw new Error("header name must be a non-empty string");const p=ge.findKey(s,f);(!p||s[p]===void 0||u===!0||u===void 0&&s[p]!==!1)&&(s[p||d]=qm(l))}const a=(l,d)=>ge.forEach(l,(u,f)=>i(u,f,d));if(ge.isPlainObject(e)||e instanceof this.constructor)a(e,r);else if(ge.isString(e)&&(e=e.trim())&&!dG(e))a(cG(e),r);else if(ge.isObject(e)&&ge.isIterable(e)){let l={},d,u;for(const f of e){if(!ge.isArray(f))throw TypeError("Object iterator must return a key-value pair");l[u=f[0]]=(d=l[u])?ge.isArray(d)?[...d,f[1]]:[d,f[1]]:f[1]}a(l,r)}else e!=null&&i(r,e,n);return this}get(e,r){if(e=Id(e),e){const n=ge.findKey(this,e);if(n){const s=this[n];if(!r)return s;if(r===!0)return uG(s);if(ge.isFunction(r))return r.call(this,s,n);if(ge.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,r){if(e=Id(e),e){const n=ge.findKey(this,e);return!!(n&&this[n]!==void 0&&(!r||Ox(this,this[n],n,r)))}return!1}delete(e,r){const n=this;let s=!1;function i(a){if(a=Id(a),a){const l=ge.findKey(n,a);l&&(!r||Ox(n,n[l],l,r))&&(delete n[l],s=!0)}}return ge.isArray(e)?e.forEach(i):i(e),s}clear(e){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const i=r[n];(!e||Ox(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const r=this,n={};return ge.forEach(this,(s,i)=>{const a=ge.findKey(n,i);if(a){r[a]=qm(s),delete r[i];return}const l=e?hG(i):String(i).trim();l!==i&&delete r[i],r[l]=qm(s),n[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const r=Object.create(null);return ge.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=e&&ge.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,r])=>e+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...r){const n=new this(e);return r.forEach(s=>n.set(s)),n}static accessor(e){const n=(this[RT]=this[RT]={accessors:{}}).accessors,s=this.prototype;function i(a){const l=Id(a);n[l]||(fG(s,a),n[l]=!0)}return ge.isArray(e)?e.forEach(i):i(e),this}}ms.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ge.reduceDescriptors(ms.prototype,({value:t},e)=>{let r=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(n){this[r]=n}}});ge.freezeMethods(ms);function Fx(t,e){const r=this||gf,n=e||r,s=ms.from(n.headers);let i=n.data;return ge.forEach(t,function(l){i=l.call(r,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function LP(t){return!!(t&&t.__CANCEL__)}function Qu(t,e,r){pt.call(this,t??"canceled",pt.ERR_CANCELED,e,r),this.name="CanceledError"}ge.inherits(Qu,pt,{__CANCEL__:!0});function PP(t,e,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?t(r):e(new pt("Request failed with status code "+r.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function mG(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function pG(t,e){t=t||10;const r=new Array(t),n=new Array(t);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(d){const u=Date.now(),f=n[i];a||(a=u),r[s]=d,n[s]=u;let p=i,y=0;for(;p!==s;)y+=r[p++],p=p%t;if(s=(s+1)%t,s===i&&(i=(i+1)%t),u-a<e)return;const v=f&&u-f;return v?Math.round(y*1e3/v):void 0}}function gG(t,e){let r=0,n=1e3/e,s,i;const a=(u,f=Date.now())=>{r=f,s=null,i&&(clearTimeout(i),i=null),t(...u)};return[(...u)=>{const f=Date.now(),p=f-r;p>=n?a(u,f):(s=u,i||(i=setTimeout(()=>{i=null,a(s)},n-p)))},()=>s&&a(s)]}const W0=(t,e,r=3)=>{let n=0;const s=pG(50,250);return gG(i=>{const a=i.loaded,l=i.lengthComputable?i.total:void 0,d=a-n,u=s(d),f=a<=l;n=a;const p={loaded:a,total:l,progress:l?a/l:void 0,bytes:d,rate:u||void 0,estimated:u&&l&&f?(l-a)/u:void 0,event:i,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(p)},r)},_T=(t,e)=>{const r=t!=null;return[n=>e[0]({lengthComputable:r,total:t,loaded:n}),e[1]]},LT=t=>(...e)=>ge.asap(()=>t(...e)),xG=Mn.hasStandardBrowserEnv?((t,e)=>r=>(r=new URL(r,Mn.origin),t.protocol===r.protocol&&t.host===r.host&&(e||t.port===r.port)))(new URL(Mn.origin),Mn.navigator&&/(msie|trident)/i.test(Mn.navigator.userAgent)):()=>!0,yG=Mn.hasStandardBrowserEnv?{write(t,e,r,n,s,i,a){if(typeof document>"u")return;const l=[`${t}=${encodeURIComponent(e)}`];ge.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),ge.isString(n)&&l.push(`path=${n}`),ge.isString(s)&&l.push(`domain=${s}`),i===!0&&l.push("secure"),ge.isString(a)&&l.push(`SameSite=${a}`),document.cookie=l.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function vG(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function wG(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function DP(t,e,r){let n=!vG(e);return t&&(n||r==!1)?wG(t,e):e}const PT=t=>t instanceof ms?{...t}:t;function Hl(t,e){e=e||{};const r={};function n(u,f,p,y){return ge.isPlainObject(u)&&ge.isPlainObject(f)?ge.merge.call({caseless:y},u,f):ge.isPlainObject(f)?ge.merge({},f):ge.isArray(f)?f.slice():f}function s(u,f,p,y){if(ge.isUndefined(f)){if(!ge.isUndefined(u))return n(void 0,u,p,y)}else return n(u,f,p,y)}function i(u,f){if(!ge.isUndefined(f))return n(void 0,f)}function a(u,f){if(ge.isUndefined(f)){if(!ge.isUndefined(u))return n(void 0,u)}else return n(void 0,f)}function l(u,f,p){if(p in e)return n(u,f);if(p in t)return n(void 0,u)}const d={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:l,headers:(u,f,p)=>s(PT(u),PT(f),p,!0)};return ge.forEach(Object.keys({...t,...e}),function(f){const p=d[f]||s,y=p(t[f],e[f],f);ge.isUndefined(y)&&p!==l||(r[f]=y)}),r}const kP=t=>{const e=Hl({},t);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:i,headers:a,auth:l}=e;if(e.headers=a=ms.from(a),e.url=IP(DP(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),ge.isFormData(r)){if(Mn.hasStandardBrowserEnv||Mn.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(ge.isFunction(r.getHeaders)){const d=r.getHeaders(),u=["content-type","content-length"];Object.entries(d).forEach(([f,p])=>{u.includes(f.toLowerCase())&&a.set(f,p)})}}if(Mn.hasStandardBrowserEnv&&(n&&ge.isFunction(n)&&(n=n(e)),n||n!==!1&&xG(e.url))){const d=s&&i&&yG.read(i);d&&a.set(s,d)}return e},bG=typeof XMLHttpRequest<"u",EG=bG&&function(t){return new Promise(function(r,n){const s=kP(t);let i=s.data;const a=ms.from(s.headers).normalize();let{responseType:l,onUploadProgress:d,onDownloadProgress:u}=s,f,p,y,v,E;function b(){v&&v(),E&&E(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let T=new XMLHttpRequest;T.open(s.method.toUpperCase(),s.url,!0),T.timeout=s.timeout;function I(){if(!T)return;const A=ms.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),P={data:!l||l==="text"||l==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:A,config:t,request:T};PP(function(D){r(D),b()},function(D){n(D),b()},P),T=null}"onloadend"in T?T.onloadend=I:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(I)},T.onabort=function(){T&&(n(new pt("Request aborted",pt.ECONNABORTED,t,T)),T=null)},T.onerror=function(L){const P=L&&L.message?L.message:"Network Error",k=new pt(P,pt.ERR_NETWORK,t,T);k.event=L||null,n(k),T=null},T.ontimeout=function(){let L=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const P=s.transitional||RP;s.timeoutErrorMessage&&(L=s.timeoutErrorMessage),n(new pt(L,P.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,t,T)),T=null},i===void 0&&a.setContentType(null),"setRequestHeader"in T&&ge.forEach(a.toJSON(),function(L,P){T.setRequestHeader(P,L)}),ge.isUndefined(s.withCredentials)||(T.withCredentials=!!s.withCredentials),l&&l!=="json"&&(T.responseType=s.responseType),u&&([y,E]=W0(u,!0),T.addEventListener("progress",y)),d&&T.upload&&([p,v]=W0(d),T.upload.addEventListener("progress",p),T.upload.addEventListener("loadend",v)),(s.cancelToken||s.signal)&&(f=A=>{T&&(n(!A||A.type?new Qu(null,t,T):A),T.abort(),T=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const N=mG(s.url);if(N&&Mn.protocols.indexOf(N)===-1){n(new pt("Unsupported protocol "+N+":",pt.ERR_BAD_REQUEST,t));return}T.send(i||null)})},SG=(t,e)=>{const{length:r}=t=t?t.filter(Boolean):[];if(e||r){let n=new AbortController,s;const i=function(u){if(!s){s=!0,l();const f=u instanceof Error?u:this.reason;n.abort(f instanceof pt?f:new Qu(f instanceof Error?f.message:f))}};let a=e&&setTimeout(()=>{a=null,i(new pt(`timeout ${e} of ms exceeded`,pt.ETIMEDOUT))},e);const l=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),t=null)};t.forEach(u=>u.addEventListener("abort",i));const{signal:d}=n;return d.unsubscribe=()=>ge.asap(l),d}},TG=function*(t,e){let r=t.byteLength;if(r<e){yield t;return}let n=0,s;for(;n<r;)s=n+e,yield t.slice(n,s),n=s},CG=async function*(t,e){for await(const r of AG(t))yield*TG(r,e)},AG=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)break;yield n}}finally{await e.cancel()}},DT=(t,e,r,n)=>{const s=CG(t,e);let i=0,a,l=d=>{a||(a=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:u,value:f}=await s.next();if(u){l(),d.close();return}let p=f.byteLength;if(r){let y=i+=p;r(y)}d.enqueue(new Uint8Array(f))}catch(u){throw l(u),u}},cancel(d){return l(d),s.return()}},{highWaterMark:2})},kT=64*1024,{isFunction:om}=ge,NG=(({Request:t,Response:e})=>({Request:t,Response:e}))(ge.global),{ReadableStream:jT,TextEncoder:MT}=ge.global,OT=(t,...e)=>{try{return!!t(...e)}catch{return!1}},IG=t=>{t=ge.merge.call({skipUndefined:!0},NG,t);const{fetch:e,Request:r,Response:n}=t,s=e?om(e):typeof fetch=="function",i=om(r),a=om(n);if(!s)return!1;const l=s&&om(jT),d=s&&(typeof MT=="function"?(E=>b=>E.encode(b))(new MT):async E=>new Uint8Array(await new r(E).arrayBuffer())),u=i&&l&&OT(()=>{let E=!1;const b=new r(Mn.origin,{body:new jT,method:"POST",get duplex(){return E=!0,"half"}}).headers.has("Content-Type");return E&&!b}),f=a&&l&&OT(()=>ge.isReadableStream(new n("").body)),p={stream:f&&(E=>E.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(E=>{!p[E]&&(p[E]=(b,T)=>{let I=b&&b[E];if(I)return I.call(b);throw new pt(`Response type '${E}' is not supported`,pt.ERR_NOT_SUPPORT,T)})});const y=async E=>{if(E==null)return 0;if(ge.isBlob(E))return E.size;if(ge.isSpecCompliantForm(E))return(await new r(Mn.origin,{method:"POST",body:E}).arrayBuffer()).byteLength;if(ge.isArrayBufferView(E)||ge.isArrayBuffer(E))return E.byteLength;if(ge.isURLSearchParams(E)&&(E=E+""),ge.isString(E))return(await d(E)).byteLength},v=async(E,b)=>{const T=ge.toFiniteNumber(E.getContentLength());return T??y(b)};return async E=>{let{url:b,method:T,data:I,signal:N,cancelToken:A,timeout:L,onDownloadProgress:P,onUploadProgress:k,responseType:D,headers:O,withCredentials:F="same-origin",fetchOptions:$}=kP(E),G=e||fetch;D=D?(D+"").toLowerCase():"text";let Y=SG([N,A&&A.toAbortSignal()],L),ne=null;const X=Y&&Y.unsubscribe&&(()=>{Y.unsubscribe()});let z;try{if(k&&u&&T!=="get"&&T!=="head"&&(z=await v(O,I))!==0){let Q=new r(b,{method:"POST",body:I,duplex:"half"}),re;if(ge.isFormData(I)&&(re=Q.headers.get("content-type"))&&O.setContentType(re),Q.body){const[Ee,ie]=_T(z,W0(LT(k)));I=DT(Q.body,kT,Ee,ie)}}ge.isString(F)||(F=F?"include":"omit");const Z=i&&"credentials"in r.prototype,ee={...$,signal:Y,method:T.toUpperCase(),headers:O.normalize().toJSON(),body:I,duplex:"half",credentials:Z?F:void 0};ne=i&&new r(b,ee);let q=await(i?G(ne,$):G(b,ee));const K=f&&(D==="stream"||D==="response");if(f&&(P||K&&X)){const Q={};["status","statusText","headers"].forEach(se=>{Q[se]=q[se]});const re=ge.toFiniteNumber(q.headers.get("content-length")),[Ee,ie]=P&&_T(re,W0(LT(P),!0))||[];q=new n(DT(q.body,kT,Ee,()=>{ie&&ie(),X&&X()}),Q)}D=D||"text";let ae=await p[ge.findKey(p,D)||"text"](q,E);return!K&&X&&X(),await new Promise((Q,re)=>{PP(Q,re,{data:ae,headers:ms.from(q.headers),status:q.status,statusText:q.statusText,config:E,request:ne})})}catch(Z){throw X&&X(),Z&&Z.name==="TypeError"&&/Load failed|fetch/i.test(Z.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,E,ne),{cause:Z.cause||Z}):pt.from(Z,Z&&Z.code,E,ne)}}},RG=new Map,jP=t=>{let e=t&&t.env||{};const{fetch:r,Request:n,Response:s}=e,i=[n,s,r];let a=i.length,l=a,d,u,f=RG;for(;l--;)d=i[l],u=f.get(d),u===void 0&&f.set(d,u=l?new Map:IG(e)),f=u;return u};jP();const Mb={http:WV,xhr:EG,fetch:{get:jP}};ge.forEach(Mb,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const FT=t=>`- ${t}`,_G=t=>ge.isFunction(t)||t===null||t===!1;function LG(t,e){t=ge.isArray(t)?t:[t];const{length:r}=t;let n,s;const i={};for(let a=0;a<r;a++){n=t[a];let l;if(s=n,!_G(n)&&(s=Mb[(l=String(n)).toLowerCase()],s===void 0))throw new pt(`Unknown adapter '${l}'`);if(s&&(ge.isFunction(s)||(s=s.get(e))))break;i[l||"#"+a]=s}if(!s){const a=Object.entries(i).map(([d,u])=>`adapter ${d} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?a.length>1?`since :
`+a.map(FT).join(`
`):" "+FT(a[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return s}const MP={getAdapter:LG,adapters:Mb};function Bx(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Qu(null,t)}function BT(t){return Bx(t),t.headers=ms.from(t.headers),t.data=Fx.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),MP.getAdapter(t.adapter||gf.adapter,t)(t).then(function(n){return Bx(t),n.data=Fx.call(t,t.transformResponse,n),n.headers=ms.from(n.headers),n},function(n){return LP(n)||(Bx(t),n&&n.response&&(n.response.data=Fx.call(t,t.transformResponse,n.response),n.response.headers=ms.from(n.response.headers))),Promise.reject(n)})}const OP="1.13.2",dg={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{dg[t]=function(n){return typeof n===t||"a"+(e<1?"n ":" ")+t}});const UT={};dg.transitional=function(e,r,n){function s(i,a){return"[Axios v"+OP+"] Transitional option '"+i+"'"+a+(n?". "+n:"")}return(i,a,l)=>{if(e===!1)throw new pt(s(a," has been removed"+(r?" in "+r:"")),pt.ERR_DEPRECATED);return r&&!UT[a]&&(UT[a]=!0,console.warn(s(a," has been deprecated since v"+r+" and will be removed in the near future"))),e?e(i,a,l):!0}};dg.spelling=function(e){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};function PG(t,e,r){if(typeof t!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);const n=Object.keys(t);let s=n.length;for(;s-- >0;){const i=n[s],a=e[i];if(a){const l=t[i],d=l===void 0||a(l,i,t);if(d!==!0)throw new pt("option "+i+" must be "+d,pt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new pt("Unknown option "+i,pt.ERR_BAD_OPTION)}}const Xm={assertOptions:PG,validators:dg},Fi=Xm.validators;class _l{constructor(e){this.defaults=e||{},this.interceptors={request:new IT,response:new IT}}async request(e,r){try{return await this._request(e,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?i&&!String(n.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+i):n.stack=i}catch{}}throw n}}_request(e,r){typeof e=="string"?(r=r||{},r.url=e):r=e||{},r=Hl(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:i}=r;n!==void 0&&Xm.assertOptions(n,{silentJSONParsing:Fi.transitional(Fi.boolean),forcedJSONParsing:Fi.transitional(Fi.boolean),clarifyTimeoutError:Fi.transitional(Fi.boolean)},!1),s!=null&&(ge.isFunction(s)?r.paramsSerializer={serialize:s}:Xm.assertOptions(s,{encode:Fi.function,serialize:Fi.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Xm.assertOptions(r,{baseUrl:Fi.spelling("baseURL"),withXsrfToken:Fi.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let a=i&&ge.merge(i.common,i[r.method]);i&&ge.forEach(["delete","get","head","post","put","patch","common"],E=>{delete i[E]}),r.headers=ms.concat(a,i);const l=[];let d=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(r)===!1||(d=d&&b.synchronous,l.unshift(b.fulfilled,b.rejected))});const u=[];this.interceptors.response.forEach(function(b){u.push(b.fulfilled,b.rejected)});let f,p=0,y;if(!d){const E=[BT.bind(this),void 0];for(E.unshift(...l),E.push(...u),y=E.length,f=Promise.resolve(r);p<y;)f=f.then(E[p++],E[p++]);return f}y=l.length;let v=r;for(;p<y;){const E=l[p++],b=l[p++];try{v=E(v)}catch(T){b.call(this,T);break}}try{f=BT.call(this,v)}catch(E){return Promise.reject(E)}for(p=0,y=u.length;p<y;)f=f.then(u[p++],u[p++]);return f}getUri(e){e=Hl(this.defaults,e);const r=DP(e.baseURL,e.url,e.allowAbsoluteUrls);return IP(r,e.params,e.paramsSerializer)}}ge.forEach(["delete","get","head","options"],function(e){_l.prototype[e]=function(r,n){return this.request(Hl(n||{},{method:e,url:r,data:(n||{}).data}))}});ge.forEach(["post","put","patch"],function(e){function r(n){return function(i,a,l){return this.request(Hl(l||{},{method:e,headers:n?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}_l.prototype[e]=r(),_l.prototype[e+"Form"]=r(!0)});class Ob{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(i){r=i});const n=this;this.promise.then(s=>{if(!n._listeners)return;let i=n._listeners.length;for(;i-- >0;)n._listeners[i](s);n._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(l=>{n.subscribe(l),i=l}).then(s);return a.cancel=function(){n.unsubscribe(i)},a},e(function(i,a,l){n.reason||(n.reason=new Qu(i,a,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const r=this._listeners.indexOf(e);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const e=new AbortController,r=n=>{e.abort(n)};return this.subscribe(r),e.signal.unsubscribe=()=>this.unsubscribe(r),e.signal}static source(){let e;return{token:new Ob(function(s){e=s}),cancel:e}}}function DG(t){return function(r){return t.apply(null,r)}}function kG(t){return ge.isObject(t)&&t.isAxiosError===!0}const Zy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Zy).forEach(([t,e])=>{Zy[e]=t});function FP(t){const e=new _l(t),r=gP(_l.prototype.request,e);return ge.extend(r,_l.prototype,e,{allOwnKeys:!0}),ge.extend(r,e,null,{allOwnKeys:!0}),r.create=function(s){return FP(Hl(t,s))},r}const zr=FP(gf);zr.Axios=_l;zr.CanceledError=Qu;zr.CancelToken=Ob;zr.isCancel=LP;zr.VERSION=OP;zr.toFormData=ug;zr.AxiosError=pt;zr.Cancel=zr.CanceledError;zr.all=function(e){return Promise.all(e)};zr.spread=DG;zr.isAxiosError=kG;zr.mergeConfig=Hl;zr.AxiosHeaders=ms;zr.formToJSON=t=>_P(ge.isHTMLForm(t)?new FormData(t):t);zr.getAdapter=MP.getAdapter;zr.HttpStatusCode=Zy;zr.default=zr;const K0="http://localhost:5000/api",ye=zr.create({baseURL:K0,withCredentials:!0,headers:{"Content-Type":"application/json"}}),Lu=t=>{if(!t)return"";if(t.startsWith("http"))return t;const e=t.startsWith("/")?t.slice(1):t;if(e.includes("uploads/avatars/")){const n=e.split("/").pop();return`${K0}/static/avatars/${n}`}return`${K0.replace(/\/api$/,"")}/${e}`};let Ux=!1;ye.interceptors.request.use(t=>(console.log("[API DEBUG] Request:",{url:t.url,baseURL:t.baseURL,method:t.method}),t),t=>(console.error("[API DEBUG] Request error:",t),Promise.reject(t)));ye.interceptors.response.use(t=>t,t=>{var e,r,n,s,i;if(console.error("[API DEBUG] Response error:",{status:(e=t.response)==null?void 0:e.status,statusText:(r=t.response)==null?void 0:r.statusText,url:(n=t.config)==null?void 0:n.url,data:(s=t.response)==null?void 0:s.data,message:t.message}),((i=t.response)==null?void 0:i.status)===401){const l=["/login","/register","/auth","/super-secret-login","/forgot-password","/reset-password","/verify-email"].some(d=>window.location.pathname.startsWith(d));!Ux&&!l&&(Ux=!0,console.warn("[API] Redirecting to /auth - 401 Unauthorized (session expired)"),window.location.href="/auth",setTimeout(()=>{Ux=!1},1e3))}return Promise.reject(t)});const cn={register:t=>ye.post("/auth/register",t),login:t=>ye.post("/auth/login",t),superAdminLogin:t=>ye.post("/auth/super-admin-login",t),logout:()=>ye.post("/auth/logout"),getCurrentUser:()=>ye.get("/auth/me"),updateProfile:t=>ye.put("/auth/update-profile",t),changePassword:t=>ye.post("/auth/change-password",t),verifyEmail:(t,e)=>ye.post("/auth/verify-email",{email:t,code:e}),resendVerificationCode:t=>ye.post("/auth/resend-verification",{email:t}),getGoogleAuthUrl:()=>ye.get("/auth/google-auth-url"),googleAuthenticate:t=>ye.post("/auth/google/authenticate",{token:t}),uploadAvatar:t=>ye.post("/auth/upload-avatar",t,{headers:{"Content-Type":"multipart/form-data"}})},qs={getMyVideos:()=>ye.get(`/videos/my-videos?_t=${Date.now()}`),startRecording:t=>ye.post("/videos/record",t),stopRecording:t=>ye.post("/videos/stop-recording",t),unlockVideo:t=>ye.post(`/videos/${t}/unlock`),getVideo:t=>ye.get(`/videos/${t}`),shareVideo:(t,e)=>ye.post(`/videos/${t}/share`,{platform:e}),buyCredits:t=>ye.post("/players/credits/buy",t),getCreditPackages:()=>ye.get("/players/credits/packages"),getPaymentMethods:()=>ye.get("/players/credits/payment-methods"),getCreditsHistory:()=>ye.get("/players/credits/history"),scanQrCode:t=>ye.post("/videos/qr-scan",{qr_code:t}),getCameraStream:t=>ye.get(`/videos/courts/${t}/camera-stream`),getCourtsForClub:t=>ye.get(`/videos/clubs/${t}/courts`),updateVideo:(t,e)=>ye.put(`/videos/${t}`,e),deleteVideo:t=>ye.delete(`/videos/${t}`),getRecordingStatus:t=>ye.get(`/videos/recording/${t}/status`),stopRecordingById:(t,e)=>ye.post(`/videos/recording/${t}/stop`,e),getAvailableCourts:()=>ye.get("/videos/courts/available"),downloadVideo:t=>ye.get(`/videos/download/${t}`,{responseType:"blob"}),getClubCourtsForPlayers:t=>ye.get(`/recording/v3/clubs/${t}/courts?_t=${Date.now()}`),shareVideoWithUser:(t,e,r)=>ye.post(`/videos/${t}/share-with-user`,{recipient_email:e,message:r}),getDownloadUrl:t=>`${K0}/videos/${t}/download`,getSharedWithMe:()=>ye.get("/videos/shared-with-me"),removeSharedAccess:t=>ye.delete(`/videos/shared/${t}`),getMySharedVideos:()=>ye.get("/videos/my-shared-videos"),getVideoOverlays:t=>ye.get(`/videos/${t}/overlays`)},Ph={startAdvancedRecording:t=>ye.post("/recording/v3/start",t),stopRecording:t=>ye.post(`/recording/v3/stop/${t}`),forceStopRecording:t=>ye.post(`/recording/v3/force-stop/${t}`),getMyActiveRecording:()=>ye.get("/recording/v3/my-active"),getClubActiveRecordings:()=>ye.get("/recording/v3/club/active"),getAvailableCourts:t=>ye.get(`/recording/v3/available-courts/${t}`),cleanupExpiredRecordings:()=>ye.post("/recording/v3/cleanup-expired"),getClubCourtsForPlayers:t=>ye.get(`/recording/v3/clubs/${t}/courts?_t=${Date.now()}`),getAllAvailableCourts:()=>ye.get("/recording/v3/available-courts"),startSimpleRecording:t=>ye.post("/recording/v3/start-simple",t)},Vc={getAvailableClubs:()=>ye.get("/players/clubs/available"),followClub:t=>ye.post(`/players/clubs/${t}/follow`),unfollowClub:t=>ye.post(`/players/clubs/${t}/unfollow`),getFollowedClubs:()=>ye.get("/players/clubs/followed")},iu={createMessage:t=>ye.post("/support/messages",t,{headers:{"Content-Type":"multipart/form-data"}}),getMyMessages:()=>ye.get("/support/messages"),getAllMessages:t=>ye.get("/support/admin/messages",{params:t}),updateMessage:(t,e)=>ye.patch(`/support/admin/messages/${t}`,e)},Qm={getMyNotifications:()=>ye.get("/notifications"),markAsRead:t=>ye.post(`/notifications/${t}/mark-read`),markAllAsRead:()=>ye.post("/notifications/mark-all-read")},ra={getDashboard:()=>ye.get("/clubs/dashboard"),getClubInfo:()=>ye.get("/clubs/info"),getCourts:()=>ye.get("/clubs/courts"),getClubVideos:()=>ye.get("/clubs/videos"),getAllClubs:()=>ye.get("/clubs/all"),getClubHistory:()=>ye.get("/clubs/history"),getFollowers:()=>ye.get("/clubs/followers"),updateProfile:t=>ye.put("/clubs/profile",t),stopRecording:t=>ye.post(`/clubs/courts/${t}/stop-recording`),cleanupExpiredSessions:()=>ye.post("/clubs/cleanup-expired-sessions"),buyCredits:t=>ye.post("/clubs/credits/buy",t),getCreditsHistory:()=>ye.get("/clubs/credits/history"),getCreditPackages:()=>ye.get("/clubs/credits/packages"),getPaymentMethods:()=>ye.get("/players/credits/payment-methods"),updatePlayer:(t,e)=>ye.put(`/clubs/${t}`,e),addCreditsToPlayer:(t,e)=>ye.post(`/clubs/${t}/add-credits`,{credits:e}),updateFollower:(t,e)=>ra.updatePlayer(t,e),addCreditsToFollower:(t,e)=>ra.addCreditsToPlayer(t,e)},Ic={getSystemHealth:()=>ye.get("/analytics/system-health"),getPlatformOverview:()=>ye.get("/analytics/platform-overview"),getUserGrowth:(t="week")=>ye.get(`/analytics/user-growth?timeframe=${t}`),getClubAdoption:(t="month")=>ye.get(`/analytics/club-adoption?timeframe=${t}`),getRevenueGrowth:(t="month")=>ye.get(`/analytics/revenue-growth?timeframe=${t}`),getUserEngagement:()=>ye.get("/analytics/user-engagement"),getTopClubs:(t=10)=>ye.get(`/analytics/top-clubs?limit=${t}`),getFinancialOverview:()=>ye.get("/analytics/financial-overview")},Y0={uploadDirectClip:t=>ye.post("/clips/upload-direct",t,{headers:{"Content-Type":"multipart/form-data"}}),getMyClips:()=>ye.get("/clips/my-clips"),createClip:t=>ye.post("/clips/create",t),getClip:t=>ye.get(`/clips/${t}`),getVideoClips:t=>ye.get(`/clips/video/${t}`),deleteClip:t=>ye.delete(`/clips/${t}`),shareClip:(t,e)=>ye.post(`/clips/${t}/share`,e?{platform:e}:{}),downloadClip:t=>ye.get(`/clips/${t}/download`,{responseType:"blob"}),trackDownload:t=>ye.post(`/clips/${t}/download`),getClipMeta:t=>ye.get(`/clips/${t}/meta`)},yt={getAllUsers:()=>ye.get("/admin/users"),createUser:t=>ye.post("/admin/users",t),updateUser:(t,e)=>ye.put(`/admin/users/${t}`,e),deleteUser:t=>ye.delete(`/admin/users/${t}`),getAllClubs:()=>ye.get("/admin/clubs"),createClub:t=>ye.post("/admin/clubs",t),updateClub:(t,e)=>ye.put(`/admin/clubs/${t}`,e),deleteClub:t=>ye.delete(`/admin/clubs/${t}`),createCourt:(t,e)=>ye.post(`/admin/clubs/${t}/courts`,e),getClubCourts:t=>ye.get(`/admin/clubs/${t}/courts`),updateCourt:(t,e)=>ye.put(`/admin/courts/${t}`,e),deleteCourt:t=>ye.delete(`/admin/courts/${t}`),getAllCourts:()=>ye.get("/admin/courts"),getAllVideos:()=>ye.get("/admin/videos"),deleteVideo:(t,e="local_and_cloud")=>ye.delete(`/admin/videos/${t}`,{data:{mode:e}}),retryBunnyUpload:t=>ye.post(`/admin/videos/${t}/retry-bunny-upload`),updateBunnyUrl:(t,e)=>ye.patch(`/admin/videos/${t}/update-bunny-url`,e),createManualVideo:t=>ye.post("/admin/videos/create-manual",t),addCredits:(t,e)=>ye.post(`/admin/users/${t}/credits`,{credits:e}),addCreditsToClub:(t,e)=>ye.post(`/admin/clubs/${t}/credits`,{credits:e}),getAllClubsHistory:()=>ye.get("/admin/clubs/history/all"),getSystemConfig:()=>ye.get("/admin/config"),getBunnyCDNConfig:()=>ye.get("/admin/config/bunny-cdn"),updateBunnyCDNConfig:t=>ye.put("/admin/config/bunny-cdn",t),testBunnyCDN:t=>ye.post("/admin/config/test-bunny",t),getLogs:t=>ye.get("/admin/logs",{params:t}),downloadLogs:()=>ye.get("/admin/logs/download",{responseType:"blob"}),getNotifications:()=>ye.get("/notifications"),markNotificationAsRead:t=>ye.post(`/notifications/${t}/mark-read`),markAllNotificationsAsRead:()=>ye.post("/notifications/mark-all-read"),getCreditPackages:t=>ye.get(`/admin/credit-packages${t?`?type=${t}`:""}`),createCreditPackage:t=>ye.post("/admin/credit-packages",t),updateCreditPackage:(t,e)=>ye.put(`/admin/credit-packages/${t}`,e),deleteCreditPackage:t=>ye.delete(`/admin/credit-packages/${t}`),uploadImage:t=>ye.post("/admin/uploads/image",t,{headers:{"Content-Type":"multipart/form-data"}}),getClubOverlays:t=>ye.get(`/admin/clubs/${t}/overlays`),createClubOverlay:(t,e)=>ye.post(`/admin/clubs/${t}/overlays`,e),updateClubOverlay:(t,e,r)=>ye.put(`/admin/clubs/${t}/overlays/${e}`,r),deleteClubOverlay:(t,e)=>ye.delete(`/admin/clubs/${t}/overlays/${e}`)},Jy={getSettings:()=>ye.get("/settings"),updateSettings:t=>ye.put("/settings",t)},$x=Object.freeze(Object.defineProperty({__proto__:null,adminService:yt,analyticsService:Ic,authService:cn,clipService:Y0,clubService:ra,default:ye,getAssetUrl:Lu,notificationService:Qm,playerService:Vc,recordingService:Ph,settingsService:Jy,supportService:iu,videoService:qs},Symbol.toStringTag,{value:"Module"})),BP=C.createContext(void 0),ps=()=>{const t=C.useContext(BP);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},jG=({children:t})=>{const[e,r]=C.useState(null),[n,s]=C.useState(!0),[i,a]=C.useState(null),[l,d]=C.useState(!1);C.useEffect(()=>{(async()=>{var k;if(l)return;const P=localStorage.getItem("user");if(P)try{r(JSON.parse(P))}catch(D){console.error("Failed to parse stored user",D),localStorage.removeItem("user")}try{const D=await cn.getCurrentUser();r(D.data.user),localStorage.setItem("user",JSON.stringify(D.data.user))}catch(D){((k=D.response)==null?void 0:k.status)===401?(r(null),localStorage.removeItem("user")):console.error("Error checking authentication status:",D)}finally{s(!1),d(!0)}})()},[l]);const u=async L=>{var P,k,D,O;try{a(null),s(!0);const F=await cn.login(L),$=F.data.user;return F.data.token?console.log("[useAuth] JWT token stored explicitly"):console.warn("[useAuth] No token in login response!"),r($),localStorage.setItem("user",JSON.stringify($)),{success:!0,user:$}}catch(F){const $=((k=(P=F.response)==null?void 0:P.data)==null?void 0:k.error)||((O=(D=F.response)==null?void 0:D.data)==null?void 0:O.message)||"Login error";return a($),{success:!1,error:$}}finally{s(!1)}},f=async L=>{var P,k,D,O;try{a(null),s(!0);const F=await cn.register(L);return F.data.user&&(r(F.data.user),localStorage.setItem("user",JSON.stringify(F.data.user))),{success:!0,data:F.data}}catch(F){const $=((k=(P=F.response)==null?void 0:P.data)==null?void 0:k.error)||((O=(D=F.response)==null?void 0:D.data)==null?void 0:O.message)||"Registration error";return a($),{success:!1,error:$}}finally{s(!1)}},p=async()=>{try{await cn.logout()}catch(L){console.error("Logout error",L)}finally{return r(null),localStorage.removeItem("user"),{success:!0}}},y=async()=>{var L;try{const k=(await cn.getCurrentUser()).data.user;return r(k),localStorage.setItem("user",JSON.stringify(k)),k}catch(P){throw((L=P.response)==null?void 0:L.status)===401&&(r(null),localStorage.removeItem("user")),P}},v=async L=>{var P,k,D,O;try{a(null),s(!0);const $=(await cn.updateProfile(L)).data.user;return r($),localStorage.setItem("user",JSON.stringify($)),{success:!0,user:$}}catch(F){const $=((k=(P=F.response)==null?void 0:P.data)==null?void 0:k.error)||((O=(D=F.response)==null?void 0:D.data)==null?void 0:O.message)||"Profile update error";return a($),{success:!1,error:$}}finally{s(!1)}},E=async(L,P)=>{var k,D,O,F;try{a(null),s(!0);const $=await cn.verifyEmail(L,P),G=$.data.user;return $.data.token&&console.log("[useAuth] JWT token stored from email verification"),r(G),localStorage.setItem("user",JSON.stringify(G)),{success:!0,user:G}}catch($){const G=((D=(k=$.response)==null?void 0:k.data)==null?void 0:D.error)||((F=(O=$.response)==null?void 0:O.data)==null?void 0:F.message)||"Verification error";return a(G),{success:!1,error:G}}finally{s(!1)}},b=!!e,T=(e==null?void 0:e.role)==="super_admin",I=(e==null?void 0:e.role)==="player",N=(e==null?void 0:e.role)==="club"||(e==null?void 0:e.role)==="club_admin",A={user:e,setUser:r,loading:n,error:i,login:u,register:f,logout:p,fetchUser:y,updateProfile:v,verifyEmail:E,isAuthenticated:b,isAdmin:T,isPlayer:I,isClub:N};return o.jsx(BP.Provider,{value:A,children:t})},fa=({children:t,requiredRole:e})=>{const{user:r,loading:n}=ps();if(n)return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-primary border-r-transparent mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:"Chargement..."})]})});if(!r)return console.log(" ProtectedRoute: Access denied - No user found"),o.jsx(Nd,{to:"/auth",replace:!0});if(e&&r.role!==e)switch(console.log(` ProtectedRoute: Access denied - Role mismatch. User: ${r.role}, Required: ${e}`),r.role){case"player":return o.jsx(Nd,{to:"/dashboard",replace:!0});case"club":return o.jsx(Nd,{to:"/club",replace:!0});case"super_admin":return o.jsx(Nd,{to:"/admin",replace:!0});default:return o.jsx(Nd,{to:"/auth",replace:!0})}return console.log(" ProtectedRoute: Access granted"),o.jsx(o.Fragment,{children:t})},MG=nf("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-lg text-sm font-semibold ring-offset-background transition-all duration-300 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 hover:shadow-lg hover:shadow-primary/25",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",neon:"relative bg-gradient-to-r from-primary to-[hsl(180,100%,50%)] text-primary-foreground hover:shadow-[0_0_30px_hsl(var(--primary)/0.5)] hover:-translate-y-0.5 active:translate-y-0",neonOutline:"border-2 border-primary bg-transparent text-primary hover:bg-primary/10 hover:shadow-[0_0_20px_hsl(var(--primary)/0.3)]",neonGreen:"relative bg-gradient-to-r from-accent to-[hsl(180,100%,50%)] text-accent-foreground hover:shadow-[0_0_30px_hsl(var(--accent)/0.5)] hover:-translate-y-0.5 active:translate-y-0",glass:"bg-card/70 backdrop-blur-md text-foreground hover:bg-card/90 border border-border/50",hero:"bg-gradient-to-r from-primary via-[hsl(180,100%,50%)] to-primary bg-[length:200%_100%] text-primary-foreground font-bold hover:bg-[position:100%_0] hover:shadow-[0_0_40px_hsl(var(--primary)/0.6)] hover:-translate-y-1 active:translate-y-0 transition-all duration-500"},size:{default:"h-10 px-5 py-2",sm:"h-9 rounded-md px-4",lg:"h-12 rounded-lg px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ve=C.forwardRef(({className:t,variant:e,size:r,asChild:n=!1,...s},i)=>{const a=n?pF:"button";return o.jsx(a,{className:Ye(MG({variant:e,size:r,className:t})),ref:i,...s})});ve.displayName="Button";function ev(){const{theme:t,toggleTheme:e}=pP();return o.jsxs(ve,{variant:"ghost",size:"icon",onClick:e,className:"relative overflow-hidden rounded-full hover:bg-primary/10 transition-all duration-300","aria-label":"Toggle theme",children:[o.jsx(qp,{className:`h-5 w-5 transition-all duration-500 ${t==="dark"?"rotate-90 scale-0":"rotate-0 scale-100"} text-primary`}),o.jsx(Kp,{className:`absolute h-5 w-5 transition-all duration-500 ${t==="dark"?"rotate-0 scale-100":"-rotate-90 scale-0"} text-primary`})]})}const $T=[{icon:TB,title:"Notre Mission",description:"Dmocratiser l'analyse vido sportive pour tous les joueurs, du amateur au professionnel."},{icon:Hu,title:"Innovation",description:"Utiliser la technologie IA pour transformer l'exprience sportive et aider les athltes  progresser."},{icon:ru,title:"Communaut",description:"Crer une plateforme o les sportifs peuvent partager, apprendre et s'amliorer ensemble."},{icon:nL,title:"Expansion",description:"Du padel au tennis, et bientt tous les sports. Notre vision est globale."}],OG=[{year:"2025",title:"Fondation",description:o.jsxs("ul",{className:"space-y-2 text-sm text-left list-none",children:[o.jsx("li",{children:" Accompli"}),o.jsx("li",{children:" Conception de la plateforme Spovio"}),o.jsx("li",{children:" Dpt de brevet (technologie de dclenchement intelligent)"}),o.jsx("li",{children:" Dveloppement du MySmash"}),o.jsx("li",{children:" Validation du concept avec clubs partenaires"})]})},{year:"2026",title:"Lancement MySmash",description:o.jsxs("div",{className:"space-y-4 text-sm text-left",children:[o.jsxs("div",{children:[o.jsx("strong",{className:"block text-primary mb-1",children:" Q1-Q2 : Lancement Tunisie"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-primary/20",children:[o.jsx("li",{children:"Dploiement premiers clubs pilotes (Padel & Tennis)"}),o.jsx("li",{children:"Systme de crdits et packs joueurs"}),o.jsx("li",{children:"Dashboard clubs et statistiques"})]})]}),o.jsxs("div",{children:[o.jsx("strong",{className:"block text-accent mb-1",children:" Q3-Q4 : Enrichissement"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-accent/20",children:[o.jsx("li",{children:"Application mobile iOS & Android"}),o.jsx("li",{children:"Amlioration continue base sur retours utilisateurs"}),o.jsx("li",{children:"Extension du rseau de clubs partenaires"})]})]})]})},{year:"2027",title:"Expansion & Intelligence",description:o.jsxs("div",{className:"space-y-4 text-sm text-left",children:[o.jsxs("div",{children:[o.jsx("strong",{className:"block text-primary mb-1",children:" Expansion Rgionale"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-primary/20",children:[o.jsx("li",{children:"Ouverture du march international"}),o.jsx("li",{children:"Nouveaux partenariats clubs premium"})]})]}),o.jsxs("div",{children:[o.jsx("strong",{className:"block text-accent mb-1",children:" Fonctionnalits IA"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-accent/20",children:[o.jsx("li",{children:"Dtection automatique des moments forts"}),o.jsx("li",{children:"Statistiques de jeu personnalises"}),o.jsx("li",{children:"Recommandations d'amlioration"})]})]}),o.jsxs("div",{children:[o.jsx("strong",{className:"block text-primary mb-1",children:" Exprience Enrichie"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-primary/20",children:[o.jsx("li",{children:"Suivi de progression dans le temps"}),o.jsx("li",{children:"Comparaison avec d'autres joueurs"}),o.jsx("li",{children:"Classements et challenges communautaires"})]})]})]})},{year:"2028+",title:"Nouveaux Horizons",description:o.jsxs("div",{className:"space-y-4 text-sm text-left",children:[o.jsxs("div",{children:[o.jsx("strong",{className:"block text-primary mb-1",children:" Nouveaux Sports"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-primary/20",children:[o.jsx("li",{children:"Extension  d'autres disciplines sportives"}),o.jsx("li",{children:"Plateforme multi-sports complte"})]})]}),o.jsxs("div",{children:[o.jsx("strong",{className:"block text-accent mb-1",children:" Innovation Continue"}),o.jsxs("ul",{className:"space-y-1 pl-4 border-l-2 border-accent/20",children:[o.jsx("li",{children:"Intgrations avec quipements connects"}),o.jsx("li",{children:"Fonctionnalits communautaires avances"})]})]})]})}],FG=[{icon:ib,title:"Statistiques de Match par IA",description:"Analyses compltes pour chaque point, jeu et set. Comprenez vos taux de russite, vos fautes et votre slection de coups.",status:"coming"},{icon:Oa,title:"Suivi de Position",description:"Suivi en temps rel des positions sur le terrain. Analysez la couverture du terrain et les stratgies de placement.",status:"coming"},{icon:nb,title:"Heatmaps de Vitesse",description:"Visualisez les modles de dplacement, les zones de vitesse et la couverture du terrain avec des cartes thermiques dtailles.",status:"coming"},{icon:Yp,title:"Moments Forts Auto",description:"L'IA identifie et dcoupe les meilleurs moments de vos matchs. Partagez vos highlights instantanment.",status:"coming"},{icon:hs,title:"Rsum Intelligent",description:"Obtenez un rsum complet avec les statistiques cls, les tournants du match et des insights de performance.",status:"coming"},{icon:O0,title:"volution Performance",description:"Suivez votre progression au fil du temps avec des analyses de tendances et des jalons atteints.",status:"coming"}],VT=[{number:"01",icon:ub,title:"Scanner le QR Code",description:"Scannez simplement le QR code  l'entre du terrain quip par Spovio. Le systme vous reconnat instantanment.",color:"primary"},{number:"02",icon:yr,title:"Lancer l'Enregistrement",description:"La camra commence  enregistrer automatiquement aprs confirmation. Plusieurs angles capturent chaque moment.",color:"primary"},{number:"03",icon:ob,title:"Sauvegarde Cloud Auto",description:"Votre match est sauvegard automatiquement. Pas d'upload manuel ncessaire - c'est prt ds la fin du match.",color:"primary"},{number:"04",icon:tL,title:"Regarder & Clipper",description:"Revoyez tout votre match, crez des clips de vos meilleures actions et marquez les points cls.",color:"primary"},{number:"05",icon:Vl,title:"Partager Facilement",description:"Partagez vos matchs et highlights avec vos coquipiers, coachs ou sur les rseaux sociaux en un clic.",color:"primary"},{number:"06",icon:sb,title:"Analyse IA",description:"Bientt : Obtenez des insights, statistiques et recommandations pour amliorer votre jeu.",color:"accent",badge:"Bientt"}],BG=[{href:"/ai-features",label:"Fonctionnalits IA"},{href:"/how-it-works",label:"Comment a marche"},{href:"/about",label:" propos"},{href:"/contact",label:"Contact"}],UG={product:[{label:"Fonctionnalits",href:"/ai-features"},{label:"Tarifs",href:"/#pricing"},{label:"Pour les Clubs",href:"/contact?type=club"},{label:"API",href:"/api"}],company:[{label:" propos",href:"/about"},{label:"Blog",href:"/blog"},{label:"Carrires",href:"/careers"},{label:"Presse",href:"/press"}],support:[{label:"Centre d'aide",href:"/help"},{label:"Contact",href:"/contact"},{label:"Statut",href:"/status"},{label:"Communaut",href:"/community"}],legal:[{label:"Confidentialit",href:"/privacy"},{label:"CGU",href:"/terms"},{label:"Cookies",href:"/cookies"}]};function hg(){const[t,e]=C.useState(!1),r=BG;return o.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 glass border-b border-border/30",children:o.jsxs("div",{className:"container mx-auto px-4",children:[o.jsxs("div",{className:"flex items-center justify-between h-16 md:h-20",children:[o.jsxs(pr,{to:"/",className:"flex items-center gap-2 group",children:[o.jsx("div",{className:"relative w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-neon-cyan flex items-center justify-center group-hover:shadow-[0_0_20px_hsl(var(--primary)/0.5)] transition-all duration-300",children:o.jsx(yr,{className:"w-5 h-5 text-primary-foreground"})}),o.jsx("span",{className:"font-display font-bold text-xl tracking-tight",children:o.jsx("span",{className:"gradient-text",children:"Spovio"})})]}),o.jsx("div",{className:"hidden md:flex items-center gap-8",children:r.map(n=>o.jsx("a",{href:n.href,className:"text-sm font-medium text-muted-foreground hover:text-foreground transition-colors relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-primary hover:after:w-full after:transition-all after:duration-300",children:n.label},n.href))}),o.jsxs("div",{className:"hidden md:flex items-center gap-3",children:[o.jsx(ev,{}),o.jsx(pr,{to:"/auth?mode=login",children:o.jsx(ve,{variant:"ghost",size:"sm",children:"Se Connecter"})}),o.jsx(pr,{to:"/auth",children:o.jsxs(ve,{variant:"neon",size:"sm",className:"gap-2",children:[o.jsx(Ps,{className:"w-4 h-4"}),"Commencer"]})})]}),o.jsxs("div",{className:"flex md:hidden items-center gap-2",children:[o.jsx(ev,{}),o.jsx(ve,{variant:"ghost",size:"icon",onClick:()=>e(!t),"aria-label":"Toggle menu",children:t?o.jsx(tc,{className:"w-5 h-5"}):o.jsx(aL,{className:"w-5 h-5"})})]})]}),t&&o.jsx("div",{className:"md:hidden py-4 border-t border-border/30 animate-fade-in",children:o.jsxs("div",{className:"flex flex-col gap-4",children:[r.map(n=>o.jsx("a",{href:n.href,className:"text-sm font-medium text-muted-foreground hover:text-foreground transition-colors px-2 py-1",onClick:()=>e(!1),children:n.label},n.href)),o.jsxs("div",{className:"flex flex-col gap-2 pt-4 border-t border-border/30",children:[o.jsx(pr,{to:"/auth?mode=login",children:o.jsx(ve,{variant:"ghost",className:"justify-start w-full",children:"Se Connecter"})}),o.jsx(pr,{to:"/auth",children:o.jsxs(ve,{variant:"neon",className:"gap-2 w-full",children:[o.jsx(Ps,{className:"w-4 h-4"}),"Commencer"]})})]})]})})]})})}function $G(){return o.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden pt-20",children:[o.jsx("div",{className:"absolute inset-0 bg-grid opacity-30"}),o.jsx("div",{className:"absolute inset-0 bg-radial-glow"}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1/2 bg-radial-accent"}),o.jsx("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-primary/20 rounded-full blur-3xl animate-float"}),o.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-accent/20 rounded-full blur-3xl animate-float animation-delay-500"}),o.jsx("div",{className:"container mx-auto px-4 relative z-10",children:o.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[o.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full glass border border-primary/30 mb-8 animate-slide-up",children:[o.jsx(Hu,{className:"w-4 h-4 text-primary"}),o.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Plateforme d'Analyse Sportive Propulse par l'IA"}),o.jsx(Q_,{className:"w-4 h-4 text-primary"})]}),o.jsxs("h1",{className:"font-display text-4xl md:text-6xl lg:text-7xl font-bold tracking-tight mb-6 animate-slide-up animation-delay-100",children:["Rvolutionnez Votre Sport avec",o.jsx("br",{}),o.jsx("span",{className:"gradient-text",children:"Spovio"})]}),o.jsx("p",{className:"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mb-10 animate-slide-up animation-delay-200",children:"La plateforme complte propulse par l'IA pour enregistrer, analyser et amliorer votre jeu. Du padel au football, nous couvrons tous vos sports."}),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-10 animate-slide-up animation-delay-250",children:[o.jsx("div",{className:"p-4 rounded-xl glass border border-primary/20 transition-all",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Td,{className:"w-6 h-6 text-primary"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-semibold",children:"MySmash"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Padel & Tennis"})]})]})}),o.jsx("div",{className:"p-4 rounded-xl glass border border-border/50 opacity-60",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Td,{className:"w-6 h-6 text-muted-foreground"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-semibold",children:"MyGoal"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Football"})]})]})}),o.jsx("div",{className:"p-4 rounded-xl glass border border-border/50 opacity-60",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Td,{className:"w-6 h-6 text-muted-foreground"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-semibold",children:"MyDunk"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Basketball"})]})]})}),o.jsx("div",{className:"p-4 rounded-xl glass border border-border/50 opacity-60",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Td,{className:"w-6 h-6 text-muted-foreground"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-semibold",children:"MyShot"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Handball"})]})]})}),o.jsx("div",{className:"p-4 rounded-xl glass border border-border/50 opacity-60",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Td,{className:"w-6 h-6 text-muted-foreground"}),o.jsxs("div",{className:"text-left",children:[o.jsx("div",{className:"font-semibold",children:"More"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Coming Soon"})]})]})})]})]})}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-background to-transparent"})]})}const VG=[{icon:yr,title:"Enregistrement Automatique",description:"Les camras du terrain dmarrent automatiquement l'enregistrement ds le dbut de votre match. Aucune configuration manuelle ncessaire.",color:"primary"},{icon:Hu,title:"Analyse par IA",description:"Obtenez des insights instantans sur votre jeu grce  notre IA avance qui analyse vos coups, dplacements et stratgies.",color:"accent"},{icon:Vl,title:"Partage Facile",description:"Partagez vos meilleurs moments avec vos coquipiers, entraneurs ou sur les rseaux sociaux en un seul clic.",color:"primary"},{icon:ib,title:"Suivi de Progression",description:"Suivez votre amlioration au fil du temps avec des statistiques dtailles et des tendances de performance.",color:"accent"},{icon:Gu,title:"Stockage Scuris",description:"Vos vidos sont cryptes et stockes en toute scurit dans le cloud. Accdez-y  tout moment, o que vous soyez.",color:"primary"},{icon:hs,title:"Systme de Crdits Flexible",description:"Payez uniquement ce que vous utilisez avec notre systme de crdits. Parfait pour les joueurs occasionnels et comptitifs.",color:"accent"}];function GG(){return o.jsxs("section",{id:"features",className:"py-24 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 tech-grid opacity-50"}),o.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[o.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-5xl font-bold mb-6",children:["Tout Ce Dont Vous Avez Besoin pour",o.jsx("br",{}),o.jsx("span",{className:"gradient-text",children:"lever Votre Jeu"})]}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"Des outils professionnels d'enregistrement vido et d'analyse, conus spcifiquement pour les sportifs de tous niveaux."})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:VG.map((t,e)=>o.jsxs("div",{className:"group relative p-6 rounded-2xl bg-card border border-border hover:border-primary/50 transition-all duration-300 card-glow",style:{animationDelay:`${e*100}ms`},children:[o.jsx("div",{className:`w-12 h-12 rounded-xl mb-4 flex items-center justify-center ${t.color==="primary"?"bg-primary/10 text-primary group-hover:bg-primary group-hover:text-primary-foreground":"bg-accent/10 text-accent group-hover:bg-accent group-hover:text-accent-foreground"} transition-all duration-300`,children:o.jsx(t.icon,{className:"w-6 h-6"})}),o.jsx("h3",{className:"font-display text-xl font-semibold mb-2",children:t.title}),o.jsx("p",{className:"text-muted-foreground leading-relaxed",children:t.description}),o.jsx("div",{className:`absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none ${t.color==="primary"?"shadow-[inset_0_0_30px_hsl(var(--primary)/0.1)]":"shadow-[inset_0_0_30px_hsl(var(--accent)/0.1)]"}`})]},t.title))})]})]})}const Fb=C.createContext({});function Bb(t){const e=C.useRef(null);return e.current===null&&(e.current=t()),e.current}const Ub=typeof window<"u",UP=Ub?C.useLayoutEffect:C.useEffect,fg=C.createContext(null);function $b(t,e){t.indexOf(e)===-1&&t.push(e)}function Vb(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const ka=(t,e,r)=>r>e?e:r<t?t:r;let q0=()=>{};const ja={},$P=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function VP(t){return typeof t=="object"&&t!==null}const GP=t=>/^0[^.\s]+$/u.test(t);function Gb(t){let e;return()=>(e===void 0&&(e=t()),e)}const Zs=t=>t,HG=(t,e)=>r=>e(t(r)),xf=(...t)=>t.reduce(HG),Dh=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class Hb{constructor(){this.subscriptions=[]}add(e){return $b(this.subscriptions,e),()=>Vb(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const na=t=>t*1e3,Xs=t=>t/1e3;function HP(t,e){return e?t*(1e3/e):0}const zP=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,zG=1e-7,WG=12;function KG(t,e,r,n,s){let i,a,l=0;do a=e+(r-e)/2,i=zP(a,n,s)-t,i>0?r=a:e=a;while(Math.abs(i)>zG&&++l<WG);return a}function yf(t,e,r,n){if(t===e&&r===n)return Zs;const s=i=>KG(i,0,1,t,r);return i=>i===0||i===1?i:zP(s(i),e,n)}const WP=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,KP=t=>e=>1-t(1-e),YP=yf(.33,1.53,.69,.99),zb=KP(YP),qP=WP(zb),XP=t=>(t*=2)<1?.5*zb(t):.5*(2-Math.pow(2,-10*(t-1))),Wb=t=>1-Math.sin(Math.acos(t)),QP=KP(Wb),ZP=WP(Wb),YG=yf(.42,0,1,1),qG=yf(0,0,.58,1),JP=yf(.42,0,.58,1),XG=t=>Array.isArray(t)&&typeof t[0]!="number",eD=t=>Array.isArray(t)&&typeof t[0]=="number",GT={linear:Zs,easeIn:YG,easeInOut:JP,easeOut:qG,circIn:Wb,circInOut:ZP,circOut:QP,backIn:zb,backInOut:qP,backOut:YP,anticipate:XP},QG=t=>typeof t=="string",HT=t=>{if(eD(t)){q0(t.length===4);const[e,r,n,s]=t;return yf(e,r,n,s)}else if(QG(t))return q0(GT[t]!==void 0),GT[t];return t},lm=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],zT={value:null,addProjectionMetrics:null};function ZG(t,e){let r=new Set,n=new Set,s=!1,i=!1;const a=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1},d=0;function u(p){a.has(p)&&(f.schedule(p),t()),d++,p(l)}const f={schedule:(p,y=!1,v=!1)=>{const b=v&&s?r:n;return y&&a.add(p),b.has(p)||b.add(p),p},cancel:p=>{n.delete(p),a.delete(p)},process:p=>{if(l=p,s){i=!0;return}s=!0,[r,n]=[n,r],r.forEach(u),e&&zT.value&&zT.value.frameloop[e].push(d),d=0,r.clear(),s=!1,i&&(i=!1,f.process(p))}};return f}const JG=40;function tD(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,a=lm.reduce((A,L)=>(A[L]=ZG(i,e?L:void 0),A),{}),{setup:l,read:d,resolveKeyframes:u,preUpdate:f,update:p,preRender:y,render:v,postRender:E}=a,b=()=>{const A=ja.useManualTiming?s.timestamp:performance.now();r=!1,ja.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(A-s.timestamp,JG),1)),s.timestamp=A,s.isProcessing=!0,l.process(s),d.process(s),u.process(s),f.process(s),p.process(s),y.process(s),v.process(s),E.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(b))},T=()=>{r=!0,n=!0,s.isProcessing||t(b)};return{schedule:lm.reduce((A,L)=>{const P=a[L];return A[L]=(k,D=!1,O=!1)=>(r||T(),P.schedule(k,D,O)),A},{}),cancel:A=>{for(let L=0;L<lm.length;L++)a[lm[L]].cancel(A)},state:s,steps:a}}const{schedule:cr,cancel:jo,state:yn,steps:Vx}=tD(typeof requestAnimationFrame<"u"?requestAnimationFrame:Zs,!0);let Zm;function eH(){Zm=void 0}const os={now:()=>(Zm===void 0&&os.set(yn.isProcessing||ja.useManualTiming?yn.timestamp:performance.now()),Zm),set:t=>{Zm=t,queueMicrotask(eH)}},rD=t=>e=>typeof e=="string"&&e.startsWith(t),nD=rD("--"),tH=rD("var(--"),Kb=t=>tH(t)?rH.test(t.split("/*")[0].trim()):!1,rH=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Zu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},kh={...Zu,transform:t=>ka(0,1,t)},cm={...Zu,default:1},qd=t=>Math.round(t*1e5)/1e5,Yb=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function nH(t){return t==null}const sH=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,qb=(t,e)=>r=>!!(typeof r=="string"&&sH.test(r)&&r.startsWith(t)||e&&!nH(r)&&Object.prototype.hasOwnProperty.call(r,e)),sD=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,i,a,l]=n.match(Yb);return{[t]:parseFloat(s),[e]:parseFloat(i),[r]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},iH=t=>ka(0,255,t),Gx={...Zu,transform:t=>Math.round(iH(t))},gl={test:qb("rgb","red"),parse:sD("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+Gx.transform(t)+", "+Gx.transform(e)+", "+Gx.transform(r)+", "+qd(kh.transform(n))+")"};function aH(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const tv={test:qb("#"),parse:aH,transform:gl.transform},vf=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ja=vf("deg"),sa=vf("%"),ot=vf("px"),oH=vf("vh"),lH=vf("vw"),WT={...sa,parse:t=>sa.parse(t)/100,transform:t=>sa.transform(t*100)},Gc={test:qb("hsl","hue"),parse:sD("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+sa.transform(qd(e))+", "+sa.transform(qd(r))+", "+qd(kh.transform(n))+")"},Vr={test:t=>gl.test(t)||tv.test(t)||Gc.test(t),parse:t=>gl.test(t)?gl.parse(t):Gc.test(t)?Gc.parse(t):tv.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?gl.transform(t):Gc.transform(t),getAnimatableNone:t=>{const e=Vr.parse(t);return e.alpha=0,Vr.transform(e)}},cH=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function uH(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(Yb))==null?void 0:e.length)||0)+(((r=t.match(cH))==null?void 0:r.length)||0)>0}const iD="number",aD="color",dH="var",hH="var(",KT="${}",fH=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function jh(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let i=0;const l=e.replace(fH,d=>(Vr.test(d)?(n.color.push(i),s.push(aD),r.push(Vr.parse(d))):d.startsWith(hH)?(n.var.push(i),s.push(dH),r.push(d)):(n.number.push(i),s.push(iD),r.push(parseFloat(d))),++i,KT)).split(KT);return{values:r,split:l,indexes:n,types:s}}function oD(t){return jh(t).values}function lD(t){const{split:e,types:r}=jh(t),n=e.length;return s=>{let i="";for(let a=0;a<n;a++)if(i+=e[a],s[a]!==void 0){const l=r[a];l===iD?i+=qd(s[a]):l===aD?i+=Vr.transform(s[a]):i+=s[a]}return i}}const mH=t=>typeof t=="number"?0:Vr.test(t)?Vr.getAnimatableNone(t):t;function pH(t){const e=oD(t);return lD(t)(e.map(mH))}const Mo={test:uH,parse:oD,createTransformer:lD,getAnimatableNone:pH};function Hx(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function gH({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,i=0,a=0;if(!e)s=i=a=r;else{const l=r<.5?r*(1+e):r+e-r*e,d=2*r-l;s=Hx(d,l,t+1/3),i=Hx(d,l,t),a=Hx(d,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:n}}function X0(t,e){return r=>r>0?e:t}const gr=(t,e,r)=>t+(e-t)*r,zx=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},xH=[tv,gl,Gc],yH=t=>xH.find(e=>e.test(t));function YT(t){const e=yH(t);if(!e)return!1;let r=e.parse(t);return e===Gc&&(r=gH(r)),r}const qT=(t,e)=>{const r=YT(t),n=YT(e);if(!r||!n)return X0(t,e);const s={...r};return i=>(s.red=zx(r.red,n.red,i),s.green=zx(r.green,n.green,i),s.blue=zx(r.blue,n.blue,i),s.alpha=gr(r.alpha,n.alpha,i),gl.transform(s))},rv=new Set(["none","hidden"]);function vH(t,e){return rv.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function wH(t,e){return r=>gr(t,e,r)}function Xb(t){return typeof t=="number"?wH:typeof t=="string"?Kb(t)?X0:Vr.test(t)?qT:SH:Array.isArray(t)?cD:typeof t=="object"?Vr.test(t)?qT:bH:X0}function cD(t,e){const r=[...t],n=r.length,s=t.map((i,a)=>Xb(i)(i,e[a]));return i=>{for(let a=0;a<n;a++)r[a]=s[a](i);return r}}function bH(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=Xb(t[s])(t[s],e[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}}function EH(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const i=e.types[s],a=t.indexes[i][n[i]],l=t.values[a]??0;r[s]=l,n[i]++}return r}const SH=(t,e)=>{const r=Mo.createTransformer(e),n=jh(t),s=jh(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?rv.has(t)&&!s.values.length||rv.has(e)&&!n.values.length?vH(t,e):xf(cD(EH(n,s),s.values),r):X0(t,e)};function uD(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?gr(t,e,r):Xb(t)(t,e)}const TH=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>cr.update(e,r),stop:()=>jo(e),now:()=>yn.isProcessing?yn.timestamp:os.now()}},dD=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let i=0;i<s;i++)n+=Math.round(t(i/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},Q0=2e4;function Qb(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<Q0;)e+=r,n=t.next(e);return e>=Q0?1/0:e}function CH(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(Qb(n),Q0);return{type:"keyframes",ease:i=>n.next(s*i).value/e,duration:Xs(s)}}const AH=5;function hD(t,e,r){const n=Math.max(e-AH,0);return HP(r-t(n),e-n)}const Ar={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Wx=.001;function NH({duration:t=Ar.duration,bounce:e=Ar.bounce,velocity:r=Ar.velocity,mass:n=Ar.mass}){let s,i,a=1-e;a=ka(Ar.minDamping,Ar.maxDamping,a),t=ka(Ar.minDuration,Ar.maxDuration,Xs(t)),a<1?(s=u=>{const f=u*a,p=f*t,y=f-r,v=nv(u,a),E=Math.exp(-p);return Wx-y/v*E},i=u=>{const p=u*a*t,y=p*r+r,v=Math.pow(a,2)*Math.pow(u,2)*t,E=Math.exp(-p),b=nv(Math.pow(u,2),a);return(-s(u)+Wx>0?-1:1)*((y-v)*E)/b}):(s=u=>{const f=Math.exp(-u*t),p=(u-r)*t+1;return-Wx+f*p},i=u=>{const f=Math.exp(-u*t),p=(r-u)*(t*t);return f*p});const l=5/t,d=RH(s,i,l);if(t=na(t),isNaN(d))return{stiffness:Ar.stiffness,damping:Ar.damping,duration:t};{const u=Math.pow(d,2)*n;return{stiffness:u,damping:a*2*Math.sqrt(n*u),duration:t}}}const IH=12;function RH(t,e,r){let n=r;for(let s=1;s<IH;s++)n=n-t(n)/e(n);return n}function nv(t,e){return t*Math.sqrt(1-e*e)}const _H=["duration","bounce"],LH=["stiffness","damping","mass"];function XT(t,e){return e.some(r=>t[r]!==void 0)}function PH(t){let e={velocity:Ar.velocity,stiffness:Ar.stiffness,damping:Ar.damping,mass:Ar.mass,isResolvedFromDuration:!1,...t};if(!XT(t,LH)&&XT(t,_H))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,i=2*ka(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:Ar.mass,stiffness:s,damping:i}}else{const r=NH(t);e={...e,...r,mass:Ar.mass},e.isResolvedFromDuration=!0}return e}function Z0(t=Ar.visualDuration,e=Ar.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const i=r.keyframes[0],a=r.keyframes[r.keyframes.length-1],l={done:!1,value:i},{stiffness:d,damping:u,mass:f,duration:p,velocity:y,isResolvedFromDuration:v}=PH({...r,velocity:-Xs(r.velocity||0)}),E=y||0,b=u/(2*Math.sqrt(d*f)),T=a-i,I=Xs(Math.sqrt(d/f)),N=Math.abs(T)<5;n||(n=N?Ar.restSpeed.granular:Ar.restSpeed.default),s||(s=N?Ar.restDelta.granular:Ar.restDelta.default);let A;if(b<1){const P=nv(I,b);A=k=>{const D=Math.exp(-b*I*k);return a-D*((E+b*I*T)/P*Math.sin(P*k)+T*Math.cos(P*k))}}else if(b===1)A=P=>a-Math.exp(-I*P)*(T+(E+I*T)*P);else{const P=I*Math.sqrt(b*b-1);A=k=>{const D=Math.exp(-b*I*k),O=Math.min(P*k,300);return a-D*((E+b*I*T)*Math.sinh(O)+P*T*Math.cosh(O))/P}}const L={calculatedDuration:v&&p||null,next:P=>{const k=A(P);if(v)l.done=P>=p;else{let D=P===0?E:0;b<1&&(D=P===0?na(E):hD(A,P,k));const O=Math.abs(D)<=n,F=Math.abs(a-k)<=s;l.done=O&&F}return l.value=l.done?a:k,l},toString:()=>{const P=Math.min(Qb(L),Q0),k=dD(D=>L.next(P*D).value,P,30);return P+"ms "+k},toTransition:()=>{}};return L}Z0.applyToOptions=t=>{const e=CH(t,100,Z0);return t.ease=e.ease,t.duration=na(e.duration),t.type="keyframes",t};function sv({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:l,max:d,restDelta:u=.5,restSpeed:f}){const p=t[0],y={done:!1,value:p},v=O=>l!==void 0&&O<l||d!==void 0&&O>d,E=O=>l===void 0?d:d===void 0||Math.abs(l-O)<Math.abs(d-O)?l:d;let b=r*e;const T=p+b,I=a===void 0?T:a(T);I!==T&&(b=I-p);const N=O=>-b*Math.exp(-O/n),A=O=>I+N(O),L=O=>{const F=N(O),$=A(O);y.done=Math.abs(F)<=u,y.value=y.done?I:$};let P,k;const D=O=>{v(y.value)&&(P=O,k=Z0({keyframes:[y.value,E(y.value)],velocity:hD(A,O,y.value),damping:s,stiffness:i,restDelta:u,restSpeed:f}))};return D(0),{calculatedDuration:null,next:O=>{let F=!1;return!k&&P===void 0&&(F=!0,L(O),D(O)),P!==void 0&&O>=P?k.next(O-P):(!F&&L(O),y)}}}function DH(t,e,r){const n=[],s=r||ja.mix||uD,i=t.length-1;for(let a=0;a<i;a++){let l=s(t[a],t[a+1]);if(e){const d=Array.isArray(e)?e[a]||Zs:e;l=xf(d,l)}n.push(l)}return n}function kH(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const i=t.length;if(q0(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const a=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=DH(e,n,s),d=l.length,u=f=>{if(a&&f<t[0])return e[0];let p=0;if(d>1)for(;p<t.length-2&&!(f<t[p+1]);p++);const y=Dh(t[p],t[p+1],f);return l[p](y)};return r?f=>u(ka(t[0],t[i-1],f)):u}function jH(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=Dh(0,e,n);t.push(gr(r,1,s))}}function MH(t){const e=[0];return jH(e,t.length-1),e}function OH(t,e){return t.map(r=>r*e)}function FH(t,e){return t.map(()=>e||JP).splice(0,t.length-1)}function Xd({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=XG(n)?n.map(HT):HT(n),i={done:!1,value:e[0]},a=OH(r&&r.length===e.length?r:MH(e),t),l=kH(a,e,{ease:Array.isArray(s)?s:FH(e,s)});return{calculatedDuration:t,next:d=>(i.value=l(d),i.done=d>=t,i)}}const BH=t=>t!==null;function Zb(t,{repeat:e,repeatType:r="loop"},n,s=1){const i=t.filter(BH),l=s<0||e&&r!=="loop"&&e%2===1?0:i.length-1;return!l||n===void 0?i[l]:n}const UH={decay:sv,inertia:sv,tween:Xd,keyframes:Xd,spring:Z0};function fD(t){typeof t.type=="string"&&(t.type=UH[t.type])}class Jb{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const $H=t=>t/100;class eE extends Jb{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==os.now()&&this.tick(os.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;fD(e);const{type:r=Xd,repeat:n=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=e;let{keyframes:l}=e;const d=r||Xd;d!==Xd&&typeof l[0]!="number"&&(this.mixKeyframes=xf($H,uD(l[0],l[1])),l=[0,100]);const u=d({...e,keyframes:l});i==="mirror"&&(this.mirroredGenerator=d({...e,keyframes:[...l].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=Qb(u));const{calculatedDuration:f}=u;this.calculatedDuration=f,this.resolvedDuration=f+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:l,calculatedDuration:d}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:f,repeat:p,repeatType:y,repeatDelay:v,type:E,onUpdate:b,finalKeyframe:T}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const I=this.currentTime-u*(this.playbackSpeed>=0?1:-1),N=this.playbackSpeed>=0?I<0:I>s;this.currentTime=Math.max(I,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let A=this.currentTime,L=n;if(p){const O=Math.min(this.currentTime,s)/l;let F=Math.floor(O),$=O%1;!$&&O>=1&&($=1),$===1&&F--,F=Math.min(F,p+1),!!(F%2)&&(y==="reverse"?($=1-$,v&&($-=v/l)):y==="mirror"&&(L=a)),A=ka(0,1,$)*l}const P=N?{done:!1,value:f[0]}:L.next(A);i&&(P.value=i(P.value));let{done:k}=P;!N&&d!==null&&(k=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const D=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&k);return D&&E!==sv&&(P.value=Zb(f,this.options,T,this.speed)),b&&b(P.value),D&&this.finish(),P}then(e,r){return this.finished.then(e,r)}get duration(){return Xs(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Xs(e)}get time(){return Xs(this.currentTime)}set time(e){var r;e=na(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(os.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Xs(this.currentTime))}play(){var s,i;if(this.isStopped)return;const{driver:e=TH,startTime:r}=this.options;this.driver||(this.driver=e(a=>this.tick(a))),(i=(s=this.options).onPlay)==null||i.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(os.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function VH(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const xl=t=>t*180/Math.PI,iv=t=>{const e=xl(Math.atan2(t[1],t[0]));return av(e)},GH={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:iv,rotateZ:iv,skewX:t=>xl(Math.atan(t[1])),skewY:t=>xl(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},av=t=>(t=t%360,t<0&&(t+=360),t),QT=iv,ZT=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),JT=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),HH={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:ZT,scaleY:JT,scale:t=>(ZT(t)+JT(t))/2,rotateX:t=>av(xl(Math.atan2(t[6],t[5]))),rotateY:t=>av(xl(Math.atan2(-t[2],t[0]))),rotateZ:QT,rotate:QT,skewX:t=>xl(Math.atan(t[4])),skewY:t=>xl(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function ov(t){return t.includes("scale")?1:0}function lv(t,e){if(!t||t==="none")return ov(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=HH,s=r;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=GH,s=l}if(!s)return ov(e);const i=n[e],a=s[1].split(",").map(WH);return typeof i=="function"?i(a):a[i]}const zH=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return lv(r,e)};function WH(t){return parseFloat(t.trim())}const Ju=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ed=new Set(Ju),eC=t=>t===Zu||t===ot,KH=new Set(["x","y","z"]),YH=Ju.filter(t=>!KH.has(t));function qH(t){const e=[];return YH.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const Ll={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>lv(e,"x"),y:(t,{transform:e})=>lv(e,"y")};Ll.translateX=Ll.x;Ll.translateY=Ll.y;const Pl=new Set;let cv=!1,uv=!1,dv=!1;function mD(){if(uv){const t=Array.from(Pl).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=qH(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([i,a])=>{var l;(l=n.getValue(i))==null||l.set(a)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}uv=!1,cv=!1,Pl.forEach(t=>t.complete(dv)),Pl.clear()}function pD(){Pl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(uv=!0)})}function XH(){dv=!0,pD(),mD(),dv=!1}class tE{constructor(e,r,n,s,i,a=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.state="scheduled",this.isAsync?(Pl.add(this),cv||(cv=!0,cr.read(pD),cr.resolveKeyframes(mD))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const i=s==null?void 0:s.get(),a=e[e.length-1];if(i!==void 0)e[0]=i;else if(n&&r){const l=n.readValue(r,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&i===void 0&&s.set(e[0])}VH(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Pl.delete(this)}cancel(){this.state==="scheduled"&&(Pl.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const QH=t=>t.startsWith("--");function ZH(t,e,r){QH(e)?t.style.setProperty(e,r):t.style[e]=r}const JH=Gb(()=>window.ScrollTimeline!==void 0),ez={};function tz(t,e){const r=Gb(t);return()=>ez[e]??r()}const gD=tz(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),jd=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,tC={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:jd([0,.65,.55,1]),circOut:jd([.55,0,1,.45]),backIn:jd([.31,.01,.66,-.59]),backOut:jd([.33,1.53,.69,.99])};function xD(t,e){if(t)return typeof t=="function"?gD()?dD(t,e):"ease-out":eD(t)?jd(t):Array.isArray(t)?t.map(r=>xD(r,e)||tC.easeOut):tC[t]}function rz(t,e,r,{delay:n=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:l="easeOut",times:d}={},u=void 0){const f={[e]:r};d&&(f.offset=d);const p=xD(l,s);Array.isArray(p)&&(f.easing=p);const y={delay:n,duration:s,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return u&&(y.pseudoElement=u),t.animate(f,y)}function yD(t){return typeof t=="function"&&"applyToOptions"in t}function nz({type:t,...e}){return yD(t)&&gD()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class sz extends Jb{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:l,onComplete:d}=e;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=e,q0(typeof e.type!="string");const u=nz(e);this.animation=rz(r,n,s,u,i),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const f=Zb(s,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(f):ZH(r,n,f),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return Xs(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+Xs(e)}get time(){return Xs(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=na(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&JH()?(this.animation.timeline=e,Zs):r(this)}}const vD={anticipate:XP,backInOut:qP,circInOut:ZP};function iz(t){return t in vD}function az(t){typeof t.ease=="string"&&iz(t.ease)&&(t.ease=vD[t.ease])}const rC=10;class oz extends sz{constructor(e){az(e),fD(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:i,...a}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const l=new eE({...a,autoplay:!1}),d=na(this.finishedTime??this.time);r.setWithVelocity(l.sample(d-rC).value,l.sample(d).value,rC),l.stop()}}const nC=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Mo.test(t)||t==="0")&&!t.startsWith("url("));function lz(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function cz(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],a=nC(s,e),l=nC(i,e);return!a||!l?!1:lz(t)||(r==="spring"||yD(r))&&n}function hv(t){t.duration=0,t.type="keyframes"}const uz=new Set(["opacity","clipPath","filter","transform"]),dz=Gb(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function hz(t){var f;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:i,type:a}=t;if(!(((f=e==null?void 0:e.owner)==null?void 0:f.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:u}=e.owner.getProps();return dz()&&r&&uz.has(r)&&(r!=="transform"||!u)&&!d&&!n&&s!=="mirror"&&i!==0&&a!=="inertia"}const fz=40;class mz extends Jb{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:l,name:d,motionValue:u,element:f,...p}){var E;super(),this.stop=()=>{var b,T;this._animation&&(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)),(T=this.keyframeResolver)==null||T.cancel()},this.createdAt=os.now();const y={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:i,repeatType:a,name:d,motionValue:u,element:f,...p},v=(f==null?void 0:f.KeyframeResolver)||tE;this.keyframeResolver=new v(l,(b,T,I)=>this.onKeyframesResolved(b,T,y,!I),d,u,f),(E=this.keyframeResolver)==null||E.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:l,delay:d,isHandoff:u,onUpdate:f}=n;this.resolvedAt=os.now(),cz(e,i,a,l)||((ja.instantAnimations||!d)&&(f==null||f(Zb(e,n,r))),e[0]=e[e.length-1],hv(n),n.repeat=0);const y={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>fz?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},v=!u&&hz(y)?new oz({...y,element:y.motionValue.owner.current}):new eE(y);v.finished.then(()=>this.notifyFinished()).catch(Zs),this.pendingTimeline&&(this.stopTimeline=v.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=v}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),XH()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const pz=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function gz(t){const e=pz.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function wD(t,e,r=1){const[n,s]=gz(t);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const a=i.trim();return $P(a)?parseFloat(a):a}return Kb(s)?wD(s,e,r+1):s}function rE(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const bD=new Set(["width","height","top","left","right","bottom",...Ju]),xz={test:t=>t==="auto",parse:t=>t},ED=t=>e=>e.test(t),SD=[Zu,ot,sa,Ja,lH,oH,xz],sC=t=>SD.find(ED(t));function yz(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||GP(t):!0}const vz=new Set(["brightness","contrast","saturate","opacity"]);function wz(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(Yb)||[];if(!n)return t;const s=r.replace(n,"");let i=vz.has(e)?1:0;return n!==r&&(i*=100),e+"("+i+s+")"}const bz=/\b([a-z-]*)\(.*?\)/gu,fv={...Mo,getAnimatableNone:t=>{const e=t.match(bz);return e?e.map(wz).join(" "):t}},iC={...Zu,transform:Math.round},Ez={rotate:Ja,rotateX:Ja,rotateY:Ja,rotateZ:Ja,scale:cm,scaleX:cm,scaleY:cm,scaleZ:cm,skew:Ja,skewX:Ja,skewY:Ja,distance:ot,translateX:ot,translateY:ot,translateZ:ot,x:ot,y:ot,z:ot,perspective:ot,transformPerspective:ot,opacity:kh,originX:WT,originY:WT,originZ:ot},nE={borderWidth:ot,borderTopWidth:ot,borderRightWidth:ot,borderBottomWidth:ot,borderLeftWidth:ot,borderRadius:ot,radius:ot,borderTopLeftRadius:ot,borderTopRightRadius:ot,borderBottomRightRadius:ot,borderBottomLeftRadius:ot,width:ot,maxWidth:ot,height:ot,maxHeight:ot,top:ot,right:ot,bottom:ot,left:ot,padding:ot,paddingTop:ot,paddingRight:ot,paddingBottom:ot,paddingLeft:ot,margin:ot,marginTop:ot,marginRight:ot,marginBottom:ot,marginLeft:ot,backgroundPositionX:ot,backgroundPositionY:ot,...Ez,zIndex:iC,fillOpacity:kh,strokeOpacity:kh,numOctaves:iC},Sz={...nE,color:Vr,backgroundColor:Vr,outlineColor:Vr,fill:Vr,stroke:Vr,borderColor:Vr,borderTopColor:Vr,borderRightColor:Vr,borderBottomColor:Vr,borderLeftColor:Vr,filter:fv,WebkitFilter:fv},TD=t=>Sz[t];function CD(t,e){let r=TD(t);return r!==fv&&(r=Mo),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const Tz=new Set(["auto","none","0"]);function Cz(t,e,r){let n=0,s;for(;n<t.length&&!s;){const i=t[n];typeof i=="string"&&!Tz.has(i)&&jh(i).values.length&&(s=t[n]),n++}if(s&&r)for(const i of e)t[i]=CD(r,s)}class Az extends tE{constructor(e,r,n,s,i){super(e,r,n,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let d=0;d<e.length;d++){let u=e[d];if(typeof u=="string"&&(u=u.trim(),Kb(u))){const f=wD(u,r.current);f!==void 0&&(e[d]=f),d===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!bD.has(n)||e.length!==2)return;const[s,i]=e,a=sC(s),l=sC(i);if(a!==l)if(eC(a)&&eC(l))for(let d=0;d<e.length;d++){const u=e[d];typeof u=="string"&&(e[d]=parseFloat(u))}else Ll[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||yz(e[s]))&&n.push(s);n.length&&Cz(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ll[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var l;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const i=n.length-1,a=n[i];n[i]=Ll[r](e.measureViewportBox(),window.getComputedStyle(e.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([d,u])=>{e.getValue(d).set(u)}),this.resolveNoneKeyframes()}}function Nz(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){const s=document.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const AD=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function ND(t){return VP(t)&&"offsetHeight"in t}const aC=30,Iz=t=>!isNaN(parseFloat(t));class Rz{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var i;const s=os.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=os.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=Iz(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new Hb);const n=this.events[e].add(r);return e==="change"?()=>{n(),cr.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=os.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>aC)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,aC);return HP(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Pu(t,e){return new Rz(t,e)}const{schedule:sE,cancel:Aae}=tD(queueMicrotask,!1),fi={x:!1,y:!1};function ID(){return fi.x||fi.y}function _z(t){return t==="x"||t==="y"?fi[t]?null:(fi[t]=!0,()=>{fi[t]=!1}):fi.x||fi.y?null:(fi.x=fi.y=!0,()=>{fi.x=fi.y=!1})}function RD(t,e){const r=Nz(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function oC(t){return!(t.pointerType==="touch"||ID())}function Lz(t,e,r={}){const[n,s,i]=RD(t,r),a=l=>{if(!oC(l))return;const{target:d}=l,u=e(d,l);if(typeof u!="function"||!d)return;const f=p=>{oC(p)&&(u(p),d.removeEventListener("pointerleave",f))};d.addEventListener("pointerleave",f,s)};return n.forEach(l=>{l.addEventListener("pointerenter",a,s)}),i}const _D=(t,e)=>e?t===e?!0:_D(t,e.parentElement):!1,iE=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Pz=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Dz(t){return Pz.has(t.tagName)||t.tabIndex!==-1}const Jm=new WeakSet;function lC(t){return e=>{e.key==="Enter"&&t(e)}}function Kx(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const kz=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=lC(()=>{if(Jm.has(r))return;Kx(r,"down");const s=lC(()=>{Kx(r,"up")}),i=()=>Kx(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",i,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function cC(t){return iE(t)&&!ID()}function jz(t,e,r={}){const[n,s,i]=RD(t,r),a=l=>{const d=l.currentTarget;if(!cC(l))return;Jm.add(d);const u=e(d,l),f=(v,E)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",y),Jm.has(d)&&Jm.delete(d),cC(v)&&typeof u=="function"&&u(v,{success:E})},p=v=>{f(v,d===window||d===document||r.useGlobalTarget||_D(d,v.target))},y=v=>{f(v,!1)};window.addEventListener("pointerup",p,s),window.addEventListener("pointercancel",y,s)};return n.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",a,s),ND(l)&&(l.addEventListener("focus",u=>kz(u,s)),!Dz(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),i}function LD(t){return VP(t)&&"ownerSVGElement"in t}function Mz(t){return LD(t)&&t.tagName==="svg"}const On=t=>!!(t&&t.getVelocity),Oz=[...SD,Vr,Mo],Fz=t=>Oz.find(ED(t)),aE=C.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function uC(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function Bz(...t){return e=>{let r=!1;const n=t.map(s=>{const i=uC(s,e);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let s=0;s<n.length;s++){const i=n[s];typeof i=="function"?i():uC(t[s],null)}}}}function Uz(...t){return C.useCallback(Bz(...t),t)}class $z extends C.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=ND(n)&&n.offsetWidth||0,i=this.props.sizeRef.current;i.height=r.offsetHeight||0,i.width=r.offsetWidth||0,i.top=r.offsetTop,i.left=r.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Vz({children:t,isPresent:e,anchorX:r,root:n}){const s=C.useId(),i=C.useRef(null),a=C.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=C.useContext(aE),d=Uz(i,t==null?void 0:t.ref);return C.useInsertionEffect(()=>{const{width:u,height:f,top:p,left:y,right:v}=a.current;if(e||!i.current||!u||!f)return;const E=r==="left"?`left: ${y}`:`right: ${v}`;i.current.dataset.motionPopId=s;const b=document.createElement("style");l&&(b.nonce=l);const T=n??document.head;return T.appendChild(b),b.sheet&&b.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${f}px !important;
            ${E}px !important;
            top: ${p}px !important;
          }
        `),()=>{T.contains(b)&&T.removeChild(b)}},[e]),o.jsx($z,{isPresent:e,childRef:i,sizeRef:a,children:C.cloneElement(t,{ref:d})})}const Gz=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:a,anchorX:l,root:d})=>{const u=Bb(Hz),f=C.useId();let p=!0,y=C.useMemo(()=>(p=!1,{id:f,initial:e,isPresent:r,custom:s,onExitComplete:v=>{u.set(v,!0);for(const E of u.values())if(!E)return;n&&n()},register:v=>(u.set(v,!1),()=>u.delete(v))}),[r,u,n]);return i&&p&&(y={...y}),C.useMemo(()=>{u.forEach((v,E)=>u.set(E,!1))},[r]),C.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),a==="popLayout"&&(t=o.jsx(Vz,{isPresent:r,anchorX:l,root:d,children:t})),o.jsx(fg.Provider,{value:y,children:t})};function Hz(){return new Map}function PD(t=!0){const e=C.useContext(fg);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,i=C.useId();C.useEffect(()=>{if(t)return s(i)},[t]);const a=C.useCallback(()=>t&&n&&n(i),[i,n,t]);return!r&&n?[!1,a]:[!0]}const um=t=>t.key||"";function dC(t){const e=[];return C.Children.forEach(t,r=>{C.isValidElement(r)&&e.push(r)}),e}const oE=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:l="left",root:d})=>{const[u,f]=PD(a),p=C.useMemo(()=>dC(t),[t]),y=a&&!u?[]:p.map(um),v=C.useRef(!0),E=C.useRef(p),b=Bb(()=>new Map),[T,I]=C.useState(p),[N,A]=C.useState(p);UP(()=>{v.current=!1,E.current=p;for(let k=0;k<N.length;k++){const D=um(N[k]);y.includes(D)?b.delete(D):b.get(D)!==!0&&b.set(D,!1)}},[N,y.length,y.join("-")]);const L=[];if(p!==T){let k=[...p];for(let D=0;D<N.length;D++){const O=N[D],F=um(O);y.includes(F)||(k.splice(D,0,O),L.push(O))}return i==="wait"&&L.length&&(k=L),A(dC(k)),I(p),null}const{forceRender:P}=C.useContext(Fb);return o.jsx(o.Fragment,{children:N.map(k=>{const D=um(k),O=a&&!u?!1:p===N||y.includes(D),F=()=>{if(b.has(D))b.set(D,!0);else return;let $=!0;b.forEach(G=>{G||($=!1)}),$&&(P==null||P(),A(E.current),a&&(f==null||f()),n&&n())};return o.jsx(Gz,{isPresent:O,initial:!v.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:i,root:d,onExitComplete:O?void 0:F,anchorX:l,children:k},D)})})},DD=C.createContext({strict:!1}),hC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Du={};for(const t in hC)Du[t]={isEnabled:e=>hC[t].some(r=>!!e[r])};function zz(t){for(const e in t)Du[e]={...Du[e],...t[e]}}const Wz=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function J0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Wz.has(t)}let kD=t=>!J0(t);function Kz(t){typeof t=="function"&&(kD=e=>e.startsWith("on")?!J0(e):t(e))}try{Kz(require("@emotion/is-prop-valid").default)}catch{}function Yz(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(kD(s)||r===!0&&J0(s)||!e&&!J0(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const mg=C.createContext({});function pg(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Mh(t){return typeof t=="string"||Array.isArray(t)}const lE=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],cE=["initial",...lE];function gg(t){return pg(t.animate)||cE.some(e=>Mh(t[e]))}function jD(t){return!!(gg(t)||t.variants)}function qz(t,e){if(gg(t)){const{initial:r,animate:n}=t;return{initial:r===!1||Mh(r)?r:void 0,animate:Mh(n)?n:void 0}}return t.inherit!==!1?e:{}}function Xz(t){const{initial:e,animate:r}=qz(t,C.useContext(mg));return C.useMemo(()=>({initial:e,animate:r}),[fC(e),fC(r)])}function fC(t){return Array.isArray(t)?t.join(" "):t}function mC(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Rd={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(ot.test(t))t=parseFloat(t);else return t;const r=mC(t,e.target.x),n=mC(t,e.target.y);return`${r}% ${n}%`}},Qz={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=Mo.parse(t);if(s.length>5)return n;const i=Mo.createTransformer(t),a=typeof s[0]!="number"?1:0,l=r.x.scale*e.x,d=r.y.scale*e.y;s[0+a]/=l,s[1+a]/=d;const u=gr(l,d,.5);return typeof s[2+a]=="number"&&(s[2+a]/=u),typeof s[3+a]=="number"&&(s[3+a]/=u),i(s)}},mv={borderRadius:{...Rd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Rd,borderTopRightRadius:Rd,borderBottomLeftRadius:Rd,borderBottomRightRadius:Rd,boxShadow:Qz};function MD(t,{layout:e,layoutId:r}){return ed.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!mv[t]||t==="opacity")}const Zz={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Jz=Ju.length;function eW(t,e,r){let n="",s=!0;for(let i=0;i<Jz;i++){const a=Ju[i],l=t[a];if(l===void 0)continue;let d=!0;if(typeof l=="number"?d=l===(a.startsWith("scale")?1:0):d=parseFloat(l)===0,!d||r){const u=AD(l,nE[a]);if(!d){s=!1;const f=Zz[a]||a;n+=`${f}(${u}) `}r&&(e[a]=u)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function uE(t,e,r){const{style:n,vars:s,transformOrigin:i}=t;let a=!1,l=!1;for(const d in e){const u=e[d];if(ed.has(d)){a=!0;continue}else if(nD(d)){s[d]=u;continue}else{const f=AD(u,nE[d]);d.startsWith("origin")?(l=!0,i[d]=f):n[d]=f}}if(e.transform||(a||r?n.transform=eW(e,t.transform,r):n.transform&&(n.transform="none")),l){const{originX:d="50%",originY:u="50%",originZ:f=0}=i;n.transformOrigin=`${d} ${u} ${f}`}}const dE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function OD(t,e,r){for(const n in e)!On(e[n])&&!MD(n,r)&&(t[n]=e[n])}function tW({transformTemplate:t},e){return C.useMemo(()=>{const r=dE();return uE(r,e,t),Object.assign({},r.vars,r.style)},[e])}function rW(t,e){const r=t.style||{},n={};return OD(n,r,t),Object.assign(n,tW(t,e)),n}function nW(t,e){const r={},n=rW(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const sW={offset:"stroke-dashoffset",array:"stroke-dasharray"},iW={offset:"strokeDashoffset",array:"strokeDasharray"};function aW(t,e,r=1,n=0,s=!0){t.pathLength=1;const i=s?sW:iW;t[i.offset]=ot.transform(-n);const a=ot.transform(e),l=ot.transform(r);t[i.array]=`${a} ${l}`}function FD(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...l},d,u,f){if(uE(t,l,u),d){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:p,style:y}=t;p.transform&&(y.transform=p.transform,delete p.transform),(y.transform||p.transformOrigin)&&(y.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),y.transform&&(y.transformBox=(f==null?void 0:f.transformBox)??"fill-box",delete p.transformBox),e!==void 0&&(p.x=e),r!==void 0&&(p.y=r),n!==void 0&&(p.scale=n),s!==void 0&&aW(p,s,i,a,!1)}const BD=()=>({...dE(),attrs:{}}),UD=t=>typeof t=="string"&&t.toLowerCase()==="svg";function oW(t,e,r,n){const s=C.useMemo(()=>{const i=BD();return FD(i,e,UD(n),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};OD(i,t.style,t),s.style={...i,...s.style}}return s}const lW=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hE(t){return typeof t!="string"||t.includes("-")?!1:!!(lW.indexOf(t)>-1||/[A-Z]/u.test(t))}function cW(t,e,r,{latestValues:n},s,i=!1){const l=(hE(t)?oW:nW)(e,n,s,t),d=Yz(e,typeof t=="string",i),u=t!==C.Fragment?{...d,...l,ref:r}:{},{children:f}=e,p=C.useMemo(()=>On(f)?f.get():f,[f]);return C.createElement(t,{...u,children:p})}function pC(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function fE(t,e,r,n){if(typeof e=="function"){const[s,i]=pC(n);e=e(r!==void 0?r:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=pC(n);e=e(r!==void 0?r:t.custom,s,i)}return e}function e0(t){return On(t)?t.get():t}function uW({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:dW(r,n,s,t),renderState:e()}}function dW(t,e,r,n){const s={},i=n(t,{});for(const y in i)s[y]=e0(i[y]);let{initial:a,animate:l}=t;const d=gg(t),u=jD(t);e&&u&&!d&&t.inherit!==!1&&(a===void 0&&(a=e.initial),l===void 0&&(l=e.animate));let f=r?r.initial===!1:!1;f=f||a===!1;const p=f?l:a;if(p&&typeof p!="boolean"&&!pg(p)){const y=Array.isArray(p)?p:[p];for(let v=0;v<y.length;v++){const E=fE(t,y[v]);if(E){const{transitionEnd:b,transition:T,...I}=E;for(const N in I){let A=I[N];if(Array.isArray(A)){const L=f?A.length-1:0;A=A[L]}A!==null&&(s[N]=A)}for(const N in b)s[N]=b[N]}}}return s}const $D=t=>(e,r)=>{const n=C.useContext(mg),s=C.useContext(fg),i=()=>uW(t,e,n,s);return r?i():Bb(i)};function mE(t,e,r){var i;const{style:n}=t,s={};for(const a in n)(On(n[a])||e.style&&On(e.style[a])||MD(a,t)||((i=r==null?void 0:r.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=n[a]);return s}const hW=$D({scrapeMotionValuesFromProps:mE,createRenderState:dE});function VD(t,e,r){const n=mE(t,e,r);for(const s in t)if(On(t[s])||On(e[s])){const i=Ju.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[i]=t[s]}return n}const fW=$D({scrapeMotionValuesFromProps:VD,createRenderState:BD}),mW=Symbol.for("motionComponentSymbol");function Hc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function pW(t,e,r){return C.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):Hc(r)&&(r.current=n))},[e])}const pE=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),gW="framerAppearId",GD="data-"+pE(gW),HD=C.createContext({});function xW(t,e,r,n,s){var b,T;const{visualElement:i}=C.useContext(mg),a=C.useContext(DD),l=C.useContext(fg),d=C.useContext(aE).reducedMotion,u=C.useRef(null);n=n||a.renderer,!u.current&&n&&(u.current=n(t,{visualState:e,parent:i,props:r,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:d}));const f=u.current,p=C.useContext(HD);f&&!f.projection&&s&&(f.type==="html"||f.type==="svg")&&yW(u.current,r,s,p);const y=C.useRef(!1);C.useInsertionEffect(()=>{f&&y.current&&f.update(r,l)});const v=r[GD],E=C.useRef(!!v&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,v))&&((T=window.MotionHasOptimisedAnimation)==null?void 0:T.call(window,v)));return UP(()=>{f&&(y.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),E.current&&f.animationState&&f.animationState.animateChanges())}),C.useEffect(()=>{f&&(!E.current&&f.animationState&&f.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var I;(I=window.MotionHandoffMarkAsComplete)==null||I.call(window,v)}),E.current=!1),f.enteringChildren=void 0)}),f}function yW(t,e,r,n){const{layoutId:s,layout:i,drag:a,dragConstraints:l,layoutScroll:d,layoutRoot:u,layoutCrossfade:f}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:zD(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||l&&Hc(l),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,crossfade:f,layoutScroll:d,layoutRoot:u})}function zD(t){if(t)return t.options.allowProjection!==!1?t.projection:zD(t.parent)}function Yx(t,{forwardMotionProps:e=!1}={},r,n){r&&zz(r);const s=hE(t)?fW:hW;function i(l,d){let u;const f={...C.useContext(aE),...l,layoutId:vW(l)},{isStatic:p}=f,y=Xz(l),v=s(l,p);if(!p&&Ub){wW();const E=bW(f);u=E.MeasureLayout,y.visualElement=xW(t,v,f,n,E.ProjectionNode)}return o.jsxs(mg.Provider,{value:y,children:[u&&y.visualElement?o.jsx(u,{visualElement:y.visualElement,...f}):null,cW(t,l,pW(v,y.visualElement,d),v,p,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=C.forwardRef(i);return a[mW]=t,a}function vW({layoutId:t}){const e=C.useContext(Fb).id;return e&&t!==void 0?e+"-"+t:t}function wW(t,e){C.useContext(DD).strict}function bW(t){const{drag:e,layout:r}=Du;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function EW(t,e){if(typeof Proxy>"u")return Yx;const r=new Map,n=(i,a)=>Yx(i,a,t,e),s=(i,a)=>n(i,a);return new Proxy(s,{get:(i,a)=>a==="create"?n:(r.has(a)||r.set(a,Yx(a,void 0,t,e)),r.get(a))})}function WD({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function SW({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function TW(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function qx(t){return t===void 0||t===1}function pv({scale:t,scaleX:e,scaleY:r}){return!qx(t)||!qx(e)||!qx(r)}function ul(t){return pv(t)||KD(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function KD(t){return gC(t.x)||gC(t.y)}function gC(t){return t&&t!=="0%"}function ep(t,e,r){const n=t-r,s=e*n;return r+s}function xC(t,e,r,n,s){return s!==void 0&&(t=ep(t,s,n)),ep(t,r,n)+e}function gv(t,e=0,r=1,n,s){t.min=xC(t.min,e,r,n,s),t.max=xC(t.max,e,r,n,s)}function YD(t,{x:e,y:r}){gv(t.x,e.translate,e.scale,e.originPoint),gv(t.y,r.translate,r.scale,r.originPoint)}const yC=.999999999999,vC=1.0000000000001;function CW(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let i,a;for(let l=0;l<s;l++){i=r[l],a=i.projectionDelta;const{visualElement:d}=i.options;d&&d.props.style&&d.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Wc(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,YD(t,a)),n&&ul(i.latestValues)&&Wc(t,i.latestValues))}e.x<vC&&e.x>yC&&(e.x=1),e.y<vC&&e.y>yC&&(e.y=1)}function zc(t,e){t.min=t.min+e,t.max=t.max+e}function wC(t,e,r,n,s=.5){const i=gr(t.min,t.max,s);gv(t,e,r,i,n)}function Wc(t,e){wC(t.x,e.x,e.scaleX,e.scale,e.originX),wC(t.y,e.y,e.scaleY,e.scale,e.originY)}function qD(t,e){return WD(TW(t.getBoundingClientRect(),e))}function AW(t,e,r){const n=qD(t,r),{scroll:s}=e;return s&&(zc(n.x,s.offset.x),zc(n.y,s.offset.y)),n}const bC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Kc=()=>({x:bC(),y:bC()}),EC=()=>({min:0,max:0}),Qr=()=>({x:EC(),y:EC()}),xv={current:null},XD={current:!1};function NW(){if(XD.current=!0,!!Ub)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>xv.current=t.matches;t.addEventListener("change",e),e()}else xv.current=!1}const IW=new WeakMap;function RW(t,e,r){for(const n in e){const s=e[n],i=r[n];if(On(s))t.addValue(n,s);else if(On(i))t.addValue(n,Pu(s,{owner:t}));else if(i!==s)if(t.hasValue(n)){const a=t.getValue(n);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=t.getStaticValue(n);t.addValue(n,Pu(a!==void 0?a:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const SC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class _W{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=tE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const y=os.now();this.renderScheduledAt<y&&(this.renderScheduledAt=y,cr.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=a;this.latestValues=d,this.baseTarget={...d},this.initialValues=r.initial?{...d}:{},this.renderState=u,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=gg(r),this.isVariantNode=jD(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...p}=this.scrapeMotionValuesFromProps(r,{},this);for(const y in p){const v=p[y];d[y]!==void 0&&On(v)&&v.set(d[y])}}mount(e){var r;this.current=e,IW.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),XD.current||NW(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:xv.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),jo(this.notifyUpdate),jo(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=ed.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&cr.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),i&&i(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Du){const r=Du[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Qr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<SC.length;n++){const s=SC[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=e[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=RW(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Pu(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&($P(n)||GP(n))?n=parseFloat(n):!Fz(n)&&Mo.test(r)&&(n=CD(e,r)),this.setBaseTarget(e,On(n)?n.get():n)),On(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var i;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=fE(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);a&&(n=a[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!On(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new Hb),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){sE.render(this.render)}}class QD extends _W{constructor(){super(...arguments),this.KeyframeResolver=Az}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;On(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function ZD(t,{style:e,vars:r},n,s){const i=t.style;let a;for(a in e)i[a]=e[a];s==null||s.applyProjectionStyles(i,n);for(a in r)i.setProperty(a,r[a])}function LW(t){return window.getComputedStyle(t)}class PW extends QD{constructor(){super(...arguments),this.type="html",this.renderInstance=ZD}readValueFromInstance(e,r){var n;if(ed.has(r))return(n=this.projection)!=null&&n.isProjecting?ov(r):zH(e,r);{const s=LW(e),i=(nD(r)?s.getPropertyValue(r):s[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:r}){return qD(e,r)}build(e,r,n){uE(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return mE(e,r,n)}}const JD=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function DW(t,e,r,n){ZD(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(JD.has(s)?s:pE(s),e.attrs[s])}class kW extends QD{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Qr}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(ed.has(r)){const n=TD(r);return n&&n.default||0}return r=JD.has(r)?r:pE(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return VD(e,r,n)}build(e,r,n){FD(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){DW(e,r,n,s)}mount(e){this.isSVGTag=UD(e.tagName),super.mount(e)}}const jW=(t,e)=>hE(t)?new kW(e):new PW(e,{allowProjection:t!==C.Fragment});function au(t,e,r){const n=t.getProps();return fE(n,e,r!==void 0?r:n.custom,t)}const yv=t=>Array.isArray(t);function MW(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Pu(r))}function OW(t){return yv(t)?t[t.length-1]||0:t}function FW(t,e){const r=au(t,e);let{transitionEnd:n={},transition:s={},...i}=r||{};i={...i,...n};for(const a in i){const l=OW(i[a]);MW(t,a,l)}}function BW(t){return!!(On(t)&&t.add)}function vv(t,e){const r=t.getValue("willChange");if(BW(r))return r.add(e);if(!r&&ja.WillChange){const n=new ja.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function e3(t){return t.props[GD]}const UW=t=>t!==null;function $W(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(UW),i=e&&r!=="loop"&&e%2===1?0:s.length-1;return!i||n===void 0?s[i]:n}const VW={type:"spring",stiffness:500,damping:25,restSpeed:10},GW=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),HW={type:"keyframes",duration:.8},zW={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},WW=(t,{keyframes:e})=>e.length>2?HW:ed.has(t)?t.startsWith("scale")?GW(e[1]):VW:zW;function KW({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:l,from:d,elapsed:u,...f}){return!!Object.keys(f).length}const gE=(t,e,r,n={},s,i)=>a=>{const l=rE(n,t)||{},d=l.delay||n.delay||0;let{elapsed:u=0}=n;u=u-na(d);const f={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-u,onUpdate:y=>{e.set(y),l.onUpdate&&l.onUpdate(y)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:i?void 0:s};KW(l)||Object.assign(f,WW(t,f)),f.duration&&(f.duration=na(f.duration)),f.repeatDelay&&(f.repeatDelay=na(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(hv(f),f.delay===0&&(p=!0)),(ja.instantAnimations||ja.skipAnimations)&&(p=!0,hv(f),f.delay=0),f.allowFlatten=!l.type&&!l.ease,p&&!i&&e.get()!==void 0){const y=$W(f.keyframes,l);if(y!==void 0){cr.update(()=>{f.onUpdate(y),f.onComplete()});return}}return l.isSync?new eE(f):new mz(f)};function YW({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function t3(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:a,...l}=e;n&&(i=n);const d=[],u=s&&t.animationState&&t.animationState.getState()[s];for(const f in l){const p=t.getValue(f,t.latestValues[f]??null),y=l[f];if(y===void 0||u&&YW(u,f))continue;const v={delay:r,...rE(i||{},f)},E=p.get();if(E!==void 0&&!p.isAnimating&&!Array.isArray(y)&&y===E&&!v.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const I=e3(t);if(I){const N=window.MotionHandoffAnimation(I,f,cr);N!==null&&(v.startTime=N,b=!0)}}vv(t,f),p.start(gE(f,p,y,t.shouldReduceMotion&&bD.has(f)?{type:!1}:v,t,b));const T=p.animation;T&&d.push(T)}return a&&Promise.all(d).then(()=>{cr.update(()=>{a&&FW(t,a)})}),d}function r3(t,e,r,n=0,s=1){const i=Array.from(t).sort((u,f)=>u.sortNodePosition(f)).indexOf(e),a=t.size,l=(a-1)*n;return typeof r=="function"?r(i,a):s===1?i*n:l-i*n}function wv(t,e,r={}){var d;const n=au(t,e,r.type==="exit"?(d=t.presenceContext)==null?void 0:d.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const i=n?()=>Promise.all(t3(t,n,r)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:f=0,staggerChildren:p,staggerDirection:y}=s;return qW(t,e,u,f,p,y,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,f]=l==="beforeChildren"?[i,a]:[a,i];return u().then(()=>f())}else return Promise.all([i(),a(r.delay)])}function qW(t,e,r=0,n=0,s=0,i=1,a){const l=[];for(const d of t.variantChildren)d.notify("AnimationStart",e),l.push(wv(d,e,{...a,delay:r+(typeof n=="function"?0:n)+r3(t.variantChildren,d,n,s,i)}).then(()=>d.notify("AnimationComplete",e)));return Promise.all(l)}function XW(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(i=>wv(t,i,r));n=Promise.all(s)}else if(typeof e=="string")n=wv(t,e,r);else{const s=typeof e=="function"?au(t,e,r.custom):e;n=Promise.all(t3(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function n3(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const QW=cE.length;function s3(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?s3(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<QW;r++){const n=cE[r],s=t.props[n];(Mh(s)||s===!1)&&(e[n]=s)}return e}const ZW=[...lE].reverse(),JW=lE.length;function eK(t){return e=>Promise.all(e.map(({animation:r,options:n})=>XW(t,r,n)))}function tK(t){let e=eK(t),r=TC(),n=!0;const s=d=>(u,f)=>{var y;const p=au(t,f,d==="exit"?(y=t.presenceContext)==null?void 0:y.custom:void 0);if(p){const{transition:v,transitionEnd:E,...b}=p;u={...u,...b,...E}}return u};function i(d){e=d(t)}function a(d){const{props:u}=t,f=s3(t.parent)||{},p=[],y=new Set;let v={},E=1/0;for(let T=0;T<JW;T++){const I=ZW[T],N=r[I],A=u[I]!==void 0?u[I]:f[I],L=Mh(A),P=I===d?N.isActive:null;P===!1&&(E=T);let k=A===f[I]&&A!==u[I]&&L;if(k&&n&&t.manuallyAnimateOnMount&&(k=!1),N.protectedKeys={...v},!N.isActive&&P===null||!A&&!N.prevProp||pg(A)||typeof A=="boolean")continue;const D=rK(N.prevProp,A);let O=D||I===d&&N.isActive&&!k&&L||T>E&&L,F=!1;const $=Array.isArray(A)?A:[A];let G=$.reduce(s(I),{});P===!1&&(G={});const{prevResolvedValues:Y={}}=N,ne={...Y,...G},X=ee=>{O=!0,y.has(ee)&&(F=!0,y.delete(ee)),N.needsAnimating[ee]=!0;const q=t.getValue(ee);q&&(q.liveStyle=!1)};for(const ee in ne){const q=G[ee],K=Y[ee];if(v.hasOwnProperty(ee))continue;let ae=!1;yv(q)&&yv(K)?ae=!n3(q,K):ae=q!==K,ae?q!=null?X(ee):y.add(ee):q!==void 0&&y.has(ee)?X(ee):N.protectedKeys[ee]=!0}N.prevProp=A,N.prevResolvedValues=G,N.isActive&&(v={...v,...G}),n&&t.blockInitialAnimation&&(O=!1);const z=k&&D;O&&(!z||F)&&p.push(...$.map(ee=>{const q={type:I};if(typeof ee=="string"&&n&&!z&&t.manuallyAnimateOnMount&&t.parent){const{parent:K}=t,ae=au(K,ee);if(K.enteringChildren&&ae){const{delayChildren:Q}=ae.transition||{};q.delay=r3(K.enteringChildren,t,Q)}}return{animation:ee,options:q}}))}if(y.size){const T={};if(typeof u.initial!="boolean"){const I=au(t,Array.isArray(u.initial)?u.initial[0]:u.initial);I&&I.transition&&(T.transition=I.transition)}y.forEach(I=>{const N=t.getBaseTarget(I),A=t.getValue(I);A&&(A.liveStyle=!0),T[I]=N??null}),p.push({animation:T})}let b=!!p.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(b=!1),n=!1,b?e(p):Promise.resolve()}function l(d,u){var p;if(r[d].isActive===u)return Promise.resolve();(p=t.variantChildren)==null||p.forEach(y=>{var v;return(v=y.animationState)==null?void 0:v.setActive(d,u)}),r[d].isActive=u;const f=a(d);for(const y in r)r[y].protectedKeys={};return f}return{animateChanges:a,setActive:l,setAnimateFunction:i,getState:()=>r,reset:()=>{r=TC()}}}function rK(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!n3(e,t):!1}function il(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function TC(){return{animate:il(!0),whileInView:il(),whileHover:il(),whileTap:il(),whileDrag:il(),whileFocus:il(),exit:il()}}class Yo{constructor(e){this.isMounted=!1,this.node=e}update(){}}class nK extends Yo{constructor(e){super(e),e.animationState||(e.animationState=tK(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();pg(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let sK=0;class iK extends Yo{constructor(){super(...arguments),this.id=sK++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const aK={animation:{Feature:nK},exit:{Feature:iK}};function Oh(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function wf(t){return{point:{x:t.pageX,y:t.pageY}}}const oK=t=>e=>iE(e)&&t(e,wf(e));function Qd(t,e,r,n){return Oh(t,e,oK(r),n)}const i3=1e-4,lK=1-i3,cK=1+i3,a3=.01,uK=0-a3,dK=0+a3;function zn(t){return t.max-t.min}function hK(t,e,r){return Math.abs(t-e)<=r}function CC(t,e,r,n=.5){t.origin=n,t.originPoint=gr(e.min,e.max,t.origin),t.scale=zn(r)/zn(e),t.translate=gr(r.min,r.max,t.origin)-t.originPoint,(t.scale>=lK&&t.scale<=cK||isNaN(t.scale))&&(t.scale=1),(t.translate>=uK&&t.translate<=dK||isNaN(t.translate))&&(t.translate=0)}function Zd(t,e,r,n){CC(t.x,e.x,r.x,n?n.originX:void 0),CC(t.y,e.y,r.y,n?n.originY:void 0)}function AC(t,e,r){t.min=r.min+e.min,t.max=t.min+zn(e)}function fK(t,e,r){AC(t.x,e.x,r.x),AC(t.y,e.y,r.y)}function NC(t,e,r){t.min=e.min-r.min,t.max=t.min+zn(e)}function tp(t,e,r){NC(t.x,e.x,r.x),NC(t.y,e.y,r.y)}function Hs(t){return[t("x"),t("y")]}const o3=({current:t})=>t?t.ownerDocument.defaultView:null,IC=(t,e)=>Math.abs(t-e);function mK(t,e){const r=IC(t.x,e.x),n=IC(t.y,e.y);return Math.sqrt(r**2+n**2)}class l3{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:i=!1,distanceThreshold:a=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=Qx(this.lastMoveEventInfo,this.history),v=this.startEvent!==null,E=mK(y.offset,{x:0,y:0})>=this.distanceThreshold;if(!v&&!E)return;const{point:b}=y,{timestamp:T}=yn;this.history.push({...b,timestamp:T});const{onStart:I,onMove:N}=this.handlers;v||(I&&I(this.lastMoveEvent,y),this.startEvent=this.lastMoveEvent),N&&N(this.lastMoveEvent,y)},this.handlePointerMove=(y,v)=>{this.lastMoveEvent=y,this.lastMoveEventInfo=Xx(v,this.transformPagePoint),cr.update(this.updatePoint,!0)},this.handlePointerUp=(y,v)=>{this.end();const{onEnd:E,onSessionEnd:b,resumeAnimation:T}=this.handlers;if(this.dragSnapToOrigin&&T&&T(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const I=Qx(y.type==="pointercancel"?this.lastMoveEventInfo:Xx(v,this.transformPagePoint),this.history);this.startEvent&&E&&E(y,I),b&&b(y,I)},!iE(e))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=a,this.contextWindow=s||window;const l=wf(e),d=Xx(l,this.transformPagePoint),{point:u}=d,{timestamp:f}=yn;this.history=[{...u,timestamp:f}];const{onSessionStart:p}=r;p&&p(e,Qx(d,this.history)),this.removeListeners=xf(Qd(this.contextWindow,"pointermove",this.handlePointerMove),Qd(this.contextWindow,"pointerup",this.handlePointerUp),Qd(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),jo(this.updatePoint)}}function Xx(t,e){return e?{point:e(t.point)}:t}function RC(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Qx({point:t},e){return{point:t,delta:RC(t,c3(e)),offset:RC(t,pK(e)),velocity:gK(e,.1)}}function pK(t){return t[0]}function c3(t){return t[t.length-1]}function gK(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=c3(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>na(e)));)r--;if(!n)return{x:0,y:0};const i=Xs(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function xK(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?gr(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?gr(r,t,n.max):Math.min(t,r)),t}function _C(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function yK(t,{top:e,left:r,bottom:n,right:s}){return{x:_C(t.x,r,s),y:_C(t.y,e,n)}}function LC(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function vK(t,e){return{x:LC(t.x,e.x),y:LC(t.y,e.y)}}function wK(t,e){let r=.5;const n=zn(t),s=zn(e);return s>n?r=Dh(e.min,e.max-n,t.min):n>s&&(r=Dh(t.min,t.max-s,e.min)),ka(0,1,r)}function bK(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const bv=.35;function EK(t=bv){return t===!1?t=0:t===!0&&(t=bv),{x:PC(t,"left","right"),y:PC(t,"top","bottom")}}function PC(t,e,r){return{min:DC(t,e),max:DC(t,r)}}function DC(t,e){return typeof t=="number"?t:t[e]||0}const SK=new WeakMap;class TK{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Qr(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const i=p=>{const{dragSnapToOrigin:y}=this.getProps();y?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(wf(p).point)},a=(p,y)=>{const{drag:v,dragPropagation:E,onDragStart:b}=this.getProps();if(v&&!E&&(this.openDragLock&&this.openDragLock(),this.openDragLock=_z(v),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=y,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Hs(I=>{let N=this.getAxisMotionValue(I).get()||0;if(sa.test(N)){const{projection:A}=this.visualElement;if(A&&A.layout){const L=A.layout.layoutBox[I];L&&(N=zn(L)*(parseFloat(N)/100))}}this.originPoint[I]=N}),b&&cr.postRender(()=>b(p,y)),vv(this.visualElement,"transform");const{animationState:T}=this.visualElement;T&&T.setActive("whileDrag",!0)},l=(p,y)=>{this.latestPointerEvent=p,this.latestPanInfo=y;const{dragPropagation:v,dragDirectionLock:E,onDirectionLock:b,onDrag:T}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:I}=y;if(E&&this.currentDirection===null){this.currentDirection=CK(I),this.currentDirection!==null&&b&&b(this.currentDirection);return}this.updateAxis("x",y.point,I),this.updateAxis("y",y.point,I),this.visualElement.render(),T&&T(p,y)},d=(p,y)=>{this.latestPointerEvent=p,this.latestPanInfo=y,this.stop(p,y),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Hs(p=>{var y;return this.getAnimationState(p)==="paused"&&((y=this.getAxisMotionValue(p).animation)==null?void 0:y.play())}),{dragSnapToOrigin:f}=this.getProps();this.panSession=new l3(e,{onSessionStart:i,onStart:a,onMove:l,onSessionEnd:d,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:n,contextWindow:o3(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!s||!n)return;const{velocity:a}=s;this.startAnimation(a);const{onDragEnd:l}=this.getProps();l&&cr.postRender(()=>l(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!dm(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=xK(a,this.constraints[e],this.elastic[e])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;e&&Hc(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=yK(n.layoutBox,e):this.constraints=!1,this.elastic=EK(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Hs(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=bK(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!Hc(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=AW(n,s.root,this.visualElement.getTransformPagePoint());let a=vK(s.layout.layoutBox,i);if(r){const l=r(SW(a));this.hasMutatedConstraints=!!l,l&&(a=WD(l))}return a}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),d=this.constraints||{},u=Hs(f=>{if(!dm(f,r,this.currentDirection))return;let p=d&&d[f]||{};a&&(p={min:0,max:0});const y=s?200:1e6,v=s?40:1e7,E={type:"inertia",velocity:n?e[f]:0,bounceStiffness:y,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...i,...p};return this.startAxisValueAnimation(f,E)});return Promise.all(u).then(l)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return vv(this.visualElement,e),n.start(gE(e,n,0,r,this.visualElement,!1))}stopAnimation(){Hs(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Hs(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){Hs(r=>{const{drag:n}=this.getProps();if(!dm(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:a,max:l}=s.layout.layoutBox[r];i.set(e[r]-gr(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Hc(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Hs(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const d=l.get();s[a]=wK({min:d,max:d},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Hs(a=>{if(!dm(a,e,null))return;const l=this.getAxisMotionValue(a),{min:d,max:u}=this.constraints[a];l.set(gr(d,u,s[a]))})}addListeners(){if(!this.visualElement.current)return;SK.set(this.visualElement,this);const e=this.visualElement.current,r=Qd(e,"pointerdown",d=>{const{drag:u,dragListener:f=!0}=this.getProps();u&&f&&this.start(d)}),n=()=>{const{dragConstraints:d}=this.getProps();Hc(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),cr.read(n);const a=Oh(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:d,hasLayoutChanged:u})=>{this.isDragging&&u&&(Hs(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=d[f].translate,p.set(p.get()+d[f].translate))}),this.visualElement.render())});return()=>{a(),r(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=bv,dragMomentum:l=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:l}}}function dm(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function CK(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class AK extends Yo{constructor(e){super(e),this.removeGroupControls=Zs,this.removeListeners=Zs,this.controls=new TK(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zs}unmount(){this.removeGroupControls(),this.removeListeners()}}const kC=t=>(e,r)=>{t&&cr.postRender(()=>t(e,r))};class NK extends Yo{constructor(){super(...arguments),this.removePointerDownListener=Zs}onPointerDown(e){this.session=new l3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:o3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:kC(e),onStart:kC(r),onMove:n,onEnd:(i,a)=>{delete this.session,s&&cr.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Qd(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const t0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};let Zx=!1;class IK extends C.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=e;i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),Zx&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),t0.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,{projection:a}=n;return a&&(a.isPresent=i,Zx=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==i?a.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?a.promote():a.relegate()||cr.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),sE.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;Zx=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function u3(t){const[e,r]=PD(),n=C.useContext(Fb);return o.jsx(IK,{...t,layoutGroup:n,switchLayoutGroup:C.useContext(HD),isPresent:e,safeToRemove:r})}function RK(t,e,r){const n=On(t)?t:Pu(t);return n.start(gE("",n,e,r)),n.animation}const _K=(t,e)=>t.depth-e.depth;class LK{constructor(){this.children=[],this.isDirty=!1}add(e){$b(this.children,e),this.isDirty=!0}remove(e){Vb(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(_K),this.isDirty=!1,this.children.forEach(e)}}function PK(t,e){const r=os.now(),n=({timestamp:s})=>{const i=s-r;i>=e&&(jo(n),t(i-e))};return cr.setup(n,!0),()=>jo(n)}const d3=["TopLeft","TopRight","BottomLeft","BottomRight"],DK=d3.length,jC=t=>typeof t=="string"?parseFloat(t):t,MC=t=>typeof t=="number"||ot.test(t);function kK(t,e,r,n,s,i){s?(t.opacity=gr(0,r.opacity??1,jK(n)),t.opacityExit=gr(e.opacity??1,0,MK(n))):i&&(t.opacity=gr(e.opacity??1,r.opacity??1,n));for(let a=0;a<DK;a++){const l=`border${d3[a]}Radius`;let d=OC(e,l),u=OC(r,l);if(d===void 0&&u===void 0)continue;d||(d=0),u||(u=0),d===0||u===0||MC(d)===MC(u)?(t[l]=Math.max(gr(jC(d),jC(u),n),0),(sa.test(u)||sa.test(d))&&(t[l]+="%")):t[l]=u}(e.rotate||r.rotate)&&(t.rotate=gr(e.rotate||0,r.rotate||0,n))}function OC(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const jK=h3(0,.5,QP),MK=h3(.5,.95,Zs);function h3(t,e,r){return n=>n<t?0:n>e?1:r(Dh(t,e,n))}function FC(t,e){t.min=e.min,t.max=e.max}function di(t,e){FC(t.x,e.x),FC(t.y,e.y)}function BC(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function UC(t,e,r,n,s){return t-=e,t=ep(t,1/r,n),s!==void 0&&(t=ep(t,1/s,n)),t}function OK(t,e=0,r=1,n=.5,s,i=t,a=t){if(sa.test(e)&&(e=parseFloat(e),e=gr(a.min,a.max,e/100)-a.min),typeof e!="number")return;let l=gr(i.min,i.max,n);t===i&&(l-=e),t.min=UC(t.min,e,r,l,s),t.max=UC(t.max,e,r,l,s)}function $C(t,e,[r,n,s],i,a){OK(t,e[r],e[n],e[s],e.scale,i,a)}const FK=["x","scaleX","originX"],BK=["y","scaleY","originY"];function VC(t,e,r,n){$C(t.x,e,FK,r?r.x:void 0,n?n.x:void 0),$C(t.y,e,BK,r?r.y:void 0,n?n.y:void 0)}function GC(t){return t.translate===0&&t.scale===1}function f3(t){return GC(t.x)&&GC(t.y)}function HC(t,e){return t.min===e.min&&t.max===e.max}function UK(t,e){return HC(t.x,e.x)&&HC(t.y,e.y)}function zC(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function m3(t,e){return zC(t.x,e.x)&&zC(t.y,e.y)}function WC(t){return zn(t.x)/zn(t.y)}function KC(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class $K{constructor(){this.members=[]}add(e){$b(this.members,e),e.scheduleRender()}remove(e){if(Vb(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function VK(t,e,r){let n="";const s=t.x.translate/e.x,i=t.y.translate/e.y,a=(r==null?void 0:r.z)||0;if((s||i||a)&&(n=`translate3d(${s}px, ${i}px, ${a}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:u,rotate:f,rotateX:p,rotateY:y,skewX:v,skewY:E}=r;u&&(n=`perspective(${u}px) ${n}`),f&&(n+=`rotate(${f}deg) `),p&&(n+=`rotateX(${p}deg) `),y&&(n+=`rotateY(${y}deg) `),v&&(n+=`skewX(${v}deg) `),E&&(n+=`skewY(${E}deg) `)}const l=t.x.scale*e.x,d=t.y.scale*e.y;return(l!==1||d!==1)&&(n+=`scale(${l}, ${d})`),n||"none"}const Jx=["","X","Y","Z"],GK=1e3;let HK=0;function e1(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function p3(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=e3(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",cr,!(s||i))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&p3(n)}function g3({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(a={},l=e==null?void 0:e()){this.id=HK++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(KK),this.nodes.forEach(QK),this.nodes.forEach(ZK),this.nodes.forEach(YK)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new LK)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new Hb),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const d=this.eventHandlers.get(a);d&&d.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=LD(a)&&!Mz(a),this.instance=a;const{layoutId:l,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||l)&&(this.isLayoutDirty=!0),t){let f,p=0;const y=()=>this.root.updateBlockedByResize=!1;cr.read(()=>{p=window.innerWidth}),t(a,()=>{const v=window.innerWidth;v!==p&&(p=v,this.root.updateBlockedByResize=!0,f&&f(),f=PK(y,250),t0.hasAnimatedSinceResize&&(t0.hasAnimatedSinceResize=!1,this.nodes.forEach(XC)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeLayoutChanged:y,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const E=this.options.transition||u.getDefaultTransition()||nY,{onLayoutAnimationStart:b,onLayoutAnimationComplete:T}=u.getProps(),I=!this.targetLayout||!m3(this.targetLayout,v),N=!p&&y;if(this.options.layoutRoot||this.resumeFrom||N||p&&(I||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const A={...rE(E,"layout"),onPlay:b,onComplete:T};(u.shouldReduceMotion||this.options.layoutRoot)&&(A.delay=0,A.type=!1),this.startAnimation(A),this.setAnimationOrigin(f,N)}else p||XC(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),jo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(JK),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&p3(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:l,layout:d}=this.options;if(l===void 0&&!d)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(YC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(qC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(XK),this.nodes.forEach(zK),this.nodes.forEach(WK)):this.nodes.forEach(qC),this.clearAllSnapshots();const l=os.now();yn.delta=ka(0,1e3/60,l-yn.timestamp),yn.timestamp=l,yn.isProcessing=!0,Vx.update.process(yn),Vx.preRender.process(yn),Vx.render.process(yn),yn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,sE.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(qK),this.sharedNodes.forEach(eY)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,cr.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){cr.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!zn(this.snapshot.measuredBox.x)&&!zn(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Qr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l&&this.instance){const d=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:d,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!f3(this.projectionDelta),d=this.getTransformTemplate(),u=d?d(this.latestValues,""):void 0,f=u!==this.prevTransformTemplateValue;a&&this.instance&&(l||ul(this.latestValues)||f)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let d=this.removeElementScroll(l);return a&&(d=this.removeTransform(d)),sY(d),{animationId:this.root.animationId,measuredBox:l,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:a}=this.options;if(!a)return Qr();const l=a.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(iY))){const{scroll:f}=this.root;f&&(zc(l.x,f.offset.x),zc(l.y,f.offset.y))}return l}removeElementScroll(a){var d;const l=Qr();if(di(l,a),(d=this.scroll)!=null&&d.wasRoot)return l;for(let u=0;u<this.path.length;u++){const f=this.path[u],{scroll:p,options:y}=f;f!==this.root&&p&&y.layoutScroll&&(p.wasRoot&&di(l,a),zc(l.x,p.offset.x),zc(l.y,p.offset.y))}return l}applyTransform(a,l=!1){const d=Qr();di(d,a);for(let u=0;u<this.path.length;u++){const f=this.path[u];!l&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Wc(d,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),ul(f.latestValues)&&Wc(d,f.latestValues)}return ul(this.latestValues)&&Wc(d,this.latestValues),d}removeTransform(a){const l=Qr();di(l,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];if(!u.instance||!ul(u.latestValues))continue;pv(u.latestValues)&&u.updateSnapshot();const f=Qr(),p=u.measurePageBox();di(f,p),VC(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,f)}return ul(this.latestValues)&&VC(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==yn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var v;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==l;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:p}=this.options;if(!this.layout||!(f||p))return;this.resolvedRelativeTargetAt=yn.timestamp;const y=this.getClosestProjectingParent();y&&this.linkedParentVersion!==y.layoutVersion&&!y.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(y&&y.layout?this.createRelativeTarget(y,this.layout.layoutBox,y.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Qr(),this.targetWithTransforms=Qr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),fK(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):di(this.target,this.layout.layoutBox),YD(this.target,this.targetDelta)):di(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?this.createRelativeTarget(y,this.target,y.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||pv(this.parent.latestValues)||KD(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(a,l,d){this.relativeParent=a,this.linkedParentVersion=a.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Qr(),this.relativeTargetOrigin=Qr(),tp(this.relativeTargetOrigin,l,d),di(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var E;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let d=!0;if((this.isProjectionDirty||(E=this.parent)!=null&&E.isProjectionDirty)&&(d=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===yn.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;di(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,y=this.treeScale.y;CW(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=Qr());const{target:v}=a;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(BC(this.prevProjectionDelta.x,this.projectionDelta.x),BC(this.prevProjectionDelta.y,this.projectionDelta.y)),Zd(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==y||!KC(this.projectionDelta.x,this.prevProjectionDelta.x)||!KC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),a){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Kc(),this.projectionDelta=Kc(),this.projectionDeltaWithTransform=Kc()}setAnimationOrigin(a,l=!1){const d=this.snapshot,u=d?d.latestValues:{},f={...this.latestValues},p=Kc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const y=Qr(),v=d?d.source:void 0,E=this.layout?this.layout.source:void 0,b=v!==E,T=this.getStack(),I=!T||T.members.length<=1,N=!!(b&&!I&&this.options.crossfade===!0&&!this.path.some(rY));this.animationProgress=0;let A;this.mixTargetDelta=L=>{const P=L/1e3;QC(p.x,a.x,P),QC(p.y,a.y,P),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(tp(y,this.layout.layoutBox,this.relativeParent.layout.layoutBox),tY(this.relativeTarget,this.relativeTargetOrigin,y,P),A&&UK(this.relativeTarget,A)&&(this.isProjectionDirty=!1),A||(A=Qr()),di(A,this.relativeTarget)),b&&(this.animationValues=f,kK(f,u,this.latestValues,P,N,I)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=P},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){var l,d,u;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(u=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||u.stop(),this.pendingAnimation&&(jo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=cr.update(()=>{t0.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Pu(0)),this.currentAnimation=RK(this.motionValue,[0,1e3],{...a,velocity:0,isSync:!0,onUpdate:f=>{this.mixTargetDelta(f),a.onUpdate&&a.onUpdate(f)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(GK),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:d,layout:u,latestValues:f}=a;if(!(!l||!d||!u)){if(this!==a&&this.layout&&u&&x3(this.options.animationType,this.layout.layoutBox,u.layoutBox)){d=this.target||Qr();const p=zn(this.layout.layoutBox.x);d.x.min=a.target.x.min,d.x.max=d.x.min+p;const y=zn(this.layout.layoutBox.y);d.y.min=a.target.y.min,d.y.max=d.y.min+y}di(l,d),Wc(l,f),Zd(this.projectionDeltaWithTransform,this.layoutCorrected,l,f)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new $K),this.sharedNodes.get(a).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var l;const{layoutId:a}=this.options;return a?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:a}=this.options;return a?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:d}={}){const u=this.getStack();u&&u.promote(this,d),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:d}=a;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(l=!0),!l)return;const u={};d.z&&e1("z",a,u,this.animationValues);for(let f=0;f<Jx.length;f++)e1(`rotate${Jx[f]}`,a,u,this.animationValues),e1(`skew${Jx[f]}`,a,u,this.animationValues);a.render();for(const f in u)a.setStaticValue(f,u[f]),this.animationValues&&(this.animationValues[f]=u[f]);a.scheduleRender()}applyProjectionStyles(a,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){a.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,a.visibility="",a.opacity="",a.pointerEvents=e0(l==null?void 0:l.pointerEvents)||"",a.transform=d?d(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(a.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,a.pointerEvents=e0(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!ul(this.latestValues)&&(a.transform=d?d({},""):"none",this.hasProjected=!1);return}a.visibility="";const f=u.animationValues||u.latestValues;this.applyTransformsToTarget();let p=VK(this.projectionDeltaWithTransform,this.treeScale,f);d&&(p=d(f,p)),a.transform=p;const{x:y,y:v}=this.projectionDelta;a.transformOrigin=`${y.origin*100}% ${v.origin*100}% 0`,u.animationValues?a.opacity=u===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:a.opacity=u===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const E in mv){if(f[E]===void 0)continue;const{correct:b,applyTo:T,isCSSVariable:I}=mv[E],N=p==="none"?f[E]:b(f[E],u);if(T){const A=T.length;for(let L=0;L<A;L++)a[T[L]]=N}else I?this.options.visualElement.renderState.vars[E]=N:a[E]=N}this.options.layoutId&&(a.pointerEvents=u===this?e0(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(YC),this.root.sharedNodes.clear()}}}function zK(t){t.updateLayout()}function WK(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:i}=t.options,a=e.source!==t.layout.source;i==="size"?Hs(p=>{const y=a?e.measuredBox[p]:e.layoutBox[p],v=zn(y);y.min=n[p].min,y.max=y.min+v}):x3(i,e.layoutBox,n)&&Hs(p=>{const y=a?e.measuredBox[p]:e.layoutBox[p],v=zn(n[p]);y.max=y.min+v,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[p].max=t.relativeTarget[p].min+v)});const l=Kc();Zd(l,n,e.layoutBox);const d=Kc();a?Zd(d,t.applyTransform(s,!0),e.measuredBox):Zd(d,n,e.layoutBox);const u=!f3(l);let f=!1;if(!t.resumeFrom){const p=t.getClosestProjectingParent();if(p&&!p.resumeFrom){const{snapshot:y,layout:v}=p;if(y&&v){const E=Qr();tp(E,e.layoutBox,y.layoutBox);const b=Qr();tp(b,n,v.layoutBox),m3(E,b)||(f=!0),p.options.layoutRoot&&(t.relativeTarget=b,t.relativeTargetOrigin=E,t.relativeParent=p)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:d,layoutDelta:l,hasLayoutChanged:u,hasRelativeLayoutChanged:f})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function KK(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function YK(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function qK(t){t.clearSnapshot()}function YC(t){t.clearMeasurements()}function qC(t){t.isLayoutDirty=!1}function XK(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function XC(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function QK(t){t.resolveTargetDelta()}function ZK(t){t.calcProjection()}function JK(t){t.resetSkewAndRotation()}function eY(t){t.removeLeadSnapshot()}function QC(t,e,r){t.translate=gr(e.translate,0,r),t.scale=gr(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function ZC(t,e,r,n){t.min=gr(e.min,r.min,n),t.max=gr(e.max,r.max,n)}function tY(t,e,r,n){ZC(t.x,e.x,r.x,n),ZC(t.y,e.y,r.y,n)}function rY(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const nY={duration:.45,ease:[.4,0,.1,1]},JC=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),eA=JC("applewebkit/")&&!JC("chrome/")?Math.round:Zs;function tA(t){t.min=eA(t.min),t.max=eA(t.max)}function sY(t){tA(t.x),tA(t.y)}function x3(t,e,r){return t==="position"||t==="preserve-aspect"&&!hK(WC(e),WC(r),.2)}function iY(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const aY=g3({attachResizeListener:(t,e)=>Oh(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),t1={current:void 0},y3=g3({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!t1.current){const t=new aY({});t.mount(window),t.setOptions({layoutScroll:!0}),t1.current=t}return t1.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),oY={pan:{Feature:NK},drag:{Feature:AK,ProjectionNode:y3,MeasureLayout:u3}};function rA(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,i=n[s];i&&cr.postRender(()=>i(e,wf(e)))}class lY extends Yo{mount(){const{current:e}=this.node;e&&(this.unmount=Lz(e,(r,n)=>(rA(this.node,n,"Start"),s=>rA(this.node,s,"End"))))}unmount(){}}class cY extends Yo{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=xf(Oh(this.node.current,"focus",()=>this.onFocus()),Oh(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function nA(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),i=n[s];i&&cr.postRender(()=>i(e,wf(e)))}class uY extends Yo{mount(){const{current:e}=this.node;e&&(this.unmount=jz(e,(r,n)=>(nA(this.node,n,"Start"),(s,{success:i})=>nA(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ev=new WeakMap,r1=new WeakMap,dY=t=>{const e=Ev.get(t.target);e&&e(t)},hY=t=>{t.forEach(dY)};function fY({root:t,...e}){const r=t||document;r1.has(r)||r1.set(r,{});const n=r1.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(hY,{root:t,...e})),n[s]}function mY(t,e,r){const n=fY(e);return Ev.set(t,r),n.observe(t),()=>{Ev.delete(t),n.unobserve(t)}}const pY={some:0,all:1};class gY extends Yo{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=e,a={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:pY[s]},l=d=>{const{isIntersecting:u}=d;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),y=u?f:p;y&&y(d)};return mY(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(xY(e,r))&&this.startObserver()}unmount(){}}function xY({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const yY={inView:{Feature:gY},tap:{Feature:uY},focus:{Feature:cY},hover:{Feature:lY}},vY={layout:{ProjectionNode:y3,MeasureLayout:u3}},wY={...aK,...yY,...oY,...vY},Me=EW(wY,jW),v3="/assets/ai-network-BQUH8mWU.jpg",bY=[{icon:ib,title:"Statistiques de Match",description:"Analyses dtailles pour chaque point"},{icon:Oa,title:"Suivi de Position",description:"Analyse des dplacements des joueurs"},{icon:nb,title:"Cartes de Chaleur",description:"Visualisez votre couverture du terrain"},{icon:Yp,title:"Highlights Auto",description:"Meilleurs moments gnrs par IA"}],EY=()=>o.jsxs("section",{id:"ai-features",className:"py-24 relative bg-card/30 overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-10",children:o.jsx("img",{src:v3,alt:"",className:"w-full h-full object-cover"})}),o.jsxs("div",{className:"container mx-auto px-4 lg:px-8 relative",children:[o.jsxs(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full border border-accent/30 bg-accent/10 mb-6",children:[o.jsx(sb,{className:"w-4 h-4 text-accent"}),o.jsx("span",{className:"text-xs font-medium text-accent uppercase tracking-wider",children:"Bientt Disponible"})]}),o.jsxs("h2",{className:"font-display text-3xl md:text-4xl lg:text-5xl font-bold mb-6",children:["Analyse ",o.jsx("span",{className:"text-gradient",children:"Propulse par IA"})]}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"L'intelligence artificielle de nouvelle gnration transformera votre comprhension et amlioration du jeu."})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12",children:bY.map((t,e)=>o.jsx(Me.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:e*.1},className:"relative group",children:o.jsxs("div",{className:"p-6 rounded-2xl bg-card/80 border border-border backdrop-blur-sm h-full",children:[o.jsx("div",{className:"absolute -top-2 -right-2 px-2 py-0.5 rounded-full bg-accent/20 border border-accent/30 text-[10px] font-medium text-accent",children:"Soon"}),o.jsx("div",{className:"w-12 h-12 rounded-xl bg-accent/10 flex items-center justify-center mb-4 group-hover:bg-accent/20 transition-colors",children:o.jsx(t.icon,{className:"w-6 h-6 text-accent"})}),o.jsx("h3",{className:"font-display text-lg font-semibold mb-2",children:t.title}),o.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]})},e))})]})]}),sA=[{number:"01",icon:hL,title:"Crez Votre Compte",description:"Inscrivez-vous en quelques secondes avec votre email. Recevez 1 crdit de bienvenue offert."},{number:"02",icon:Oa,title:"Trouvez Votre Terrain",description:"Parcourez notre rseau de clubs partenaires et slectionnez le terrain o vous allez jouer."},{number:"03",icon:Ps,title:"Scannez et Enregistrez",description:"Scannez le QR code du terrain et appuyez sur Enregistrer. Notre systme s'occupe du reste."},{number:"04",icon:yr,title:"Visionnez et Progressez",description:"Accdez  vos vidos instantanment. Analysez votre jeu et suivez votre progression."}];function SY(){return o.jsxs("section",{id:"how-it-works",className:"py-24 bg-secondary/30 relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-primary/50 to-transparent"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-accent/50 to-transparent"}),o.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[o.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-5xl font-bold mb-6",children:["Commencez en",o.jsx("br",{}),o.jsx("span",{className:"gradient-text-accent",children:"4 tapes Simples"})]}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"De l'inscription  votre premier match enregistr, cela ne prend que quelques minutes. Voici comment fonctionne MySmash."})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:sA.map((t,e)=>o.jsxs("div",{className:"relative",children:[e<sA.length-1&&o.jsx("div",{className:"hidden lg:block absolute top-12 left-[calc(50%+2rem)] right-[-2rem] h-px bg-gradient-to-r from-primary/50 to-accent/50"}),o.jsxs("div",{className:"text-center group",children:[o.jsxs("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-2xl bg-card border border-border group-hover:border-primary/50 transition-all duration-300 mb-6 relative overflow-hidden card-glow",children:[o.jsx("span",{className:"font-display text-4xl font-bold gradient-text",children:t.number}),o.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-primary opacity-0 group-hover:opacity-100 transition-all duration-300",children:o.jsx(t.icon,{className:"w-10 h-10 text-primary-foreground"})})]}),o.jsx("h3",{className:"font-display text-xl font-semibold mb-3",children:t.title}),o.jsx("p",{className:"text-muted-foreground",children:t.description})]})]},t.number))})]})]})}function TY(){return o.jsxs("section",{id:"pricing",className:"py-24 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-glow opacity-50"}),o.jsxs("div",{className:"container mx-auto px-4 relative z-10",children:[o.jsxs("div",{className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-5xl font-bold mb-6",children:["Tarification Simple et",o.jsx("br",{}),o.jsx("span",{className:"gradient-text",children:"Transparente"})]}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"Achetez des crdits selon vos besoins. 1 crdit = 1 vido dverrouille. Plus vous achetez, plus vous conomisez."})]}),o.jsx("div",{className:"max-w-4xl mx-auto",children:o.jsxs("div",{className:"p-8 rounded-2xl bg-card border border-primary/50 relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/10 rounded-full blur-3xl"}),o.jsxs("div",{className:"relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"w-12 h-12 rounded-xl bg-primary text-primary-foreground flex items-center justify-center",children:o.jsx(Bl,{className:"w-6 h-6"})}),o.jsx("h3",{className:"font-display text-2xl font-bold",children:"Vous tes un Club ?"})]}),o.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Offrez  vos membres une exprience premium avec notre solution cl en main. Installation, formation et support inclus."}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-6",children:[o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Ts,{className:"w-5 h-5 text-accent mt-0.5"}),o.jsx("span",{className:"text-sm",children:"Installation camras incluse"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Ts,{className:"w-5 h-5 text-accent mt-0.5"}),o.jsx("span",{className:"text-sm",children:"Dashboard de gestion ddi"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Ts,{className:"w-5 h-5 text-accent mt-0.5"}),o.jsx("span",{className:"text-sm",children:"Commission sur les ventes de crdits"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Ts,{className:"w-5 h-5 text-accent mt-0.5"}),o.jsx("span",{className:"text-sm",children:"Support technique prioritaire"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Ts,{className:"w-5 h-5 text-accent mt-0.5"}),o.jsx("span",{className:"text-sm",children:"Formation quipe incluse"})]}),o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Ts,{className:"w-5 h-5 text-accent mt-0.5"}),o.jsx("span",{className:"text-sm",children:"Personnalisat ion aux couleurs du club"})]})]}),o.jsx("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:o.jsx(ve,{variant:"hero",size:"lg",className:"w-full sm:w-auto",children:"Contacter l'quipe Commerciale"})})]})]})})]})]})}const w3=({limit:t,className:e=""})=>{const r=t?$T.slice(0,t):$T;return o.jsx("div",{className:`grid md:grid-cols-2 lg:grid-cols-4 gap-8 ${e}`,children:r.map((n,s)=>o.jsxs(Me.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:s*.1},className:"text-center p-4",children:[o.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-br from-primary to-accent flex items-center justify-center mx-auto mb-4",children:o.jsx(n.icon,{className:"w-8 h-8 text-white"})}),o.jsx("h3",{className:"font-display text-xl font-semibold mb-3",children:n.title}),o.jsx("p",{className:"text-muted-foreground",children:n.description})]},s))})},CY=()=>o.jsx("section",{id:"about",className:"py-24 relative overflow-hidden",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8 relative",children:[o.jsxs(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-5xl font-bold mb-6",children:[" Propos de",o.jsx("br",{}),o.jsx("span",{className:"gradient-text",children:"Spovio"})]}),o.jsx("p",{className:"text-lg text-muted-foreground leading-relaxed",children:"Spovio est ne de la frustration de ne pas pouvoir revoir et analyser ses propres performances sportives. Nous avons cr une solution simple et accessible qui permet  chaque sportif d'enregistrer, analyser et amliorer son jeu grce  la technologie."})]}),o.jsx("div",{className:"mb-16",children:o.jsx(w3,{})}),o.jsx(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"max-w-4xl mx-auto",children:o.jsxs("div",{className:"p-8 md:p-12 rounded-2xl bg-card border border-border",children:[o.jsx("h3",{className:"font-display text-2xl md:text-3xl font-bold mb-6 text-center",children:"Notre Histoire"}),o.jsxs("div",{className:"space-y-4 text-muted-foreground leading-relaxed",children:[o.jsx("p",{children:'Tout a commenc sur un terrain de padel en Tunisie. Aprs chaque match, nous nous demandions : "Pourquoi est-ce si difficile de revoir nos performances ?"'}),o.jsx("p",{children:"C'est l que l'ide de Spovio est ne. Nous avons runi une quipe passionne de dveloppeurs, de sportifs et d'experts en IA pour crer la solution que nous aurions aim avoir."}),o.jsxs("p",{children:["Aujourd'hui, ",o.jsx("span",{className:"text-foreground font-semibold",children:"Spovio"})," couvre le padel et le tennis, permettant  des centaines de joueurs d'enregistrer, analyser et partager leurs matchs. Et ce n'est que le dbut."]}),o.jsx("p",{className:"text-foreground font-semibold pt-4 text-center",children:"Rejoignez-nous dans cette aventure sportive ! "})]}),o.jsx("div",{className:"mt-8 text-center",children:o.jsx(pr,{to:"/about",children:o.jsxs(ve,{variant:"outline",size:"lg",className:"group",children:["En savoir plus sur Spovio",o.jsx(_o,{className:"w-4 h-4 ml-2 transition-transform group-hover:translate-x-1"})]})})})]})})]})});function AY(){return o.jsxs("section",{className:"py-24 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary/10 via-background to-accent/10"}),o.jsx("div",{className:"absolute inset-0 tech-grid opacity-30"}),o.jsx("div",{className:"absolute top-1/2 left-1/4 w-64 h-64 bg-primary/30 rounded-full blur-3xl animate-float"}),o.jsx("div",{className:"absolute top-1/2 right-1/4 w-64 h-64 bg-accent/30 rounded-full blur-3xl animate-float animation-delay-500"}),o.jsx("div",{className:"container mx-auto px-4 relative z-10",children:o.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-5xl lg:text-6xl font-bold mb-6",children:["Prt  Transformer",o.jsx("br",{}),o.jsx("span",{className:"gradient-text",children:"Votre Jeu de Padel ?"})]}),o.jsx("p",{className:"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto mb-10",children:"Rejoignez les joueurs qui utilisent dj MySmash pour enregistrer, analyser et amliorer leurs performances sur le terrain."}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4",children:[o.jsx("a",{href:"/auth",children:o.jsxs(ve,{variant:"hero",size:"xl",className:"group",children:[o.jsx(Ps,{className:"w-5 h-5 mr-2 group-hover:scale-110 transition-transform"}),"Commencer Gratuitement",o.jsx(_o,{className:"w-5 h-5 ml-2 group-hover:translate-x-1 transition-transform"})]})}),o.jsx(ve,{variant:"glass",size:"xl",children:"Parler  un Expert"})]}),o.jsx("p",{className:"mt-8 text-sm text-muted-foreground",children:" Aucune carte bancaire requise   1 crdit offert  l'inscription   Annulez  tout moment"})]})})]})}const hm=UG,NY=[{icon:NB,href:"#",label:"Twitter"},{icon:iL,href:"#",label:"Instagram"},{icon:_B,href:"#",label:"YouTube"},{icon:vB,href:"#",label:"LinkedIn"}];function b3(){return o.jsx("footer",{id:"contact",className:"bg-secondary/30 border-t border-border pt-16 pb-8",children:o.jsxs("div",{className:"container mx-auto px-4",children:[o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-8 mb-12",children:[o.jsxs("div",{className:"col-span-2",children:[o.jsxs("a",{href:"/",className:"flex items-center gap-2 mb-4",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-neon-cyan flex items-center justify-center",children:o.jsx(yr,{className:"w-5 h-5 text-primary-foreground"})}),o.jsx("span",{className:"font-display font-bold text-xl tracking-tight",children:o.jsx("span",{className:"gradient-text",children:"Spovio"})})]}),o.jsx("p",{className:"text-muted-foreground text-sm mb-4 max-w-xs",children:"La plateforme ultime d'enregistrement vido sportif et d'analyse de performance propulse par l'IA."}),o.jsx("div",{className:"flex items-center gap-3",children:NY.map(t=>o.jsx("a",{href:t.href,"aria-label":t.label,className:"w-9 h-9 rounded-lg bg-card border border-border flex items-center justify-center text-muted-foreground hover:text-primary hover:border-primary/50 transition-all duration-300",children:o.jsx(t.icon,{className:"w-4 h-4"})},t.label))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-4",children:"Produit"}),o.jsx("ul",{className:"space-y-2",children:hm.product.map(t=>o.jsx("li",{children:o.jsx("a",{href:t.href,className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:t.label})},t.label))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-4",children:"Entreprise"}),o.jsx("ul",{className:"space-y-2",children:hm.company.map(t=>o.jsx("li",{children:o.jsx("a",{href:t.href,className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:t.label})},t.label))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-4",children:"Support"}),o.jsx("ul",{className:"space-y-2",children:hm.support.map(t=>o.jsx("li",{children:o.jsx("a",{href:t.href,className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:t.label})},t.label))})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-4",children:"Lgal"}),o.jsx("ul",{className:"space-y-2",children:hm.legal.map(t=>o.jsx("li",{children:o.jsx("a",{href:t.href,className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:t.label})},t.label))})]})]}),o.jsxs("div",{className:"pt-8 border-t border-border flex flex-col md:flex-row items-center justify-between gap-4",children:[o.jsxs("p",{className:"text-sm text-muted-foreground",children:[" ",new Date().getFullYear()," Spovio. All rights reserved."]}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Fait avec  pour les sportifs du monde entier"})]})]})})}const IY=()=>o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(hg,{}),o.jsxs("main",{children:[o.jsx($G,{}),o.jsx(GG,{}),o.jsx(EY,{}),o.jsx(SY,{}),o.jsx(TY,{}),o.jsx(CY,{}),o.jsx(AY,{})]}),o.jsx(b3,{})]}),xg=({children:t})=>o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(hg,{}),o.jsx("main",{className:"pt-20",children:t}),o.jsx(b3,{})]}),RY=()=>o.jsxs(xg,{children:[o.jsxs("section",{className:"relative min-h-[70vh] flex items-center overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0",children:[o.jsx("img",{src:v3,alt:"AI Neural Network",className:"w-full h-full object-cover opacity-20"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-background via-background/95 to-background"})]}),o.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[...Array(20)].map((t,e)=>o.jsx(Me.div,{initial:{opacity:0},animate:{opacity:[0,1,0],y:[-20,-100],x:Math.random()*20-10},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*5},className:"absolute w-1 h-1 bg-accent rounded-full",style:{left:`${Math.random()*100}%`,top:`${50+Math.random()*50}%`}},e))}),o.jsx("div",{className:"container mx-auto px-4 lg:px-8 relative z-10 py-20",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-3xl mx-auto text-center",children:[o.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full border border-accent/30 bg-accent/10 mb-6",children:[o.jsx(sb,{className:"w-4 h-4 text-accent"}),o.jsx("span",{className:"text-sm font-medium text-accent",children:"Bientt Disponible"})]}),o.jsxs("h1",{className:"font-display text-4xl md:text-5xl lg:text-6xl font-bold mb-6",children:["Analyse de Performance",o.jsx("br",{}),o.jsx("span",{className:"text-gradient",children:"Propulse par l'IA"})]}),o.jsx("p",{className:"text-xl text-muted-foreground mb-8",children:"L'intelligence artificielle de nouvelle gnration transformera votre faon de comprendre, d'analyser et d'amliorer votre jeu."}),o.jsx(pr,{to:"/auth?mode=signup",children:o.jsxs(ve,{variant:"neon",size:"xl",className:"group",children:["Obtenir un Accs Anticip",o.jsx(Hu,{className:"w-5 h-5"})]})})]})})]}),o.jsx("section",{className:"py-24 bg-card/30",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Fonctionnalits IA ",o.jsx("span",{className:"text-gradient",children:" Venir"})]}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"Nous construisons la plateforme d'analyse sportive la plus avance"})]}),o.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:FG.map((t,e)=>o.jsx(Me.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:e*.1},className:"relative group",children:o.jsxs("div",{className:"p-6 rounded-2xl bg-card border border-border h-full backdrop-blur-sm hover:border-accent/30 transition-all",children:[o.jsx("div",{className:"absolute -top-2 -right-2 px-2 py-0.5 rounded-full bg-accent/20 border border-accent/30 text-[10px] font-medium text-accent",children:"Bientt"}),o.jsx("div",{className:"w-12 h-12 rounded-xl bg-accent/10 flex items-center justify-center mb-4 group-hover:bg-accent/20 transition-colors",children:o.jsx(t.icon,{className:"w-6 h-6 text-accent"})}),o.jsx("h3",{className:"font-display text-xl font-semibold mb-3",children:t.title}),o.jsx("p",{className:"text-muted-foreground",children:t.description})]})},e))})]})}),o.jsx("section",{className:"py-24 bg-card/30",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"max-w-3xl mx-auto text-center",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Soyez le Premier  Exprimenter"," ",o.jsx("span",{className:"text-gradient",children:"l'Analyse IA"})]}),o.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:"Crez votre compte maintenant pour obtenir un accs anticip au lancement des fonctionnalits IA"}),o.jsx(pr,{to:"/auth?mode=signup",children:o.jsxs(ve,{variant:"hero",size:"xl",className:"group",children:["Obtenir un Accs Anticip",o.jsx(_o,{className:"w-5 h-5 transition-transform group-hover:translate-x-1"})]})})]})})})]}),_Y=()=>o.jsxs(xg,{children:[o.jsxs("section",{className:"py-32 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:o.jsx(Me.div,{animate:{opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0},className:"absolute top-1/3 left-1/4 w-96 h-96 bg-primary/20 rounded-full blur-[150px]"})}),o.jsx("div",{className:"container mx-auto px-4 lg:px-8 relative z-10",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-3xl mx-auto text-center",children:[o.jsxs("h1",{className:"font-display text-4xl md:text-5xl lg:text-6xl font-bold mb-6",children:["Comment ",o.jsx("span",{className:"text-gradient",children:"Spovio"})," Marche"]}),o.jsx("p",{className:"text-xl text-muted-foreground",children:"Du scan au partage en quelques minutes. Dcouvrez la faon la plus simple d'enregistrer et analyser vos matchs."})]})})]}),o.jsx("section",{className:"pb-24",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsx("div",{className:"max-w-4xl mx-auto",children:VT.map((t,e)=>o.jsxs(Me.div,{initial:{opacity:0,x:e%2===0?-30:30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.6},className:"relative",children:[e<VT.length-1&&o.jsx("div",{className:"absolute left-8 top-24 bottom-0 w-px bg-gradient-to-b from-border to-transparent"}),o.jsxs("div",{className:"flex gap-8 pb-16",children:[o.jsxs("div",{className:"relative flex-shrink-0",children:[o.jsx("div",{className:`w-16 h-16 rounded-2xl flex items-center justify-center ${t.color==="accent"?"bg-accent/10 border border-accent/30":"bg-primary/10 border border-primary/30"}`,children:o.jsx(t.icon,{className:`w-7 h-7 ${t.color==="accent"?"text-accent":"text-primary"}`})}),o.jsx("div",{className:`absolute -top-2 -left-2 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${t.color==="accent"?"bg-accent text-accent-foreground":"bg-primary text-primary-foreground"}`,children:t.number})]}),o.jsxs("div",{className:"flex-1 pt-2",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("h3",{className:"font-display text-2xl font-bold",children:t.title}),t.badge&&o.jsx("span",{className:"px-2 py-0.5 rounded-full bg-accent/20 border border-accent/30 text-xs font-medium text-accent",children:t.badge})]}),o.jsx("p",{className:"text-muted-foreground text-lg",children:t.description})]})]})]},e))})})}),o.jsx("section",{className:"py-16 bg-card/30 border-y border-border",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:[{value:"<10s",label:"Temps d'Install."},{value:"1080p",label:"Qualit Vido"},{value:"",label:"Stockage Cloud"},{value:"1-Clic",label:"Partage"}].map((t,e)=>o.jsxs(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:e*.1},className:"text-center",children:[o.jsx("div",{className:"font-display text-3xl md:text-4xl font-bold text-gradient-cyan mb-2",children:t.value}),o.jsx("div",{className:"text-sm text-muted-foreground",children:t.label})]},e))})})}),o.jsx("section",{className:"py-24",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"max-w-3xl mx-auto text-center",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Prt  ",o.jsx("span",{className:"text-gradient",children:"Commencer"})," ?"]}),o.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:"Crez votre compte et commencez  enregistrer vos matchs ds aujourd'hui"}),o.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[o.jsx(pr,{to:"/auth?mode=signup",children:o.jsxs(ve,{variant:"hero",size:"xl",className:"group",children:["Crer un Compte",o.jsx(_o,{className:"w-5 h-5 transition-transform group-hover:translate-x-1"})]})}),o.jsx(pr,{to:"/contact",children:o.jsx(ve,{variant:"neonOutline",size:"xl",children:"Contacter les Ventes"})})]})]})})})]}),LY=()=>o.jsxs(xg,{children:[o.jsxs("section",{className:"py-32 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[o.jsx(Me.div,{animate:{opacity:[.2,.4,.2]},transition:{duration:10,repeat:1/0},className:"absolute top-1/4 right-1/4 w-[500px] h-[500px] bg-primary/10 rounded-full blur-[150px]"}),o.jsx(Me.div,{animate:{opacity:[.15,.3,.15]},transition:{duration:12,repeat:1/0},className:"absolute bottom-1/4 left-1/4 w-[400px] h-[400px] bg-accent/10 rounded-full blur-[120px]"})]}),o.jsx("div",{className:"container mx-auto px-4 lg:px-8 relative z-10",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-3xl mx-auto text-center",children:[o.jsxs("h1",{className:"font-display text-4xl md:text-5xl lg:text-6xl font-bold mb-6",children:[" Propos de ",o.jsx("span",{className:"text-gradient",children:"Spovio"})]}),o.jsx("p",{className:"text-xl text-muted-foreground",children:"Dmocratiser la vido sportive intelligente et l'analyse IA pour les athltes partout"})]})})]}),o.jsx("section",{className:"py-24 bg-card/30",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[o.jsxs(Me.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.6},children:[o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Notre ",o.jsx("span",{className:"text-gradient",children:"Vision"})]}),o.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"Nous pensons que chaque athlte mrite d'avoir accs aux mmes outils d'analyse vido que les professionnels. Spovio construit le futur de la technologie sportive  simple, accessible et puissant pour tous."}),o.jsx("p",{className:"text-lg text-muted-foreground mb-6",children:"En commenant par le padel et en s'tendant  plusieurs sports, nous crons une plateforme unifie qui combine capture vido automatise et insights de performance par IA."}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"Notre focus sur la rgion MENA, l'Europe et les marchs mondiaux nous positionne pour servir les athltes dans les rgions sportives  la croissance la plus rapide."})]}),o.jsx(Me.div,{initial:{opacity:0,x:30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.6},className:"relative",children:o.jsxs("div",{className:"aspect-square max-w-md mx-auto relative",children:[o.jsx("div",{className:"absolute inset-0 rounded-full border border-primary/20 animate-[spin_30s_linear_infinite]"}),o.jsx("div",{className:"absolute inset-8 rounded-full border border-primary/30 animate-[spin_25s_linear_infinite_reverse]"}),o.jsx("div",{className:"absolute inset-16 rounded-full border border-primary/40 animate-[spin_20s_linear_infinite]"}),o.jsx("div",{className:"absolute inset-24 rounded-full bg-gradient-to-br from-primary/20 to-accent/20 flex items-center justify-center",children:o.jsx(nL,{className:"w-16 h-16 text-primary"})}),o.jsx(Me.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0},className:"absolute top-1/4 right-1/4 w-3 h-3 bg-primary rounded-full"}),o.jsx(Me.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0,delay:.5},className:"absolute bottom-1/3 left-1/4 w-3 h-3 bg-accent rounded-full"}),o.jsx(Me.div,{animate:{scale:[1,1.2,1]},transition:{duration:2,repeat:1/0,delay:1},className:"absolute top-1/3 left-1/3 w-3 h-3 bg-primary rounded-full"})]})})]})})}),o.jsx("section",{className:"py-24",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center max-w-3xl mx-auto mb-16",children:[o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Nos ",o.jsx("span",{className:"text-gradient",children:"Valeurs"})]}),o.jsx("p",{className:"text-lg text-muted-foreground",children:"The principles that guide everything we do"})]}),o.jsx("div",{className:"mb-16",children:o.jsx(w3,{})})]})}),o.jsx("section",{className:"py-24 bg-card/30",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsx(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"text-center max-w-3xl mx-auto mb-16",children:o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Notre ",o.jsx("span",{className:"text-gradient",children:"Parcours"})]})}),o.jsx("div",{className:"max-w-3xl mx-auto",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-4 md:left-1/2 top-0 bottom-0 w-px bg-border"}),OG.map((t,e)=>o.jsxs(Me.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.5,delay:e*.1},className:`relative flex items-center gap-8 pb-12 ${e%2===0?"md:flex-row-reverse":""}`,children:[o.jsx("div",{className:"absolute left-4 md:left-1/2 w-3 h-3 -ml-1.5 rounded-full bg-primary"}),o.jsxs("div",{className:`ml-12 md:ml-0 md:w-[calc(50%-2rem)] ${e%2===0?"md:text-right":""}`,children:[o.jsx("div",{className:"font-display text-primary font-bold mb-1",children:t.year}),o.jsx("h3",{className:"font-display text-xl font-semibold mb-2",children:t.title}),o.jsx("div",{className:"text-muted-foreground w-full",children:t.description})]})]},e))]})})]})}),o.jsx("section",{className:"py-24",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},className:"max-w-3xl mx-auto text-center",children:[o.jsx(SB,{className:"w-12 h-12 text-primary mx-auto mb-6"}),o.jsxs("h2",{className:"font-display text-3xl md:text-4xl font-bold mb-6",children:["Rejoignez la ",o.jsx("span",{className:"text-gradient",children:"Rvolution"})]}),o.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:"Faites partie du futur de la technologie sportive"}),o.jsxs("div",{className:"flex flex-wrap justify-center gap-4",children:[o.jsx(pr,{to:"/auth?mode=signup",children:o.jsxs(ve,{variant:"hero",size:"xl",className:"group",children:["Commencer",o.jsx(_o,{className:"w-5 h-5 transition-transform group-hover:translate-x-1"})]})}),o.jsx(pr,{to:"/contact",children:o.jsx(ve,{variant:"neonOutline",size:"xl",children:"Nous Contacter"})})]})]})})})]}),Ue=C.forwardRef(({className:t,type:e,...r},n)=>o.jsx("input",{type:e,className:Ye("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...r}));Ue.displayName="Input";const qo=C.forwardRef(({className:t,...e},r)=>o.jsx("textarea",{className:Ye("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));qo.displayName="Textarea";const PY=[{icon:Lo,label:"Email",value:"contact@spovio.net",href:"mailto:contact@spovio.net"},{icon:cf,label:"Tlphone",value:"+216 50 988 787",href:"tel:+21650988787"},{icon:Oa,label:"Adresse",value:"Sousse, Tunisie",href:"#"}],DY=()=>{const{toast:t}=la(),[e,r]=C.useState({name:"",email:"",company:"",type:"player",message:""}),[n,s]=C.useState(!1),i=async a=>{a.preventDefault(),s(!0);try{const l=await fetch("http://localhost:5000/api/support/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),d=await l.json();if(!l.ok)throw new Error(d.error||"Erreur lors de l'envoi");t({title:"Message envoy !",description:"Nous vous rpondrons dans les plus brefs dlais. Un email de confirmation vous a t envoy."}),r({name:"",email:"",company:"",type:"player",message:""})}catch(l){t({title:"Erreur",description:l.message||"Une erreur est survenue",variant:"destructive"})}finally{s(!1)}};return o.jsxs(xg,{children:[o.jsxs("section",{className:"py-32 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:o.jsx(Me.div,{animate:{opacity:[.2,.4,.2]},transition:{duration:8,repeat:1/0},className:"absolute top-1/3 left-1/3 w-96 h-96 bg-primary/15 rounded-full blur-[150px]"})}),o.jsx("div",{className:"container mx-auto px-4 lg:px-8 relative z-10",children:o.jsxs(Me.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},className:"max-w-3xl mx-auto text-center",children:[o.jsxs("h1",{className:"font-display text-4xl md:text-5xl lg:text-6xl font-bold mb-6",children:["Nous ",o.jsx("span",{className:"text-gradient",children:"Contacter"})]}),o.jsx("p",{className:"text-xl text-muted-foreground",children:"Vous avez des questions ? Vous souhaitez une dmo pour votre club ? Nous serions ravis de vous entendre."})]})})]}),o.jsx("section",{className:"pb-24",children:o.jsx("div",{className:"container mx-auto px-4 lg:px-8",children:o.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 max-w-6xl mx-auto",children:[o.jsx(Me.div,{initial:{opacity:0,x:-30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.6},children:o.jsxs("div",{className:"p-8 rounded-2xl bg-card border border-border",children:[o.jsx("h2",{className:"font-display text-2xl font-bold mb-6",children:"Envoyez-nous un message"}),o.jsxs("form",{onSubmit:i,className:"space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("button",{type:"button",onClick:()=>r({...e,type:"player"}),className:`p-4 rounded-xl border transition-all flex items-center gap-3 ${e.type==="player"?"border-primary bg-primary/10":"border-border hover:border-muted-foreground"}`,children:[o.jsx(Nn,{className:`w-5 h-5 ${e.type==="player"?"text-primary":"text-muted-foreground"}`}),o.jsx("span",{className:e.type==="player"?"text-foreground":"text-muted-foreground",children:"Joueur"})]}),o.jsxs("button",{type:"button",onClick:()=>r({...e,type:"club"}),className:`p-4 rounded-xl border transition-all flex items-center gap-3 ${e.type==="club"?"border-primary bg-primary/10":"border-border hover:border-muted-foreground"}`,children:[o.jsx(wh,{className:`w-5 h-5 ${e.type==="club"?"text-primary":"text-muted-foreground"}`}),o.jsx("span",{className:e.type==="club"?"text-foreground":"text-muted-foreground",children:"Club"})]})]}),o.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nom"}),o.jsx(Ue,{placeholder:"Votre nom",value:e.name,onChange:a=>r({...e,name:a.target.value}),required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email"}),o.jsx(Ue,{type:"email",placeholder:"vous@exemple.com",value:e.email,onChange:a=>r({...e,email:a.target.value}),required:!0})]})]}),e.type==="club"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Club / Organisation"}),o.jsx(Ue,{placeholder:"Nom de votre club",value:e.company,onChange:a=>r({...e,company:a.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-2",children:"Message"}),o.jsx(qo,{placeholder:"Dites-nous comment nous pouvons vous aider...",rows:5,value:e.message,onChange:a=>r({...e,message:a.target.value}),required:!0})]}),o.jsx(ve,{type:"submit",variant:"hero",size:"lg",className:"w-full",disabled:n,children:n?"Envoi en cours...":o.jsxs(o.Fragment,{children:["Envoyer le message",o.jsx(Ch,{className:"w-4 h-4"})]})})]})]})}),o.jsxs(Me.div,{initial:{opacity:0,x:30},whileInView:{opacity:1,x:0},viewport:{once:!0},transition:{duration:.6},className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"font-display text-2xl font-bold mb-6",children:"Informations de contact"}),o.jsx("div",{className:"space-y-4",children:PY.map((a,l)=>o.jsxs("a",{href:a.href,className:"flex items-center gap-4 p-4 rounded-xl bg-card border border-border hover:border-primary/30 transition-all group",children:[o.jsx("div",{className:"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:o.jsx(a.icon,{className:"w-5 h-5 text-primary"})}),o.jsxs("div",{children:[o.jsx("div",{className:"text-sm text-muted-foreground",children:a.label}),o.jsx("div",{className:"font-medium",children:a.value})]})]},l))})]}),o.jsxs("div",{className:"p-6 rounded-2xl bg-gradient-to-br from-primary/10 to-accent/10 border border-primary/20",children:[o.jsx($l,{className:"w-10 h-10 text-primary mb-4"}),o.jsx("h3",{className:"font-display text-xl font-bold mb-2",children:"Demander une dmo"}),o.jsx("p",{className:"text-muted-foreground mb-4",children:"Intress par Spovio pour votre club ? Laissez-nous vous montrer comment notre plateforme peut transformer votre exprience sportive."}),o.jsxs(ve,{variant:"hero",children:["Planifier une dmo",o.jsx(Ch,{className:"w-4 h-4"})]})]}),o.jsxs("div",{className:"p-6 rounded-2xl bg-card border border-border",children:[o.jsx("h3",{className:"font-display text-lg font-bold mb-2",children:"Vous cherchez des rponses ?"}),o.jsx("p",{className:"text-muted-foreground text-sm",children:"Consultez notre section FAQ pour des rponses rapides aux questions frquentes sur Spovio."})]})]})]})})})]})},kY=()=>{const t=Ba();return C.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),o.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),o.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),o.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})};var jY="Label",E3=C.forwardRef((t,e)=>o.jsx(He.label,{...t,ref:e,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));E3.displayName=jY;var S3=E3;const MY=nf("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Ce=C.forwardRef(({className:t,...e},r)=>o.jsx(S3,{ref:r,className:Ye(MY(),t),...e}));Ce.displayName=S3.displayName;const OY=()=>{const t=ni(),{toast:e}=la(),[r,n]=C.useState("login"),[s,i]=C.useState(!1),[a,l]=C.useState(!1),[d,u]=C.useState({email:"",password:""}),[f,p]=C.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),{login:y,register:v}=ps(),E=async I=>{I.preventDefault(),l(!0);try{const N=await y(d);if(N.success&&N.user){e({title:"Connexion russie",description:`Bienvenue ${N.user.name||""} !`});const A=N.user.role;t(A==="super_admin"?"/admin":A==="club_admin"?"/club":"/dashboard")}else throw new Error(N.error)}catch(N){console.error("Login error:",N),e({title:"Erreur de connexion",description:N.message||"Email ou mot de passe incorrect",variant:"destructive"})}finally{l(!1)}},b=async I=>{var N,A,L,P;if(I.preventDefault(),f.password!==f.confirmPassword){e({title:"Erreur",description:"Les mots de passe ne correspondent pas.",variant:"destructive"});return}l(!0);try{const k={name:`${f.firstName} ${f.lastName}`,email:f.email,password:f.password,role:"player"},D=await cn.register(k);console.log("Registration response:",D),console.log("Response data:",D.data),console.log("Requires verification?",(N=D.data)==null?void 0:N.requires_verification),(A=D.data)!=null&&A.requires_verification?(e({title:"Email envoy",description:"Un code de vrification a t envoy  votre email."}),t("/verify-email",{state:{email:k.email}})):(e({title:"Inscription russie",description:"Votre compte a t cr. Vous pouvez maintenant vous connecter."}),p({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),n("login"),u({...d,email:k.email}))}catch(k){console.error("Registration error:",k),e({title:"Erreur d'inscription",description:((P=(L=k.response)==null?void 0:L.data)==null?void 0:P.message)||"Une erreur est survenue lors de l'inscription",variant:"destructive"})}finally{l(!1)}},T=async()=>{try{l(!0);const I=await cn.getGoogleAuthUrl();I.data&&I.data.auth_url?window.location.href=I.data.auth_url:(e({title:"Erreur",description:"Impossible d'initialiser la connexion Google",variant:"destructive"}),l(!1))}catch(I){console.error("Google auth error:",I),e({title:"Erreur",description:"Erreur de connexion avec Google",variant:"destructive"}),l(!1)}};return o.jsxs(o.Fragment,{children:[o.jsx(hg,{}),o.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 relative overflow-hidden pt-20",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-glow pointer-events-none"}),o.jsx("div",{className:"absolute inset-0 tech-grid opacity-30 pointer-events-none"}),o.jsx("div",{className:"absolute top-20 left-20 w-64 h-64 bg-primary/10 rounded-full blur-3xl animate-float"}),o.jsx("div",{className:"absolute bottom-20 right-20 w-80 h-80 bg-accent/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),o.jsxs(Me.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"w-full max-w-md relative z-10",children:[o.jsx(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:o.jsxs(pr,{to:"/",className:"inline-flex items-center gap-2",children:[o.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-primary to-accent flex items-center justify-center",children:o.jsx(Hu,{className:"h-7 w-7 text-white"})}),o.jsx("span",{className:"text-3xl font-bold font-orbitron gradient-text",children:"MySmash"})]})}),o.jsxs(Me.div,{layout:!0,className:"glass rounded-2xl p-8 shadow-xl",children:[o.jsxs("div",{className:"flex gap-2 p-1 bg-muted/50 rounded-xl mb-8",children:[o.jsx("button",{onClick:()=>n("login"),className:`flex-1 py-2.5 px-4 rounded-lg font-medium transition-all ${r==="login"?"bg-primary text-primary-foreground shadow-lg":"text-muted-foreground hover:text-foreground"}`,children:"Connexion"}),o.jsx("button",{onClick:()=>n("register"),className:`flex-1 py-2.5 px-4 rounded-lg font-medium transition-all ${r==="register"?"bg-primary text-primary-foreground shadow-lg":"text-muted-foreground hover:text-foreground"}`,children:"Inscription"})]}),o.jsx(oE,{mode:"wait",children:r==="login"?o.jsxs(Me.form,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.3},onSubmit:E,className:"space-y-5",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"login-email",className:"flex items-center gap-2",children:[o.jsx(Lo,{className:"h-4 w-4 text-muted-foreground"}),"Email"]}),o.jsx(Ue,{id:"login-email",type:"email",placeholder:"votre@email.com",value:d.email,onChange:I=>u({...d,email:I.target.value}),className:"bg-card/50",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"login-password",className:"flex items-center gap-2",children:[o.jsx(Rl,{className:"h-4 w-4 text-muted-foreground"}),"Mot de passe"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Ue,{id:"login-password",type:s?"text":"password",placeholder:"",value:d.password,onChange:I=>u({...d,password:I.target.value}),className:"bg-card/50 pr-10",required:!0}),o.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:s?o.jsx(WS,{className:"h-4 w-4"}):o.jsx(Th,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"text-right",children:o.jsx(pr,{to:"/forgot-password",className:"text-sm text-primary hover:underline",children:"Mot de passe oubli ?"})}),o.jsx(ve,{type:"submit",variant:"neon",className:"w-full gap-2",disabled:a,children:a?o.jsx("div",{className:"h-5 w-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):o.jsxs(o.Fragment,{children:["Se connecter",o.jsx(_o,{className:"h-4 w-4"})]})}),o.jsxs("div",{className:"relative my-6",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-border/50"})}),o.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:o.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"ou"})})]}),o.jsxs(ve,{type:"button",variant:"outline",className:"w-full gap-2",onClick:T,disabled:a,children:[o.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]})]},"login"):o.jsxs(Me.form,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},onSubmit:b,className:"space-y-5",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"firstName",className:"flex items-center gap-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"}),"Prnom"]}),o.jsx(Ue,{id:"firstName",placeholder:"Thomas",value:f.firstName,onChange:I=>p({...f,firstName:I.target.value}),className:"bg-card/50",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"lastName",children:"Nom"}),o.jsx(Ue,{id:"lastName",placeholder:"Martin",value:f.lastName,onChange:I=>p({...f,lastName:I.target.value}),className:"bg-card/50",required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"register-email",className:"flex items-center gap-2",children:[o.jsx(Lo,{className:"h-4 w-4 text-muted-foreground"}),"Email"]}),o.jsx(Ue,{id:"register-email",type:"email",placeholder:"votre@email.com",value:f.email,onChange:I=>p({...f,email:I.target.value}),className:"bg-card/50",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"register-password",className:"flex items-center gap-2",children:[o.jsx(Rl,{className:"h-4 w-4 text-muted-foreground"}),"Mot de passe"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Ue,{id:"register-password",type:s?"text":"password",placeholder:"",value:f.password,onChange:I=>p({...f,password:I.target.value}),className:"bg-card/50 pr-10",required:!0}),o.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:s?o.jsx(WS,{className:"h-4 w-4"}):o.jsx(Th,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"confirm-password",children:"Confirmer le mot de passe"}),o.jsx(Ue,{id:"confirm-password",type:"password",placeholder:"",value:f.confirmPassword,onChange:I=>p({...f,confirmPassword:I.target.value}),className:"bg-card/50",required:!0})]}),o.jsx(ve,{type:"submit",variant:"neon",className:"w-full gap-2",disabled:a,children:a?o.jsx("div",{className:"h-5 w-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):o.jsxs(o.Fragment,{children:["Crer mon compte",o.jsx(_o,{className:"h-4 w-4"})]})}),o.jsxs("div",{className:"relative my-6",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("div",{className:"w-full border-t border-border/50"})}),o.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:o.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"ou"})})]}),o.jsxs(ve,{type:"button",variant:"outline",className:"w-full gap-2",onClick:T,disabled:a,children:[o.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continuer avec Google"]}),o.jsxs("p",{className:"text-center text-xs text-muted-foreground",children:["En vous inscrivant, vous acceptez nos"," ",o.jsx(pr,{to:"/terms",className:"text-primary hover:underline",children:"conditions d'utilisation"})," ","et notre"," ",o.jsx(pr,{to:"/privacy",className:"text-primary hover:underline",children:"politique de confidentialit"})]})]},"register")})]}),o.jsx("p",{className:"text-center text-sm text-muted-foreground mt-6",children:" 2026 Spovio. Tous droits rservs."})]})]})]})},FY=()=>{const t=ni(),e=Ba(),{toast:r}=la(),[n,s]=C.useState(""),[i,a]=C.useState(!1),[l,d]=C.useState(!1),[u,f]=C.useState("");C.useEffect(()=>{var E;const v=(E=e.state)==null?void 0:E.email;if(!v){t("/auth");return}f(v)},[e,t]);const p=async v=>{var E,b;if(v.preventDefault(),n.length!==6){r({title:"Code invalide",description:"Le code doit contenir 6 chiffres.",variant:"destructive"});return}a(!0);try{await cn.verifyEmail(u,n),r({title:"Email vrifi !",description:"Votre compte est maintenant actif. Vous pouvez vous connecter."}),t("/dashboard")}catch(T){console.error("Verification error:",T),r({title:"Code incorrect",description:((b=(E=T.response)==null?void 0:E.data)==null?void 0:b.message)||"Le code de vrification est invalide ou expir.",variant:"destructive"})}finally{a(!1)}},y=async()=>{var v,E;d(!0);try{await cn.resendVerificationCode(u),r({title:"Code renvoy",description:"Un nouveau code de vrification a t envoy  votre email."})}catch(b){console.error("Resend error:",b),r({title:"Erreur",description:((E=(v=b.response)==null?void 0:v.data)==null?void 0:E.message)||"Impossible de renvoyer le code.",variant:"destructive"})}finally{d(!1)}};return o.jsxs("div",{className:"min-h-screen bg-background flex items-center justify-center p-4 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-radial-glow pointer-events-none"}),o.jsx("div",{className:"absolute inset-0 tech-grid opacity-30 pointer-events-none"}),o.jsx("div",{className:"absolute top-20 left-20 w-64 h-64 bg-primary/10 rounded-full blur-3xl animate-float"}),o.jsx("div",{className:"absolute bottom-20 right-20 w-80 h-80 bg-accent/10 rounded-full blur-3xl animate-float",style:{animationDelay:"1s"}}),o.jsxs(Me.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.5},className:"w-full max-w-md relative z-10",children:[o.jsx(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"text-center mb-8",children:o.jsxs(pr,{to:"/",className:"inline-flex items-center gap-2",children:[o.jsx("div",{className:"h-12 w-12 rounded-xl bg-gradient-to-br from-primary to-accent flex items-center justify-center",children:o.jsx(Hu,{className:"h-7 w-7 text-white"})}),o.jsx("span",{className:"text-3xl font-bold font-orbitron gradient-text",children:"MySmash"})]})}),o.jsxs(Me.div,{layout:!0,className:"glass rounded-2xl p-8 shadow-xl",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-primary/10 mb-4",children:o.jsx(Lo,{className:"h-8 w-8 text-primary"})}),o.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Vrifiez votre email"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Nous avons envoy un code  6 chiffres "}),o.jsx("p",{className:"text-sm font-medium text-foreground mt-1",children:u})]}),o.jsxs("form",{onSubmit:p,className:"space-y-5",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"code",className:"flex items-center gap-2",children:[o.jsx(Ho,{className:"h-4 w-4 text-muted-foreground"}),"Code de vrification"]}),o.jsx(Ue,{id:"code",type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:6,placeholder:"123456",value:n,onChange:v=>s(v.target.value.replace(/[^0-9]/g,"")),className:"bg-card/50 text-center text-2xl tracking-widest font-mono",required:!0}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Entrez le code  6 chiffres reu par email"})]}),o.jsx(ve,{type:"submit",variant:"neon",className:"w-full gap-2",disabled:i||n.length!==6,children:i?o.jsx("div",{className:"h-5 w-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):o.jsxs(o.Fragment,{children:["Vrifier",o.jsx(_o,{className:"h-4 w-4"})]})})]}),o.jsxs("div",{className:"mt-6 text-center space-y-3",children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:"Vous n'avez pas reu de code ?"}),o.jsx(ve,{type:"button",variant:"outline",className:"w-full",onClick:y,disabled:l,children:l?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"h-4 w-4 border-2 border-current border-t-transparent rounded-full animate-spin mr-2"}),"Envoi en cours..."]}):"Renvoyer le code"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx(pr,{to:"/auth",className:"text-sm text-primary hover:underline",children:"Retour  la connexion"})})]}),o.jsx("p",{className:"text-center text-sm text-muted-foreground mt-6",children:" 2026 Spovio. Tous droits rservs."})]})]})},BY=()=>{const[t]=iV(),e=ni(),{toast:r}=la();return ps(),C.useEffect(()=>{const n=t.get("token");if(!n){r({title:"Erreur d'authentification",description:"Token Google manquant",variant:"destructive"}),e("/auth");return}(async()=>{try{const i=await cn.googleAuthenticate(n);if(i.data&&i.data.user){r({title:"Connexion russie",description:`Bienvenue ${i.data.user.name}!`});const a=i.data.user.role;e(a==="super_admin"?"/admin":a==="club_admin"?"/club":"/dashboard"),window.location.href=a==="player"?"/dashboard":a==="club_admin"?"/club":"/admin"}}catch(i){console.error("Google auth error:",i),r({title:"Erreur de connexion",description:"chec de l'authentification Google",variant:"destructive"}),e("/auth")}})()},[t,e,r]),o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:o.jsxs("div",{className:"flex flex-col items-center gap-4",children:[o.jsx("div",{className:"h-10 w-10 border-4 border-primary/30 border-t-primary rounded-full animate-spin"}),o.jsx("p",{className:"text-muted-foreground animate-pulse",children:"Authentification avec Google..."})]})})},UY="modulepreload",$Y=function(t){return"/"+t},iA={},n1=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),l=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(d=>{if(d=$Y(d),d in iA)return;iA[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":UY,u||(p.as="script"),p.crossOrigin="",p.href=d,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((y,v)=>{p.addEventListener("load",y),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return s.then(a=>{for(const l of a||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};var s1=0;function yg(){C.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??aA()),document.body.insertAdjacentElement("beforeend",t[1]??aA()),s1++,()=>{s1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),s1--}},[])}function aA(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var i1="focusScope.autoFocusOnMount",a1="focusScope.autoFocusOnUnmount",oA={bubbles:!1,cancelable:!0},VY="FocusScope",bf=C.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=t,[l,d]=C.useState(null),u=Lr(s),f=Lr(i),p=C.useRef(null),y=st(e,b=>d(b)),v=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(n){let b=function(A){if(v.paused||!l)return;const L=A.target;l.contains(L)?p.current=L:eo(p.current,{select:!0})},T=function(A){if(v.paused||!l)return;const L=A.relatedTarget;L!==null&&(l.contains(L)||eo(p.current,{select:!0}))},I=function(A){if(document.activeElement===document.body)for(const P of A)P.removedNodes.length>0&&eo(l)};document.addEventListener("focusin",b),document.addEventListener("focusout",T);const N=new MutationObserver(I);return l&&N.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",T),N.disconnect()}}},[n,l,v.paused]),C.useEffect(()=>{if(l){cA.add(v);const b=document.activeElement;if(!l.contains(b)){const I=new CustomEvent(i1,oA);l.addEventListener(i1,u),l.dispatchEvent(I),I.defaultPrevented||(GY(YY(T3(l)),{select:!0}),document.activeElement===b&&eo(l))}return()=>{l.removeEventListener(i1,u),setTimeout(()=>{const I=new CustomEvent(a1,oA);l.addEventListener(a1,f),l.dispatchEvent(I),I.defaultPrevented||eo(b??document.body,{select:!0}),l.removeEventListener(a1,f),cA.remove(v)},0)}}},[l,u,f,v]);const E=C.useCallback(b=>{if(!r&&!n||v.paused)return;const T=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,I=document.activeElement;if(T&&I){const N=b.currentTarget,[A,L]=HY(N);A&&L?!b.shiftKey&&I===L?(b.preventDefault(),r&&eo(A,{select:!0})):b.shiftKey&&I===A&&(b.preventDefault(),r&&eo(L,{select:!0})):I===N&&b.preventDefault()}},[r,n,v.paused]);return o.jsx(He.div,{tabIndex:-1,...a,ref:y,onKeyDown:E})});bf.displayName=VY;function GY(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(eo(n,{select:e}),document.activeElement!==r)return}function HY(t){const e=T3(t),r=lA(e,t),n=lA(e.reverse(),t);return[r,n]}function T3(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function lA(t,e){for(const r of t)if(!zY(r,{upTo:e}))return r}function zY(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function WY(t){return t instanceof HTMLInputElement&&"select"in t}function eo(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&WY(t)&&e&&t.select()}}var cA=KY();function KY(){let t=[];return{add(e){const r=t[0];e!==r&&(r==null||r.pause()),t=uA(t,e),t.unshift(e)},remove(e){var r;t=uA(t,e),(r=t[0])==null||r.resume()}}}function uA(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function YY(t){return t.filter(e=>e.tagName!=="A")}var qY=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},wc=new WeakMap,fm=new WeakMap,mm={},o1=0,C3=function(t){return t&&(t.host||C3(t.parentNode))},XY=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=C3(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},QY=function(t,e,r,n){var s=XY(e,Array.isArray(t)?t:[t]);mm[r]||(mm[r]=new WeakMap);var i=mm[r],a=[],l=new Set,d=new Set(s),u=function(p){!p||l.has(p)||(l.add(p),u(p.parentNode))};s.forEach(u);var f=function(p){!p||d.has(p)||Array.prototype.forEach.call(p.children,function(y){if(l.has(y))f(y);else try{var v=y.getAttribute(n),E=v!==null&&v!=="false",b=(wc.get(y)||0)+1,T=(i.get(y)||0)+1;wc.set(y,b),i.set(y,T),a.push(y),b===1&&E&&fm.set(y,!0),T===1&&y.setAttribute(r,"true"),E||y.setAttribute(n,"true")}catch(I){console.error("aria-hidden: cannot operate on ",y,I)}})};return f(e),l.clear(),o1++,function(){a.forEach(function(p){var y=wc.get(p)-1,v=i.get(p)-1;wc.set(p,y),i.set(p,v),y||(fm.has(p)||p.removeAttribute(n),fm.delete(p)),v||p.removeAttribute(r)}),o1--,o1||(wc=new WeakMap,wc=new WeakMap,fm=new WeakMap,mm={})}},vg=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),s=qY(t);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),QY(n,s,r,"aria-hidden")):function(){return null}},Yi=function(){return Yi=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},Yi.apply(this,arguments)};function A3(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function ZY(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var r0="right-scroll-bar-position",n0="width-before-scroll-bar",JY="with-scroll-bars-hidden",eq="--removed-body-scroll-bar-size";function l1(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function tq(t,e){var r=C.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=e,r.facade}var rq=typeof window<"u"?C.useLayoutEffect:C.useEffect,dA=new WeakMap;function nq(t,e){var r=tq(null,function(n){return t.forEach(function(s){return l1(s,n)})});return rq(function(){var n=dA.get(r);if(n){var s=new Set(n),i=new Set(t),a=r.current;s.forEach(function(l){i.has(l)||l1(l,null)}),i.forEach(function(l){s.has(l)||l1(l,a)})}dA.set(r,t)},[t]),r}function sq(t){return t}function iq(t,e){e===void 0&&(e=sq);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var a=e(i,n);return r.push(a),function(){r=r.filter(function(l){return l!==a})}},assignSyncMedium:function(i){for(n=!0;r.length;){var a=r;r=[],a.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){n=!0;var a=[];if(r.length){var l=r;r=[],l.forEach(i),a=r}var d=function(){var f=a;a=[],f.forEach(i)},u=function(){return Promise.resolve().then(d)};u(),r={push:function(f){a.push(f),u()},filter:function(f){return a=a.filter(f),r}}}};return s}function aq(t){t===void 0&&(t={});var e=iq(null);return e.options=Yi({async:!0,ssr:!1},t),e}var N3=function(t){var e=t.sideCar,r=A3(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return C.createElement(n,Yi({},r))};N3.isSideCarExport=!0;function oq(t,e){return t.useMedium(e),N3}var I3=aq(),c1=function(){},wg=C.forwardRef(function(t,e){var r=C.useRef(null),n=C.useState({onScrollCapture:c1,onWheelCapture:c1,onTouchMoveCapture:c1}),s=n[0],i=n[1],a=t.forwardProps,l=t.children,d=t.className,u=t.removeScrollBar,f=t.enabled,p=t.shards,y=t.sideCar,v=t.noRelative,E=t.noIsolation,b=t.inert,T=t.allowPinchZoom,I=t.as,N=I===void 0?"div":I,A=t.gapMode,L=A3(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=y,k=nq([r,e]),D=Yi(Yi({},L),s);return C.createElement(C.Fragment,null,f&&C.createElement(P,{sideCar:I3,removeScrollBar:u,shards:p,noRelative:v,noIsolation:E,inert:b,setCallbacks:i,allowPinchZoom:!!T,lockRef:r,gapMode:A}),a?C.cloneElement(C.Children.only(l),Yi(Yi({},D),{ref:k})):C.createElement(N,Yi({},D,{className:d,ref:k}),l))});wg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};wg.classNames={fullWidth:n0,zeroRight:r0};var lq=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function cq(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=lq();return e&&t.setAttribute("nonce",e),t}function uq(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function dq(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var hq=function(){var t=0,e=null;return{add:function(r){t==0&&(e=cq())&&(uq(e,r),dq(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},fq=function(){var t=hq();return function(e,r){C.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},R3=function(){var t=fq(),e=function(r){var n=r.styles,s=r.dynamic;return t(n,s),null};return e},mq={left:0,top:0,right:0,gap:0},u1=function(t){return parseInt(t||"",10)||0},pq=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[u1(r),u1(n),u1(s)]},gq=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return mq;var e=pq(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},xq=R3(),ou="data-scroll-locked",yq=function(t,e,r,n){var s=t.left,i=t.top,a=t.right,l=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(JY,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(ou,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(r0,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(n0,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(r0," .").concat(r0,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(n0," .").concat(n0,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(ou,`] {
    `).concat(eq,": ").concat(l,`px;
  }
`)},hA=function(){var t=parseInt(document.body.getAttribute(ou)||"0",10);return isFinite(t)?t:0},vq=function(){C.useEffect(function(){return document.body.setAttribute(ou,(hA()+1).toString()),function(){var t=hA()-1;t<=0?document.body.removeAttribute(ou):document.body.setAttribute(ou,t.toString())}},[])},wq=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,s=n===void 0?"margin":n;vq();var i=C.useMemo(function(){return gq(s)},[s]);return C.createElement(xq,{styles:yq(i,!e,s,r?"":"!important")})},Sv=!1;if(typeof window<"u")try{var pm=Object.defineProperty({},"passive",{get:function(){return Sv=!0,!0}});window.addEventListener("test",pm,pm),window.removeEventListener("test",pm,pm)}catch{Sv=!1}var bc=Sv?{passive:!1}:!1,bq=function(t){return t.tagName==="TEXTAREA"},_3=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!bq(t)&&r[e]==="visible")},Eq=function(t){return _3(t,"overflowY")},Sq=function(t){return _3(t,"overflowX")},fA=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=L3(t,n);if(s){var i=P3(t,n),a=i[1],l=i[2];if(a>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},Tq=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},Cq=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},L3=function(t,e){return t==="v"?Eq(e):Sq(e)},P3=function(t,e){return t==="v"?Tq(e):Cq(e)},Aq=function(t,e){return t==="h"&&e==="rtl"?-1:1},Nq=function(t,e,r,n,s){var i=Aq(t,window.getComputedStyle(e).direction),a=i*n,l=r.target,d=e.contains(l),u=!1,f=a>0,p=0,y=0;do{if(!l)break;var v=P3(t,l),E=v[0],b=v[1],T=v[2],I=b-T-i*E;(E||I)&&L3(t,l)&&(p+=I,y+=E);var N=l.parentNode;l=N&&N.nodeType===Node.DOCUMENT_FRAGMENT_NODE?N.host:N}while(!d&&l!==document.body||d&&(e.contains(l)||e===l));return(f&&(Math.abs(p)<1||!s)||!f&&(Math.abs(y)<1||!s))&&(u=!0),u},gm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},mA=function(t){return[t.deltaX,t.deltaY]},pA=function(t){return t&&"current"in t?t.current:t},Iq=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Rq=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},_q=0,Ec=[];function Lq(t){var e=C.useRef([]),r=C.useRef([0,0]),n=C.useRef(),s=C.useState(_q++)[0],i=C.useState(R3)[0],a=C.useRef(t);C.useEffect(function(){a.current=t},[t]),C.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var b=ZY([t.lockRef.current],(t.shards||[]).map(pA),!0).filter(Boolean);return b.forEach(function(T){return T.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=C.useCallback(function(b,T){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var I=gm(b),N=r.current,A="deltaX"in b?b.deltaX:N[0]-I[0],L="deltaY"in b?b.deltaY:N[1]-I[1],P,k=b.target,D=Math.abs(A)>Math.abs(L)?"h":"v";if("touches"in b&&D==="h"&&k.type==="range")return!1;var O=fA(D,k);if(!O)return!0;if(O?P=D:(P=D==="v"?"h":"v",O=fA(D,k)),!O)return!1;if(!n.current&&"changedTouches"in b&&(A||L)&&(n.current=P),!P)return!0;var F=n.current||P;return Nq(F,T,b,F==="h"?A:L,!0)},[]),d=C.useCallback(function(b){var T=b;if(!(!Ec.length||Ec[Ec.length-1]!==i)){var I="deltaY"in T?mA(T):gm(T),N=e.current.filter(function(P){return P.name===T.type&&(P.target===T.target||T.target===P.shadowParent)&&Iq(P.delta,I)})[0];if(N&&N.should){T.cancelable&&T.preventDefault();return}if(!N){var A=(a.current.shards||[]).map(pA).filter(Boolean).filter(function(P){return P.contains(T.target)}),L=A.length>0?l(T,A[0]):!a.current.noIsolation;L&&T.cancelable&&T.preventDefault()}}},[]),u=C.useCallback(function(b,T,I,N){var A={name:b,delta:T,target:I,should:N,shadowParent:Pq(I)};e.current.push(A),setTimeout(function(){e.current=e.current.filter(function(L){return L!==A})},1)},[]),f=C.useCallback(function(b){r.current=gm(b),n.current=void 0},[]),p=C.useCallback(function(b){u(b.type,mA(b),b.target,l(b,t.lockRef.current))},[]),y=C.useCallback(function(b){u(b.type,gm(b),b.target,l(b,t.lockRef.current))},[]);C.useEffect(function(){return Ec.push(i),t.setCallbacks({onScrollCapture:p,onWheelCapture:p,onTouchMoveCapture:y}),document.addEventListener("wheel",d,bc),document.addEventListener("touchmove",d,bc),document.addEventListener("touchstart",f,bc),function(){Ec=Ec.filter(function(b){return b!==i}),document.removeEventListener("wheel",d,bc),document.removeEventListener("touchmove",d,bc),document.removeEventListener("touchstart",f,bc)}},[]);var v=t.removeScrollBar,E=t.inert;return C.createElement(C.Fragment,null,E?C.createElement(i,{styles:Rq(s)}):null,v?C.createElement(wq,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Pq(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Dq=oq(I3,Lq);var Ef=C.forwardRef(function(t,e){return C.createElement(wg,Yi({},t,{ref:e,sideCar:Dq}))});Ef.classNames=wg.classNames;var bg="Popover",[D3,Iae]=hn(bg,[zo]),Sf=zo(),[kq,Xo]=D3(bg),k3=t=>{const{__scopePopover:e,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!1}=t,l=Sf(e),d=C.useRef(null),[u,f]=C.useState(!1),[p,y]=Ai({prop:n,defaultProp:s??!1,onChange:i,caller:bg});return o.jsx(Cb,{...l,children:o.jsx(kq,{scope:e,contentId:Ti(),triggerRef:d,open:p,onOpenChange:y,onOpenToggle:C.useCallback(()=>y(v=>!v),[y]),hasCustomAnchor:u,onCustomAnchorAdd:C.useCallback(()=>f(!0),[]),onCustomAnchorRemove:C.useCallback(()=>f(!1),[]),modal:a,children:r})})};k3.displayName=bg;var j3="PopoverAnchor",jq=C.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Xo(j3,r),i=Sf(r),{onCustomAnchorAdd:a,onCustomAnchorRemove:l}=s;return C.useEffect(()=>(a(),()=>l()),[a,l]),o.jsx(hf,{...i,...n,ref:e})});jq.displayName=j3;var M3="PopoverTrigger",O3=C.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Xo(M3,r),i=Sf(r),a=st(e,s.triggerRef),l=o.jsx(He.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":V3(s.open),...n,ref:a,onClick:Re(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:o.jsx(hf,{asChild:!0,...i,children:l})});O3.displayName=M3;var xE="PopoverPortal",[Mq,Oq]=D3(xE,{forceMount:void 0}),F3=t=>{const{__scopePopover:e,forceMount:r,children:n,container:s}=t,i=Xo(xE,e);return o.jsx(Mq,{scope:e,forceMount:r,children:o.jsx(fn,{present:r||i.open,children:o.jsx(Vu,{asChild:!0,container:s,children:n})})})};F3.displayName=xE;var ku="PopoverContent",B3=C.forwardRef((t,e)=>{const r=Oq(ku,t.__scopePopover),{forceMount:n=r.forceMount,...s}=t,i=Xo(ku,t.__scopePopover);return o.jsx(fn,{present:n||i.open,children:i.modal?o.jsx(Bq,{...s,ref:e}):o.jsx(Uq,{...s,ref:e})})});B3.displayName=ku;var Fq=Ro("PopoverContent.RemoveScroll"),Bq=C.forwardRef((t,e)=>{const r=Xo(ku,t.__scopePopover),n=C.useRef(null),s=st(e,n),i=C.useRef(!1);return C.useEffect(()=>{const a=n.current;if(a)return vg(a)},[]),o.jsx(Ef,{as:Fq,allowPinchZoom:!0,children:o.jsx(U3,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(t.onCloseAutoFocus,a=>{var l;a.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Re(t.onPointerDownOutside,a=>{const l=a.detail.originalEvent,d=l.button===0&&l.ctrlKey===!0,u=l.button===2||d;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Re(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),Uq=C.forwardRef((t,e)=>{const r=Xo(ku,t.__scopePopover),n=C.useRef(!1),s=C.useRef(!1);return o.jsx(U3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,l;(a=t.onCloseAutoFocus)==null||a.call(t,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),U3=C.forwardRef((t,e)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:u,onInteractOutside:f,...p}=t,y=Xo(ku,r),v=Sf(r);return yg(),o.jsx(bf,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:o.jsx(ec,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:f,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:u,onDismiss:()=>y.onOpenChange(!1),children:o.jsx(eg,{"data-state":V3(y.open),role:"dialog",id:y.contentId,...v,...p,ref:e,style:{...p.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),$3="PopoverClose",$q=C.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Xo($3,r);return o.jsx(He.button,{type:"button",...n,ref:e,onClick:Re(t.onClick,()=>s.onOpenChange(!1))})});$q.displayName=$3;var Vq="PopoverArrow",Gq=C.forwardRef((t,e)=>{const{__scopePopover:r,...n}=t,s=Sf(r);return o.jsx(tg,{...s,...n,ref:e})});Gq.displayName=Vq;function V3(t){return t?"open":"closed"}var Hq=k3,zq=O3,Wq=F3,G3=B3;const Kq=Hq,Yq=zq,H3=C.forwardRef(({className:t,align:e="center",sideOffset:r=4,...n},s)=>o.jsx(Wq,{children:o.jsx(G3,{ref:s,align:e,sideOffset:r,className:Ye("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));H3.displayName=G3.displayName;var qq=C.createContext(void 0);function rc(t){const e=C.useContext(qq);return t||e||"ltr"}function Fh(t,[e,r]){return Math.min(r,Math.max(e,t))}function Xq(t,e){return C.useReducer((r,n)=>e[r][n]??r,t)}var yE="ScrollArea",[z3,Rae]=hn(yE),[Qq,si]=z3(yE),W3=C.forwardRef((t,e)=>{const{__scopeScrollArea:r,type:n="hover",dir:s,scrollHideDelay:i=600,...a}=t,[l,d]=C.useState(null),[u,f]=C.useState(null),[p,y]=C.useState(null),[v,E]=C.useState(null),[b,T]=C.useState(null),[I,N]=C.useState(0),[A,L]=C.useState(0),[P,k]=C.useState(!1),[D,O]=C.useState(!1),F=st(e,G=>d(G)),$=rc(s);return o.jsx(Qq,{scope:r,type:n,dir:$,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:f,content:p,onContentChange:y,scrollbarX:v,onScrollbarXChange:E,scrollbarXEnabled:P,onScrollbarXEnabledChange:k,scrollbarY:b,onScrollbarYChange:T,scrollbarYEnabled:D,onScrollbarYEnabledChange:O,onCornerWidthChange:N,onCornerHeightChange:L,children:o.jsx(He.div,{dir:$,...a,ref:F,style:{position:"relative","--radix-scroll-area-corner-width":I+"px","--radix-scroll-area-corner-height":A+"px",...t.style}})})});W3.displayName=yE;var K3="ScrollAreaViewport",Y3=C.forwardRef((t,e)=>{const{__scopeScrollArea:r,children:n,nonce:s,...i}=t,a=si(K3,r),l=C.useRef(null),d=st(e,l,a.onViewportChange);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),o.jsx(He.div,{"data-radix-scroll-area-viewport":"",...i,ref:d,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...t.style},children:o.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Y3.displayName=K3;var ua="ScrollAreaScrollbar",vE=C.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=si(ua,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,l=t.orientation==="horizontal";return C.useEffect(()=>(l?i(!0):a(!0),()=>{l?i(!1):a(!1)}),[l,i,a]),s.type==="hover"?o.jsx(Zq,{...n,ref:e,forceMount:r}):s.type==="scroll"?o.jsx(Jq,{...n,ref:e,forceMount:r}):s.type==="auto"?o.jsx(q3,{...n,ref:e,forceMount:r}):s.type==="always"?o.jsx(wE,{...n,ref:e}):null});vE.displayName=ua;var Zq=C.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=si(ua,t.__scopeScrollArea),[i,a]=C.useState(!1);return C.useEffect(()=>{const l=s.scrollArea;let d=0;if(l){const u=()=>{window.clearTimeout(d),a(!0)},f=()=>{d=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",f),()=>{window.clearTimeout(d),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",f)}}},[s.scrollArea,s.scrollHideDelay]),o.jsx(fn,{present:r||i,children:o.jsx(q3,{"data-state":i?"visible":"hidden",...n,ref:e})})}),Jq=C.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=si(ua,t.__scopeScrollArea),i=t.orientation==="horizontal",a=Sg(()=>d("SCROLL_END"),100),[l,d]=Xq("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return C.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>d("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,d]),C.useEffect(()=>{const u=s.viewport,f=i?"scrollLeft":"scrollTop";if(u){let p=u[f];const y=()=>{const v=u[f];p!==v&&(d("SCROLL"),a()),p=v};return u.addEventListener("scroll",y),()=>u.removeEventListener("scroll",y)}},[s.viewport,i,d,a]),o.jsx(fn,{present:r||l!=="hidden",children:o.jsx(wE,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:Re(t.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Re(t.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),q3=C.forwardRef((t,e)=>{const r=si(ua,t.__scopeScrollArea),{forceMount:n,...s}=t,[i,a]=C.useState(!1),l=t.orientation==="horizontal",d=Sg(()=>{if(r.viewport){const u=r.viewport.offsetWidth<r.viewport.scrollWidth,f=r.viewport.offsetHeight<r.viewport.scrollHeight;a(l?u:f)}},10);return ju(r.viewport,d),ju(r.content,d),o.jsx(fn,{present:n||i,children:o.jsx(wE,{"data-state":i?"visible":"hidden",...s,ref:e})})}),wE=C.forwardRef((t,e)=>{const{orientation:r="vertical",...n}=t,s=si(ua,t.__scopeScrollArea),i=C.useRef(null),a=C.useRef(0),[l,d]=C.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=ek(l.viewport,l.content),f={...n,sizes:l,onSizesChange:d,hasThumb:u>0&&u<1,onThumbChange:y=>i.current=y,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:y=>a.current=y};function p(y,v){return iX(y,a.current,l,v)}return r==="horizontal"?o.jsx(eX,{...f,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const y=s.viewport.scrollLeft,v=gA(y,l,s.dir);i.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:y=>{s.viewport&&(s.viewport.scrollLeft=y)},onDragScroll:y=>{s.viewport&&(s.viewport.scrollLeft=p(y,s.dir))}}):r==="vertical"?o.jsx(tX,{...f,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const y=s.viewport.scrollTop,v=gA(y,l);i.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:y=>{s.viewport&&(s.viewport.scrollTop=y)},onDragScroll:y=>{s.viewport&&(s.viewport.scrollTop=p(y))}}):null}),eX=C.forwardRef((t,e)=>{const{sizes:r,onSizesChange:n,...s}=t,i=si(ua,t.__scopeScrollArea),[a,l]=C.useState(),d=C.useRef(null),u=st(e,d,i.onScrollbarXChange);return C.useEffect(()=>{d.current&&l(getComputedStyle(d.current))},[d]),o.jsx(Q3,{"data-orientation":"horizontal",...s,ref:u,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Eg(r)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.x),onDragScroll:f=>t.onDragScroll(f.x),onWheelScroll:(f,p)=>{if(i.viewport){const y=i.viewport.scrollLeft+f.deltaX;t.onWheelScroll(y),rk(y,p)&&f.preventDefault()}},onResize:()=>{d.current&&i.viewport&&a&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:np(a.paddingLeft),paddingEnd:np(a.paddingRight)}})}})}),tX=C.forwardRef((t,e)=>{const{sizes:r,onSizesChange:n,...s}=t,i=si(ua,t.__scopeScrollArea),[a,l]=C.useState(),d=C.useRef(null),u=st(e,d,i.onScrollbarYChange);return C.useEffect(()=>{d.current&&l(getComputedStyle(d.current))},[d]),o.jsx(Q3,{"data-orientation":"vertical",...s,ref:u,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Eg(r)+"px",...t.style},onThumbPointerDown:f=>t.onThumbPointerDown(f.y),onDragScroll:f=>t.onDragScroll(f.y),onWheelScroll:(f,p)=>{if(i.viewport){const y=i.viewport.scrollTop+f.deltaY;t.onWheelScroll(y),rk(y,p)&&f.preventDefault()}},onResize:()=>{d.current&&i.viewport&&a&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:np(a.paddingTop),paddingEnd:np(a.paddingBottom)}})}})}),[rX,X3]=z3(ua),Q3=C.forwardRef((t,e)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:l,onThumbPositionChange:d,onDragScroll:u,onWheelScroll:f,onResize:p,...y}=t,v=si(ua,r),[E,b]=C.useState(null),T=st(e,F=>b(F)),I=C.useRef(null),N=C.useRef(""),A=v.viewport,L=n.content-n.viewport,P=Lr(f),k=Lr(d),D=Sg(p,10);function O(F){if(I.current){const $=F.clientX-I.current.left,G=F.clientY-I.current.top;u({x:$,y:G})}}return C.useEffect(()=>{const F=$=>{const G=$.target;(E==null?void 0:E.contains(G))&&P($,L)};return document.addEventListener("wheel",F,{passive:!1}),()=>document.removeEventListener("wheel",F,{passive:!1})},[A,E,L,P]),C.useEffect(k,[n,k]),ju(E,D),ju(v.content,D),o.jsx(rX,{scope:r,scrollbar:E,hasThumb:s,onThumbChange:Lr(i),onThumbPointerUp:Lr(a),onThumbPositionChange:k,onThumbPointerDown:Lr(l),children:o.jsx(He.div,{...y,ref:T,style:{position:"absolute",...y.style},onPointerDown:Re(t.onPointerDown,F=>{F.button===0&&(F.target.setPointerCapture(F.pointerId),I.current=E.getBoundingClientRect(),N.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),O(F))}),onPointerMove:Re(t.onPointerMove,O),onPointerUp:Re(t.onPointerUp,F=>{const $=F.target;$.hasPointerCapture(F.pointerId)&&$.releasePointerCapture(F.pointerId),document.body.style.webkitUserSelect=N.current,v.viewport&&(v.viewport.style.scrollBehavior=""),I.current=null})})})}),rp="ScrollAreaThumb",Z3=C.forwardRef((t,e)=>{const{forceMount:r,...n}=t,s=X3(rp,t.__scopeScrollArea);return o.jsx(fn,{present:r||s.hasThumb,children:o.jsx(nX,{ref:e,...n})})}),nX=C.forwardRef((t,e)=>{const{__scopeScrollArea:r,style:n,...s}=t,i=si(rp,r),a=X3(rp,r),{onThumbPositionChange:l}=a,d=st(e,p=>a.onThumbChange(p)),u=C.useRef(void 0),f=Sg(()=>{u.current&&(u.current(),u.current=void 0)},100);return C.useEffect(()=>{const p=i.viewport;if(p){const y=()=>{if(f(),!u.current){const v=aX(p,l);u.current=v,l()}};return l(),p.addEventListener("scroll",y),()=>p.removeEventListener("scroll",y)}},[i.viewport,f,l]),o.jsx(He.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:Re(t.onPointerDownCapture,p=>{const v=p.target.getBoundingClientRect(),E=p.clientX-v.left,b=p.clientY-v.top;a.onThumbPointerDown({x:E,y:b})}),onPointerUp:Re(t.onPointerUp,a.onThumbPointerUp)})});Z3.displayName=rp;var bE="ScrollAreaCorner",J3=C.forwardRef((t,e)=>{const r=si(bE,t.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?o.jsx(sX,{...t,ref:e}):null});J3.displayName=bE;var sX=C.forwardRef((t,e)=>{const{__scopeScrollArea:r,...n}=t,s=si(bE,r),[i,a]=C.useState(0),[l,d]=C.useState(0),u=!!(i&&l);return ju(s.scrollbarX,()=>{var p;const f=((p=s.scrollbarX)==null?void 0:p.offsetHeight)||0;s.onCornerHeightChange(f),d(f)}),ju(s.scrollbarY,()=>{var p;const f=((p=s.scrollbarY)==null?void 0:p.offsetWidth)||0;s.onCornerWidthChange(f),a(f)}),u?o.jsx(He.div,{...n,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function np(t){return t?parseInt(t,10):0}function ek(t,e){const r=t/e;return isNaN(r)?0:r}function Eg(t){const e=ek(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=(t.scrollbar.size-r)*e;return Math.max(n,18)}function iX(t,e,r,n="ltr"){const s=Eg(r),i=s/2,a=e||i,l=s-a,d=r.scrollbar.paddingStart+a,u=r.scrollbar.size-r.scrollbar.paddingEnd-l,f=r.content-r.viewport,p=n==="ltr"?[0,f]:[f*-1,0];return tk([d,u],p)(t)}function gA(t,e,r="ltr"){const n=Eg(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,a=e.content-e.viewport,l=i-n,d=r==="ltr"?[0,a]:[a*-1,0],u=Fh(t,d);return tk([0,a],[0,l])(u)}function tk(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(t[1]-t[0]);return e[0]+n*(r-t[0])}}function rk(t,e){return t>0&&t<e}var aX=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},n=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},a=r.left!==i.left,l=r.top!==i.top;(a||l)&&e(),r=i,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function Sg(t,e){const r=Lr(t),n=C.useRef(0);return C.useEffect(()=>()=>window.clearTimeout(n.current),[]),C.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,e)},[r,e])}function ju(t,e){const r=Lr(e);Br(()=>{let n=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return s.observe(t),()=>{window.cancelAnimationFrame(n),s.unobserve(t)}}},[t,r])}var nk=W3,oX=Y3,lX=J3;const sk=C.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(nk,{ref:n,className:Ye("relative overflow-hidden",t),...r,children:[o.jsx(oX,{className:"h-full w-full rounded-[inherit]",children:e}),o.jsx(ik,{}),o.jsx(lX,{})]}));sk.displayName=nk.displayName;const ik=C.forwardRef(({className:t,orientation:e="vertical",...r},n)=>o.jsx(vE,{ref:n,orientation:e,className:Ye("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:o.jsx(Z3,{className:"relative flex-1 rounded-full bg-border"})}));ik.displayName=vE.displayName;const cX=t=>{switch(t){case"SUPPORT":return"";case"VIDEO":return"";case"CREDIT":return"";case"SYSTEM":return"";case"SHARE":return"";default:return""}},uX=t=>{const e=t.endsWith("Z")?t:t+"Z",r=new Date(e),s=Math.floor((new Date().getTime()-r.getTime())/1e3);return s<60?" l'instant":s<3600?`Il y a ${Math.floor(s/60)} min`:s<86400?`Il y a ${Math.floor(s/3600)} h`:r.toLocaleDateString("fr-FR",{day:"numeric",month:"short"})};function dX(){const t=ni(),[e,r]=C.useState([]),[n,s]=C.useState(!1),[i,a]=C.useState(!1),[l,d]=C.useState(0);C.useEffect(()=>{u();const v=setInterval(u,3e4);return()=>clearInterval(v)},[]),C.useEffect(()=>{n&&u()},[n]);const u=async()=>{var v,E;try{a(!0);const b=await Qm.getMyNotifications();console.log("[NotificationBell] API Response:",b.data),r(b.data.notifications||[]),d(((v=b.data.stats)==null?void 0:v.unread_count)||0)}catch(b){console.error("Error loading notifications:",b),(E=b.response)==null||E.status}finally{a(!1)}},f=async()=>{try{await Qm.markAllAsRead(),await u(),Ge.success("Toutes les notifications sont marques comme lues")}catch(v){console.error("Failed to mark all as read:",v),Ge.error("Erreur lors de la mise  jour")}},p=async v=>{if(!v.is_read)try{await Qm.markAsRead(v.id.toString()),await u()}catch(E){console.error("Error marking notification as read:",E)}if(v.link)try{["/dashboard","/my-clips","/profile","/credits"].some(b=>{var T;return(T=v.link)==null?void 0:T.startsWith(b)})?(t(v.link),s(!1)):console.warn("Invalid notification link:",v.link)}catch(E){console.error("Navigation error:",E)}},y=(v,E)=>{E.stopPropagation(),r(b=>b.filter(T=>T.id!==v)),d(b=>{const T=e.find(I=>I.id===v);return T&&!T.is_read?b-1:b})};return o.jsxs(Kq,{open:n,onOpenChange:s,children:[o.jsx(Yq,{asChild:!0,children:o.jsxs(ve,{variant:"ghost",size:"icon",className:"relative rounded-full hover:bg-primary/10",children:[o.jsx(ky,{className:"h-5 w-5"}),o.jsx(oE,{children:l>0&&o.jsx(Me.span,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center rounded-full bg-destructive text-destructive-foreground text-xs font-bold",children:l>9?"9+":l})})]})}),o.jsxs(H3,{align:"end",className:"w-80 p-0 glass border-border/50",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border/50",children:[o.jsxs("h3",{className:"font-semibold",children:["Notifications ",l>0&&`(${l})`]}),l>0&&o.jsxs(ve,{variant:"ghost",size:"sm",onClick:f,className:"text-xs text-primary hover:text-primary",children:[o.jsx(Ts,{className:"h-3 w-3 mr-1"}),"Tout marquer lu"]})]}),o.jsx(sk,{className:"max-h-96",children:i?o.jsx("div",{className:"p-8 text-center",children:o.jsx(ft,{className:"h-8 w-8 mx-auto animate-spin text-primary"})}):e.length===0?o.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:[o.jsx(ky,{className:"h-10 w-10 mx-auto mb-2 opacity-50"}),o.jsx("p",{className:"text-sm",children:"Aucune notification"})]}):o.jsx("div",{className:"divide-y divide-border/50",children:e.map(v=>{const E=v.notification_type||v.type||"SYSTEM",b=cX(E);return o.jsx(Me.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:`p-3 hover:bg-card/50 transition-colors cursor-pointer group ${v.is_read?"":"bg-primary/5"}`,onClick:()=>p(v),children:o.jsxs("div",{className:"flex gap-3 w-full",children:[o.jsx("div",{className:"text-2xl flex-shrink-0",children:b}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-2",children:[o.jsx("p",{className:"font-medium text-sm",children:v.title}),o.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[!v.is_read&&o.jsx("span",{className:"h-2 w-2 rounded-full bg-primary"}),o.jsx(ve,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100",onClick:T=>y(v.id,T),children:o.jsx(Fa,{className:"h-3 w-3"})})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1 line-clamp-2",children:v.message}),o.jsx("p",{className:"text-xs text-muted-foreground/70 mt-1",children:uX(v.created_at)})]})]})},v.id)})})})]})]})}var d1="rovingFocusGroup.onEntryFocus",hX={bubbles:!1,cancelable:!0},Tf="RovingFocusGroup",[Tv,ak,fX]=tf(Tf),[mX,td]=hn(Tf,[fX]),[pX,gX]=mX(Tf),ok=C.forwardRef((t,e)=>o.jsx(Tv.Provider,{scope:t.__scopeRovingFocusGroup,children:o.jsx(Tv.Slot,{scope:t.__scopeRovingFocusGroup,children:o.jsx(xX,{...t,ref:e})})}));ok.displayName=Tf;var xX=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:d,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...p}=t,y=C.useRef(null),v=st(e,y),E=rc(i),[b,T]=Ai({prop:a,defaultProp:l??null,onChange:d,caller:Tf}),[I,N]=C.useState(!1),A=Lr(u),L=ak(r),P=C.useRef(!1),[k,D]=C.useState(0);return C.useEffect(()=>{const O=y.current;if(O)return O.addEventListener(d1,A),()=>O.removeEventListener(d1,A)},[A]),o.jsx(pX,{scope:r,orientation:n,dir:E,loop:s,currentTabStopId:b,onItemFocus:C.useCallback(O=>T(O),[T]),onItemShiftTab:C.useCallback(()=>N(!0),[]),onFocusableItemAdd:C.useCallback(()=>D(O=>O+1),[]),onFocusableItemRemove:C.useCallback(()=>D(O=>O-1),[]),children:o.jsx(He.div,{tabIndex:I||k===0?-1:0,"data-orientation":n,...p,ref:v,style:{outline:"none",...t.style},onMouseDown:Re(t.onMouseDown,()=>{P.current=!0}),onFocus:Re(t.onFocus,O=>{const F=!P.current;if(O.target===O.currentTarget&&F&&!I){const $=new CustomEvent(d1,hX);if(O.currentTarget.dispatchEvent($),!$.defaultPrevented){const G=L().filter(Z=>Z.focusable),Y=G.find(Z=>Z.active),ne=G.find(Z=>Z.id===b),z=[Y,ne,...G].filter(Boolean).map(Z=>Z.ref.current);uk(z,f)}}P.current=!1}),onBlur:Re(t.onBlur,()=>N(!1))})})}),lk="RovingFocusGroupItem",ck=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,children:a,...l}=t,d=Ti(),u=i||d,f=gX(lk,r),p=f.currentTabStopId===u,y=ak(r),{onFocusableItemAdd:v,onFocusableItemRemove:E,currentTabStopId:b}=f;return C.useEffect(()=>{if(n)return v(),()=>E()},[n,v,E]),o.jsx(Tv.ItemSlot,{scope:r,id:u,focusable:n,active:s,children:o.jsx(He.span,{tabIndex:p?0:-1,"data-orientation":f.orientation,...l,ref:e,onMouseDown:Re(t.onMouseDown,T=>{n?f.onItemFocus(u):T.preventDefault()}),onFocus:Re(t.onFocus,()=>f.onItemFocus(u)),onKeyDown:Re(t.onKeyDown,T=>{if(T.key==="Tab"&&T.shiftKey){f.onItemShiftTab();return}if(T.target!==T.currentTarget)return;const I=wX(T,f.orientation,f.dir);if(I!==void 0){if(T.metaKey||T.ctrlKey||T.altKey||T.shiftKey)return;T.preventDefault();let A=y().filter(L=>L.focusable).map(L=>L.ref.current);if(I==="last")A.reverse();else if(I==="prev"||I==="next"){I==="prev"&&A.reverse();const L=A.indexOf(T.currentTarget);A=f.loop?bX(A,L+1):A.slice(L+1)}setTimeout(()=>uk(A))}}),children:typeof a=="function"?a({isCurrentTabStop:p,hasTabStop:b!=null}):a})})});ck.displayName=lk;var yX={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function vX(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function wX(t,e,r){const n=vX(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return yX[n]}function uk(t,e=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:e}),document.activeElement!==r))return}function bX(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var EE=ok,SE=ck,Cv=["Enter"," "],EX=["ArrowDown","PageUp","Home"],dk=["ArrowUp","PageDown","End"],SX=[...EX,...dk],TX={ltr:[...Cv,"ArrowRight"],rtl:[...Cv,"ArrowLeft"]},CX={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Cf="Menu",[Bh,AX,NX]=tf(Cf),[nc,hk]=hn(Cf,[NX,zo,td]),Tg=zo(),fk=td(),[IX,sc]=nc(Cf),[RX,Af]=nc(Cf),mk=t=>{const{__scopeMenu:e,open:r=!1,children:n,dir:s,onOpenChange:i,modal:a=!0}=t,l=Tg(e),[d,u]=C.useState(null),f=C.useRef(!1),p=Lr(i),y=rc(s);return C.useEffect(()=>{const v=()=>{f.current=!0,document.addEventListener("pointerdown",E,{capture:!0,once:!0}),document.addEventListener("pointermove",E,{capture:!0,once:!0})},E=()=>f.current=!1;return document.addEventListener("keydown",v,{capture:!0}),()=>{document.removeEventListener("keydown",v,{capture:!0}),document.removeEventListener("pointerdown",E,{capture:!0}),document.removeEventListener("pointermove",E,{capture:!0})}},[]),o.jsx(Cb,{...l,children:o.jsx(IX,{scope:e,open:r,onOpenChange:p,content:d,onContentChange:u,children:o.jsx(RX,{scope:e,onClose:C.useCallback(()=>p(!1),[p]),isUsingKeyboardRef:f,dir:y,modal:a,children:n})})})};mk.displayName=Cf;var _X="MenuAnchor",TE=C.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=Tg(r);return o.jsx(hf,{...s,...n,ref:e})});TE.displayName=_X;var CE="MenuPortal",[LX,pk]=nc(CE,{forceMount:void 0}),gk=t=>{const{__scopeMenu:e,forceMount:r,children:n,container:s}=t,i=sc(CE,e);return o.jsx(LX,{scope:e,forceMount:r,children:o.jsx(fn,{present:r||i.open,children:o.jsx(Vu,{asChild:!0,container:s,children:n})})})};gk.displayName=CE;var Js="MenuContent",[PX,AE]=nc(Js),xk=C.forwardRef((t,e)=>{const r=pk(Js,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,i=sc(Js,t.__scopeMenu),a=Af(Js,t.__scopeMenu);return o.jsx(Bh.Provider,{scope:t.__scopeMenu,children:o.jsx(fn,{present:n||i.open,children:o.jsx(Bh.Slot,{scope:t.__scopeMenu,children:a.modal?o.jsx(DX,{...s,ref:e}):o.jsx(kX,{...s,ref:e})})})})}),DX=C.forwardRef((t,e)=>{const r=sc(Js,t.__scopeMenu),n=C.useRef(null),s=st(e,n);return C.useEffect(()=>{const i=n.current;if(i)return vg(i)},[]),o.jsx(NE,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Re(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),kX=C.forwardRef((t,e)=>{const r=sc(Js,t.__scopeMenu);return o.jsx(NE,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),jX=Ro("MenuContent.ScrollLock"),NE=C.forwardRef((t,e)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:l,onEntryFocus:d,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:p,onInteractOutside:y,onDismiss:v,disableOutsideScroll:E,...b}=t,T=sc(Js,r),I=Af(Js,r),N=Tg(r),A=fk(r),L=AX(r),[P,k]=C.useState(null),D=C.useRef(null),O=st(e,D,T.onContentChange),F=C.useRef(0),$=C.useRef(""),G=C.useRef(0),Y=C.useRef(null),ne=C.useRef("right"),X=C.useRef(0),z=E?Ef:C.Fragment,Z=E?{as:jX,allowPinchZoom:!0}:void 0,ee=K=>{var fe,Le;const ae=$.current+K,Q=L().filter(_e=>!_e.disabled),re=document.activeElement,Ee=(fe=Q.find(_e=>_e.ref.current===re))==null?void 0:fe.textValue,ie=Q.map(_e=>_e.textValue),se=KX(ie,ae,Ee),oe=(Le=Q.find(_e=>_e.textValue===se))==null?void 0:Le.ref.current;(function _e(ce){$.current=ce,window.clearTimeout(F.current),ce!==""&&(F.current=window.setTimeout(()=>_e(""),1e3))})(ae),oe&&setTimeout(()=>oe.focus())};C.useEffect(()=>()=>window.clearTimeout(F.current),[]),yg();const q=C.useCallback(K=>{var Q,re;return ne.current===((Q=Y.current)==null?void 0:Q.side)&&qX(K,(re=Y.current)==null?void 0:re.area)},[]);return o.jsx(PX,{scope:r,searchRef:$,onItemEnter:C.useCallback(K=>{q(K)&&K.preventDefault()},[q]),onItemLeave:C.useCallback(K=>{var ae;q(K)||((ae=D.current)==null||ae.focus(),k(null))},[q]),onTriggerLeave:C.useCallback(K=>{q(K)&&K.preventDefault()},[q]),pointerGraceTimerRef:G,onPointerGraceIntentChange:C.useCallback(K=>{Y.current=K},[]),children:o.jsx(z,{...Z,children:o.jsx(bf,{asChild:!0,trapped:s,onMountAutoFocus:Re(i,K=>{var ae;K.preventDefault(),(ae=D.current)==null||ae.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:o.jsx(ec,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:p,onInteractOutside:y,onDismiss:v,children:o.jsx(EE,{asChild:!0,...A,dir:I.dir,orientation:"vertical",loop:n,currentTabStopId:P,onCurrentTabStopIdChange:k,onEntryFocus:Re(d,K=>{I.isUsingKeyboardRef.current||K.preventDefault()}),preventScrollOnEntryFocus:!0,children:o.jsx(eg,{role:"menu","aria-orientation":"vertical","data-state":Dk(T.open),"data-radix-menu-content":"",dir:I.dir,...N,...b,ref:O,style:{outline:"none",...b.style},onKeyDown:Re(b.onKeyDown,K=>{const Q=K.target.closest("[data-radix-menu-content]")===K.currentTarget,re=K.ctrlKey||K.altKey||K.metaKey,Ee=K.key.length===1;Q&&(K.key==="Tab"&&K.preventDefault(),!re&&Ee&&ee(K.key));const ie=D.current;if(K.target!==ie||!SX.includes(K.key))return;K.preventDefault();const oe=L().filter(fe=>!fe.disabled).map(fe=>fe.ref.current);dk.includes(K.key)&&oe.reverse(),zX(oe)}),onBlur:Re(t.onBlur,K=>{K.currentTarget.contains(K.target)||(window.clearTimeout(F.current),$.current="")}),onPointerMove:Re(t.onPointerMove,Uh(K=>{const ae=K.target,Q=X.current!==K.clientX;if(K.currentTarget.contains(ae)&&Q){const re=K.clientX>X.current?"right":"left";ne.current=re,X.current=K.clientX}}))})})})})})})});xk.displayName=Js;var MX="MenuGroup",IE=C.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return o.jsx(He.div,{role:"group",...n,ref:e})});IE.displayName=MX;var OX="MenuLabel",yk=C.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return o.jsx(He.div,{...n,ref:e})});yk.displayName=OX;var sp="MenuItem",xA="menu.itemSelect",Cg=C.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:n,...s}=t,i=C.useRef(null),a=Af(sp,t.__scopeMenu),l=AE(sp,t.__scopeMenu),d=st(e,i),u=C.useRef(!1),f=()=>{const p=i.current;if(!r&&p){const y=new CustomEvent(xA,{bubbles:!0,cancelable:!0});p.addEventListener(xA,v=>n==null?void 0:n(v),{once:!0}),Jw(p,y),y.defaultPrevented?u.current=!1:a.onClose()}};return o.jsx(vk,{...s,ref:d,disabled:r,onClick:Re(t.onClick,f),onPointerDown:p=>{var y;(y=t.onPointerDown)==null||y.call(t,p),u.current=!0},onPointerUp:Re(t.onPointerUp,p=>{var y;u.current||(y=p.currentTarget)==null||y.click()}),onKeyDown:Re(t.onKeyDown,p=>{const y=l.searchRef.current!=="";r||y&&p.key===" "||Cv.includes(p.key)&&(p.currentTarget.click(),p.preventDefault())})})});Cg.displayName=sp;var vk=C.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...i}=t,a=AE(sp,r),l=fk(r),d=C.useRef(null),u=st(e,d),[f,p]=C.useState(!1),[y,v]=C.useState("");return C.useEffect(()=>{const E=d.current;E&&v((E.textContent??"").trim())},[i.children]),o.jsx(Bh.ItemSlot,{scope:r,disabled:n,textValue:s??y,children:o.jsx(SE,{asChild:!0,...l,focusable:!n,children:o.jsx(He.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:u,onPointerMove:Re(t.onPointerMove,Uh(E=>{n?a.onItemLeave(E):(a.onItemEnter(E),E.defaultPrevented||E.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Re(t.onPointerLeave,Uh(E=>a.onItemLeave(E))),onFocus:Re(t.onFocus,()=>p(!0)),onBlur:Re(t.onBlur,()=>p(!1))})})})}),FX="MenuCheckboxItem",wk=C.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:n,...s}=t;return o.jsx(Ck,{scope:t.__scopeMenu,checked:r,children:o.jsx(Cg,{role:"menuitemcheckbox","aria-checked":ip(r)?"mixed":r,...s,ref:e,"data-state":_E(r),onSelect:Re(s.onSelect,()=>n==null?void 0:n(ip(r)?!0:!r),{checkForDefaultPrevented:!1})})})});wk.displayName=FX;var bk="MenuRadioGroup",[BX,UX]=nc(bk,{value:void 0,onValueChange:()=>{}}),Ek=C.forwardRef((t,e)=>{const{value:r,onValueChange:n,...s}=t,i=Lr(n);return o.jsx(BX,{scope:t.__scopeMenu,value:r,onValueChange:i,children:o.jsx(IE,{...s,ref:e})})});Ek.displayName=bk;var Sk="MenuRadioItem",Tk=C.forwardRef((t,e)=>{const{value:r,...n}=t,s=UX(Sk,t.__scopeMenu),i=r===s.value;return o.jsx(Ck,{scope:t.__scopeMenu,checked:i,children:o.jsx(Cg,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":_E(i),onSelect:Re(n.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,r)},{checkForDefaultPrevented:!1})})})});Tk.displayName=Sk;var RE="MenuItemIndicator",[Ck,$X]=nc(RE,{checked:!1}),Ak=C.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:n,...s}=t,i=$X(RE,r);return o.jsx(fn,{present:n||ip(i.checked)||i.checked===!0,children:o.jsx(He.span,{...s,ref:e,"data-state":_E(i.checked)})})});Ak.displayName=RE;var VX="MenuSeparator",Nk=C.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return o.jsx(He.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});Nk.displayName=VX;var GX="MenuArrow",Ik=C.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=Tg(r);return o.jsx(tg,{...s,...n,ref:e})});Ik.displayName=GX;var HX="MenuSub",[_ae,Rk]=nc(HX),Md="MenuSubTrigger",_k=C.forwardRef((t,e)=>{const r=sc(Md,t.__scopeMenu),n=Af(Md,t.__scopeMenu),s=Rk(Md,t.__scopeMenu),i=AE(Md,t.__scopeMenu),a=C.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:d}=i,u={__scopeMenu:t.__scopeMenu},f=C.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return C.useEffect(()=>f,[f]),C.useEffect(()=>{const p=l.current;return()=>{window.clearTimeout(p),d(null)}},[l,d]),o.jsx(TE,{asChild:!0,...u,children:o.jsx(vk,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":Dk(r.open),...t,ref:$p(e,s.onTriggerChange),onClick:p=>{var y;(y=t.onClick)==null||y.call(t,p),!(t.disabled||p.defaultPrevented)&&(p.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Re(t.onPointerMove,Uh(p=>{i.onItemEnter(p),!p.defaultPrevented&&!t.disabled&&!r.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:Re(t.onPointerLeave,Uh(p=>{var v,E;f();const y=(v=r.content)==null?void 0:v.getBoundingClientRect();if(y){const b=(E=r.content)==null?void 0:E.dataset.side,T=b==="right",I=T?-5:5,N=y[T?"left":"right"],A=y[T?"right":"left"];i.onPointerGraceIntentChange({area:[{x:p.clientX+I,y:p.clientY},{x:N,y:y.top},{x:A,y:y.top},{x:A,y:y.bottom},{x:N,y:y.bottom}],side:b}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(p),p.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Re(t.onKeyDown,p=>{var v;const y=i.searchRef.current!=="";t.disabled||y&&p.key===" "||TX[n.dir].includes(p.key)&&(r.onOpenChange(!0),(v=r.content)==null||v.focus(),p.preventDefault())})})})});_k.displayName=Md;var Lk="MenuSubContent",Pk=C.forwardRef((t,e)=>{const r=pk(Js,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,i=sc(Js,t.__scopeMenu),a=Af(Js,t.__scopeMenu),l=Rk(Lk,t.__scopeMenu),d=C.useRef(null),u=st(e,d);return o.jsx(Bh.Provider,{scope:t.__scopeMenu,children:o.jsx(fn,{present:n||i.open,children:o.jsx(Bh.Slot,{scope:t.__scopeMenu,children:o.jsx(NE,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var p;a.isUsingKeyboardRef.current&&((p=d.current)==null||p.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:Re(t.onFocusOutside,f=>{f.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Re(t.onEscapeKeyDown,f=>{a.onClose(),f.preventDefault()}),onKeyDown:Re(t.onKeyDown,f=>{var v;const p=f.currentTarget.contains(f.target),y=CX[a.dir].includes(f.key);p&&y&&(i.onOpenChange(!1),(v=l.trigger)==null||v.focus(),f.preventDefault())})})})})})});Pk.displayName=Lk;function Dk(t){return t?"open":"closed"}function ip(t){return t==="indeterminate"}function _E(t){return ip(t)?"indeterminate":t?"checked":"unchecked"}function zX(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function WX(t,e){return t.map((r,n)=>t[(e+n)%t.length])}function KX(t,e,r){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=r?t.indexOf(r):-1;let a=WX(t,Math.max(i,0));s.length===1&&(a=a.filter(u=>u!==r));const d=a.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return d!==r?d:void 0}function YX(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,a=e.length-1;i<e.length;a=i++){const l=e[i],d=e[a],u=l.x,f=l.y,p=d.x,y=d.y;f>n!=y>n&&r<(p-u)*(n-f)/(y-f)+u&&(s=!s)}return s}function qX(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return YX(r,e)}function Uh(t){return e=>e.pointerType==="mouse"?t(e):void 0}var XX=mk,QX=TE,ZX=gk,JX=xk,eQ=IE,tQ=yk,rQ=Cg,nQ=wk,sQ=Ek,iQ=Tk,aQ=Ak,oQ=Nk,lQ=Ik,cQ=_k,uQ=Pk,Ag="DropdownMenu",[dQ,Lae]=hn(Ag,[hk]),Xn=hk(),[hQ,kk]=dQ(Ag),jk=t=>{const{__scopeDropdownMenu:e,children:r,dir:n,open:s,defaultOpen:i,onOpenChange:a,modal:l=!0}=t,d=Xn(e),u=C.useRef(null),[f,p]=Ai({prop:s,defaultProp:i??!1,onChange:a,caller:Ag});return o.jsx(hQ,{scope:e,triggerId:Ti(),triggerRef:u,contentId:Ti(),open:f,onOpenChange:p,onOpenToggle:C.useCallback(()=>p(y=>!y),[p]),modal:l,children:o.jsx(XX,{...d,open:f,onOpenChange:p,dir:n,modal:l,children:r})})};jk.displayName=Ag;var Mk="DropdownMenuTrigger",Ok=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=t,i=kk(Mk,r),a=Xn(r);return o.jsx(QX,{asChild:!0,...a,children:o.jsx(He.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:$p(e,i.triggerRef),onPointerDown:Re(t.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Re(t.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Ok.displayName=Mk;var fQ="DropdownMenuPortal",Fk=t=>{const{__scopeDropdownMenu:e,...r}=t,n=Xn(e);return o.jsx(ZX,{...n,...r})};Fk.displayName=fQ;var Bk="DropdownMenuContent",Uk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=kk(Bk,r),i=Xn(r),a=C.useRef(!1);return o.jsx(JX,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:Re(t.onCloseAutoFocus,l=>{var d;a.current||(d=s.triggerRef.current)==null||d.focus(),a.current=!1,l.preventDefault()}),onInteractOutside:Re(t.onInteractOutside,l=>{const d=l.detail.originalEvent,u=d.button===0&&d.ctrlKey===!0,f=d.button===2||u;(!s.modal||f)&&(a.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Uk.displayName=Bk;var mQ="DropdownMenuGroup",pQ=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(eQ,{...s,...n,ref:e})});pQ.displayName=mQ;var gQ="DropdownMenuLabel",$k=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(tQ,{...s,...n,ref:e})});$k.displayName=gQ;var xQ="DropdownMenuItem",Vk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(rQ,{...s,...n,ref:e})});Vk.displayName=xQ;var yQ="DropdownMenuCheckboxItem",Gk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(nQ,{...s,...n,ref:e})});Gk.displayName=yQ;var vQ="DropdownMenuRadioGroup",wQ=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(sQ,{...s,...n,ref:e})});wQ.displayName=vQ;var bQ="DropdownMenuRadioItem",Hk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(iQ,{...s,...n,ref:e})});Hk.displayName=bQ;var EQ="DropdownMenuItemIndicator",zk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(aQ,{...s,...n,ref:e})});zk.displayName=EQ;var SQ="DropdownMenuSeparator",Wk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(oQ,{...s,...n,ref:e})});Wk.displayName=SQ;var TQ="DropdownMenuArrow",CQ=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(lQ,{...s,...n,ref:e})});CQ.displayName=TQ;var AQ="DropdownMenuSubTrigger",Kk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(cQ,{...s,...n,ref:e})});Kk.displayName=AQ;var NQ="DropdownMenuSubContent",Yk=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=Xn(r);return o.jsx(uQ,{...s,...n,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Yk.displayName=NQ;var IQ=jk,RQ=Ok,_Q=Fk,qk=Uk,Xk=$k,Qk=Vk,Zk=Gk,Jk=Hk,e4=zk,t4=Wk,r4=Kk,n4=Yk;const ic=IQ,ac=RQ,LQ=C.forwardRef(({className:t,inset:e,children:r,...n},s)=>o.jsxs(r4,{ref:s,className:Ye("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",t),...n,children:[r,o.jsx(Q_,{className:"ml-auto h-4 w-4"})]}));LQ.displayName=r4.displayName;const PQ=C.forwardRef(({className:t,...e},r)=>o.jsx(n4,{ref:r,className:Ye("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));PQ.displayName=n4.displayName;const Qo=C.forwardRef(({className:t,sideOffset:e=4,...r},n)=>o.jsx(_Q,{children:o.jsx(qk,{ref:n,sideOffset:e,className:Ye("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));Qo.displayName=qk.displayName;const kt=C.forwardRef(({className:t,inset:e,...r},n)=>o.jsx(Qk,{ref:n,className:Ye("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",t),...r}));kt.displayName=Qk.displayName;const DQ=C.forwardRef(({className:t,children:e,checked:r,...n},s)=>o.jsxs(Zk,{ref:s,className:Ye("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:r,...n,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(e4,{children:o.jsx(Ts,{className:"h-4 w-4"})})}),e]}));DQ.displayName=Zk.displayName;const kQ=C.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(Jk,{ref:n,className:Ye("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(e4,{children:o.jsx(ab,{className:"h-2 w-2 fill-current"})})}),e]}));kQ.displayName=Jk.displayName;const s4=C.forwardRef(({className:t,inset:e,...r},n)=>o.jsx(Xk,{ref:n,className:Ye("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...r}));s4.displayName=Xk.displayName;const Xi=C.forwardRef(({className:t,...e},r)=>o.jsx(t4,{ref:r,className:Ye("-mx-1 my-1 h-px bg-muted",t),...e}));Xi.displayName=t4.displayName;var i4={exports:{}},a4={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mu=C;function jQ(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var MQ=typeof Object.is=="function"?Object.is:jQ,OQ=Mu.useState,FQ=Mu.useEffect,BQ=Mu.useLayoutEffect,UQ=Mu.useDebugValue;function $Q(t,e){var r=e(),n=OQ({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return BQ(function(){s.value=r,s.getSnapshot=e,h1(s)&&i({inst:s})},[t,r,e]),FQ(function(){return h1(s)&&i({inst:s}),t(function(){h1(s)&&i({inst:s})})},[t]),UQ(r),r}function h1(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!MQ(t,r)}catch{return!0}}function VQ(t,e){return e()}var GQ=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?VQ:$Q;a4.useSyncExternalStore=Mu.useSyncExternalStore!==void 0?Mu.useSyncExternalStore:GQ;i4.exports=a4;var HQ=i4.exports;function zQ(){return HQ.useSyncExternalStore(WQ,()=>!0,()=>!1)}function WQ(){return()=>{}}var LE="Avatar",[KQ,Pae]=hn(LE),[YQ,o4]=KQ(LE),l4=C.forwardRef((t,e)=>{const{__scopeAvatar:r,...n}=t,[s,i]=C.useState("idle");return o.jsx(YQ,{scope:r,imageLoadingStatus:s,onImageLoadingStatusChange:i,children:o.jsx(He.span,{...n,ref:e})})});l4.displayName=LE;var c4="AvatarImage",u4=C.forwardRef((t,e)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:s=()=>{},...i}=t,a=o4(c4,r),l=qQ(n,i),d=Lr(u=>{s(u),a.onImageLoadingStatusChange(u)});return Br(()=>{l!=="idle"&&d(l)},[l,d]),l==="loaded"?o.jsx(He.img,{...i,ref:e,src:n}):null});u4.displayName=c4;var d4="AvatarFallback",h4=C.forwardRef((t,e)=>{const{__scopeAvatar:r,delayMs:n,...s}=t,i=o4(d4,r),[a,l]=C.useState(n===void 0);return C.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(d)}},[n]),a&&i.imageLoadingStatus!=="loaded"?o.jsx(He.span,{...s,ref:e}):null});h4.displayName=d4;function yA(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function qQ(t,{referrerPolicy:e,crossOrigin:r}){const n=zQ(),s=C.useRef(null),i=n?(s.current||(s.current=new window.Image),s.current):null,[a,l]=C.useState(()=>yA(i,t));return Br(()=>{l(yA(i,t))},[i,t]),Br(()=>{const d=p=>()=>{l(p)};if(!i)return;const u=d("loaded"),f=d("error");return i.addEventListener("load",u),i.addEventListener("error",f),e&&(i.referrerPolicy=e),typeof r=="string"&&(i.crossOrigin=r),()=>{i.removeEventListener("load",u),i.removeEventListener("error",f)}},[i,r,e]),a}var f4=l4,m4=u4,p4=h4;const PE=C.forwardRef(({className:t,...e},r)=>o.jsx(f4,{ref:r,className:Ye("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));PE.displayName=f4.displayName;const DE=C.forwardRef(({className:t,...e},r)=>o.jsx(m4,{ref:r,className:Ye("aspect-square h-full w-full",t),...e}));DE.displayName=m4.displayName;const kE=C.forwardRef(({className:t,...e},r)=>o.jsx(p4,{ref:r,className:Ye("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));kE.displayName=p4.displayName;function XQ({user:t={name:"Thomas Martin",email:"thomas@example.com"}}){const e=ni(),{toast:r}=la(),n=t.name.split(" ").map(i=>i[0]).join("").toUpperCase(),s=()=>{r({title:"Dconnexion",description:"Vous avez t dconnect avec succs."}),e("/auth")};return o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsxs(ve,{variant:"ghost",className:"relative h-10 gap-2 px-2 hover:bg-primary/10",children:[o.jsxs(PE,{className:"h-8 w-8 border-2 border-primary/30",children:[o.jsx(DE,{src:Lu(t.avatar||""),alt:t.name}),o.jsx(kE,{className:"bg-primary/10 text-primary font-semibold text-sm",children:n})]}),o.jsx("span",{className:"hidden lg:block text-sm font-medium max-w-[100px] truncate",children:t.name.split(" ")[0]}),o.jsx(zp,{className:"h-4 w-4 text-muted-foreground hidden lg:block"})]})}),o.jsxs(Qo,{align:"end",className:"w-56 glass border-border/50",children:[o.jsxs("div",{className:"px-3 py-3 border-b border-border/50",children:[o.jsx("p",{className:"font-semibold",children:t.name}),o.jsx("p",{className:"text-xs text-muted-foreground",children:t.email})]}),o.jsxs("div",{className:"py-1",children:[o.jsx(kt,{asChild:!0,children:o.jsxs(pr,{to:"/profile",className:"flex items-center cursor-pointer",children:[o.jsx(Nn,{className:"h-4 w-4 mr-3 text-muted-foreground"}),"Mon Profil"]})}),o.jsx(kt,{asChild:!0,children:o.jsxs(pr,{to:"/credits",className:"flex items-center cursor-pointer",children:[o.jsx(Ul,{className:"h-4 w-4 mr-3 text-accent"}),"Acheter des crdits"]})})]}),o.jsx(Xi,{}),o.jsxs(kt,{className:"cursor-pointer text-destructive focus:text-destructive",onClick:s,children:[o.jsx(cb,{className:"h-4 w-4 mr-3"}),"Dconnexion"]})]})]})}function rd({credits:t}){const[e,r]=C.useState(!1),n=Ba(),{user:s}=ps(),i=[{href:"/dashboard",label:"Mes Vidos",icon:yr},{href:"/my-clips",label:"Mes Clips",icon:Na},{href:"/clubs",label:"Clubs",icon:wh},{href:"/support",label:"Support",icon:$l},{href:"/credits",label:"Crdits",icon:Cn}];return o.jsx(Me.nav,{initial:{y:-100},animate:{y:0},transition:{duration:.5},className:"fixed top-0 left-0 right-0 z-50 glass border-b border-border/50",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsxs(pr,{to:"/dashboard",className:"flex items-center gap-2",children:[o.jsx("div",{className:"relative w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-accent flex items-center justify-center neon-glow-blue",children:o.jsx(yr,{className:"h-5 w-5 text-white"})}),o.jsx("span",{className:"text-xl font-bold font-orbitron gradient-text hidden sm:block",children:"MySmash"})]}),o.jsx("div",{className:"hidden md:flex items-center gap-1",children:i.map(a=>{const l=n.pathname===a.href;return o.jsxs(pr,{to:a.href,className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm transition-all ${l?"bg-primary text-primary-foreground font-medium":"text-muted-foreground hover:text-foreground hover:bg-card/50"}`,children:[o.jsx(a.icon,{className:"h-4 w-4"}),a.label]},a.href)})}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs(Me.div,{whileHover:{scale:1.05},className:"hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full glass border border-accent/30",children:[o.jsx(Ul,{className:"h-4 w-4 text-accent"}),o.jsx("span",{className:"text-sm font-semibold text-accent",children:t})]}),o.jsx(dX,{}),o.jsx(ev,{}),o.jsx(XQ,{user:s?{name:s.name,email:s.email,avatar:s.avatar}:void 0}),o.jsx(ve,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>r(!e),children:e?o.jsx(tc,{className:"h-5 w-5"}):o.jsx(aL,{className:"h-5 w-5"})})]})]}),e&&o.jsx(Me.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden py-4 border-t border-border/50",children:o.jsxs("div",{className:"flex flex-col gap-3",children:[i.map(a=>o.jsxs(pr,{to:a.href,onClick:()=>r(!1),className:"flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-card/50 transition-colors",children:[o.jsx(a.icon,{className:"h-4 w-4 text-primary"}),a.label]},a.href)),o.jsxs("div",{className:"flex items-center gap-2 px-4 py-2",children:[o.jsx(Ul,{className:"h-4 w-4 text-accent"}),o.jsxs("span",{className:"text-sm font-semibold",children:[t," crdits"]})]})]})})]})})}const QQ={primary:{bg:"bg-primary/10",icon:"text-primary",glow:"group-hover:shadow-[0_0_30px_hsl(var(--primary)/0.3)]",border:"border-primary/20 group-hover:border-primary/50"},accent:{bg:"bg-accent/10",icon:"text-accent",glow:"group-hover:shadow-[0_0_30px_hsl(var(--accent)/0.3)]",border:"border-accent/20 group-hover:border-accent/50"},cyan:{bg:"bg-[hsl(180,100%,50%)]/10",icon:"text-[hsl(180,100%,50%)]",glow:"group-hover:shadow-[0_0_30px_hsl(180,100%,50%,0.3)]",border:"border-[hsl(180,100%,50%)]/20 group-hover:border-[hsl(180,100%,50%)]/50"},purple:{bg:"bg-[hsl(270,100%,60%)]/10",icon:"text-[hsl(270,100%,60%)]",glow:"group-hover:shadow-[0_0_30px_hsl(270,100%,60%,0.3)]",border:"border-[hsl(270,100%,60%)]/20 group-hover:border-[hsl(270,100%,60%)]/50"}};function ZQ({icon:t,label:e,value:r,color:n="primary"}){const s=QQ[n];return o.jsxs(Me.div,{whileHover:{scale:1.02,y:-4},transition:{duration:.2},className:`group relative p-6 rounded-2xl glass border ${s.border} ${s.glow} transition-all duration-300 cursor-pointer`,children:[o.jsx("div",{className:"absolute inset-0 rounded-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-gradient-to-br from-transparent via-transparent to-primary/5"}),o.jsxs("div",{className:"relative flex items-center gap-4",children:[o.jsx("div",{className:`p-3 rounded-xl ${s.bg}`,children:o.jsx(t,{className:`h-6 w-6 ${s.icon}`})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-2xl lg:text-3xl font-bold font-orbitron",children:r}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e})]})]})]})}const JQ=nf("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Hr({className:t,variant:e,...r}){return o.jsx("div",{className:Ye(JQ({variant:e}),t),...r})}function eZ({id:t,title:e,thumbnail:r,duration:n,date:s,shared:i=!1,court:a,isExpired:l=!1,processingStatus:d,onPlay:u,onShare:f,onDelete:p,onCreateClip:y,onEdit:v,onDownload:E}){const[b,T]=C.useState(!1),I=L=>{const P=L.endsWith("Z")?L:L+"Z";return new Date(P).toLocaleDateString("fr-FR",{day:"numeric",month:"short"})},N=d==="failed",A=d==="processing"||d==="uploading";return o.jsxs(Me.div,{whileHover:{y:-8},transition:{duration:.3},onMouseEnter:()=>T(!0),onMouseLeave:()=>T(!1),className:"group relative rounded-2xl overflow-hidden glass border border-border/50 hover:border-primary/50 transition-all duration-300 card-glow",children:[o.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[o.jsx("img",{src:r,alt:e,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"}),o.jsx(Me.div,{initial:{opacity:0,scale:.8},animate:{opacity:b?1:0,scale:b?1:.8},transition:{duration:.2},className:"absolute inset-0 flex items-center justify-center",children:o.jsx(ve,{variant:"neon",size:"icon",onClick:u,className:"h-14 w-14 rounded-full animate-pulse-glow",children:o.jsx(Ps,{className:"h-6 w-6 fill-current"})})}),o.jsxs("div",{className:"absolute bottom-3 left-3 flex items-center gap-1.5 px-2 py-1 rounded-md bg-black/60 backdrop-blur-sm",children:[o.jsx(hs,{className:"h-3 w-3 text-white/80"}),o.jsx("span",{className:"text-xs font-medium text-white",children:n})]}),i&&!l&&o.jsxs(Hr,{className:"absolute top-3 left-3 bg-accent/80 hover:bg-accent text-accent-foreground",children:[o.jsx(Vl,{className:"h-3 w-3 mr-1"}),"Partage"]}),l&&!N&&!A&&o.jsx(Hr,{className:"absolute top-3 left-3 bg-destructive/90 hover:bg-destructive text-destructive-foreground",children:" Expire"}),N&&o.jsx(Hr,{className:"absolute top-3 left-3 bg-red-600 hover:bg-red-700 text-white border-red-800",children:" chec"}),A&&o.jsx(Hr,{className:"absolute top-3 left-3 bg-blue-500/90 hover:bg-blue-600 text-white animate-pulse",children:" Traitement..."}),o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsx(ve,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 h-8 w-8 bg-black/40 hover:bg-black/60 text-white",children:o.jsx(lf,{className:"h-4 w-4"})})}),o.jsxs(Qo,{align:"end",className:"w-48",children:[o.jsxs(kt,{onClick:u,disabled:l,children:[o.jsx(Ps,{className:"h-4 w-4 mr-2"}),l?"Vido expire":"Lire"]}),o.jsxs(kt,{onClick:y,disabled:l,children:[o.jsx(Na,{className:"h-4 w-4 mr-2"}),l?"Clip non disponible":"Crer un clip"]}),o.jsxs(kt,{onClick:v,children:[o.jsx(Po,{className:"h-4 w-4 mr-2"}),"Modifier le titre"]}),o.jsxs(kt,{onClick:f,children:[o.jsx(Vl,{className:"h-4 w-4 mr-2"}),"Partager"]}),o.jsxs(kt,{onClick:E,disabled:l,children:[o.jsx(Sh,{className:"h-4 w-4 mr-2"}),l?"Tlchargement non disponible":"Tlcharger MP4"]}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:p,className:"text-destructive focus:text-destructive",children:[o.jsx(Fa,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]})]}),o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"font-semibold text-foreground line-clamp-1 mb-2 group-hover:text-primary transition-colors",children:e}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[o.jsx("span",{children:I(s)}),a&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Oa,{className:"h-3 w-3"}),o.jsx("span",{children:a})]})]})]})]})}function tZ({court:t,club:e,startTime:r,duration:n,onStop:s,onDismiss:i}){const[a,l]=C.useState("--:--"),[d,u]=C.useState(!0);return C.useEffect(()=>{const f=()=>{if(!r||!n)return;const y=new Date,v=r.getTime(),E=n*60*1e3,T=v+E-y.getTime();if(T<=0){l("00:00");return}const I=Math.floor(T/6e4),N=Math.floor(T%6e4/1e3);l(`${I.toString().padStart(2,"0")}:${N.toString().padStart(2,"0")}`)};f();const p=setInterval(f,1e3);return()=>clearInterval(p)},[r,n]),d?o.jsx(oE,{children:o.jsx(Me.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},className:"relative overflow-hidden z-40 pointer-events-auto",children:o.jsxs("div",{className:"bg-gradient-to-r from-destructive/90 via-destructive to-destructive/90 text-destructive-foreground",children:[o.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,255,255,0.1),transparent_50%)] animate-pulse"}),o.jsx("div",{className:"container mx-auto px-4 lg:px-8 py-3",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"relative flex h-3 w-3",children:[o.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-white opacity-75"}),o.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-white"})]}),o.jsx(yr,{className:"h-5 w-5"}),o.jsx("span",{className:"font-semibold",children:"EN DIRECT"})]}),o.jsxs("div",{className:"hidden sm:flex items-center gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(Oa,{className:"h-4 w-4"}),o.jsxs("span",{children:[t,"  ",e]})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(hs,{className:"h-4 w-4"}),o.jsx("span",{className:"font-mono",children:a})]})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs(ve,{variant:"outline",size:"sm",onClick:s,className:"bg-white/10 border-white/20 hover:bg-white/20 text-white gap-2 relative z-50 cursor-pointer",children:[o.jsx(J_,{className:"h-4 w-4"}),"Arrter"]})})]})})]})})}):null}var Ng="Dialog",[g4,Dae]=hn(Ng),[rZ,_i]=g4(Ng),x4=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:a=!0}=t,l=C.useRef(null),d=C.useRef(null),[u,f]=Ai({prop:n,defaultProp:s??!1,onChange:i,caller:Ng});return o.jsx(rZ,{scope:e,triggerRef:l,contentRef:d,contentId:Ti(),titleId:Ti(),descriptionId:Ti(),open:u,onOpenChange:f,onOpenToggle:C.useCallback(()=>f(p=>!p),[f]),modal:a,children:r})};x4.displayName=Ng;var y4="DialogTrigger",v4=C.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=_i(y4,r),i=st(e,s.triggerRef);return o.jsx(He.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":OE(s.open),...n,ref:i,onClick:Re(t.onClick,s.onOpenToggle)})});v4.displayName=y4;var jE="DialogPortal",[nZ,w4]=g4(jE,{forceMount:void 0}),b4=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:s}=t,i=_i(jE,e);return o.jsx(nZ,{scope:e,forceMount:r,children:C.Children.map(n,a=>o.jsx(fn,{present:r||i.open,children:o.jsx(Vu,{asChild:!0,container:s,children:a})}))})};b4.displayName=jE;var ap="DialogOverlay",E4=C.forwardRef((t,e)=>{const r=w4(ap,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=_i(ap,t.__scopeDialog);return i.modal?o.jsx(fn,{present:n||i.open,children:o.jsx(iZ,{...s,ref:e})}):null});E4.displayName=ap;var sZ=Ro("DialogOverlay.RemoveScroll"),iZ=C.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=_i(ap,r);return o.jsx(Ef,{as:sZ,allowPinchZoom:!0,shards:[s.contentRef],children:o.jsx(He.div,{"data-state":OE(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),zl="DialogContent",S4=C.forwardRef((t,e)=>{const r=w4(zl,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=_i(zl,t.__scopeDialog);return o.jsx(fn,{present:n||i.open,children:i.modal?o.jsx(aZ,{...s,ref:e}):o.jsx(oZ,{...s,ref:e})})});S4.displayName=zl;var aZ=C.forwardRef((t,e)=>{const r=_i(zl,t.__scopeDialog),n=C.useRef(null),s=st(e,r.contentRef,n);return C.useEffect(()=>{const i=n.current;if(i)return vg(i)},[]),o.jsx(T4,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Re(t.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=r.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Re(t.onPointerDownOutside,i=>{const a=i.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0;(a.button===2||l)&&i.preventDefault()}),onFocusOutside:Re(t.onFocusOutside,i=>i.preventDefault())})}),oZ=C.forwardRef((t,e)=>{const r=_i(zl,t.__scopeDialog),n=C.useRef(!1),s=C.useRef(!1);return o.jsx(T4,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,l;(a=t.onCloseAutoFocus)==null||a.call(t,i),i.defaultPrevented||(n.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{var d,u;(d=t.onInteractOutside)==null||d.call(t,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((u=r.triggerRef.current)==null?void 0:u.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),T4=C.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=t,l=_i(zl,r),d=C.useRef(null),u=st(e,d);return yg(),o.jsxs(o.Fragment,{children:[o.jsx(bf,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:o.jsx(ec,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":OE(l.open),...a,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),o.jsxs(o.Fragment,{children:[o.jsx(lZ,{titleId:l.titleId}),o.jsx(uZ,{contentRef:d,descriptionId:l.descriptionId})]})]})}),ME="DialogTitle",C4=C.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=_i(ME,r);return o.jsx(He.h2,{id:s.titleId,...n,ref:e})});C4.displayName=ME;var A4="DialogDescription",N4=C.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=_i(A4,r);return o.jsx(He.p,{id:s.descriptionId,...n,ref:e})});N4.displayName=A4;var I4="DialogClose",R4=C.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=_i(I4,r);return o.jsx(He.button,{type:"button",...n,ref:e,onClick:Re(t.onClick,()=>s.onOpenChange(!1))})});R4.displayName=I4;function OE(t){return t?"open":"closed"}var _4="DialogTitleWarning",[kae,L4]=fF(_4,{contentName:zl,titleName:ME,docsSlug:"dialog"}),lZ=({titleId:t})=>{const e=L4(_4),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return C.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},cZ="DialogDescriptionWarning",uZ=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${L4(cZ).contentName}}.`;return C.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},dZ=x4,hZ=v4,fZ=b4,P4=E4,D4=S4,k4=C4,j4=N4,mZ=R4;const Ir=dZ,M4=hZ,pZ=fZ,O4=C.forwardRef(({className:t,...e},r)=>o.jsx(P4,{ref:r,className:Ye("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));O4.displayName=P4.displayName;const fr=C.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(pZ,{children:[o.jsx(O4,{}),o.jsxs(D4,{ref:n,className:Ye("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,o.jsxs(mZ,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[o.jsx(tc,{className:"h-4 w-4"}),o.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fr.displayName=D4.displayName;const Rr=({className:t,...e})=>o.jsx("div",{className:Ye("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Rr.displayName="DialogHeader";const op=({className:t,...e})=>o.jsx("div",{className:Ye("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});op.displayName="DialogFooter";const _r=C.forwardRef(({className:t,...e},r)=>o.jsx(k4,{ref:r,className:Ye("text-lg font-semibold leading-none tracking-tight",t),...e}));_r.displayName=k4.displayName;const bn=C.forwardRef(({className:t,...e},r)=>o.jsx(j4,{ref:r,className:Ye("text-sm text-muted-foreground",t),...e}));bn.displayName=j4.displayName;function Ig(t){const e=C.useRef({value:t,previous:t});return C.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var gZ=[" ","Enter","ArrowUp","ArrowDown"],xZ=[" ","Enter"],Wl="Select",[Rg,_g,yZ]=tf(Wl),[nd,jae]=hn(Wl,[yZ,zo]),Lg=zo(),[vZ,Zo]=nd(Wl),[wZ,bZ]=nd(Wl),F4=t=>{const{__scopeSelect:e,children:r,open:n,defaultOpen:s,onOpenChange:i,value:a,defaultValue:l,onValueChange:d,dir:u,name:f,autoComplete:p,disabled:y,required:v,form:E}=t,b=Lg(e),[T,I]=C.useState(null),[N,A]=C.useState(null),[L,P]=C.useState(!1),k=rc(u),[D,O]=Ai({prop:n,defaultProp:s??!1,onChange:i,caller:Wl}),[F,$]=Ai({prop:a,defaultProp:l,onChange:d,caller:Wl}),G=C.useRef(null),Y=T?E||!!T.closest("form"):!0,[ne,X]=C.useState(new Set),z=Array.from(ne).map(Z=>Z.props.value).join(";");return o.jsx(Cb,{...b,children:o.jsxs(vZ,{required:v,scope:e,trigger:T,onTriggerChange:I,valueNode:N,onValueNodeChange:A,valueNodeHasChildren:L,onValueNodeHasChildrenChange:P,contentId:Ti(),value:F,onValueChange:$,open:D,onOpenChange:O,dir:k,triggerPointerDownPosRef:G,disabled:y,children:[o.jsx(Rg.Provider,{scope:e,children:o.jsx(wZ,{scope:t.__scopeSelect,onNativeOptionAdd:C.useCallback(Z=>{X(ee=>new Set(ee).add(Z))},[]),onNativeOptionRemove:C.useCallback(Z=>{X(ee=>{const q=new Set(ee);return q.delete(Z),q})},[]),children:r})}),Y?o.jsxs(lj,{"aria-hidden":!0,required:v,tabIndex:-1,name:f,autoComplete:p,value:F,onChange:Z=>$(Z.target.value),disabled:y,form:E,children:[F===void 0?o.jsx("option",{value:""}):null,Array.from(ne)]},z):null]})})};F4.displayName=Wl;var B4="SelectTrigger",U4=C.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:n=!1,...s}=t,i=Lg(r),a=Zo(B4,r),l=a.disabled||n,d=st(e,a.onTriggerChange),u=_g(r),f=C.useRef("touch"),[p,y,v]=uj(b=>{const T=u().filter(A=>!A.disabled),I=T.find(A=>A.value===a.value),N=dj(T,b,I);N!==void 0&&a.onValueChange(N.value)}),E=b=>{l||(a.onOpenChange(!0),v()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return o.jsx(hf,{asChild:!0,...i,children:o.jsx(He.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":cj(a.value)?"":void 0,...s,ref:d,onClick:Re(s.onClick,b=>{b.currentTarget.focus(),f.current!=="mouse"&&E(b)}),onPointerDown:Re(s.onPointerDown,b=>{f.current=b.pointerType;const T=b.target;T.hasPointerCapture(b.pointerId)&&T.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(E(b),b.preventDefault())}),onKeyDown:Re(s.onKeyDown,b=>{const T=p.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&y(b.key),!(T&&b.key===" ")&&gZ.includes(b.key)&&(E(),b.preventDefault())})})})});U4.displayName=B4;var $4="SelectValue",V4=C.forwardRef((t,e)=>{const{__scopeSelect:r,className:n,style:s,children:i,placeholder:a="",...l}=t,d=Zo($4,r),{onValueNodeHasChildrenChange:u}=d,f=i!==void 0,p=st(e,d.onValueNodeChange);return Br(()=>{u(f)},[u,f]),o.jsx(He.span,{...l,ref:p,style:{pointerEvents:"none"},children:cj(d.value)?o.jsx(o.Fragment,{children:a}):i})});V4.displayName=$4;var EZ="SelectIcon",G4=C.forwardRef((t,e)=>{const{__scopeSelect:r,children:n,...s}=t;return o.jsx(He.span,{"aria-hidden":!0,...s,ref:e,children:n||""})});G4.displayName=EZ;var SZ="SelectPortal",H4=t=>o.jsx(Vu,{asChild:!0,...t});H4.displayName=SZ;var Kl="SelectContent",z4=C.forwardRef((t,e)=>{const r=Zo(Kl,t.__scopeSelect),[n,s]=C.useState();if(Br(()=>{s(new DocumentFragment)},[]),!r.open){const i=n;return i?Jl.createPortal(o.jsx(W4,{scope:t.__scopeSelect,children:o.jsx(Rg.Slot,{scope:t.__scopeSelect,children:o.jsx("div",{children:t.children})})}),i):null}return o.jsx(K4,{...t,ref:e})});z4.displayName=Kl;var mi=10,[W4,Jo]=nd(Kl),TZ="SelectContentImpl",CZ=Ro("SelectContent.RemoveScroll"),K4=C.forwardRef((t,e)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:l,sideOffset:d,align:u,alignOffset:f,arrowPadding:p,collisionBoundary:y,collisionPadding:v,sticky:E,hideWhenDetached:b,avoidCollisions:T,...I}=t,N=Zo(Kl,r),[A,L]=C.useState(null),[P,k]=C.useState(null),D=st(e,fe=>L(fe)),[O,F]=C.useState(null),[$,G]=C.useState(null),Y=_g(r),[ne,X]=C.useState(!1),z=C.useRef(!1);C.useEffect(()=>{if(A)return vg(A)},[A]),yg();const Z=C.useCallback(fe=>{const[Le,..._e]=Y().map(Pe=>Pe.ref.current),[ce]=_e.slice(-1),Se=document.activeElement;for(const Pe of fe)if(Pe===Se||(Pe==null||Pe.scrollIntoView({block:"nearest"}),Pe===Le&&P&&(P.scrollTop=0),Pe===ce&&P&&(P.scrollTop=P.scrollHeight),Pe==null||Pe.focus(),document.activeElement!==Se))return},[Y,P]),ee=C.useCallback(()=>Z([O,A]),[Z,O,A]);C.useEffect(()=>{ne&&ee()},[ne,ee]);const{onOpenChange:q,triggerPointerDownPosRef:K}=N;C.useEffect(()=>{if(A){let fe={x:0,y:0};const Le=ce=>{var Se,Pe;fe={x:Math.abs(Math.round(ce.pageX)-(((Se=K.current)==null?void 0:Se.x)??0)),y:Math.abs(Math.round(ce.pageY)-(((Pe=K.current)==null?void 0:Pe.y)??0))}},_e=ce=>{fe.x<=10&&fe.y<=10?ce.preventDefault():A.contains(ce.target)||q(!1),document.removeEventListener("pointermove",Le),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",Le),document.addEventListener("pointerup",_e,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Le),document.removeEventListener("pointerup",_e,{capture:!0})}}},[A,q,K]),C.useEffect(()=>{const fe=()=>q(!1);return window.addEventListener("blur",fe),window.addEventListener("resize",fe),()=>{window.removeEventListener("blur",fe),window.removeEventListener("resize",fe)}},[q]);const[ae,Q]=uj(fe=>{const Le=Y().filter(Se=>!Se.disabled),_e=Le.find(Se=>Se.ref.current===document.activeElement),ce=dj(Le,fe,_e);ce&&setTimeout(()=>ce.ref.current.focus())}),re=C.useCallback((fe,Le,_e)=>{const ce=!z.current&&!_e;(N.value!==void 0&&N.value===Le||ce)&&(F(fe),ce&&(z.current=!0))},[N.value]),Ee=C.useCallback(()=>A==null?void 0:A.focus(),[A]),ie=C.useCallback((fe,Le,_e)=>{const ce=!z.current&&!_e;(N.value!==void 0&&N.value===Le||ce)&&G(fe)},[N.value]),se=n==="popper"?Av:Y4,oe=se===Av?{side:l,sideOffset:d,align:u,alignOffset:f,arrowPadding:p,collisionBoundary:y,collisionPadding:v,sticky:E,hideWhenDetached:b,avoidCollisions:T}:{};return o.jsx(W4,{scope:r,content:A,viewport:P,onViewportChange:k,itemRefCallback:re,selectedItem:O,onItemLeave:Ee,itemTextRefCallback:ie,focusSelectedItem:ee,selectedItemText:$,position:n,isPositioned:ne,searchRef:ae,children:o.jsx(Ef,{as:CZ,allowPinchZoom:!0,children:o.jsx(bf,{asChild:!0,trapped:N.open,onMountAutoFocus:fe=>{fe.preventDefault()},onUnmountAutoFocus:Re(s,fe=>{var Le;(Le=N.trigger)==null||Le.focus({preventScroll:!0}),fe.preventDefault()}),children:o.jsx(ec,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:fe=>fe.preventDefault(),onDismiss:()=>N.onOpenChange(!1),children:o.jsx(se,{role:"listbox",id:N.contentId,"data-state":N.open?"open":"closed",dir:N.dir,onContextMenu:fe=>fe.preventDefault(),...I,...oe,onPlaced:()=>X(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...I.style},onKeyDown:Re(I.onKeyDown,fe=>{const Le=fe.ctrlKey||fe.altKey||fe.metaKey;if(fe.key==="Tab"&&fe.preventDefault(),!Le&&fe.key.length===1&&Q(fe.key),["ArrowUp","ArrowDown","Home","End"].includes(fe.key)){let ce=Y().filter(Se=>!Se.disabled).map(Se=>Se.ref.current);if(["ArrowUp","End"].includes(fe.key)&&(ce=ce.slice().reverse()),["ArrowUp","ArrowDown"].includes(fe.key)){const Se=fe.target,Pe=ce.indexOf(Se);ce=ce.slice(Pe+1)}setTimeout(()=>Z(ce)),fe.preventDefault()}})})})})})})});K4.displayName=TZ;var AZ="SelectItemAlignedPosition",Y4=C.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:n,...s}=t,i=Zo(Kl,r),a=Jo(Kl,r),[l,d]=C.useState(null),[u,f]=C.useState(null),p=st(e,D=>f(D)),y=_g(r),v=C.useRef(!1),E=C.useRef(!0),{viewport:b,selectedItem:T,selectedItemText:I,focusSelectedItem:N}=a,A=C.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&b&&T&&I){const D=i.trigger.getBoundingClientRect(),O=u.getBoundingClientRect(),F=i.valueNode.getBoundingClientRect(),$=I.getBoundingClientRect();if(i.dir!=="rtl"){const Se=$.left-O.left,Pe=F.left-Se,Be=D.left-Pe,tt=D.width+Be,we=Math.max(tt,O.width),Ne=window.innerWidth-mi,Je=Fh(Pe,[mi,Math.max(mi,Ne-we)]);l.style.minWidth=tt+"px",l.style.left=Je+"px"}else{const Se=O.right-$.right,Pe=window.innerWidth-F.right-Se,Be=window.innerWidth-D.right-Pe,tt=D.width+Be,we=Math.max(tt,O.width),Ne=window.innerWidth-mi,Je=Fh(Pe,[mi,Math.max(mi,Ne-we)]);l.style.minWidth=tt+"px",l.style.right=Je+"px"}const G=y(),Y=window.innerHeight-mi*2,ne=b.scrollHeight,X=window.getComputedStyle(u),z=parseInt(X.borderTopWidth,10),Z=parseInt(X.paddingTop,10),ee=parseInt(X.borderBottomWidth,10),q=parseInt(X.paddingBottom,10),K=z+Z+ne+q+ee,ae=Math.min(T.offsetHeight*5,K),Q=window.getComputedStyle(b),re=parseInt(Q.paddingTop,10),Ee=parseInt(Q.paddingBottom,10),ie=D.top+D.height/2-mi,se=Y-ie,oe=T.offsetHeight/2,fe=T.offsetTop+oe,Le=z+Z+fe,_e=K-Le;if(Le<=ie){const Se=G.length>0&&T===G[G.length-1].ref.current;l.style.bottom="0px";const Pe=u.clientHeight-b.offsetTop-b.offsetHeight,Be=Math.max(se,oe+(Se?Ee:0)+Pe+ee),tt=Le+Be;l.style.height=tt+"px"}else{const Se=G.length>0&&T===G[0].ref.current;l.style.top="0px";const Be=Math.max(ie,z+b.offsetTop+(Se?re:0)+oe)+_e;l.style.height=Be+"px",b.scrollTop=Le-ie+b.offsetTop}l.style.margin=`${mi}px 0`,l.style.minHeight=ae+"px",l.style.maxHeight=Y+"px",n==null||n(),requestAnimationFrame(()=>v.current=!0)}},[y,i.trigger,i.valueNode,l,u,b,T,I,i.dir,n]);Br(()=>A(),[A]);const[L,P]=C.useState();Br(()=>{u&&P(window.getComputedStyle(u).zIndex)},[u]);const k=C.useCallback(D=>{D&&E.current===!0&&(A(),N==null||N(),E.current=!1)},[A,N]);return o.jsx(IZ,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:v,onScrollButtonChange:k,children:o.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:L},children:o.jsx(He.div,{...s,ref:p,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Y4.displayName=AZ;var NZ="SelectPopperPosition",Av=C.forwardRef((t,e)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=mi,...i}=t,a=Lg(r);return o.jsx(eg,{...a,...i,ref:e,align:n,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Av.displayName=NZ;var[IZ,FE]=nd(Kl,{}),Nv="SelectViewport",q4=C.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:n,...s}=t,i=Jo(Nv,r),a=FE(Nv,r),l=st(e,i.onViewportChange),d=C.useRef(0);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(Rg.Slot,{scope:r,children:o.jsx(He.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Re(s.onScroll,u=>{const f=u.currentTarget,{contentWrapper:p,shouldExpandOnScrollRef:y}=a;if(y!=null&&y.current&&p){const v=Math.abs(d.current-f.scrollTop);if(v>0){const E=window.innerHeight-mi*2,b=parseFloat(p.style.minHeight),T=parseFloat(p.style.height),I=Math.max(b,T);if(I<E){const N=I+v,A=Math.min(E,N),L=N-A;p.style.height=A+"px",p.style.bottom==="0px"&&(f.scrollTop=L>0?L:0,p.style.justifyContent="flex-end")}}}d.current=f.scrollTop})})})]})});q4.displayName=Nv;var X4="SelectGroup",[RZ,_Z]=nd(X4),LZ=C.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,s=Ti();return o.jsx(RZ,{scope:r,id:s,children:o.jsx(He.div,{role:"group","aria-labelledby":s,...n,ref:e})})});LZ.displayName=X4;var Q4="SelectLabel",Z4=C.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,s=_Z(Q4,r);return o.jsx(He.div,{id:s.id,...n,ref:e})});Z4.displayName=Q4;var lp="SelectItem",[PZ,J4]=nd(lp),ej=C.forwardRef((t,e)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:i,...a}=t,l=Zo(lp,r),d=Jo(lp,r),u=l.value===n,[f,p]=C.useState(i??""),[y,v]=C.useState(!1),E=st(e,N=>{var A;return(A=d.itemRefCallback)==null?void 0:A.call(d,N,n,s)}),b=Ti(),T=C.useRef("touch"),I=()=>{s||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return o.jsx(PZ,{scope:r,value:n,disabled:s,textId:b,isSelected:u,onItemTextChange:C.useCallback(N=>{p(A=>A||((N==null?void 0:N.textContent)??"").trim())},[]),children:o.jsx(Rg.ItemSlot,{scope:r,value:n,disabled:s,textValue:f,children:o.jsx(He.div,{role:"option","aria-labelledby":b,"data-highlighted":y?"":void 0,"aria-selected":u&&y,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:E,onFocus:Re(a.onFocus,()=>v(!0)),onBlur:Re(a.onBlur,()=>v(!1)),onClick:Re(a.onClick,()=>{T.current!=="mouse"&&I()}),onPointerUp:Re(a.onPointerUp,()=>{T.current==="mouse"&&I()}),onPointerDown:Re(a.onPointerDown,N=>{T.current=N.pointerType}),onPointerMove:Re(a.onPointerMove,N=>{var A;T.current=N.pointerType,s?(A=d.onItemLeave)==null||A.call(d):T.current==="mouse"&&N.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Re(a.onPointerLeave,N=>{var A;N.currentTarget===document.activeElement&&((A=d.onItemLeave)==null||A.call(d))}),onKeyDown:Re(a.onKeyDown,N=>{var L;((L=d.searchRef)==null?void 0:L.current)!==""&&N.key===" "||(xZ.includes(N.key)&&I(),N.key===" "&&N.preventDefault())})})})})});ej.displayName=lp;var Od="SelectItemText",tj=C.forwardRef((t,e)=>{const{__scopeSelect:r,className:n,style:s,...i}=t,a=Zo(Od,r),l=Jo(Od,r),d=J4(Od,r),u=bZ(Od,r),[f,p]=C.useState(null),y=st(e,I=>p(I),d.onItemTextChange,I=>{var N;return(N=l.itemTextRefCallback)==null?void 0:N.call(l,I,d.value,d.disabled)}),v=f==null?void 0:f.textContent,E=C.useMemo(()=>o.jsx("option",{value:d.value,disabled:d.disabled,children:v},d.value),[d.disabled,d.value,v]),{onNativeOptionAdd:b,onNativeOptionRemove:T}=u;return Br(()=>(b(E),()=>T(E)),[b,T,E]),o.jsxs(o.Fragment,{children:[o.jsx(He.span,{id:d.textId,...i,ref:y}),d.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Jl.createPortal(i.children,a.valueNode):null]})});tj.displayName=Od;var rj="SelectItemIndicator",nj=C.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t;return J4(rj,r).isSelected?o.jsx(He.span,{"aria-hidden":!0,...n,ref:e}):null});nj.displayName=rj;var Iv="SelectScrollUpButton",sj=C.forwardRef((t,e)=>{const r=Jo(Iv,t.__scopeSelect),n=FE(Iv,t.__scopeSelect),[s,i]=C.useState(!1),a=st(e,n.onScrollButtonChange);return Br(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=d.scrollTop>0;i(u)};const d=r.viewport;return l(),d.addEventListener("scroll",l),()=>d.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?o.jsx(aj,{...t,ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:d}=r;l&&d&&(l.scrollTop=l.scrollTop-d.offsetHeight)}}):null});sj.displayName=Iv;var Rv="SelectScrollDownButton",ij=C.forwardRef((t,e)=>{const r=Jo(Rv,t.__scopeSelect),n=FE(Rv,t.__scopeSelect),[s,i]=C.useState(!1),a=st(e,n.onScrollButtonChange);return Br(()=>{if(r.viewport&&r.isPositioned){let l=function(){const u=d.scrollHeight-d.clientHeight,f=Math.ceil(d.scrollTop)<u;i(f)};const d=r.viewport;return l(),d.addEventListener("scroll",l),()=>d.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),s?o.jsx(aj,{...t,ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:d}=r;l&&d&&(l.scrollTop=l.scrollTop+d.offsetHeight)}}):null});ij.displayName=Rv;var aj=C.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=t,i=Jo("SelectScrollButton",r),a=C.useRef(null),l=_g(r),d=C.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return C.useEffect(()=>()=>d(),[d]),Br(()=>{var f;const u=l().find(p=>p.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[l]),o.jsx(He.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:Re(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:Re(s.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:Re(s.onPointerLeave,()=>{d()})})}),DZ="SelectSeparator",oj=C.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t;return o.jsx(He.div,{"aria-hidden":!0,...n,ref:e})});oj.displayName=DZ;var _v="SelectArrow",kZ=C.forwardRef((t,e)=>{const{__scopeSelect:r,...n}=t,s=Lg(r),i=Zo(_v,r),a=Jo(_v,r);return i.open&&a.position==="popper"?o.jsx(tg,{...s,...n,ref:e}):null});kZ.displayName=_v;var jZ="SelectBubbleInput",lj=C.forwardRef(({__scopeSelect:t,value:e,...r},n)=>{const s=C.useRef(null),i=st(n,s),a=Ig(e);return C.useEffect(()=>{const l=s.current;if(!l)return;const d=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(d,"value").set;if(a!==e&&f){const p=new Event("change",{bubbles:!0});f.call(l,e),l.dispatchEvent(p)}},[a,e]),o.jsx(He.select,{...r,style:{...I_,...r.style},ref:i,defaultValue:e})});lj.displayName=jZ;function cj(t){return t===""||t===void 0}function uj(t){const e=Lr(t),r=C.useRef(""),n=C.useRef(0),s=C.useCallback(a=>{const l=r.current+a;e(l),function d(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>d(""),1e3))}(l)},[e]),i=C.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return C.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,i]}function dj(t,e,r){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=r?t.indexOf(r):-1;let a=MZ(t,Math.max(i,0));s.length===1&&(a=a.filter(u=>u!==r));const d=a.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return d!==r?d:void 0}function MZ(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var OZ=F4,hj=U4,FZ=V4,BZ=G4,UZ=H4,fj=z4,$Z=q4,mj=Z4,pj=ej,VZ=tj,GZ=nj,gj=sj,xj=ij,yj=oj;const Yl=OZ,ql=FZ,Oo=C.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(hj,{ref:n,className:Ye("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[e,o.jsx(BZ,{asChild:!0,children:o.jsx(zp,{className:"h-4 w-4 opacity-50"})})]}));Oo.displayName=hj.displayName;const vj=C.forwardRef(({className:t,...e},r)=>o.jsx(gj,{ref:r,className:Ye("flex cursor-default items-center justify-center py-1",t),...e,children:o.jsx(oB,{className:"h-4 w-4"})}));vj.displayName=gj.displayName;const wj=C.forwardRef(({className:t,...e},r)=>o.jsx(xj,{ref:r,className:Ye("flex cursor-default items-center justify-center py-1",t),...e,children:o.jsx(zp,{className:"h-4 w-4"})}));wj.displayName=xj.displayName;const Fo=C.forwardRef(({className:t,children:e,position:r="popper",...n},s)=>o.jsx(UZ,{children:o.jsxs(fj,{ref:s,className:Ye("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[o.jsx(vj,{}),o.jsx($Z,{className:Ye("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),o.jsx(wj,{})]})}));Fo.displayName=fj.displayName;const HZ=C.forwardRef(({className:t,...e},r)=>o.jsx(mj,{ref:r,className:Ye("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));HZ.displayName=mj.displayName;const Dr=C.forwardRef(({className:t,children:e,...r},n)=>o.jsxs(pj,{ref:n,className:Ye("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...r,children:[o.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:o.jsx(GZ,{children:o.jsx(Ts,{className:"h-4 w-4"})})}),o.jsx(VZ,{children:e})]}));Dr.displayName=pj.displayName;const zZ=C.forwardRef(({className:t,...e},r)=>o.jsx(yj,{ref:r,className:Ye("-mx-1 my-1 h-px bg-muted",t),...e}));zZ.displayName=yj.displayName;const WZ=nf("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Xt=C.forwardRef(({className:t,variant:e,...r},n)=>o.jsx("div",{ref:n,role:"alert",className:Ye(WZ({variant:e}),t),...r}));Xt.displayName="Alert";const KZ=C.forwardRef(({className:t,...e},r)=>o.jsx("h5",{ref:r,className:Ye("mb-1 font-medium leading-none tracking-tight",t),...e}));KZ.displayName="AlertTitle";const Qt=C.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Ye("text-sm [&_p]:leading-relaxed",t),...e}));Qt.displayName="AlertDescription";var Ke;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Ke||(Ke={}));var vA=new Map([[Ke.QR_CODE,"QR_CODE"],[Ke.AZTEC,"AZTEC"],[Ke.CODABAR,"CODABAR"],[Ke.CODE_39,"CODE_39"],[Ke.CODE_93,"CODE_93"],[Ke.CODE_128,"CODE_128"],[Ke.DATA_MATRIX,"DATA_MATRIX"],[Ke.MAXICODE,"MAXICODE"],[Ke.ITF,"ITF"],[Ke.EAN_13,"EAN_13"],[Ke.EAN_8,"EAN_8"],[Ke.PDF_417,"PDF_417"],[Ke.RSS_14,"RSS_14"],[Ke.RSS_EXPANDED,"RSS_EXPANDED"],[Ke.UPC_A,"UPC_A"],[Ke.UPC_E,"UPC_E"],[Ke.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),wA;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(wA||(wA={}));function YZ(t){return Object.values(Ke).includes(t)}var cp;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(cp||(cp={}));var qZ=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[cp.SCAN_TYPE_CAMERA,cp.SCAN_TYPE_FILE],t}(),bj=function(){function t(e,r){this.format=e,this.formatName=r}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!vA.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,vA.get(e))},t}(),bA=function(){function t(){}return t.createFromText=function(e){var r={text:e};return{decodedText:e,result:r}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t}(),Lv;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Lv||(Lv={}));var XZ=function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:Lv.UNKWOWN_ERROR}},t}(),QZ=function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,r){(this.verbose||r===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t}();function xa(t){return typeof t>"u"||t===null}var Yc=function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),Ej=function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,r){if(typeof e!="object"){var n=typeof e;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(n,"."),!0),!1}for(var s=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(s),a=Object.keys(e),l=0,d=a;l<d.length;l++){var u=d[l];if(i.has(u))return r.logError("".concat(u," is not supported videoConstaints."),!0),!1}return!0},t}(),Pv={exports:{}};(function(t,e){(function(r,n){n(e)})(pd,function(r){function n(B){return B==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(B,c){B.__proto__=c}||function(B,c){for(var h in c)c.hasOwnProperty(h)&&(B[h]=c[h])};function i(B,c){s(B,c);function h(){this.constructor=B}B.prototype=c===null?Object.create(c):(h.prototype=c.prototype,new h)}function a(B,c){var h=Object.setPrototypeOf;h?h(B,c):B.__proto__=c}function l(B,c){c===void 0&&(c=B.constructor);var h=Error.captureStackTrace;h&&h(B,c)}var d=function(B){i(c,B);function c(h){var m=this.constructor,g=B.call(this,h)||this;return Object.defineProperty(g,"name",{value:m.name,enumerable:!1}),a(g,m.prototype),l(g),g}return c}(Error);class u extends d{constructor(c=void 0){super(c),this.message=c}getKind(){return this.constructor.kind}}u.kind="Exception";class f extends u{}f.kind="ArgumentException";class p extends u{}p.kind="IllegalArgumentException";class y{constructor(c){if(this.binarizer=c,c===null)throw new p("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(c,h){return this.binarizer.getBlackRow(c,h)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(c,h,m,g){const x=this.binarizer.getLuminanceSource().crop(c,h,m,g);return new y(this.binarizer.createBinarizer(x))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const c=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new y(this.binarizer.createBinarizer(c))}rotateCounterClockwise45(){const c=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new y(this.binarizer.createBinarizer(c))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class v extends u{static getChecksumInstance(){return new v}}v.kind="ChecksumException";class E{constructor(c){this.source=c}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class b{static arraycopy(c,h,m,g,x){for(;x--;)m[g++]=c[h++]}static currentTimeMillis(){return Date.now()}}class T extends u{}T.kind="IndexOutOfBoundsException";class I extends T{constructor(c=void 0,h=void 0){super(h),this.index=c,this.message=h}}I.kind="ArrayIndexOutOfBoundsException";class N{static fill(c,h){for(let m=0,g=c.length;m<g;m++)c[m]=h}static fillWithin(c,h,m,g){N.rangeCheck(c.length,h,m);for(let x=h;x<m;x++)c[x]=g}static rangeCheck(c,h,m){if(h>m)throw new p("fromIndex("+h+") > toIndex("+m+")");if(h<0)throw new I(h);if(m>c)throw new I(m)}static asList(...c){return c}static create(c,h,m){return Array.from({length:c}).map(x=>Array.from({length:h}).fill(m))}static createInt32Array(c,h,m){return Array.from({length:c}).map(x=>Int32Array.from({length:h}).fill(m))}static equals(c,h){if(!c||!h||!c.length||!h.length||c.length!==h.length)return!1;for(let m=0,g=c.length;m<g;m++)if(c[m]!==h[m])return!1;return!0}static hashCode(c){if(c===null)return 0;let h=1;for(const m of c)h=31*h+m;return h}static fillUint8Array(c,h){for(let m=0;m!==c.length;m++)c[m]=h}static copyOf(c,h){return c.slice(0,h)}static copyOfUint8Array(c,h){if(c.length<=h){const m=new Uint8Array(h);return m.set(c),m}return c.slice(0,h)}static copyOfRange(c,h,m){const g=m-h,x=new Int32Array(g);return b.arraycopy(c,h,x,0,g),x}static binarySearch(c,h,m){m===void 0&&(m=N.numberComparator);let g=0,x=c.length-1;for(;g<=x;){const w=x+g>>1,S=m(h,c[w]);if(S>0)g=w+1;else if(S<0)x=w-1;else return w}return-g-1}static numberComparator(c,h){return c-h}}class A{static numberOfTrailingZeros(c){let h;if(c===0)return 32;let m=31;return h=c<<16,h!==0&&(m-=16,c=h),h=c<<8,h!==0&&(m-=8,c=h),h=c<<4,h!==0&&(m-=4,c=h),h=c<<2,h!==0&&(m-=2,c=h),m-(c<<1>>>31)}static numberOfLeadingZeros(c){if(c===0)return 32;let h=1;return c>>>16||(h+=16,c<<=16),c>>>24||(h+=8,c<<=8),c>>>28||(h+=4,c<<=4),c>>>30||(h+=2,c<<=2),h-=c>>>31,h}static toHexString(c){return c.toString(16)}static toBinaryString(c){return String(parseInt(String(c),2))}static bitCount(c){return c=c-(c>>>1&1431655765),c=(c&858993459)+(c>>>2&858993459),c=c+(c>>>4)&252645135,c=c+(c>>>8),c=c+(c>>>16),c&63}static truncDivision(c,h){return Math.trunc(c/h)}static parseInt(c,h=void 0){return parseInt(c,h)}}A.MIN_VALUE_32_BITS=-2147483648,A.MAX_VALUE=Number.MAX_SAFE_INTEGER;class L{constructor(c,h){c===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=c,h==null?this.bits=L.makeArray(c):this.bits=h)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(c){if(c>this.bits.length*32){const h=L.makeArray(c);b.arraycopy(this.bits,0,h,0,this.bits.length),this.bits=h}}get(c){return(this.bits[Math.floor(c/32)]&1<<(c&31))!==0}set(c){this.bits[Math.floor(c/32)]|=1<<(c&31)}flip(c){this.bits[Math.floor(c/32)]^=1<<(c&31)}getNextSet(c){const h=this.size;if(c>=h)return h;const m=this.bits;let g=Math.floor(c/32),x=m[g];x&=~((1<<(c&31))-1);const w=m.length;for(;x===0;){if(++g===w)return h;x=m[g]}const S=g*32+A.numberOfTrailingZeros(x);return S>h?h:S}getNextUnset(c){const h=this.size;if(c>=h)return h;const m=this.bits;let g=Math.floor(c/32),x=~m[g];x&=~((1<<(c&31))-1);const w=m.length;for(;x===0;){if(++g===w)return h;x=~m[g]}const S=g*32+A.numberOfTrailingZeros(x);return S>h?h:S}setBulk(c,h){this.bits[Math.floor(c/32)]=h}setRange(c,h){if(h<c||c<0||h>this.size)throw new p;if(h===c)return;h--;const m=Math.floor(c/32),g=Math.floor(h/32),x=this.bits;for(let w=m;w<=g;w++){const S=w>m?0:c&31,_=(2<<(w<g?31:h&31))-(1<<S);x[w]|=_}}clear(){const c=this.bits.length,h=this.bits;for(let m=0;m<c;m++)h[m]=0}isRange(c,h,m){if(h<c||c<0||h>this.size)throw new p;if(h===c)return!0;h--;const g=Math.floor(c/32),x=Math.floor(h/32),w=this.bits;for(let S=g;S<=x;S++){const R=S>g?0:c&31,j=(2<<(S<x?31:h&31))-(1<<R)&4294967295;if((w[S]&j)!==(m?j:0))return!1}return!0}appendBit(c){this.ensureCapacity(this.size+1),c&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(c,h){if(h<0||h>32)throw new p("Num bits must be between 0 and 32");this.ensureCapacity(this.size+h);for(let m=h;m>0;m--)this.appendBit((c>>m-1&1)===1)}appendBitArray(c){const h=c.size;this.ensureCapacity(this.size+h);for(let m=0;m<h;m++)this.appendBit(c.get(m))}xor(c){if(this.size!==c.size)throw new p("Sizes don't match");const h=this.bits;for(let m=0,g=h.length;m<g;m++)h[m]^=c.bits[m]}toBytes(c,h,m,g){for(let x=0;x<g;x++){let w=0;for(let S=0;S<8;S++)this.get(c)&&(w|=1<<7-S),c++;h[m+x]=w}}getBitArray(){return this.bits}reverse(){const c=new Int32Array(this.bits.length),h=Math.floor((this.size-1)/32),m=h+1,g=this.bits;for(let x=0;x<m;x++){let w=g[x];w=w>>1&1431655765|(w&1431655765)<<1,w=w>>2&858993459|(w&858993459)<<2,w=w>>4&252645135|(w&252645135)<<4,w=w>>8&16711935|(w&16711935)<<8,w=w>>16&65535|(w&65535)<<16,c[h-x]=w}if(this.size!==m*32){const x=m*32-this.size;let w=c[0]>>>x;for(let S=1;S<m;S++){const R=c[S];w|=R<<32-x,c[S-1]=w,w=R>>>x}c[m-1]=w}this.bits=c}static makeArray(c){return new Int32Array(Math.floor((c+31)/32))}equals(c){if(!(c instanceof L))return!1;const h=c;return this.size===h.size&&N.equals(this.bits,h.bits)}hashCode(){return 31*this.size+N.hashCode(this.bits)}toString(){let c="";for(let h=0,m=this.size;h<m;h++)h&7||(c+=" "),c+=this.get(h)?"X":".";return c}clone(){return new L(this.size,this.bits.slice())}}var P;(function(B){B[B.OTHER=0]="OTHER",B[B.PURE_BARCODE=1]="PURE_BARCODE",B[B.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",B[B.TRY_HARDER=3]="TRY_HARDER",B[B.CHARACTER_SET=4]="CHARACTER_SET",B[B.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",B[B.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",B[B.ASSUME_GS1=7]="ASSUME_GS1",B[B.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",B[B.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",B[B.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(P||(P={}));var k=P;class D extends u{static getFormatInstance(){return new D}}D.kind="FormatException";var O;(function(B){B[B.Cp437=0]="Cp437",B[B.ISO8859_1=1]="ISO8859_1",B[B.ISO8859_2=2]="ISO8859_2",B[B.ISO8859_3=3]="ISO8859_3",B[B.ISO8859_4=4]="ISO8859_4",B[B.ISO8859_5=5]="ISO8859_5",B[B.ISO8859_6=6]="ISO8859_6",B[B.ISO8859_7=7]="ISO8859_7",B[B.ISO8859_8=8]="ISO8859_8",B[B.ISO8859_9=9]="ISO8859_9",B[B.ISO8859_10=10]="ISO8859_10",B[B.ISO8859_11=11]="ISO8859_11",B[B.ISO8859_13=12]="ISO8859_13",B[B.ISO8859_14=13]="ISO8859_14",B[B.ISO8859_15=14]="ISO8859_15",B[B.ISO8859_16=15]="ISO8859_16",B[B.SJIS=16]="SJIS",B[B.Cp1250=17]="Cp1250",B[B.Cp1251=18]="Cp1251",B[B.Cp1252=19]="Cp1252",B[B.Cp1256=20]="Cp1256",B[B.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",B[B.UTF8=22]="UTF8",B[B.ASCII=23]="ASCII",B[B.Big5=24]="Big5",B[B.GB18030=25]="GB18030",B[B.EUC_KR=26]="EUC_KR"})(O||(O={}));class F{constructor(c,h,m,...g){this.valueIdentifier=c,this.name=m,typeof h=="number"?this.values=Int32Array.from([h]):this.values=h,this.otherEncodingNames=g,F.VALUE_IDENTIFIER_TO_ECI.set(c,this),F.NAME_TO_ECI.set(m,this);const x=this.values;for(let w=0,S=x.length;w!==S;w++){const R=x[w];F.VALUES_TO_ECI.set(R,this)}for(const w of g)F.NAME_TO_ECI.set(w,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(c){if(c<0||c>=900)throw new D("incorect value");const h=F.VALUES_TO_ECI.get(c);if(h===void 0)throw new D("incorect value");return h}static getCharacterSetECIByName(c){const h=F.NAME_TO_ECI.get(c);if(h===void 0)throw new D("incorect value");return h}equals(c){if(!(c instanceof F))return!1;const h=c;return this.getName()===h.getName()}}F.VALUE_IDENTIFIER_TO_ECI=new Map,F.VALUES_TO_ECI=new Map,F.NAME_TO_ECI=new Map,F.Cp437=new F(O.Cp437,Int32Array.from([0,2]),"Cp437"),F.ISO8859_1=new F(O.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),F.ISO8859_2=new F(O.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),F.ISO8859_3=new F(O.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),F.ISO8859_4=new F(O.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),F.ISO8859_5=new F(O.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),F.ISO8859_6=new F(O.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),F.ISO8859_7=new F(O.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),F.ISO8859_8=new F(O.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),F.ISO8859_9=new F(O.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),F.ISO8859_10=new F(O.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),F.ISO8859_11=new F(O.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),F.ISO8859_13=new F(O.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),F.ISO8859_14=new F(O.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),F.ISO8859_15=new F(O.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),F.ISO8859_16=new F(O.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),F.SJIS=new F(O.SJIS,20,"SJIS","Shift_JIS"),F.Cp1250=new F(O.Cp1250,21,"Cp1250","windows-1250"),F.Cp1251=new F(O.Cp1251,22,"Cp1251","windows-1251"),F.Cp1252=new F(O.Cp1252,23,"Cp1252","windows-1252"),F.Cp1256=new F(O.Cp1256,24,"Cp1256","windows-1256"),F.UnicodeBigUnmarked=new F(O.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),F.UTF8=new F(O.UTF8,26,"UTF8","UTF-8"),F.ASCII=new F(O.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),F.Big5=new F(O.Big5,28,"Big5"),F.GB18030=new F(O.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),F.EUC_KR=new F(O.EUC_KR,30,"EUC_KR","EUC-KR");class $ extends u{}$.kind="UnsupportedOperationException";class G{static decode(c,h){const m=this.encodingName(h);return this.customDecoder?this.customDecoder(c,m):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(m)?this.decodeFallback(c,m):new TextDecoder(m).decode(c)}static shouldDecodeOnFallback(c){return!G.isBrowser()&&c==="ISO-8859-1"}static encode(c,h){const m=this.encodingName(h);return this.customEncoder?this.customEncoder(c,m):typeof TextEncoder>"u"?this.encodeFallback(c):new TextEncoder().encode(c)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(c){return typeof c=="string"?c:c.getName()}static encodingCharacterSet(c){return c instanceof F?c:F.getCharacterSetECIByName(c)}static decodeFallback(c,h){const m=this.encodingCharacterSet(h);if(G.isDecodeFallbackSupported(m)){let g="";for(let x=0,w=c.length;x<w;x++){let S=c[x].toString(16);S.length<2&&(S="0"+S),g+="%"+S}return decodeURIComponent(g)}if(m.equals(F.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(c.buffer));throw new $(`Encoding ${this.encodingName(h)} not supported by fallback.`)}static isDecodeFallbackSupported(c){return c.equals(F.UTF8)||c.equals(F.ISO8859_1)||c.equals(F.ASCII)}static encodeFallback(c){const m=btoa(unescape(encodeURIComponent(c))).split(""),g=[];for(let x=0;x<m.length;x++)g.push(m[x].charCodeAt(0));return new Uint8Array(g)}}class Y{static castAsNonUtf8Char(c,h=null){const m=h?h.getName():this.ISO88591;return G.decode(new Uint8Array([c]),m)}static guessEncoding(c,h){if(h!=null&&h.get(k.CHARACTER_SET)!==void 0)return h.get(k.CHARACTER_SET).toString();const m=c.length;let g=!0,x=!0,w=!0,S=0,R=0,_=0,j=0,U=0,V=0,W=0,J=0,te=0,de=0,xe=0;const ke=c.length>3&&c[0]===239&&c[1]===187&&c[2]===191;for(let je=0;je<m&&(g||x||w);je++){const Ie=c[je]&255;w&&(S>0?Ie&128?S--:w=!1:Ie&128&&(Ie&64?(S++,Ie&32?(S++,Ie&16?(S++,Ie&8?w=!1:j++):_++):R++):w=!1)),g&&(Ie>127&&Ie<160?g=!1:Ie>159&&(Ie<192||Ie===215||Ie===247)&&xe++),x&&(U>0?Ie<64||Ie===127||Ie>252?x=!1:U--:Ie===128||Ie===160||Ie>239?x=!1:Ie>160&&Ie<224?(V++,J=0,W++,W>te&&(te=W)):Ie>127?(U++,W=0,J++,J>de&&(de=J)):(W=0,J=0))}return w&&S>0&&(w=!1),x&&U>0&&(x=!1),w&&(ke||R+_+j>0)?Y.UTF8:x&&(Y.ASSUME_SHIFT_JIS||te>=3||de>=3)?Y.SHIFT_JIS:g&&x?te===2&&V===2||xe*10>=m?Y.SHIFT_JIS:Y.ISO88591:g?Y.ISO88591:x?Y.SHIFT_JIS:w?Y.UTF8:Y.PLATFORM_DEFAULT_ENCODING}static format(c,...h){let m=-1;function g(w,S,R,_,j,U){if(w==="%%")return"%";if(h[++m]===void 0)return;w=_?parseInt(_.substr(1)):void 0;let V=j?parseInt(j.substr(1)):void 0,W;switch(U){case"s":W=h[m];break;case"c":W=h[m][0];break;case"f":W=parseFloat(h[m]).toFixed(w);break;case"p":W=parseFloat(h[m]).toPrecision(w);break;case"e":W=parseFloat(h[m]).toExponential(w);break;case"x":W=parseInt(h[m]).toString(V||16);break;case"d":W=parseFloat(parseInt(h[m],V||10).toPrecision(w)).toFixed(0);break}W=typeof W=="object"?JSON.stringify(W):(+W).toString(V);let J=parseInt(R),te=R&&R[0]+""=="0"?"0":" ";for(;W.length<J;)W=S!==void 0?W+te:te+W;return W}let x=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return c.replace(x,g)}static getBytes(c,h){return G.encode(c,h)}static getCharCode(c,h=0){return c.charCodeAt(h)}static getCharAt(c){return String.fromCharCode(c)}}Y.SHIFT_JIS=F.SJIS.getName(),Y.GB2312="GB2312",Y.ISO88591=F.ISO8859_1.getName(),Y.EUC_JP="EUC_JP",Y.UTF8=F.UTF8.getName(),Y.PLATFORM_DEFAULT_ENCODING=Y.UTF8,Y.ASSUME_SHIFT_JIS=!1;class ne{constructor(c=""){this.value=c}enableDecoding(c){return this.encoding=c,this}append(c){return typeof c=="string"?this.value+=c.toString():this.encoding?this.value+=Y.castAsNonUtf8Char(c,this.encoding):this.value+=String.fromCharCode(c),this}appendChars(c,h,m){for(let g=h;h<h+m;g++)this.append(c[g]);return this}length(){return this.value.length}charAt(c){return this.value.charAt(c)}deleteCharAt(c){this.value=this.value.substr(0,c)+this.value.substring(c+1)}setCharAt(c,h){this.value=this.value.substr(0,c)+h+this.value.substr(c+1)}substring(c,h){return this.value.substring(c,h)}setLengthToZero(){this.value=""}toString(){return this.value}insert(c,h){this.value=this.value.substr(0,c)+h+this.value.substr(c+h.length)}}class X{constructor(c,h,m,g){if(this.width=c,this.height=h,this.rowSize=m,this.bits=g,h==null&&(h=c),this.height=h,c<1||h<1)throw new p("Both dimensions must be greater than 0");m==null&&(m=Math.floor((c+31)/32)),this.rowSize=m,g==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(c){const h=c.length,m=c[0].length,g=new X(m,h);for(let x=0;x<h;x++){const w=c[x];for(let S=0;S<m;S++)w[S]&&g.set(S,x)}return g}static parseFromString(c,h,m){if(c===null)throw new p("stringRepresentation cannot be null");const g=new Array(c.length);let x=0,w=0,S=-1,R=0,_=0;for(;_<c.length;)if(c.charAt(_)===`
`||c.charAt(_)==="\r"){if(x>w){if(S===-1)S=x-w;else if(x-w!==S)throw new p("row lengths do not match");w=x,R++}_++}else if(c.substring(_,_+h.length)===h)_+=h.length,g[x]=!0,x++;else if(c.substring(_,_+m.length)===m)_+=m.length,g[x]=!1,x++;else throw new p("illegal character encountered: "+c.substring(_));if(x>w){if(S===-1)S=x-w;else if(x-w!==S)throw new p("row lengths do not match");R++}const j=new X(S,R);for(let U=0;U<x;U++)g[U]&&j.set(Math.floor(U%S),Math.floor(U/S));return j}get(c,h){const m=h*this.rowSize+Math.floor(c/32);return(this.bits[m]>>>(c&31)&1)!==0}set(c,h){const m=h*this.rowSize+Math.floor(c/32);this.bits[m]|=1<<(c&31)&4294967295}unset(c,h){const m=h*this.rowSize+Math.floor(c/32);this.bits[m]&=~(1<<(c&31)&4294967295)}flip(c,h){const m=h*this.rowSize+Math.floor(c/32);this.bits[m]^=1<<(c&31)&4294967295}xor(c){if(this.width!==c.getWidth()||this.height!==c.getHeight()||this.rowSize!==c.getRowSize())throw new p("input matrix dimensions do not match");const h=new L(Math.floor(this.width/32)+1),m=this.rowSize,g=this.bits;for(let x=0,w=this.height;x<w;x++){const S=x*m,R=c.getRow(x,h).getBitArray();for(let _=0;_<m;_++)g[S+_]^=R[_]}}clear(){const c=this.bits,h=c.length;for(let m=0;m<h;m++)c[m]=0}setRegion(c,h,m,g){if(h<0||c<0)throw new p("Left and top must be nonnegative");if(g<1||m<1)throw new p("Height and width must be at least 1");const x=c+m,w=h+g;if(w>this.height||x>this.width)throw new p("The region must fit inside the matrix");const S=this.rowSize,R=this.bits;for(let _=h;_<w;_++){const j=_*S;for(let U=c;U<x;U++)R[j+Math.floor(U/32)]|=1<<(U&31)&4294967295}}getRow(c,h){h==null||h.getSize()<this.width?h=new L(this.width):h.clear();const m=this.rowSize,g=this.bits,x=c*m;for(let w=0;w<m;w++)h.setBulk(w*32,g[x+w]);return h}setRow(c,h){b.arraycopy(h.getBitArray(),0,this.bits,c*this.rowSize,this.rowSize)}rotate180(){const c=this.getWidth(),h=this.getHeight();let m=new L(c),g=new L(c);for(let x=0,w=Math.floor((h+1)/2);x<w;x++)m=this.getRow(x,m),g=this.getRow(h-1-x,g),m.reverse(),g.reverse(),this.setRow(x,g),this.setRow(h-1-x,m)}getEnclosingRectangle(){const c=this.width,h=this.height,m=this.rowSize,g=this.bits;let x=c,w=h,S=-1,R=-1;for(let _=0;_<h;_++)for(let j=0;j<m;j++){const U=g[_*m+j];if(U!==0){if(_<w&&(w=_),_>R&&(R=_),j*32<x){let V=0;for(;!(U<<31-V&4294967295);)V++;j*32+V<x&&(x=j*32+V)}if(j*32+31>S){let V=31;for(;!(U>>>V);)V--;j*32+V>S&&(S=j*32+V)}}}return S<x||R<w?null:Int32Array.from([x,w,S-x+1,R-w+1])}getTopLeftOnBit(){const c=this.rowSize,h=this.bits;let m=0;for(;m<h.length&&h[m]===0;)m++;if(m===h.length)return null;const g=m/c;let x=m%c*32;const w=h[m];let S=0;for(;!(w<<31-S&4294967295);)S++;return x+=S,Int32Array.from([x,g])}getBottomRightOnBit(){const c=this.rowSize,h=this.bits;let m=h.length-1;for(;m>=0&&h[m]===0;)m--;if(m<0)return null;const g=Math.floor(m/c);let x=Math.floor(m%c)*32;const w=h[m];let S=31;for(;!(w>>>S);)S--;return x+=S,Int32Array.from([x,g])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(c){if(!(c instanceof X))return!1;const h=c;return this.width===h.width&&this.height===h.height&&this.rowSize===h.rowSize&&N.equals(this.bits,h.bits)}hashCode(){let c=this.width;return c=31*c+this.width,c=31*c+this.height,c=31*c+this.rowSize,c=31*c+N.hashCode(this.bits),c}toString(c="X ",h="  ",m=`
`){return this.buildToString(c,h,m)}buildToString(c,h,m){let g=new ne;for(let x=0,w=this.height;x<w;x++){for(let S=0,R=this.width;S<R;S++)g.append(this.get(S,x)?c:h);g.append(m)}return g.toString()}clone(){return new X(this.width,this.height,this.rowSize,this.bits.slice())}}class z extends u{static getNotFoundInstance(){return new z}}z.kind="NotFoundException";class Z extends E{constructor(c){super(c),this.luminances=Z.EMPTY,this.buckets=new Int32Array(Z.LUMINANCE_BUCKETS)}getBlackRow(c,h){const m=this.getLuminanceSource(),g=m.getWidth();h==null||h.getSize()<g?h=new L(g):h.clear(),this.initArrays(g);const x=m.getRow(c,this.luminances),w=this.buckets;for(let R=0;R<g;R++)w[(x[R]&255)>>Z.LUMINANCE_SHIFT]++;const S=Z.estimateBlackPoint(w);if(g<3)for(let R=0;R<g;R++)(x[R]&255)<S&&h.set(R);else{let R=x[0]&255,_=x[1]&255;for(let j=1;j<g-1;j++){const U=x[j+1]&255;(_*4-R-U)/2<S&&h.set(j),R=_,_=U}}return h}getBlackMatrix(){const c=this.getLuminanceSource(),h=c.getWidth(),m=c.getHeight(),g=new X(h,m);this.initArrays(h);const x=this.buckets;for(let R=1;R<5;R++){const _=Math.floor(m*R/5),j=c.getRow(_,this.luminances),U=Math.floor(h*4/5);for(let V=Math.floor(h/5);V<U;V++){const W=j[V]&255;x[W>>Z.LUMINANCE_SHIFT]++}}const w=Z.estimateBlackPoint(x),S=c.getMatrix();for(let R=0;R<m;R++){const _=R*h;for(let j=0;j<h;j++)(S[_+j]&255)<w&&g.set(j,R)}return g}createBinarizer(c){return new Z(c)}initArrays(c){this.luminances.length<c&&(this.luminances=new Uint8ClampedArray(c));const h=this.buckets;for(let m=0;m<Z.LUMINANCE_BUCKETS;m++)h[m]=0}static estimateBlackPoint(c){const h=c.length;let m=0,g=0,x=0;for(let j=0;j<h;j++)c[j]>x&&(g=j,x=c[j]),c[j]>m&&(m=c[j]);let w=0,S=0;for(let j=0;j<h;j++){const U=j-g,V=c[j]*U*U;V>S&&(w=j,S=V)}if(g>w){const j=g;g=w,w=j}if(w-g<=h/16)throw new z;let R=w-1,_=-1;for(let j=w-1;j>g;j--){const U=j-g,V=U*U*(w-j)*(m-c[j]);V>_&&(R=j,_=V)}return R<<Z.LUMINANCE_SHIFT}}Z.LUMINANCE_BITS=5,Z.LUMINANCE_SHIFT=8-Z.LUMINANCE_BITS,Z.LUMINANCE_BUCKETS=1<<Z.LUMINANCE_BITS,Z.EMPTY=Uint8ClampedArray.from([0]);class ee extends Z{constructor(c){super(c),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const c=this.getLuminanceSource(),h=c.getWidth(),m=c.getHeight();if(h>=ee.MINIMUM_DIMENSION&&m>=ee.MINIMUM_DIMENSION){const g=c.getMatrix();let x=h>>ee.BLOCK_SIZE_POWER;h&ee.BLOCK_SIZE_MASK&&x++;let w=m>>ee.BLOCK_SIZE_POWER;m&ee.BLOCK_SIZE_MASK&&w++;const S=ee.calculateBlackPoints(g,x,w,h,m),R=new X(h,m);ee.calculateThresholdForBlock(g,x,w,h,m,S,R),this.matrix=R}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(c){return new ee(c)}static calculateThresholdForBlock(c,h,m,g,x,w,S){const R=x-ee.BLOCK_SIZE,_=g-ee.BLOCK_SIZE;for(let j=0;j<m;j++){let U=j<<ee.BLOCK_SIZE_POWER;U>R&&(U=R);const V=ee.cap(j,2,m-3);for(let W=0;W<h;W++){let J=W<<ee.BLOCK_SIZE_POWER;J>_&&(J=_);const te=ee.cap(W,2,h-3);let de=0;for(let ke=-2;ke<=2;ke++){const je=w[V+ke];de+=je[te-2]+je[te-1]+je[te]+je[te+1]+je[te+2]}const xe=de/25;ee.thresholdBlock(c,J,U,xe,g,S)}}}static cap(c,h,m){return c<h?h:c>m?m:c}static thresholdBlock(c,h,m,g,x,w){for(let S=0,R=m*x+h;S<ee.BLOCK_SIZE;S++,R+=x)for(let _=0;_<ee.BLOCK_SIZE;_++)(c[R+_]&255)<=g&&w.set(h+_,m+S)}static calculateBlackPoints(c,h,m,g,x){const w=x-ee.BLOCK_SIZE,S=g-ee.BLOCK_SIZE,R=new Array(m);for(let _=0;_<m;_++){R[_]=new Int32Array(h);let j=_<<ee.BLOCK_SIZE_POWER;j>w&&(j=w);for(let U=0;U<h;U++){let V=U<<ee.BLOCK_SIZE_POWER;V>S&&(V=S);let W=0,J=255,te=0;for(let xe=0,ke=j*g+V;xe<ee.BLOCK_SIZE;xe++,ke+=g){for(let je=0;je<ee.BLOCK_SIZE;je++){const Ie=c[ke+je]&255;W+=Ie,Ie<J&&(J=Ie),Ie>te&&(te=Ie)}if(te-J>ee.MIN_DYNAMIC_RANGE)for(xe++,ke+=g;xe<ee.BLOCK_SIZE;xe++,ke+=g)for(let je=0;je<ee.BLOCK_SIZE;je++)W+=c[ke+je]&255}let de=W>>ee.BLOCK_SIZE_POWER*2;if(te-J<=ee.MIN_DYNAMIC_RANGE&&(de=J/2,_>0&&U>0)){const xe=(R[_-1][U]+2*R[_][U-1]+R[_-1][U-1])/4;J<xe&&(de=xe)}R[_][U]=de}}return R}}ee.BLOCK_SIZE_POWER=3,ee.BLOCK_SIZE=1<<ee.BLOCK_SIZE_POWER,ee.BLOCK_SIZE_MASK=ee.BLOCK_SIZE-1,ee.MINIMUM_DIMENSION=ee.BLOCK_SIZE*5,ee.MIN_DYNAMIC_RANGE=24;class q{constructor(c,h){this.width=c,this.height=h}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(c,h,m,g){throw new $("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new $("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new $("This luminance source does not support rotation by 45 degrees.")}toString(){const c=new Uint8ClampedArray(this.width);let h=new ne;for(let m=0;m<this.height;m++){const g=this.getRow(m,c);for(let x=0;x<this.width;x++){const w=g[x]&255;let S;w<64?S="#":w<128?S="+":w<192?S=".":S=" ",h.append(S)}h.append(`
`)}return h.toString()}}class K extends q{constructor(c){super(c.getWidth(),c.getHeight()),this.delegate=c}getRow(c,h){const m=this.delegate.getRow(c,h),g=this.getWidth();for(let x=0;x<g;x++)m[x]=255-(m[x]&255);return m}getMatrix(){const c=this.delegate.getMatrix(),h=this.getWidth()*this.getHeight(),m=new Uint8ClampedArray(h);for(let g=0;g<h;g++)m[g]=255-(c[g]&255);return m}isCropSupported(){return this.delegate.isCropSupported()}crop(c,h,m,g){return new K(this.delegate.crop(c,h,m,g))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new K(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new K(this.delegate.rotateCounterClockwise45())}}class ae extends q{constructor(c){super(c.width,c.height),this.canvas=c,this.tempCanvasElement=null,this.buffer=ae.makeBufferFromCanvasImageData(c)}static makeBufferFromCanvasImageData(c){const h=c.getContext("2d").getImageData(0,0,c.width,c.height);return ae.toGrayscaleBuffer(h.data,c.width,c.height)}static toGrayscaleBuffer(c,h,m){const g=new Uint8ClampedArray(h*m);for(let x=0,w=0,S=c.length;x<S;x+=4,w++){let R;if(c[x+3]===0)R=255;else{const j=c[x],U=c[x+1],V=c[x+2];R=306*j+601*U+117*V+512>>10}g[w]=R}return g}getRow(c,h){if(c<0||c>=this.getHeight())throw new p("Requested row is outside the image: "+c);const m=this.getWidth(),g=c*m;return h===null?h=this.buffer.slice(g,g+m):(h.length<m&&(h=new Uint8ClampedArray(m)),h.set(this.buffer.slice(g,g+m))),h}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(c,h,m,g){return super.crop(c,h,m,g),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const c=this.canvas.ownerDocument.createElement("canvas");c.width=this.canvas.width,c.height=this.canvas.height,this.tempCanvasElement=c}return this.tempCanvasElement}rotate(c){const h=this.getTempCanvasElement(),m=h.getContext("2d"),g=c*ae.DEGREE_TO_RADIANS,x=this.canvas.width,w=this.canvas.height,S=Math.ceil(Math.abs(Math.cos(g))*x+Math.abs(Math.sin(g))*w),R=Math.ceil(Math.abs(Math.sin(g))*x+Math.abs(Math.cos(g))*w);return h.width=S,h.height=R,m.translate(S/2,R/2),m.rotate(g),m.drawImage(this.canvas,x/-2,w/-2),this.buffer=ae.makeBufferFromCanvasImageData(h),this}invert(){return new K(this)}}ae.DEGREE_TO_RADIANS=Math.PI/180;class Q{constructor(c,h,m){this.deviceId=c,this.label=h,this.kind="videoinput",this.groupId=m||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var re=(globalThis||pd||self||window||void 0)&&(globalThis||pd||self||window||void 0).__awaiter||function(B,c,h,m){function g(x){return x instanceof h?x:new h(function(w){w(x)})}return new(h||(h=Promise))(function(x,w){function S(j){try{_(m.next(j))}catch(U){w(U)}}function R(j){try{_(m.throw(j))}catch(U){w(U)}}function _(j){j.done?x(j.value):g(j.value).then(S,R)}_((m=m.apply(B,c||[])).next())})};class Ee{constructor(c,h=500,m){this.reader=c,this.timeBetweenScansMillis=h,this._hints=m,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(c){this._timeBetweenDecodingAttempts=c<0?0:c}set hints(c){this._hints=c||null}get hints(){return this._hints}listVideoInputDevices(){return re(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const c=yield navigator.mediaDevices.enumerateDevices(),h=[];for(const m of c){const g=m.kind==="video"?"videoinput":m.kind;if(g!=="videoinput")continue;const x=m.deviceId||m.id,w=m.label||`Video device ${h.length+1}`,S=m.groupId,R={deviceId:x,label:w,kind:g,groupId:S};h.push(R)}return h})}getVideoInputDevices(){return re(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(h=>new Q(h.deviceId,h.label))})}findDeviceById(c){return re(this,void 0,void 0,function*(){const h=yield this.listVideoInputDevices();return h?h.find(m=>m.deviceId===c):null})}decodeFromInputVideoDevice(c,h){return re(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(c,h)})}decodeOnceFromVideoDevice(c,h){return re(this,void 0,void 0,function*(){this.reset();let m;c?m={deviceId:{exact:c}}:m={facingMode:"environment"};const g={video:m};return yield this.decodeOnceFromConstraints(g,h)})}decodeOnceFromConstraints(c,h){return re(this,void 0,void 0,function*(){const m=yield navigator.mediaDevices.getUserMedia(c);return yield this.decodeOnceFromStream(m,h)})}decodeOnceFromStream(c,h){return re(this,void 0,void 0,function*(){this.reset();const m=yield this.attachStreamToVideo(c,h);return yield this.decodeOnce(m)})}decodeFromInputVideoDeviceContinuously(c,h,m){return re(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(c,h,m)})}decodeFromVideoDevice(c,h,m){return re(this,void 0,void 0,function*(){let g;c?g={deviceId:{exact:c}}:g={facingMode:"environment"};const x={video:g};return yield this.decodeFromConstraints(x,h,m)})}decodeFromConstraints(c,h,m){return re(this,void 0,void 0,function*(){const g=yield navigator.mediaDevices.getUserMedia(c);return yield this.decodeFromStream(g,h,m)})}decodeFromStream(c,h,m){return re(this,void 0,void 0,function*(){this.reset();const g=yield this.attachStreamToVideo(c,h);return yield this.decodeContinuously(g,m)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(c,h){return re(this,void 0,void 0,function*(){const m=this.prepareVideoElement(h);return this.addVideoSource(m,c),this.videoElement=m,this.stream=c,yield this.playVideoOnLoadAsync(m),m})}playVideoOnLoadAsync(c){return new Promise((h,m)=>this.playVideoOnLoad(c,()=>h()))}playVideoOnLoad(c,h){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(c),c.addEventListener("ended",this.videoEndedListener),c.addEventListener("canplay",this.videoCanPlayListener),c.addEventListener("playing",h),this.tryPlayVideo(c)}isVideoPlaying(c){return c.currentTime>0&&!c.paused&&!c.ended&&c.readyState>2}tryPlayVideo(c){return re(this,void 0,void 0,function*(){if(this.isVideoPlaying(c)){console.warn("Trying to play video that is already playing.");return}try{yield c.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(c,h){const m=document.getElementById(c);if(!m)throw new f(`element with id '${c}' not found`);if(m.nodeName.toLowerCase()!==h.toLowerCase())throw new f(`element with id '${c}' must be an ${h} element`);return m}decodeFromImage(c,h){if(!c&&!h)throw new f("either imageElement with a src set or an url must be provided");return h&&!c?this.decodeFromImageUrl(h):this.decodeFromImageElement(c)}decodeFromVideo(c,h){if(!c&&!h)throw new f("Either an element with a src set or an URL must be provided");return h&&!c?this.decodeFromVideoUrl(h):this.decodeFromVideoElement(c)}decodeFromVideoContinuously(c,h,m){if(c===void 0&&h===void 0)throw new f("Either an element with a src set or an URL must be provided");return h&&!c?this.decodeFromVideoUrlContinuously(h,m):this.decodeFromVideoElementContinuously(c,m)}decodeFromImageElement(c){if(!c)throw new f("An image element must be provided.");this.reset();const h=this.prepareImageElement(c);this.imageElement=h;let m;return this.isImageLoaded(h)?m=this.decodeOnce(h,!1,!0):m=this._decodeOnLoadImage(h),m}decodeFromVideoElement(c){const h=this._decodeFromVideoElementSetup(c);return this._decodeOnLoadVideo(h)}decodeFromVideoElementContinuously(c,h){const m=this._decodeFromVideoElementSetup(c);return this._decodeOnLoadVideoContinuously(m,h)}_decodeFromVideoElementSetup(c){if(!c)throw new f("A video element must be provided.");this.reset();const h=this.prepareVideoElement(c);return this.videoElement=h,h}decodeFromImageUrl(c){if(!c)throw new f("An URL must be provided.");this.reset();const h=this.prepareImageElement();this.imageElement=h;const m=this._decodeOnLoadImage(h);return h.src=c,m}decodeFromVideoUrl(c){if(!c)throw new f("An URL must be provided.");this.reset();const h=this.prepareVideoElement(),m=this.decodeFromVideoElement(h);return h.src=c,m}decodeFromVideoUrlContinuously(c,h){if(!c)throw new f("An URL must be provided.");this.reset();const m=this.prepareVideoElement(),g=this.decodeFromVideoElementContinuously(m,h);return m.src=c,g}_decodeOnLoadImage(c){return new Promise((h,m)=>{this.imageLoadedListener=()=>this.decodeOnce(c,!1,!0).then(h,m),c.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(c){return re(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(c),yield this.decodeOnce(c)})}_decodeOnLoadVideoContinuously(c,h){return re(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(c),this.decodeContinuously(c,h)})}isImageLoaded(c){return!(!c.complete||c.naturalWidth===0)}prepareImageElement(c){let h;return typeof c>"u"&&(h=document.createElement("img"),h.width=200,h.height=200),typeof c=="string"&&(h=this.getMediaElement(c,"img")),c instanceof HTMLImageElement&&(h=c),h}prepareVideoElement(c){let h;return!c&&typeof document<"u"&&(h=document.createElement("video"),h.width=200,h.height=200),typeof c=="string"&&(h=this.getMediaElement(c,"video")),c instanceof HTMLVideoElement&&(h=c),h.setAttribute("autoplay","true"),h.setAttribute("muted","true"),h.setAttribute("playsinline","true"),h}decodeOnce(c,h=!0,m=!0){this._stopAsyncDecode=!1;const g=(x,w)=>{if(this._stopAsyncDecode){w(new z("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const S=this.decode(c);x(S)}catch(S){const R=h&&S instanceof z,j=(S instanceof v||S instanceof D)&&m;if(R||j)return setTimeout(g,this._timeBetweenDecodingAttempts,x,w);w(S)}};return new Promise((x,w)=>g(x,w))}decodeContinuously(c,h){this._stopContinuousDecode=!1;const m=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const g=this.decode(c);h(g,null),setTimeout(m,this.timeBetweenScansMillis)}catch(g){h(null,g);const x=g instanceof v||g instanceof D,w=g instanceof z;(x||w)&&setTimeout(m,this._timeBetweenDecodingAttempts)}};m()}decode(c){const h=this.createBinaryBitmap(c);return this.decodeBitmap(h)}_isHTMLVideoElement(c){return c.videoWidth!==0}drawFrameOnCanvas(c,h,m){h||(h={sx:0,sy:0,sWidth:c.videoWidth,sHeight:c.videoHeight,dx:0,dy:0,dWidth:c.videoWidth,dHeight:c.videoHeight}),m||(m=this.captureCanvasContext),m.drawImage(c,h.sx,h.sy,h.sWidth,h.sHeight,h.dx,h.dy,h.dWidth,h.dHeight)}drawImageOnCanvas(c,h,m=this.captureCanvasContext){h||(h={sx:0,sy:0,sWidth:c.naturalWidth,sHeight:c.naturalHeight,dx:0,dy:0,dWidth:c.naturalWidth,dHeight:c.naturalHeight}),m||(m=this.captureCanvasContext),m.drawImage(c,h.sx,h.sy,h.sWidth,h.sHeight,h.dx,h.dy,h.dWidth,h.dHeight)}createBinaryBitmap(c){this.getCaptureCanvasContext(c),this._isHTMLVideoElement(c)?this.drawFrameOnCanvas(c):this.drawImageOnCanvas(c);const h=this.getCaptureCanvas(c),m=new ae(h),g=new ee(m);return new y(g)}getCaptureCanvasContext(c){if(!this.captureCanvasContext){const m=this.getCaptureCanvas(c).getContext("2d");this.captureCanvasContext=m}return this.captureCanvasContext}getCaptureCanvas(c){if(!this.captureCanvas){const h=this.createCaptureCanvas(c);this.captureCanvas=h}return this.captureCanvas}decodeBitmap(c){return this.reader.decode(c,this._hints)}createCaptureCanvas(c){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const h=document.createElement("canvas");let m,g;return typeof c<"u"&&(c instanceof HTMLVideoElement?(m=c.videoWidth,g=c.videoHeight):c instanceof HTMLImageElement&&(m=c.naturalWidth||c.width,g=c.naturalHeight||c.height)),h.style.width=m+"px",h.style.height=g+"px",h.width=m,h.height=g,h}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(c=>c.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(c,h){try{c.srcObject=h}catch{c.src=URL.createObjectURL(h)}}cleanVideoSource(c){try{c.srcObject=null}catch{c.src=""}this.videoElement.removeAttribute("src")}}class ie{constructor(c,h,m=h==null?0:8*h.length,g,x,w=b.currentTimeMillis()){this.text=c,this.rawBytes=h,this.numBits=m,this.resultPoints=g,this.format=x,this.timestamp=w,this.text=c,this.rawBytes=h,m==null?this.numBits=h==null?0:8*h.length:this.numBits=m,this.resultPoints=g,this.format=x,this.resultMetadata=null,w==null?this.timestamp=b.currentTimeMillis():this.timestamp=w}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(c,h){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(c,h)}putAllMetadata(c){c!==null&&(this.resultMetadata===null?this.resultMetadata=c:this.resultMetadata=new Map(c))}addResultPoints(c){const h=this.resultPoints;if(h===null)this.resultPoints=c;else if(c!==null&&c.length>0){const m=new Array(h.length+c.length);b.arraycopy(h,0,m,0,h.length),b.arraycopy(c,0,m,h.length,c.length),this.resultPoints=m}}getTimestamp(){return this.timestamp}toString(){return this.text}}var se;(function(B){B[B.AZTEC=0]="AZTEC",B[B.CODABAR=1]="CODABAR",B[B.CODE_39=2]="CODE_39",B[B.CODE_93=3]="CODE_93",B[B.CODE_128=4]="CODE_128",B[B.DATA_MATRIX=5]="DATA_MATRIX",B[B.EAN_8=6]="EAN_8",B[B.EAN_13=7]="EAN_13",B[B.ITF=8]="ITF",B[B.MAXICODE=9]="MAXICODE",B[B.PDF_417=10]="PDF_417",B[B.QR_CODE=11]="QR_CODE",B[B.RSS_14=12]="RSS_14",B[B.RSS_EXPANDED=13]="RSS_EXPANDED",B[B.UPC_A=14]="UPC_A",B[B.UPC_E=15]="UPC_E",B[B.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(se||(se={}));var oe=se,fe;(function(B){B[B.OTHER=0]="OTHER",B[B.ORIENTATION=1]="ORIENTATION",B[B.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",B[B.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",B[B.ISSUE_NUMBER=4]="ISSUE_NUMBER",B[B.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",B[B.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",B[B.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",B[B.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",B[B.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",B[B.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(fe||(fe={}));var Le=fe;class _e{constructor(c,h,m,g,x=-1,w=-1){this.rawBytes=c,this.text=h,this.byteSegments=m,this.ecLevel=g,this.structuredAppendSequenceNumber=x,this.structuredAppendParity=w,this.numBits=c==null?0:8*c.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(c){this.numBits=c}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(c){this.errorsCorrected=c}getErasures(){return this.erasures}setErasures(c){this.erasures=c}getOther(){return this.other}setOther(c){this.other=c}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ce{exp(c){return this.expTable[c]}log(c){if(c===0)throw new p;return this.logTable[c]}static addOrSubtract(c,h){return c^h}}class Se{constructor(c,h){if(h.length===0)throw new p;this.field=c;const m=h.length;if(m>1&&h[0]===0){let g=1;for(;g<m&&h[g]===0;)g++;g===m?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(m-g),b.arraycopy(h,g,this.coefficients,0,this.coefficients.length))}else this.coefficients=h}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(c){return this.coefficients[this.coefficients.length-1-c]}evaluateAt(c){if(c===0)return this.getCoefficient(0);const h=this.coefficients;let m;if(c===1){m=0;for(let w=0,S=h.length;w!==S;w++){const R=h[w];m=ce.addOrSubtract(m,R)}return m}m=h[0];const g=h.length,x=this.field;for(let w=1;w<g;w++)m=ce.addOrSubtract(x.multiply(c,m),h[w]);return m}addOrSubtract(c){if(!this.field.equals(c.field))throw new p("GenericGFPolys do not have same GenericGF field");if(this.isZero())return c;if(c.isZero())return this;let h=this.coefficients,m=c.coefficients;if(h.length>m.length){const w=h;h=m,m=w}let g=new Int32Array(m.length);const x=m.length-h.length;b.arraycopy(m,0,g,0,x);for(let w=x;w<m.length;w++)g[w]=ce.addOrSubtract(h[w-x],m[w]);return new Se(this.field,g)}multiply(c){if(!this.field.equals(c.field))throw new p("GenericGFPolys do not have same GenericGF field");if(this.isZero()||c.isZero())return this.field.getZero();const h=this.coefficients,m=h.length,g=c.coefficients,x=g.length,w=new Int32Array(m+x-1),S=this.field;for(let R=0;R<m;R++){const _=h[R];for(let j=0;j<x;j++)w[R+j]=ce.addOrSubtract(w[R+j],S.multiply(_,g[j]))}return new Se(S,w)}multiplyScalar(c){if(c===0)return this.field.getZero();if(c===1)return this;const h=this.coefficients.length,m=this.field,g=new Int32Array(h),x=this.coefficients;for(let w=0;w<h;w++)g[w]=m.multiply(x[w],c);return new Se(m,g)}multiplyByMonomial(c,h){if(c<0)throw new p;if(h===0)return this.field.getZero();const m=this.coefficients,g=m.length,x=new Int32Array(g+c),w=this.field;for(let S=0;S<g;S++)x[S]=w.multiply(m[S],h);return new Se(w,x)}divide(c){if(!this.field.equals(c.field))throw new p("GenericGFPolys do not have same GenericGF field");if(c.isZero())throw new p("Divide by 0");const h=this.field;let m=h.getZero(),g=this;const x=c.getCoefficient(c.getDegree()),w=h.inverse(x);for(;g.getDegree()>=c.getDegree()&&!g.isZero();){const S=g.getDegree()-c.getDegree(),R=h.multiply(g.getCoefficient(g.getDegree()),w),_=c.multiplyByMonomial(S,R),j=h.buildMonomial(S,R);m=m.addOrSubtract(j),g=g.addOrSubtract(_)}return[m,g]}toString(){let c="";for(let h=this.getDegree();h>=0;h--){let m=this.getCoefficient(h);if(m!==0){if(m<0?(c+=" - ",m=-m):c.length>0&&(c+=" + "),h===0||m!==1){const g=this.field.log(m);g===0?c+="1":g===1?c+="a":(c+="a^",c+=g)}h!==0&&(h===1?c+="x":(c+="x^",c+=h))}}return c}}class Pe extends u{}Pe.kind="ArithmeticException";class Be extends ce{constructor(c,h,m){super(),this.primitive=c,this.size=h,this.generatorBase=m;const g=new Int32Array(h);let x=1;for(let S=0;S<h;S++)g[S]=x,x*=2,x>=h&&(x^=c,x&=h-1);this.expTable=g;const w=new Int32Array(h);for(let S=0;S<h-1;S++)w[g[S]]=S;this.logTable=w,this.zero=new Se(this,Int32Array.from([0])),this.one=new Se(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(c,h){if(c<0)throw new p;if(h===0)return this.zero;const m=new Int32Array(c+1);return m[0]=h,new Se(this,m)}inverse(c){if(c===0)throw new Pe;return this.expTable[this.size-this.logTable[c]-1]}multiply(c,h){return c===0||h===0?0:this.expTable[(this.logTable[c]+this.logTable[h])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+A.toHexString(this.primitive)+","+this.size+")"}equals(c){return c===this}}Be.AZTEC_DATA_12=new Be(4201,4096,1),Be.AZTEC_DATA_10=new Be(1033,1024,1),Be.AZTEC_DATA_6=new Be(67,64,1),Be.AZTEC_PARAM=new Be(19,16,1),Be.QR_CODE_FIELD_256=new Be(285,256,0),Be.DATA_MATRIX_FIELD_256=new Be(301,256,1),Be.AZTEC_DATA_8=Be.DATA_MATRIX_FIELD_256,Be.MAXICODE_FIELD_64=Be.AZTEC_DATA_6;class tt extends u{}tt.kind="ReedSolomonException";class we extends u{}we.kind="IllegalStateException";class Ne{constructor(c){this.field=c}decode(c,h){const m=this.field,g=new Se(m,c),x=new Int32Array(h);let w=!0;for(let W=0;W<h;W++){const J=g.evaluateAt(m.exp(W+m.getGeneratorBase()));x[x.length-1-W]=J,J!==0&&(w=!1)}if(w)return;const S=new Se(m,x),R=this.runEuclideanAlgorithm(m.buildMonomial(h,1),S,h),_=R[0],j=R[1],U=this.findErrorLocations(_),V=this.findErrorMagnitudes(j,U);for(let W=0;W<U.length;W++){const J=c.length-1-m.log(U[W]);if(J<0)throw new tt("Bad error location");c[J]=Be.addOrSubtract(c[J],V[W])}}runEuclideanAlgorithm(c,h,m){if(c.getDegree()<h.getDegree()){const W=c;c=h,h=W}const g=this.field;let x=c,w=h,S=g.getZero(),R=g.getOne();for(;w.getDegree()>=(m/2|0);){let W=x,J=S;if(x=w,S=R,x.isZero())throw new tt("r_{i-1} was zero");w=W;let te=g.getZero();const de=x.getCoefficient(x.getDegree()),xe=g.inverse(de);for(;w.getDegree()>=x.getDegree()&&!w.isZero();){const ke=w.getDegree()-x.getDegree(),je=g.multiply(w.getCoefficient(w.getDegree()),xe);te=te.addOrSubtract(g.buildMonomial(ke,je)),w=w.addOrSubtract(x.multiplyByMonomial(ke,je))}if(R=te.multiply(S).addOrSubtract(J),w.getDegree()>=x.getDegree())throw new we("Division algorithm failed to reduce polynomial?")}const _=R.getCoefficient(0);if(_===0)throw new tt("sigmaTilde(0) was zero");const j=g.inverse(_),U=R.multiplyScalar(j),V=w.multiplyScalar(j);return[U,V]}findErrorLocations(c){const h=c.getDegree();if(h===1)return Int32Array.from([c.getCoefficient(1)]);const m=new Int32Array(h);let g=0;const x=this.field;for(let w=1;w<x.getSize()&&g<h;w++)c.evaluateAt(w)===0&&(m[g]=x.inverse(w),g++);if(g!==h)throw new tt("Error locator degree does not match number of roots");return m}findErrorMagnitudes(c,h){const m=h.length,g=new Int32Array(m),x=this.field;for(let w=0;w<m;w++){const S=x.inverse(h[w]);let R=1;for(let _=0;_<m;_++)if(w!==_){const j=x.multiply(h[_],S),U=j&1?j&-2:j|1;R=x.multiply(R,U)}g[w]=x.multiply(c.evaluateAt(S),x.inverse(R)),x.getGeneratorBase()!==0&&(g[w]=x.multiply(g[w],S))}return g}}var Je;(function(B){B[B.UPPER=0]="UPPER",B[B.LOWER=1]="LOWER",B[B.MIXED=2]="MIXED",B[B.DIGIT=3]="DIGIT",B[B.PUNCT=4]="PUNCT",B[B.BINARY=5]="BINARY"})(Je||(Je={}));class Xe{decode(c){this.ddata=c;let h=c.getBits(),m=this.extractBits(h),g=this.correctBits(m),x=Xe.convertBoolArrayToByteArray(g),w=Xe.getEncodedData(g),S=new _e(x,w,null,null);return S.setNumBits(g.length),S}static highLevelDecode(c){return this.getEncodedData(c)}static getEncodedData(c){let h=c.length,m=Je.UPPER,g=Je.UPPER,x="",w=0;for(;w<h;)if(g===Je.BINARY){if(h-w<5)break;let S=Xe.readCode(c,w,5);if(w+=5,S===0){if(h-w<11)break;S=Xe.readCode(c,w,11)+31,w+=11}for(let R=0;R<S;R++){if(h-w<8){w=h;break}const _=Xe.readCode(c,w,8);x+=Y.castAsNonUtf8Char(_),w+=8}g=m}else{let S=g===Je.DIGIT?4:5;if(h-w<S)break;let R=Xe.readCode(c,w,S);w+=S;let _=Xe.getCharacter(g,R);_.startsWith("CTRL_")?(m=g,g=Xe.getTable(_.charAt(5)),_.charAt(6)==="L"&&(m=g)):(x+=_,g=m)}return x}static getTable(c){switch(c){case"L":return Je.LOWER;case"P":return Je.PUNCT;case"M":return Je.MIXED;case"D":return Je.DIGIT;case"B":return Je.BINARY;case"U":default:return Je.UPPER}}static getCharacter(c,h){switch(c){case Je.UPPER:return Xe.UPPER_TABLE[h];case Je.LOWER:return Xe.LOWER_TABLE[h];case Je.MIXED:return Xe.MIXED_TABLE[h];case Je.PUNCT:return Xe.PUNCT_TABLE[h];case Je.DIGIT:return Xe.DIGIT_TABLE[h];default:throw new we("Bad table")}}correctBits(c){let h,m;this.ddata.getNbLayers()<=2?(m=6,h=Be.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(m=8,h=Be.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(m=10,h=Be.AZTEC_DATA_10):(m=12,h=Be.AZTEC_DATA_12);let g=this.ddata.getNbDatablocks(),x=c.length/m;if(x<g)throw new D;let w=c.length%m,S=new Int32Array(x);for(let V=0;V<x;V++,w+=m)S[V]=Xe.readCode(c,w,m);try{new Ne(h).decode(S,x-g)}catch(V){throw new D(V)}let R=(1<<m)-1,_=0;for(let V=0;V<g;V++){let W=S[V];if(W===0||W===R)throw new D;(W===1||W===R-1)&&_++}let j=new Array(g*m-_),U=0;for(let V=0;V<g;V++){let W=S[V];if(W===1||W===R-1)j.fill(W>1,U,U+m-1),U+=m-1;else for(let J=m-1;J>=0;--J)j[U++]=(W&1<<J)!==0}return j}extractBits(c){let h=this.ddata.isCompact(),m=this.ddata.getNbLayers(),g=(h?11:14)+m*4,x=new Int32Array(g),w=new Array(this.totalBitsInLayer(m,h));if(h)for(let S=0;S<x.length;S++)x[S]=S;else{let S=g+1+2*A.truncDivision(A.truncDivision(g,2)-1,15),R=g/2,_=A.truncDivision(S,2);for(let j=0;j<R;j++){let U=j+A.truncDivision(j,15);x[R-j-1]=_-U-1,x[R+j]=_+U+1}}for(let S=0,R=0;S<m;S++){let _=(m-S)*4+(h?9:12),j=S*2,U=g-1-j;for(let V=0;V<_;V++){let W=V*2;for(let J=0;J<2;J++)w[R+W+J]=c.get(x[j+J],x[j+V]),w[R+2*_+W+J]=c.get(x[j+V],x[U-J]),w[R+4*_+W+J]=c.get(x[U-J],x[U-V]),w[R+6*_+W+J]=c.get(x[U-V],x[j+J])}R+=_*8}return w}static readCode(c,h,m){let g=0;for(let x=h;x<h+m;x++)g<<=1,c[x]&&(g|=1);return g}static readByte(c,h){let m=c.length-h;return m>=8?Xe.readCode(c,h,8):Xe.readCode(c,h,m)<<8-m}static convertBoolArrayToByteArray(c){let h=new Uint8Array((c.length+7)/8);for(let m=0;m<h.length;m++)h[m]=Xe.readByte(c,8*m);return h}totalBitsInLayer(c,h){return((h?88:112)+16*c)*c}}Xe.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Xe.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Xe.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Xe.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Xe.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class at{constructor(){}static round(c){return c===NaN?0:c<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:c>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:c+(c<0?-.5:.5)|0}static distance(c,h,m,g){const x=c-m,w=h-g;return Math.sqrt(x*x+w*w)}static sum(c){let h=0;for(let m=0,g=c.length;m!==g;m++){const x=c[m];h+=x}return h}}class Wr{static floatToIntBits(c){return c}}Wr.MAX_VALUE=Number.MAX_SAFE_INTEGER;class $e{constructor(c,h){this.x=c,this.y=h}getX(){return this.x}getY(){return this.y}equals(c){if(c instanceof $e){const h=c;return this.x===h.x&&this.y===h.y}return!1}hashCode(){return 31*Wr.floatToIntBits(this.x)+Wr.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(c){const h=this.distance(c[0],c[1]),m=this.distance(c[1],c[2]),g=this.distance(c[0],c[2]);let x,w,S;if(m>=h&&m>=g?(w=c[0],x=c[1],S=c[2]):g>=m&&g>=h?(w=c[1],x=c[0],S=c[2]):(w=c[2],x=c[0],S=c[1]),this.crossProductZ(x,w,S)<0){const R=x;x=S,S=R}c[0]=x,c[1]=w,c[2]=S}static distance(c,h){return at.distance(c.x,c.y,h.x,h.y)}static crossProductZ(c,h,m){const g=h.x,x=h.y;return(m.x-g)*(c.y-x)-(m.y-x)*(c.x-g)}}class Bn{constructor(c,h){this.bits=c,this.points=h}getBits(){return this.bits}getPoints(){return this.points}}class gs extends Bn{constructor(c,h,m,g,x){super(c,h),this.compact=m,this.nbDatablocks=g,this.nbLayers=x}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class In{constructor(c,h,m,g){this.image=c,this.height=c.getHeight(),this.width=c.getWidth(),h==null&&(h=In.INIT_SIZE),m==null&&(m=c.getWidth()/2|0),g==null&&(g=c.getHeight()/2|0);const x=h/2|0;if(this.leftInit=m-x,this.rightInit=m+x,this.upInit=g-x,this.downInit=g+x,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new z}detect(){let c=this.leftInit,h=this.rightInit,m=this.upInit,g=this.downInit,x=!1,w=!0,S=!1,R=!1,_=!1,j=!1,U=!1;const V=this.width,W=this.height;for(;w;){w=!1;let J=!0;for(;(J||!R)&&h<V;)J=this.containsBlackPoint(m,g,h,!1),J?(h++,w=!0,R=!0):R||h++;if(h>=V){x=!0;break}let te=!0;for(;(te||!_)&&g<W;)te=this.containsBlackPoint(c,h,g,!0),te?(g++,w=!0,_=!0):_||g++;if(g>=W){x=!0;break}let de=!0;for(;(de||!j)&&c>=0;)de=this.containsBlackPoint(m,g,c,!1),de?(c--,w=!0,j=!0):j||c--;if(c<0){x=!0;break}let xe=!0;for(;(xe||!U)&&m>=0;)xe=this.containsBlackPoint(c,h,m,!0),xe?(m--,w=!0,U=!0):U||m--;if(m<0){x=!0;break}w&&(S=!0)}if(!x&&S){const J=h-c;let te=null;for(let je=1;te===null&&je<J;je++)te=this.getBlackPointOnSegment(c,g-je,c+je,g);if(te==null)throw new z;let de=null;for(let je=1;de===null&&je<J;je++)de=this.getBlackPointOnSegment(c,m+je,c+je,m);if(de==null)throw new z;let xe=null;for(let je=1;xe===null&&je<J;je++)xe=this.getBlackPointOnSegment(h,m+je,h-je,m);if(xe==null)throw new z;let ke=null;for(let je=1;ke===null&&je<J;je++)ke=this.getBlackPointOnSegment(h,g-je,h-je,g);if(ke==null)throw new z;return this.centerEdges(ke,te,xe,de)}else throw new z}getBlackPointOnSegment(c,h,m,g){const x=at.round(at.distance(c,h,m,g)),w=(m-c)/x,S=(g-h)/x,R=this.image;for(let _=0;_<x;_++){const j=at.round(c+_*w),U=at.round(h+_*S);if(R.get(j,U))return new $e(j,U)}return null}centerEdges(c,h,m,g){const x=c.getX(),w=c.getY(),S=h.getX(),R=h.getY(),_=m.getX(),j=m.getY(),U=g.getX(),V=g.getY(),W=In.CORR;return x<this.width/2?[new $e(U-W,V+W),new $e(S+W,R+W),new $e(_-W,j-W),new $e(x+W,w-W)]:[new $e(U+W,V+W),new $e(S+W,R-W),new $e(_-W,j+W),new $e(x-W,w-W)]}containsBlackPoint(c,h,m,g){const x=this.image;if(g){for(let w=c;w<=h;w++)if(x.get(w,m))return!0}else for(let w=c;w<=h;w++)if(x.get(m,w))return!0;return!1}}In.INIT_SIZE=10,In.CORR=1;class Ua{static checkAndNudgePoints(c,h){const m=c.getWidth(),g=c.getHeight();let x=!0;for(let w=0;w<h.length&&x;w+=2){const S=Math.floor(h[w]),R=Math.floor(h[w+1]);if(S<-1||S>m||R<-1||R>g)throw new z;x=!1,S===-1?(h[w]=0,x=!0):S===m&&(h[w]=m-1,x=!0),R===-1?(h[w+1]=0,x=!0):R===g&&(h[w+1]=g-1,x=!0)}x=!0;for(let w=h.length-2;w>=0&&x;w-=2){const S=Math.floor(h[w]),R=Math.floor(h[w+1]);if(S<-1||S>m||R<-1||R>g)throw new z;x=!1,S===-1?(h[w]=0,x=!0):S===m&&(h[w]=m-1,x=!0),R===-1?(h[w+1]=0,x=!0):R===g&&(h[w+1]=g-1,x=!0)}}}class Ft{constructor(c,h,m,g,x,w,S,R,_){this.a11=c,this.a21=h,this.a31=m,this.a12=g,this.a22=x,this.a32=w,this.a13=S,this.a23=R,this.a33=_}static quadrilateralToQuadrilateral(c,h,m,g,x,w,S,R,_,j,U,V,W,J,te,de){const xe=Ft.quadrilateralToSquare(c,h,m,g,x,w,S,R);return Ft.squareToQuadrilateral(_,j,U,V,W,J,te,de).times(xe)}transformPoints(c){const h=c.length,m=this.a11,g=this.a12,x=this.a13,w=this.a21,S=this.a22,R=this.a23,_=this.a31,j=this.a32,U=this.a33;for(let V=0;V<h;V+=2){const W=c[V],J=c[V+1],te=x*W+R*J+U;c[V]=(m*W+w*J+_)/te,c[V+1]=(g*W+S*J+j)/te}}transformPointsWithValues(c,h){const m=this.a11,g=this.a12,x=this.a13,w=this.a21,S=this.a22,R=this.a23,_=this.a31,j=this.a32,U=this.a33,V=c.length;for(let W=0;W<V;W++){const J=c[W],te=h[W],de=x*J+R*te+U;c[W]=(m*J+w*te+_)/de,h[W]=(g*J+S*te+j)/de}}static squareToQuadrilateral(c,h,m,g,x,w,S,R){const _=c-m+x-S,j=h-g+w-R;if(_===0&&j===0)return new Ft(m-c,x-m,c,g-h,w-g,h,0,0,1);{const U=m-x,V=S-x,W=g-w,J=R-w,te=U*J-V*W,de=(_*J-V*j)/te,xe=(U*j-_*W)/te;return new Ft(m-c+de*m,S-c+xe*S,c,g-h+de*g,R-h+xe*R,h,de,xe,1)}}static quadrilateralToSquare(c,h,m,g,x,w,S,R){return Ft.squareToQuadrilateral(c,h,m,g,x,w,S,R).buildAdjoint()}buildAdjoint(){return new Ft(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(c){return new Ft(this.a11*c.a11+this.a21*c.a12+this.a31*c.a13,this.a11*c.a21+this.a21*c.a22+this.a31*c.a23,this.a11*c.a31+this.a21*c.a32+this.a31*c.a33,this.a12*c.a11+this.a22*c.a12+this.a32*c.a13,this.a12*c.a21+this.a22*c.a22+this.a32*c.a23,this.a12*c.a31+this.a22*c.a32+this.a32*c.a33,this.a13*c.a11+this.a23*c.a12+this.a33*c.a13,this.a13*c.a21+this.a23*c.a22+this.a33*c.a23,this.a13*c.a31+this.a23*c.a32+this.a33*c.a33)}}class Ms extends Ua{sampleGrid(c,h,m,g,x,w,S,R,_,j,U,V,W,J,te,de,xe,ke,je){const Ie=Ft.quadrilateralToQuadrilateral(g,x,w,S,R,_,j,U,V,W,J,te,de,xe,ke,je);return this.sampleGridWithTransform(c,h,m,Ie)}sampleGridWithTransform(c,h,m,g){if(h<=0||m<=0)throw new z;const x=new X(h,m),w=new Float32Array(2*h);for(let S=0;S<m;S++){const R=w.length,_=S+.5;for(let j=0;j<R;j+=2)w[j]=j/2+.5,w[j+1]=_;g.transformPoints(w),Ua.checkAndNudgePoints(c,w);try{for(let j=0;j<R;j+=2)c.get(Math.floor(w[j]),Math.floor(w[j+1]))&&x.set(j/2,S)}catch{throw new z}}return x}}class Os{static setGridSampler(c){Os.gridSampler=c}static getInstance(){return Os.gridSampler}}Os.gridSampler=new Ms;class Ur{constructor(c,h){this.x=c,this.y=h}toResultPoint(){return new $e(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class Li{constructor(c){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=c}detect(){return this.detectMirror(!1)}detectMirror(c){let h=this.getMatrixCenter(),m=this.getBullsEyeCorners(h);if(c){let w=m[0];m[0]=m[2],m[2]=w}this.extractParameters(m);let g=this.sampleGrid(this.image,m[this.shift%4],m[(this.shift+1)%4],m[(this.shift+2)%4],m[(this.shift+3)%4]),x=this.getMatrixCornerPoints(m);return new gs(g,x,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(c){if(!this.isValidPoint(c[0])||!this.isValidPoint(c[1])||!this.isValidPoint(c[2])||!this.isValidPoint(c[3]))throw new z;let h=2*this.nbCenterLayers,m=new Int32Array([this.sampleLine(c[0],c[1],h),this.sampleLine(c[1],c[2],h),this.sampleLine(c[2],c[3],h),this.sampleLine(c[3],c[0],h)]);this.shift=this.getRotation(m,h);let g=0;for(let w=0;w<4;w++){let S=m[(this.shift+w)%4];this.compact?(g<<=7,g+=S>>1&127):(g<<=10,g+=(S>>2&992)+(S>>1&31))}let x=this.getCorrectedParameterData(g,this.compact);this.compact?(this.nbLayers=(x>>6)+1,this.nbDataBlocks=(x&63)+1):(this.nbLayers=(x>>11)+1,this.nbDataBlocks=(x&2047)+1)}getRotation(c,h){let m=0;c.forEach((g,x,w)=>{let S=(g>>h-2<<1)+(g&1);m=(m<<3)+S}),m=((m&1)<<11)+(m>>1);for(let g=0;g<4;g++)if(A.bitCount(m^this.EXPECTED_CORNER_BITS[g])<=2)return g;throw new z}getCorrectedParameterData(c,h){let m,g;h?(m=7,g=2):(m=10,g=4);let x=m-g,w=new Int32Array(m);for(let R=m-1;R>=0;--R)w[R]=c&15,c>>=4;try{new Ne(Be.AZTEC_PARAM).decode(w,x)}catch{throw new z}let S=0;for(let R=0;R<g;R++)S=(S<<4)+w[R];return S}getBullsEyeCorners(c){let h=c,m=c,g=c,x=c,w=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let U=this.getFirstDifferent(h,w,1,-1),V=this.getFirstDifferent(m,w,1,1),W=this.getFirstDifferent(g,w,-1,1),J=this.getFirstDifferent(x,w,-1,-1);if(this.nbCenterLayers>2){let te=this.distancePoint(J,U)*this.nbCenterLayers/(this.distancePoint(x,h)*(this.nbCenterLayers+2));if(te<.75||te>1.25||!this.isWhiteOrBlackRectangle(U,V,W,J))break}h=U,m=V,g=W,x=J,w=!w}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new z;this.compact=this.nbCenterLayers===5;let S=new $e(h.getX()+.5,h.getY()-.5),R=new $e(m.getX()+.5,m.getY()+.5),_=new $e(g.getX()-.5,g.getY()+.5),j=new $e(x.getX()-.5,x.getY()-.5);return this.expandSquare([S,R,_,j],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let c,h,m,g;try{let S=new In(this.image).detect();c=S[0],h=S[1],m=S[2],g=S[3]}catch{let R=this.image.getWidth()/2,_=this.image.getHeight()/2;c=this.getFirstDifferent(new Ur(R+7,_-7),!1,1,-1).toResultPoint(),h=this.getFirstDifferent(new Ur(R+7,_+7),!1,1,1).toResultPoint(),m=this.getFirstDifferent(new Ur(R-7,_+7),!1,-1,1).toResultPoint(),g=this.getFirstDifferent(new Ur(R-7,_-7),!1,-1,-1).toResultPoint()}let x=at.round((c.getX()+g.getX()+h.getX()+m.getX())/4),w=at.round((c.getY()+g.getY()+h.getY()+m.getY())/4);try{let S=new In(this.image,15,x,w).detect();c=S[0],h=S[1],m=S[2],g=S[3]}catch{c=this.getFirstDifferent(new Ur(x+7,w-7),!1,1,-1).toResultPoint(),h=this.getFirstDifferent(new Ur(x+7,w+7),!1,1,1).toResultPoint(),m=this.getFirstDifferent(new Ur(x-7,w+7),!1,-1,1).toResultPoint(),g=this.getFirstDifferent(new Ur(x-7,w-7),!1,-1,-1).toResultPoint()}return x=at.round((c.getX()+g.getX()+h.getX()+m.getX())/4),w=at.round((c.getY()+g.getY()+h.getY()+m.getY())/4),new Ur(x,w)}getMatrixCornerPoints(c){return this.expandSquare(c,2*this.nbCenterLayers,this.getDimension())}sampleGrid(c,h,m,g,x){let w=Os.getInstance(),S=this.getDimension(),R=S/2-this.nbCenterLayers,_=S/2+this.nbCenterLayers;return w.sampleGrid(c,S,S,R,R,_,R,_,_,R,_,h.getX(),h.getY(),m.getX(),m.getY(),g.getX(),g.getY(),x.getX(),x.getY())}sampleLine(c,h,m){let g=0,x=this.distanceResultPoint(c,h),w=x/m,S=c.getX(),R=c.getY(),_=w*(h.getX()-c.getX())/x,j=w*(h.getY()-c.getY())/x;for(let U=0;U<m;U++)this.image.get(at.round(S+U*_),at.round(R+U*j))&&(g|=1<<m-U-1);return g}isWhiteOrBlackRectangle(c,h,m,g){let x=3;c=new Ur(c.getX()-x,c.getY()+x),h=new Ur(h.getX()-x,h.getY()-x),m=new Ur(m.getX()+x,m.getY()-x),g=new Ur(g.getX()+x,g.getY()+x);let w=this.getColor(g,c);if(w===0)return!1;let S=this.getColor(c,h);return S!==w||(S=this.getColor(h,m),S!==w)?!1:(S=this.getColor(m,g),S===w)}getColor(c,h){let m=this.distancePoint(c,h),g=(h.getX()-c.getX())/m,x=(h.getY()-c.getY())/m,w=0,S=c.getX(),R=c.getY(),_=this.image.get(c.getX(),c.getY()),j=Math.ceil(m);for(let V=0;V<j;V++)S+=g,R+=x,this.image.get(at.round(S),at.round(R))!==_&&w++;let U=w/m;return U>.1&&U<.9?0:U<=.1===_?1:-1}getFirstDifferent(c,h,m,g){let x=c.getX()+m,w=c.getY()+g;for(;this.isValid(x,w)&&this.image.get(x,w)===h;)x+=m,w+=g;for(x-=m,w-=g;this.isValid(x,w)&&this.image.get(x,w)===h;)x+=m;for(x-=m;this.isValid(x,w)&&this.image.get(x,w)===h;)w+=g;return w-=g,new Ur(x,w)}expandSquare(c,h,m){let g=m/(2*h),x=c[0].getX()-c[2].getX(),w=c[0].getY()-c[2].getY(),S=(c[0].getX()+c[2].getX())/2,R=(c[0].getY()+c[2].getY())/2,_=new $e(S+g*x,R+g*w),j=new $e(S-g*x,R-g*w);x=c[1].getX()-c[3].getX(),w=c[1].getY()-c[3].getY(),S=(c[1].getX()+c[3].getX())/2,R=(c[1].getY()+c[3].getY())/2;let U=new $e(S+g*x,R+g*w),V=new $e(S-g*x,R-g*w);return[_,U,j,V]}isValid(c,h){return c>=0&&c<this.image.getWidth()&&h>0&&h<this.image.getHeight()}isValidPoint(c){let h=at.round(c.getX()),m=at.round(c.getY());return this.isValid(h,m)}distancePoint(c,h){return at.distance(c.getX(),c.getY(),h.getX(),h.getY())}distanceResultPoint(c,h){return at.distance(c.getX(),c.getY(),h.getX(),h.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(A.truncDivision(this.nbLayers-4,8)+1)+15}}class Fs{decode(c,h=null){let m=null,g=new Li(c.getBlackMatrix()),x=null,w=null;try{let j=g.detectMirror(!1);x=j.getPoints(),this.reportFoundResultPoints(h,x),w=new Xe().decode(j)}catch(j){m=j}if(w==null)try{let j=g.detectMirror(!0);x=j.getPoints(),this.reportFoundResultPoints(h,x),w=new Xe().decode(j)}catch(j){throw m??j}let S=new ie(w.getText(),w.getRawBytes(),w.getNumBits(),x,oe.AZTEC,b.currentTimeMillis()),R=w.getByteSegments();R!=null&&S.putMetadata(Le.BYTE_SEGMENTS,R);let _=w.getECLevel();return _!=null&&S.putMetadata(Le.ERROR_CORRECTION_LEVEL,_),S}reportFoundResultPoints(c,h){if(c!=null){let m=c.get(k.NEED_RESULT_POINT_CALLBACK);m!=null&&h.forEach((g,x,w)=>{m.foundPossibleResultPoint(g)})}}reset(){}}class If extends Ee{constructor(c=500){super(new Fs,c)}}class ir{decode(c,h){try{return this.doDecode(c,h)}catch{if(h&&h.get(k.TRY_HARDER)===!0&&c.isRotateSupported()){const x=c.rotateCounterClockwise(),w=this.doDecode(x,h),S=w.getResultMetadata();let R=270;S!==null&&S.get(Le.ORIENTATION)===!0&&(R=R+S.get(Le.ORIENTATION)%360),w.putMetadata(Le.ORIENTATION,R);const _=w.getResultPoints();if(_!==null){const j=x.getHeight();for(let U=0;U<_.length;U++)_[U]=new $e(j-_[U].getY()-1,_[U].getX())}return w}else throw new z}}reset(){}doDecode(c,h){const m=c.getWidth(),g=c.getHeight();let x=new L(m);const w=h&&h.get(k.TRY_HARDER)===!0,S=Math.max(1,g>>(w?8:5));let R;w?R=g:R=15;const _=Math.trunc(g/2);for(let j=0;j<R;j++){const U=Math.trunc((j+1)/2),V=(j&1)===0,W=_+S*(V?U:-U);if(W<0||W>=g)break;try{x=c.getBlackRow(W,x)}catch{continue}for(let J=0;J<2;J++){if(J===1&&(x.reverse(),h&&h.get(k.NEED_RESULT_POINT_CALLBACK)===!0)){const te=new Map;h.forEach((de,xe)=>te.set(xe,de)),te.delete(k.NEED_RESULT_POINT_CALLBACK),h=te}try{const te=this.decodeRow(W,x,h);if(J===1){te.putMetadata(Le.ORIENTATION,180);const de=te.getResultPoints();de!==null&&(de[0]=new $e(m-de[0].getX()-1,de[0].getY()),de[1]=new $e(m-de[1].getX()-1,de[1].getY()))}return te}catch{}}}throw new z}static recordPattern(c,h,m){const g=m.length;for(let _=0;_<g;_++)m[_]=0;const x=c.getSize();if(h>=x)throw new z;let w=!c.get(h),S=0,R=h;for(;R<x;){if(c.get(R)!==w)m[S]++;else{if(++S===g)break;m[S]=1,w=!w}R++}if(!(S===g||S===g-1&&R===x))throw new z}static recordPatternInReverse(c,h,m){let g=m.length,x=c.get(h);for(;h>0&&g>=0;)c.get(--h)!==x&&(g--,x=!x);if(g>=0)throw new z;ir.recordPattern(c,h+1,m)}static patternMatchVariance(c,h,m){const g=c.length;let x=0,w=0;for(let _=0;_<g;_++)x+=c[_],w+=h[_];if(x<w)return Number.POSITIVE_INFINITY;const S=x/w;m*=S;let R=0;for(let _=0;_<g;_++){const j=c[_],U=h[_]*S,V=j>U?j-U:U-j;if(V>m)return Number.POSITIVE_INFINITY;R+=V}return R/x}}class Oe extends ir{static findStartPattern(c){const h=c.getSize(),m=c.getNextSet(0);let g=0,x=Int32Array.from([0,0,0,0,0,0]),w=m,S=!1;const R=6;for(let _=m;_<h;_++)if(c.get(_)!==S)x[g]++;else{if(g===R-1){let j=Oe.MAX_AVG_VARIANCE,U=-1;for(let V=Oe.CODE_START_A;V<=Oe.CODE_START_C;V++){const W=ir.patternMatchVariance(x,Oe.CODE_PATTERNS[V],Oe.MAX_INDIVIDUAL_VARIANCE);W<j&&(j=W,U=V)}if(U>=0&&c.isRange(Math.max(0,w-(_-w)/2),w,!1))return Int32Array.from([w,_,U]);w+=x[0]+x[1],x=x.slice(2,x.length-1),x[g-1]=0,x[g]=0,g--}else g++;x[g]=1,S=!S}throw new z}static decodeCode(c,h,m){ir.recordPattern(c,m,h);let g=Oe.MAX_AVG_VARIANCE,x=-1;for(let w=0;w<Oe.CODE_PATTERNS.length;w++){const S=Oe.CODE_PATTERNS[w],R=this.patternMatchVariance(h,S,Oe.MAX_INDIVIDUAL_VARIANCE);R<g&&(g=R,x=w)}if(x>=0)return x;throw new z}decodeRow(c,h,m){const g=m&&m.get(k.ASSUME_GS1)===!0,x=Oe.findStartPattern(h),w=x[2];let S=0;const R=new Uint8Array(20);R[S++]=w;let _;switch(w){case Oe.CODE_START_A:_=Oe.CODE_CODE_A;break;case Oe.CODE_START_B:_=Oe.CODE_CODE_B;break;case Oe.CODE_START_C:_=Oe.CODE_CODE_C;break;default:throw new D}let j=!1,U=!1,V="",W=x[0],J=x[1];const te=Int32Array.from([0,0,0,0,0,0]);let de=0,xe=0,ke=w,je=0,Ie=!0,Nt=!1,mt=!1;for(;!j;){const yc=U;switch(U=!1,de=xe,xe=Oe.decodeCode(h,te,J),R[S++]=xe,xe!==Oe.CODE_STOP&&(Ie=!0),xe!==Oe.CODE_STOP&&(je++,ke+=je*xe),W=J,J+=te.reduce((D8,k8)=>D8+k8,0),xe){case Oe.CODE_START_A:case Oe.CODE_START_B:case Oe.CODE_START_C:throw new D}switch(_){case Oe.CODE_CODE_A:if(xe<64)mt===Nt?V+=String.fromCharCode(32+xe):V+=String.fromCharCode(32+xe+128),mt=!1;else if(xe<96)mt===Nt?V+=String.fromCharCode(xe-64):V+=String.fromCharCode(xe+64),mt=!1;else switch(xe!==Oe.CODE_STOP&&(Ie=!1),xe){case Oe.CODE_FNC_1:g&&(V.length===0?V+="]C1":V+="");break;case Oe.CODE_FNC_2:case Oe.CODE_FNC_3:break;case Oe.CODE_FNC_4_A:!Nt&&mt?(Nt=!0,mt=!1):Nt&&mt?(Nt=!1,mt=!1):mt=!0;break;case Oe.CODE_SHIFT:U=!0,_=Oe.CODE_CODE_B;break;case Oe.CODE_CODE_B:_=Oe.CODE_CODE_B;break;case Oe.CODE_CODE_C:_=Oe.CODE_CODE_C;break;case Oe.CODE_STOP:j=!0;break}break;case Oe.CODE_CODE_B:if(xe<96)mt===Nt?V+=String.fromCharCode(32+xe):V+=String.fromCharCode(32+xe+128),mt=!1;else switch(xe!==Oe.CODE_STOP&&(Ie=!1),xe){case Oe.CODE_FNC_1:g&&(V.length===0?V+="]C1":V+="");break;case Oe.CODE_FNC_2:case Oe.CODE_FNC_3:break;case Oe.CODE_FNC_4_B:!Nt&&mt?(Nt=!0,mt=!1):Nt&&mt?(Nt=!1,mt=!1):mt=!0;break;case Oe.CODE_SHIFT:U=!0,_=Oe.CODE_CODE_A;break;case Oe.CODE_CODE_A:_=Oe.CODE_CODE_A;break;case Oe.CODE_CODE_C:_=Oe.CODE_CODE_C;break;case Oe.CODE_STOP:j=!0;break}break;case Oe.CODE_CODE_C:if(xe<100)xe<10&&(V+="0"),V+=xe;else switch(xe!==Oe.CODE_STOP&&(Ie=!1),xe){case Oe.CODE_FNC_1:g&&(V.length===0?V+="]C1":V+="");break;case Oe.CODE_CODE_A:_=Oe.CODE_CODE_A;break;case Oe.CODE_CODE_B:_=Oe.CODE_CODE_B;break;case Oe.CODE_STOP:j=!0;break}break}yc&&(_=_===Oe.CODE_CODE_A?Oe.CODE_CODE_B:Oe.CODE_CODE_A)}const es=J-W;if(J=h.getNextUnset(J),!h.isRange(J,Math.min(h.getSize(),J+(J-W)/2),!1))throw new z;if(ke-=je*de,ke%103!==de)throw new v;const li=V.length;if(li===0)throw new z;li>0&&Ie&&(_===Oe.CODE_CODE_C?V=V.substring(0,li-2):V=V.substring(0,li-1));const ts=(x[1]+x[0])/2,Kt=W+es/2,gn=R.length,xs=new Uint8Array(gn);for(let yc=0;yc<gn;yc++)xs[yc]=R[yc];const xc=[new $e(ts,c),new $e(Kt,c)];return new ie(V,xs,0,xc,oe.CODE_128,new Date().getTime())}}Oe.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Oe.MAX_AVG_VARIANCE=.25,Oe.MAX_INDIVIDUAL_VARIANCE=.7,Oe.CODE_SHIFT=98,Oe.CODE_CODE_C=99,Oe.CODE_CODE_B=100,Oe.CODE_CODE_A=101,Oe.CODE_FNC_1=102,Oe.CODE_FNC_2=97,Oe.CODE_FNC_3=96,Oe.CODE_FNC_4_A=101,Oe.CODE_FNC_4_B=100,Oe.CODE_START_A=103,Oe.CODE_START_B=104,Oe.CODE_START_C=105,Oe.CODE_STOP=106;class wr extends ir{constructor(c=!1,h=!1){super(),this.usingCheckDigit=c,this.extendedMode=h,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(c,h,m){let g=this.counters;g.fill(0),this.decodeRowResult="";let x=wr.findAsteriskPattern(h,g),w=h.getNextSet(x[1]),S=h.getSize(),R,_;do{wr.recordPattern(h,w,g);let te=wr.toNarrowWidePattern(g);if(te<0)throw new z;R=wr.patternToChar(te),this.decodeRowResult+=R,_=w;for(let de of g)w+=de;w=h.getNextSet(w)}while(R!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let j=0;for(let te of g)j+=te;let U=w-_-j;if(w!==S&&U*2<j)throw new z;if(this.usingCheckDigit){let te=this.decodeRowResult.length-1,de=0;for(let xe=0;xe<te;xe++)de+=wr.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(xe));if(this.decodeRowResult.charAt(te)!==wr.ALPHABET_STRING.charAt(de%43))throw new v;this.decodeRowResult=this.decodeRowResult.substring(0,te)}if(this.decodeRowResult.length===0)throw new z;let V;this.extendedMode?V=wr.decodeExtended(this.decodeRowResult):V=this.decodeRowResult;let W=(x[1]+x[0])/2,J=_+j/2;return new ie(V,null,0,[new $e(W,c),new $e(J,c)],oe.CODE_39,new Date().getTime())}static findAsteriskPattern(c,h){let m=c.getSize(),g=c.getNextSet(0),x=0,w=g,S=!1,R=h.length;for(let _=g;_<m;_++)if(c.get(_)!==S)h[x]++;else{if(x===R-1){if(this.toNarrowWidePattern(h)===wr.ASTERISK_ENCODING&&c.isRange(Math.max(0,w-Math.floor((_-w)/2)),w,!1))return[w,_];w+=h[0]+h[1],h.copyWithin(0,2,2+x-1),h[x-1]=0,h[x]=0,x--}else x++;h[x]=1,S=!S}throw new z}static toNarrowWidePattern(c){let h=c.length,m=0,g;do{let x=2147483647;for(let R of c)R<x&&R>m&&(x=R);m=x,g=0;let w=0,S=0;for(let R=0;R<h;R++){let _=c[R];_>m&&(S|=1<<h-1-R,g++,w+=_)}if(g===3){for(let R=0;R<h&&g>0;R++){let _=c[R];if(_>m&&(g--,_*2>=w))return-1}return S}}while(g>3);return-1}static patternToChar(c){for(let h=0;h<wr.CHARACTER_ENCODINGS.length;h++)if(wr.CHARACTER_ENCODINGS[h]===c)return wr.ALPHABET_STRING.charAt(h);if(c===wr.ASTERISK_ENCODING)return"*";throw new z}static decodeExtended(c){let h=c.length,m="";for(let g=0;g<h;g++){let x=c.charAt(g);if(x==="+"||x==="$"||x==="%"||x==="/"){let w=c.charAt(g+1),S="\0";switch(x){case"+":if(w>="A"&&w<="Z")S=String.fromCharCode(w.charCodeAt(0)+32);else throw new D;break;case"$":if(w>="A"&&w<="Z")S=String.fromCharCode(w.charCodeAt(0)-64);else throw new D;break;case"%":if(w>="A"&&w<="E")S=String.fromCharCode(w.charCodeAt(0)-38);else if(w>="F"&&w<="J")S=String.fromCharCode(w.charCodeAt(0)-11);else if(w>="K"&&w<="O")S=String.fromCharCode(w.charCodeAt(0)+16);else if(w>="P"&&w<="T")S=String.fromCharCode(w.charCodeAt(0)+43);else if(w==="U")S="\0";else if(w==="V")S="@";else if(w==="W")S="`";else if(w==="X"||w==="Y"||w==="Z")S="";else throw new D;break;case"/":if(w>="A"&&w<="O")S=String.fromCharCode(w.charCodeAt(0)-32);else if(w==="Z")S=":";else throw new D;break}m+=S,g++}else m+=x}return m}}wr.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",wr.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],wr.ASTERISK_ENCODING=148;class Lt extends ir{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(c,h,m){let g=this.decodeStart(h),x=this.decodeEnd(h),w=new ne;Lt.decodeMiddle(h,g[1],x[0],w);let S=w.toString(),R=null;m!=null&&(R=m.get(k.ALLOWED_LENGTHS)),R==null&&(R=Lt.DEFAULT_ALLOWED_LENGTHS);let _=S.length,j=!1,U=0;for(let J of R){if(_===J){j=!0;break}J>U&&(U=J)}if(!j&&_>U&&(j=!0),!j)throw new D;const V=[new $e(g[1],c),new $e(x[0],c)];return new ie(S,null,0,V,oe.ITF,new Date().getTime())}static decodeMiddle(c,h,m,g){let x=new Int32Array(10),w=new Int32Array(5),S=new Int32Array(5);for(x.fill(0),w.fill(0),S.fill(0);h<m;){ir.recordPattern(c,h,x);for(let _=0;_<5;_++){let j=2*_;w[_]=x[j],S[_]=x[j+1]}let R=Lt.decodeDigit(w);g.append(R.toString()),R=this.decodeDigit(S),g.append(R.toString()),x.forEach(function(_){h+=_})}}decodeStart(c){let h=Lt.skipWhiteSpace(c),m=Lt.findGuardPattern(c,h,Lt.START_PATTERN);return this.narrowLineWidth=(m[1]-m[0])/4,this.validateQuietZone(c,m[0]),m}validateQuietZone(c,h){let m=this.narrowLineWidth*10;m=m<h?m:h;for(let g=h-1;m>0&&g>=0&&!c.get(g);g--)m--;if(m!==0)throw new z}static skipWhiteSpace(c){const h=c.getSize(),m=c.getNextSet(0);if(m===h)throw new z;return m}decodeEnd(c){c.reverse();try{let h=Lt.skipWhiteSpace(c),m;try{m=Lt.findGuardPattern(c,h,Lt.END_PATTERN_REVERSED[0])}catch(x){x instanceof z&&(m=Lt.findGuardPattern(c,h,Lt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(c,m[0]);let g=m[0];return m[0]=c.getSize()-m[1],m[1]=c.getSize()-g,m}finally{c.reverse()}}static findGuardPattern(c,h,m){let g=m.length,x=new Int32Array(g),w=c.getSize(),S=!1,R=0,_=h;x.fill(0);for(let j=h;j<w;j++)if(c.get(j)!==S)x[R]++;else{if(R===g-1){if(ir.patternMatchVariance(x,m,Lt.MAX_INDIVIDUAL_VARIANCE)<Lt.MAX_AVG_VARIANCE)return[_,j];_+=x[0]+x[1],b.arraycopy(x,2,x,0,R-1),x[R-1]=0,x[R]=0,R--}else R++;x[R]=1,S=!S}throw new z}static decodeDigit(c){let h=Lt.MAX_AVG_VARIANCE,m=-1,g=Lt.PATTERNS.length;for(let x=0;x<g;x++){let w=Lt.PATTERNS[x],S=ir.patternMatchVariance(c,w,Lt.MAX_INDIVIDUAL_VARIANCE);S<h?(h=S,m=x):S===h&&(m=-1)}if(m>=0)return m%10;throw new z}}Lt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Lt.MAX_AVG_VARIANCE=.38,Lt.MAX_INDIVIDUAL_VARIANCE=.5,Lt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Lt.START_PATTERN=Int32Array.from([1,1,1,1]),Lt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class ar extends ir{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(c){let h=!1,m,g=0,x=Int32Array.from([0,0,0]);for(;!h;){x=Int32Array.from([0,0,0]),m=ar.findGuardPattern(c,g,!1,this.START_END_PATTERN,x);let w=m[0];g=m[1];let S=w-(g-w);S>=0&&(h=c.isRange(S,w,!1))}return m}static checkChecksum(c){return ar.checkStandardUPCEANChecksum(c)}static checkStandardUPCEANChecksum(c){let h=c.length;if(h===0)return!1;let m=parseInt(c.charAt(h-1),10);return ar.getStandardUPCEANChecksum(c.substring(0,h-1))===m}static getStandardUPCEANChecksum(c){let h=c.length,m=0;for(let g=h-1;g>=0;g-=2){let x=c.charAt(g).charCodeAt(0)-48;if(x<0||x>9)throw new D;m+=x}m*=3;for(let g=h-2;g>=0;g-=2){let x=c.charAt(g).charCodeAt(0)-48;if(x<0||x>9)throw new D;m+=x}return(1e3-m)%10}static decodeEnd(c,h){return ar.findGuardPattern(c,h,!1,ar.START_END_PATTERN,new Int32Array(ar.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(c,h,m,g){return this.findGuardPattern(c,h,m,g,new Int32Array(g.length))}static findGuardPattern(c,h,m,g,x){let w=c.getSize();h=m?c.getNextUnset(h):c.getNextSet(h);let S=0,R=h,_=g.length,j=m;for(let U=h;U<w;U++)if(c.get(U)!==j)x[S]++;else{if(S===_-1){if(ir.patternMatchVariance(x,g,ar.MAX_INDIVIDUAL_VARIANCE)<ar.MAX_AVG_VARIANCE)return Int32Array.from([R,U]);R+=x[0]+x[1];let V=x.slice(2,x.length-1);for(let W=0;W<S-1;W++)x[W]=V[W];x[S-1]=0,x[S]=0,S--}else S++;x[S]=1,j=!j}throw new z}static decodeDigit(c,h,m,g){this.recordPattern(c,m,h);let x=this.MAX_AVG_VARIANCE,w=-1,S=g.length;for(let R=0;R<S;R++){let _=g[R],j=ir.patternMatchVariance(h,_,ar.MAX_INDIVIDUAL_VARIANCE);j<x&&(x=j,w=R)}if(w>=0)return w;throw new z}}ar.MAX_AVG_VARIANCE=.48,ar.MAX_INDIVIDUAL_VARIANCE=.7,ar.START_END_PATTERN=Int32Array.from([1,1,1]),ar.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),ar.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ar.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class el{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(c,h,m){let g=this.decodeRowStringBuffer,x=this.decodeMiddle(h,m,g),w=g.toString(),S=el.parseExtensionString(w),R=[new $e((m[0]+m[1])/2,c),new $e(x,c)],_=new ie(w,null,0,R,oe.UPC_EAN_EXTENSION,new Date().getTime());return S!=null&&_.putAllMetadata(S),_}decodeMiddle(c,h,m){let g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let x=c.getSize(),w=h[1],S=0;for(let _=0;_<5&&w<x;_++){let j=ar.decodeDigit(c,g,w,ar.L_AND_G_PATTERNS);m+=String.fromCharCode(48+j%10);for(let U of g)w+=U;j>=10&&(S|=1<<4-_),_!==4&&(w=c.getNextSet(w),w=c.getNextUnset(w))}if(m.length!==5)throw new z;let R=this.determineCheckDigit(S);if(el.extensionChecksum(m.toString())!==R)throw new z;return w}static extensionChecksum(c){let h=c.length,m=0;for(let g=h-2;g>=0;g-=2)m+=c.charAt(g).charCodeAt(0)-48;m*=3;for(let g=h-1;g>=0;g-=2)m+=c.charAt(g).charCodeAt(0)-48;return m*=3,m%10}determineCheckDigit(c){for(let h=0;h<10;h++)if(c===this.CHECK_DIGIT_ENCODINGS[h])return h;throw new z}static parseExtensionString(c){if(c.length!==5)return null;let h=el.parseExtension5String(c);return h==null?null:new Map([[Le.SUGGESTED_PRICE,h]])}static parseExtension5String(c){let h;switch(c.charAt(0)){case"0":h="";break;case"5":h="$";break;case"9":switch(c){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}h="";break;default:h="";break}let m=parseInt(c.substring(1)),g=(m/100).toString(),x=m%100,w=x<10?"0"+x:x.toString();return h+g+"."+w}}class uc{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(c,h,m){let g=this.decodeRowStringBuffer,x=this.decodeMiddle(h,m,g),w=g.toString(),S=uc.parseExtensionString(w),R=[new $e((m[0]+m[1])/2,c),new $e(x,c)],_=new ie(w,null,0,R,oe.UPC_EAN_EXTENSION,new Date().getTime());return S!=null&&_.putAllMetadata(S),_}decodeMiddle(c,h,m){let g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let x=c.getSize(),w=h[1],S=0;for(let R=0;R<2&&w<x;R++){let _=ar.decodeDigit(c,g,w,ar.L_AND_G_PATTERNS);m+=String.fromCharCode(48+_%10);for(let j of g)w+=j;_>=10&&(S|=1<<1-R),R!==1&&(w=c.getNextSet(w),w=c.getNextUnset(w))}if(m.length!==2)throw new z;if(parseInt(m.toString())%4!==S)throw new z;return w}static parseExtensionString(c){return c.length!==2?null:new Map([[Le.ISSUE_NUMBER,parseInt(c)]])}}class ad{static decodeRow(c,h,m){let g=ar.findGuardPattern(h,m,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new el().decodeRow(c,h,g)}catch{return new uc().decodeRow(c,h,g)}}}ad.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Pt extends ar{constructor(){super(),this.decodeRowStringBuffer="",Pt.L_AND_G_PATTERNS=Pt.L_PATTERNS.map(c=>Int32Array.from(c));for(let c=10;c<20;c++){let h=Pt.L_PATTERNS[c-10],m=new Int32Array(h.length);for(let g=0;g<h.length;g++)m[g]=h[h.length-g-1];Pt.L_AND_G_PATTERNS[c]=m}}decodeRow(c,h,m){let g=Pt.findStartGuardPattern(h),x=m==null?null:m.get(k.NEED_RESULT_POINT_CALLBACK);if(x!=null){const Ie=new $e((g[0]+g[1])/2,c);x.foundPossibleResultPoint(Ie)}let w=this.decodeMiddle(h,g,this.decodeRowStringBuffer),S=w.rowOffset,R=w.resultString;if(x!=null){const Ie=new $e(S,c);x.foundPossibleResultPoint(Ie)}let _=this.decodeEnd(h,S);if(x!=null){const Ie=new $e((_[0]+_[1])/2,c);x.foundPossibleResultPoint(Ie)}let j=_[1],U=j+(j-_[0]);if(U>=h.getSize()||!h.isRange(j,U,!1))throw new z;let V=R.toString();if(V.length<8)throw new D;if(!Pt.checkChecksum(V))throw new v;let W=(g[1]+g[0])/2,J=(_[1]+_[0])/2,te=this.getBarcodeFormat(),de=[new $e(W,c),new $e(J,c)],xe=new ie(V,null,0,de,te,new Date().getTime()),ke=0;try{let Ie=ad.decodeRow(c,h,_[1]);xe.putMetadata(Le.UPC_EAN_EXTENSION,Ie.getText()),xe.putAllMetadata(Ie.getResultMetadata()),xe.addResultPoints(Ie.getResultPoints()),ke=Ie.getText().length}catch{}let je=m==null?null:m.get(k.ALLOWED_EAN_EXTENSIONS);if(je!=null){let Ie=!1;for(let Nt in je)if(ke.toString()===Nt){Ie=!0;break}if(!Ie)throw new z}return xe}decodeEnd(c,h){return Pt.findGuardPattern(c,h,!1,Pt.START_END_PATTERN,new Int32Array(Pt.START_END_PATTERN.length).fill(0))}static checkChecksum(c){return Pt.checkStandardUPCEANChecksum(c)}static checkStandardUPCEANChecksum(c){let h=c.length;if(h===0)return!1;let m=parseInt(c.charAt(h-1),10);return Pt.getStandardUPCEANChecksum(c.substring(0,h-1))===m}static getStandardUPCEANChecksum(c){let h=c.length,m=0;for(let g=h-1;g>=0;g-=2){let x=c.charAt(g).charCodeAt(0)-48;if(x<0||x>9)throw new D;m+=x}m*=3;for(let g=h-2;g>=0;g-=2){let x=c.charAt(g).charCodeAt(0)-48;if(x<0||x>9)throw new D;m+=x}return(1e3-m)%10}}class ai extends Pt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(c,h,m){let g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let x=c.getSize(),w=h[1],S=0;for(let _=0;_<6&&w<x;_++){let j=Pt.decodeDigit(c,g,w,Pt.L_AND_G_PATTERNS);m+=String.fromCharCode(48+j%10);for(let U of g)w+=U;j>=10&&(S|=1<<5-_)}m=ai.determineFirstDigit(m,S),w=Pt.findGuardPattern(c,w,!0,Pt.MIDDLE_PATTERN,new Int32Array(Pt.MIDDLE_PATTERN.length).fill(0))[1];for(let _=0;_<6&&w<x;_++){let j=Pt.decodeDigit(c,g,w,Pt.L_PATTERNS);m+=String.fromCharCode(48+j);for(let U of g)w+=U}return{rowOffset:w,resultString:m}}getBarcodeFormat(){return oe.EAN_13}static determineFirstDigit(c,h){for(let m=0;m<10;m++)if(h===this.FIRST_DIGIT_ENCODINGS[m])return c=String.fromCharCode(48+m)+c,c;throw new z}}ai.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class oi extends Pt{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(c,h,m){const g=this.decodeMiddleCounters;g[0]=0,g[1]=0,g[2]=0,g[3]=0;let x=c.getSize(),w=h[1];for(let R=0;R<4&&w<x;R++){let _=Pt.decodeDigit(c,g,w,Pt.L_PATTERNS);m+=String.fromCharCode(48+_);for(let j of g)w+=j}w=Pt.findGuardPattern(c,w,!0,Pt.MIDDLE_PATTERN,new Int32Array(Pt.MIDDLE_PATTERN.length).fill(0))[1];for(let R=0;R<4&&w<x;R++){let _=Pt.decodeDigit(c,g,w,Pt.L_PATTERNS);m+=String.fromCharCode(48+_);for(let j of g)w+=j}return{rowOffset:w,resultString:m}}getBarcodeFormat(){return oe.EAN_8}}class Rf extends Pt{constructor(){super(...arguments),this.ean13Reader=new ai}getBarcodeFormat(){return oe.UPC_A}decode(c,h){return this.maybeReturnResult(this.ean13Reader.decode(c))}decodeRow(c,h,m){return this.maybeReturnResult(this.ean13Reader.decodeRow(c,h,m))}decodeMiddle(c,h,m){return this.ean13Reader.decodeMiddle(c,h,m)}maybeReturnResult(c){let h=c.getText();if(h.charAt(0)==="0"){let m=new ie(h.substring(1),null,null,c.getResultPoints(),oe.UPC_A);return c.getResultMetadata()!=null&&m.putAllMetadata(c.getResultMetadata()),m}else throw new z}reset(){this.ean13Reader.reset()}}class et extends Pt{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(c,h,m){const g=this.decodeMiddleCounters.map(_=>_);g[0]=0,g[1]=0,g[2]=0,g[3]=0;const x=c.getSize();let w=h[1],S=0;for(let _=0;_<6&&w<x;_++){const j=et.decodeDigit(c,g,w,et.L_AND_G_PATTERNS);m+=String.fromCharCode(48+j%10);for(let U of g)w+=U;j>=10&&(S|=1<<5-_)}let R=et.determineNumSysAndCheckDigit(m,S);return{rowOffset:w,resultString:R}}decodeEnd(c,h){return et.findGuardPatternWithoutCounters(c,h,!0,et.MIDDLE_END_PATTERN)}checkChecksum(c){return Pt.checkChecksum(et.convertUPCEtoUPCA(c))}static determineNumSysAndCheckDigit(c,h){for(let m=0;m<=1;m++)for(let g=0;g<10;g++)if(h===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[m][g]){let x=String.fromCharCode(48+m),w=String.fromCharCode(48+g);return x+c+w}throw z.getNotFoundInstance()}getBarcodeFormat(){return oe.UPC_E}static convertUPCEtoUPCA(c){const h=c.slice(1,7).split("").map(x=>x.charCodeAt(0)),m=new ne;m.append(c.charAt(0));let g=h[5];switch(g){case 0:case 1:case 2:m.appendChars(h,0,2),m.append(g),m.append("0000"),m.appendChars(h,2,3);break;case 3:m.appendChars(h,0,3),m.append("00000"),m.appendChars(h,3,2);break;case 4:m.appendChars(h,0,4),m.append("00000"),m.append(h[4]);break;default:m.appendChars(h,0,5),m.append("0000"),m.append(g);break}return c.length>=8&&m.append(c.charAt(7)),m.toString()}}et.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),et.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Mt extends ir{constructor(c){super();let h=c==null?null:c.get(k.POSSIBLE_FORMATS),m=[];n(h)?(m.push(new ai),m.push(new Rf),m.push(new oi),m.push(new et)):(h.indexOf(oe.EAN_13)>-1&&m.push(new ai),h.indexOf(oe.UPC_A)>-1&&m.push(new Rf),h.indexOf(oe.EAN_8)>-1&&m.push(new oi),h.indexOf(oe.UPC_E)>-1&&m.push(new et)),this.readers=m}decodeRow(c,h,m){for(let g of this.readers)try{const x=g.decodeRow(c,h,m),w=x.getBarcodeFormat()===oe.EAN_13&&x.getText().charAt(0)==="0",S=m==null?null:m.get(k.POSSIBLE_FORMATS),R=S==null||S.includes(oe.UPC_A);if(w&&R){const _=x.getRawBytes(),j=new ie(x.getText().substring(1),_,_?_.length:null,x.getResultPoints(),oe.UPC_A);return j.putAllMetadata(x.getResultMetadata()),j}return x}catch{}throw new z}reset(){for(let c of this.readers)c.reset()}}class gt extends ir{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(c,h){for(let m=0;m<h.length;m++)if(ir.patternMatchVariance(c,h[m],gt.MAX_INDIVIDUAL_VARIANCE)<gt.MAX_AVG_VARIANCE)return m;throw new z}static count(c){return at.sum(new Int32Array(c))}static increment(c,h){let m=0,g=h[0];for(let x=1;x<c.length;x++)h[x]>g&&(g=h[x],m=x);c[m]++}static decrement(c,h){let m=0,g=h[0];for(let x=1;x<c.length;x++)h[x]<g&&(g=h[x],m=x);c[m]--}static isFinderPattern(c){let h=c[0]+c[1],m=h+c[2]+c[3],g=h/m;if(g>=gt.MIN_FINDER_PATTERN_RATIO&&g<=gt.MAX_FINDER_PATTERN_RATIO){let x=Number.MAX_SAFE_INTEGER,w=Number.MIN_SAFE_INTEGER;for(let S of c)S>w&&(w=S),S<x&&(x=S);return w<10*x}return!1}}gt.MAX_AVG_VARIANCE=.2,gt.MAX_INDIVIDUAL_VARIANCE=.45,gt.MIN_FINDER_PATTERN_RATIO=9.5/12,gt.MAX_FINDER_PATTERN_RATIO=12.5/14;class rn{constructor(c,h){this.value=c,this.checksumPortion=h}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(c){if(!(c instanceof rn))return!1;const h=c;return this.value===h.value&&this.checksumPortion===h.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Rn{constructor(c,h,m,g,x){this.value=c,this.startEnd=h,this.value=c,this.startEnd=h,this.resultPoints=new Array,this.resultPoints.push(new $e(m,x)),this.resultPoints.push(new $e(g,x))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(c){if(!(c instanceof Rn))return!1;const h=c;return this.value===h.value}hashCode(){return this.value}}class Kr{constructor(){}static getRSSvalue(c,h,m){let g=0;for(let R of c)g+=R;let x=0,w=0,S=c.length;for(let R=0;R<S-1;R++){let _;for(_=1,w|=1<<R;_<c[R];_++,w&=~(1<<R)){let j=Kr.combins(g-_-1,S-R-2);if(m&&w===0&&g-_-(S-R-1)>=S-R-1&&(j-=Kr.combins(g-_-(S-R),S-R-2)),S-R-1>1){let U=0;for(let V=g-_-(S-R-2);V>h;V--)U+=Kr.combins(g-_-V-1,S-R-3);j-=U*(S-1-R)}else g-_>h&&j--;x+=j}g-=_}return x}static combins(c,h){let m,g;c-h>h?(g=h,m=c-h):(g=c-h,m=h);let x=1,w=1;for(let S=c;S>m;S--)x*=S,w<=g&&(x/=w,w++);for(;w<=g;)x/=w,w++;return x}}class da{static buildBitArray(c){let h=c.length*2-1;c[c.length-1].getRightChar()==null&&(h-=1);let m=12*h,g=new L(m),x=0,S=c[0].getRightChar().getValue();for(let R=11;R>=0;--R)S&1<<R&&g.set(x),x++;for(let R=1;R<c.length;++R){let _=c[R],j=_.getLeftChar().getValue();for(let U=11;U>=0;--U)j&1<<U&&g.set(x),x++;if(_.getRightChar()!=null){let U=_.getRightChar().getValue();for(let V=11;V>=0;--V)U&1<<V&&g.set(x),x++}}return g}}class Yr{constructor(c,h){h?this.decodedInformation=null:(this.finished=c,this.decodedInformation=h)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Bs{constructor(c){this.newPosition=c}getNewPosition(){return this.newPosition}}class Qn extends Bs{constructor(c,h){super(c),this.value=h}getValue(){return this.value}isFNC1(){return this.value===Qn.FNC1}}Qn.FNC1="$";class tl extends Bs{constructor(c,h,m){super(c),m?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=h}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Us extends Bs{constructor(c,h,m){if(super(c),h<0||h>10||m<0||m>10)throw new D;this.firstDigit=h,this.secondDigit=m}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Us.FNC1}isSecondDigitFNC1(){return this.secondDigit===Us.FNC1}isAnyFNC1(){return this.firstDigit===Us.FNC1||this.secondDigit===Us.FNC1}}Us.FNC1=10;class We{constructor(){}static parseFieldsInGeneralPurpose(c){if(!c)return null;if(c.length<2)throw new z;let h=c.substring(0,2);for(let x of We.TWO_DIGIT_DATA_LENGTH)if(x[0]===h)return x[1]===We.VARIABLE_LENGTH?We.processVariableAI(2,x[2],c):We.processFixedAI(2,x[1],c);if(c.length<3)throw new z;let m=c.substring(0,3);for(let x of We.THREE_DIGIT_DATA_LENGTH)if(x[0]===m)return x[1]===We.VARIABLE_LENGTH?We.processVariableAI(3,x[2],c):We.processFixedAI(3,x[1],c);for(let x of We.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(x[0]===m)return x[1]===We.VARIABLE_LENGTH?We.processVariableAI(4,x[2],c):We.processFixedAI(4,x[1],c);if(c.length<4)throw new z;let g=c.substring(0,4);for(let x of We.FOUR_DIGIT_DATA_LENGTH)if(x[0]===g)return x[1]===We.VARIABLE_LENGTH?We.processVariableAI(4,x[2],c):We.processFixedAI(4,x[1],c);throw new z}static processFixedAI(c,h,m){if(m.length<c)throw new z;let g=m.substring(0,c);if(m.length<c+h)throw new z;let x=m.substring(c,c+h),w=m.substring(c+h),S="("+g+")"+x,R=We.parseFieldsInGeneralPurpose(w);return R==null?S:S+R}static processVariableAI(c,h,m){let g=m.substring(0,c),x;m.length<c+h?x=m.length:x=c+h;let w=m.substring(c,x),S=m.substring(x),R="("+g+")"+w,_=We.parseFieldsInGeneralPurpose(S);return _==null?R:R+_}}We.VARIABLE_LENGTH=[],We.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",We.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",We.VARIABLE_LENGTH,20],["22",We.VARIABLE_LENGTH,29],["30",We.VARIABLE_LENGTH,8],["37",We.VARIABLE_LENGTH,8],["90",We.VARIABLE_LENGTH,30],["91",We.VARIABLE_LENGTH,30],["92",We.VARIABLE_LENGTH,30],["93",We.VARIABLE_LENGTH,30],["94",We.VARIABLE_LENGTH,30],["95",We.VARIABLE_LENGTH,30],["96",We.VARIABLE_LENGTH,30],["97",We.VARIABLE_LENGTH,3],["98",We.VARIABLE_LENGTH,30],["99",We.VARIABLE_LENGTH,30]],We.THREE_DIGIT_DATA_LENGTH=[["240",We.VARIABLE_LENGTH,30],["241",We.VARIABLE_LENGTH,30],["242",We.VARIABLE_LENGTH,6],["250",We.VARIABLE_LENGTH,30],["251",We.VARIABLE_LENGTH,30],["253",We.VARIABLE_LENGTH,17],["254",We.VARIABLE_LENGTH,20],["400",We.VARIABLE_LENGTH,30],["401",We.VARIABLE_LENGTH,30],["402",17],["403",We.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",We.VARIABLE_LENGTH,20],["421",We.VARIABLE_LENGTH,15],["422",3],["423",We.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],We.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",We.VARIABLE_LENGTH,15],["391",We.VARIABLE_LENGTH,18],["392",We.VARIABLE_LENGTH,15],["393",We.VARIABLE_LENGTH,18],["703",We.VARIABLE_LENGTH,30]],We.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",We.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",We.VARIABLE_LENGTH,20],["8003",We.VARIABLE_LENGTH,30],["8004",We.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",We.VARIABLE_LENGTH,30],["8008",We.VARIABLE_LENGTH,12],["8018",18],["8020",We.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",We.VARIABLE_LENGTH,70],["8200",We.VARIABLE_LENGTH,70]];class dc{constructor(c){this.buffer=new ne,this.information=c}decodeAllCodes(c,h){let m=h,g=null;do{let x=this.decodeGeneralPurposeField(m,g),w=We.parseFieldsInGeneralPurpose(x.getNewString());if(w!=null&&c.append(w),x.isRemaining()?g=""+x.getRemainingValue():g=null,m===x.getNewPosition())break;m=x.getNewPosition()}while(!0);return c.toString()}isStillNumeric(c){if(c+7>this.information.getSize())return c+4<=this.information.getSize();for(let h=c;h<c+3;++h)if(this.information.get(h))return!0;return this.information.get(c+3)}decodeNumeric(c){if(c+7>this.information.getSize()){let x=this.extractNumericValueFromBitArray(c,4);return x===0?new Us(this.information.getSize(),Us.FNC1,Us.FNC1):new Us(this.information.getSize(),x-1,Us.FNC1)}let h=this.extractNumericValueFromBitArray(c,7),m=(h-8)/11,g=(h-8)%11;return new Us(c+7,m,g)}extractNumericValueFromBitArray(c,h){return dc.extractNumericValueFromBitArray(this.information,c,h)}static extractNumericValueFromBitArray(c,h,m){let g=0;for(let x=0;x<m;++x)c.get(h+x)&&(g|=1<<m-x-1);return g}decodeGeneralPurposeField(c,h){this.buffer.setLengthToZero(),h!=null&&this.buffer.append(h),this.current.setPosition(c);let m=this.parseBlocks();return m!=null&&m.isRemaining()?new tl(this.current.getPosition(),this.buffer.toString(),m.getRemainingValue()):new tl(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let c,h;do{let m=this.current.getPosition();if(this.current.isAlpha()?(h=this.parseAlphaBlock(),c=h.isFinished()):this.current.isIsoIec646()?(h=this.parseIsoIec646Block(),c=h.isFinished()):(h=this.parseNumericBlock(),c=h.isFinished()),!(m!==this.current.getPosition())&&!c)break}while(!c);return h.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let c=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(c.getNewPosition()),c.isFirstDigitFNC1()){let h;return c.isSecondDigitFNC1()?h=new tl(this.current.getPosition(),this.buffer.toString()):h=new tl(this.current.getPosition(),this.buffer.toString(),c.getSecondDigit()),new Yr(!0,h)}if(this.buffer.append(c.getFirstDigit()),c.isSecondDigitFNC1()){let h=new tl(this.current.getPosition(),this.buffer.toString());return new Yr(!0,h)}this.buffer.append(c.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Yr(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let c=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(c.getNewPosition()),c.isFNC1()){let h=new tl(this.current.getPosition(),this.buffer.toString());return new Yr(!0,h)}this.buffer.append(c.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Yr(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let c=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(c.getNewPosition()),c.isFNC1()){let h=new tl(this.current.getPosition(),this.buffer.toString());return new Yr(!0,h)}this.buffer.append(c.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Yr(!1)}isStillIsoIec646(c){if(c+5>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(c,5);if(h>=5&&h<16)return!0;if(c+7>this.information.getSize())return!1;let m=this.extractNumericValueFromBitArray(c,7);if(m>=64&&m<116)return!0;if(c+8>this.information.getSize())return!1;let g=this.extractNumericValueFromBitArray(c,8);return g>=232&&g<253}decodeIsoIec646(c){let h=this.extractNumericValueFromBitArray(c,5);if(h===15)return new Qn(c+5,Qn.FNC1);if(h>=5&&h<15)return new Qn(c+5,"0"+(h-5));let m=this.extractNumericValueFromBitArray(c,7);if(m>=64&&m<90)return new Qn(c+7,""+(m+1));if(m>=90&&m<116)return new Qn(c+7,""+(m+7));let g=this.extractNumericValueFromBitArray(c,8),x;switch(g){case 232:x="!";break;case 233:x='"';break;case 234:x="%";break;case 235:x="&";break;case 236:x="'";break;case 237:x="(";break;case 238:x=")";break;case 239:x="*";break;case 240:x="+";break;case 241:x=",";break;case 242:x="-";break;case 243:x=".";break;case 244:x="/";break;case 245:x=":";break;case 246:x=";";break;case 247:x="<";break;case 248:x="=";break;case 249:x=">";break;case 250:x="?";break;case 251:x="_";break;case 252:x=" ";break;default:throw new D}return new Qn(c+8,x)}isStillAlpha(c){if(c+5>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(c,5);if(h>=5&&h<16)return!0;if(c+6>this.information.getSize())return!1;let m=this.extractNumericValueFromBitArray(c,6);return m>=16&&m<63}decodeAlphanumeric(c){let h=this.extractNumericValueFromBitArray(c,5);if(h===15)return new Qn(c+5,Qn.FNC1);if(h>=5&&h<15)return new Qn(c+5,"0"+(h-5));let m=this.extractNumericValueFromBitArray(c,6);if(m>=32&&m<58)return new Qn(c+6,""+(m+33));let g;switch(m){case 58:g="*";break;case 59:g=",";break;case 60:g="-";break;case 61:g=".";break;case 62:g="/";break;default:throw new we("Decoding invalid alphanumeric value: "+m)}return new Qn(c+6,g)}isAlphaTo646ToAlphaLatch(c){if(c+1>this.information.getSize())return!1;for(let h=0;h<5&&h+c<this.information.getSize();++h)if(h===2){if(!this.information.get(c+2))return!1}else if(this.information.get(c+h))return!1;return!0}isAlphaOr646ToNumericLatch(c){if(c+3>this.information.getSize())return!1;for(let h=c;h<c+3;++h)if(this.information.get(h))return!1;return!0}isNumericToAlphaNumericLatch(c){if(c+1>this.information.getSize())return!1;for(let h=0;h<4&&h+c<this.information.getSize();++h)if(this.information.get(c+h))return!1;return!0}}class Bg{constructor(c){this.information=c,this.generalDecoder=new dc(c)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Zn extends Bg{constructor(c){super(c)}encodeCompressedGtin(c,h){c.append("(01)");let m=c.length();c.append("9"),this.encodeCompressedGtinWithoutAI(c,h,m)}encodeCompressedGtinWithoutAI(c,h,m){for(let g=0;g<4;++g){let x=this.getGeneralDecoder().extractNumericValueFromBitArray(h+10*g,10);x/100===0&&c.append("0"),x/10===0&&c.append("0"),c.append(x)}Zn.appendCheckDigit(c,m)}static appendCheckDigit(c,h){let m=0;for(let g=0;g<13;g++){let x=c.charAt(g+h).charCodeAt(0)-48;m+=g&1?x:3*x}m=10-m%10,m===10&&(m=0),c.append(m)}}Zn.GTIN_SIZE=40;class hc extends Zn{constructor(c){super(c)}parseInformation(){let c=new ne;c.append("(01)");let h=c.length(),m=this.getGeneralDecoder().extractNumericValueFromBitArray(hc.HEADER_SIZE,4);return c.append(m),this.encodeCompressedGtinWithoutAI(c,hc.HEADER_SIZE+4,h),this.getGeneralDecoder().decodeAllCodes(c,hc.HEADER_SIZE+44)}}hc.HEADER_SIZE=4;class _f extends Bg{constructor(c){super(c)}parseInformation(){let c=new ne;return this.getGeneralDecoder().decodeAllCodes(c,_f.HEADER_SIZE)}}_f.HEADER_SIZE=5;class Lf extends Zn{constructor(c){super(c)}encodeCompressedWeight(c,h,m){let g=this.getGeneralDecoder().extractNumericValueFromBitArray(h,m);this.addWeightCode(c,g);let x=this.checkWeight(g),w=1e5;for(let S=0;S<5;++S)x/w===0&&c.append("0"),w/=10;c.append(x)}}class Pi extends Lf{constructor(c){super(c)}parseInformation(){if(this.getInformation().getSize()!=Pi.HEADER_SIZE+Lf.GTIN_SIZE+Pi.WEIGHT_SIZE)throw new z;let c=new ne;return this.encodeCompressedGtin(c,Pi.HEADER_SIZE),this.encodeCompressedWeight(c,Pi.HEADER_SIZE+Lf.GTIN_SIZE,Pi.WEIGHT_SIZE),c.toString()}}Pi.HEADER_SIZE=5,Pi.WEIGHT_SIZE=15;class a8 extends Pi{constructor(c){super(c)}addWeightCode(c,h){c.append("(3103)")}checkWeight(c){return c}}class o8 extends Pi{constructor(c){super(c)}addWeightCode(c,h){h<1e4?c.append("(3202)"):c.append("(3203)")}checkWeight(c){return c<1e4?c:c-1e4}}class Di extends Zn{constructor(c){super(c)}parseInformation(){if(this.getInformation().getSize()<Di.HEADER_SIZE+Zn.GTIN_SIZE)throw new z;let c=new ne;this.encodeCompressedGtin(c,Di.HEADER_SIZE);let h=this.getGeneralDecoder().extractNumericValueFromBitArray(Di.HEADER_SIZE+Zn.GTIN_SIZE,Di.LAST_DIGIT_SIZE);c.append("(392"),c.append(h),c.append(")");let m=this.getGeneralDecoder().decodeGeneralPurposeField(Di.HEADER_SIZE+Zn.GTIN_SIZE+Di.LAST_DIGIT_SIZE,null);return c.append(m.getNewString()),c.toString()}}Di.HEADER_SIZE=8,Di.LAST_DIGIT_SIZE=2;class Un extends Zn{constructor(c){super(c)}parseInformation(){if(this.getInformation().getSize()<Un.HEADER_SIZE+Zn.GTIN_SIZE)throw new z;let c=new ne;this.encodeCompressedGtin(c,Un.HEADER_SIZE);let h=this.getGeneralDecoder().extractNumericValueFromBitArray(Un.HEADER_SIZE+Zn.GTIN_SIZE,Un.LAST_DIGIT_SIZE);c.append("(393"),c.append(h),c.append(")");let m=this.getGeneralDecoder().extractNumericValueFromBitArray(Un.HEADER_SIZE+Zn.GTIN_SIZE+Un.LAST_DIGIT_SIZE,Un.FIRST_THREE_DIGITS_SIZE);m/100==0&&c.append("0"),m/10==0&&c.append("0"),c.append(m);let g=this.getGeneralDecoder().decodeGeneralPurposeField(Un.HEADER_SIZE+Zn.GTIN_SIZE+Un.LAST_DIGIT_SIZE+Un.FIRST_THREE_DIGITS_SIZE,null);return c.append(g.getNewString()),c.toString()}}Un.HEADER_SIZE=8,Un.LAST_DIGIT_SIZE=2,Un.FIRST_THREE_DIGITS_SIZE=10;class or extends Lf{constructor(c,h,m){super(c),this.dateCode=m,this.firstAIdigits=h}parseInformation(){if(this.getInformation().getSize()!=or.HEADER_SIZE+or.GTIN_SIZE+or.WEIGHT_SIZE+or.DATE_SIZE)throw new z;let c=new ne;return this.encodeCompressedGtin(c,or.HEADER_SIZE),this.encodeCompressedWeight(c,or.HEADER_SIZE+or.GTIN_SIZE,or.WEIGHT_SIZE),this.encodeCompressedDate(c,or.HEADER_SIZE+or.GTIN_SIZE+or.WEIGHT_SIZE),c.toString()}encodeCompressedDate(c,h){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(h,or.DATE_SIZE);if(m==38400)return;c.append("("),c.append(this.dateCode),c.append(")");let g=m%32;m/=32;let x=m%12+1;m/=12;let w=m;w/10==0&&c.append("0"),c.append(w),x/10==0&&c.append("0"),c.append(x),g/10==0&&c.append("0"),c.append(g)}addWeightCode(c,h){c.append("("),c.append(this.firstAIdigits),c.append(h/1e5),c.append(")")}checkWeight(c){return c%1e5}}or.HEADER_SIZE=8,or.WEIGHT_SIZE=20,or.DATE_SIZE=16;function p2(B){try{if(B.get(1))return new hc(B);if(!B.get(2))return new _f(B);switch(dc.extractNumericValueFromBitArray(B,1,4)){case 4:return new a8(B);case 5:return new o8(B)}switch(dc.extractNumericValueFromBitArray(B,1,5)){case 12:return new Di(B);case 13:return new Un(B)}switch(dc.extractNumericValueFromBitArray(B,1,7)){case 56:return new or(B,"310","11");case 57:return new or(B,"320","11");case 58:return new or(B,"310","13");case 59:return new or(B,"320","13");case 60:return new or(B,"310","15");case 61:return new or(B,"320","15");case 62:return new or(B,"310","17");case 63:return new or(B,"320","17")}}catch(c){throw console.log(c),new we("unknown decoder: "+B)}}class $a{constructor(c,h,m,g){this.leftchar=c,this.rightchar=h,this.finderpattern=m,this.maybeLast=g}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(c,h){return c instanceof $a?$a.equalsOrNull(c.leftchar,h.leftchar)&&$a.equalsOrNull(c.rightchar,h.rightchar)&&$a.equalsOrNull(c.finderpattern,h.finderpattern):!1}static equalsOrNull(c,h){return c===null?h===null:$a.equals(c,h)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Ug{constructor(c,h,m){this.pairs=c,this.rowNumber=h,this.wasReversed=m}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(c){return this.checkEqualitity(this,c)}toString(){return"{ "+this.pairs+" }"}equals(c,h){return c instanceof Ug?this.checkEqualitity(c,h)&&c.wasReversed===h.wasReversed:!1}checkEqualitity(c,h){if(!c||!h)return;let m;return c.forEach((g,x)=>{h.forEach(w=>{g.getLeftChar().getValue()===w.getLeftChar().getValue()&&g.getRightChar().getValue()===w.getRightChar().getValue()&&g.getFinderPatter().getValue()===w.getFinderPatter().getValue()&&(m=!0)})}),m}}class Te extends gt{constructor(c){super(...arguments),this.pairs=new Array(Te.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=c===!0}decodeRow(c,h,m){this.pairs.length=0,this.startFromEven=!1;try{return Te.constructResult(this.decodeRow2pairs(c,h))}catch(g){this.verbose&&console.log(g)}return this.pairs.length=0,this.startFromEven=!0,Te.constructResult(this.decodeRow2pairs(c,h))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(c,h){let m=!1;for(;!m;)try{this.pairs.push(this.retrieveNextPair(h,this.pairs,c))}catch(x){if(x instanceof z){if(!this.pairs.length)throw new z;m=!0}}if(this.checkChecksum())return this.pairs;let g;if(this.rows.length?g=!0:g=!1,this.storeRow(c,!1),g){let x=this.checkRowsBoolean(!1);if(x!=null||(x=this.checkRowsBoolean(!0),x!=null))return x}throw new z}checkRowsBoolean(c){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,c&&(this.rows=this.rows.reverse());let h=null;try{h=this.checkRows(new Array,0)}catch(m){this.verbose&&console.log(m)}return c&&(this.rows=this.rows.reverse()),h}checkRows(c,h){for(let m=h;m<this.rows.length;m++){let g=this.rows[m];this.pairs.length=0;for(let w of c)this.pairs.push(w.getPairs());if(this.pairs.push(g.getPairs()),!Te.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let x=new Array(c);x.push(g);try{return this.checkRows(x,m+1)}catch(w){this.verbose&&console.log(w)}}throw new z}static isValidSequence(c){for(let h of Te.FINDER_PATTERN_SEQUENCES){if(c.length>h.length)continue;let m=!0;for(let g=0;g<c.length;g++)if(c[g].getFinderPattern().getValue()!=h[g]){m=!1;break}if(m)return!0}return!1}storeRow(c,h){let m=0,g=!1,x=!1;for(;m<this.rows.length;){let w=this.rows[m];if(w.getRowNumber()>c){x=w.isEquivalent(this.pairs);break}g=w.isEquivalent(this.pairs),m++}x||g||Te.isPartialRow(this.pairs,this.rows)||(this.rows.push(m,new Ug(this.pairs,c,h)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(c,h){for(let m of h)if(m.getPairs().length!==c.length){for(let g of m.getPairs())for(let x of c)if($a.equals(g,x))break}}static isPartialRow(c,h){for(let m of h){let g=!0;for(let x of c){let w=!1;for(let S of m.getPairs())if(x.equals(S)){w=!0;break}if(!w){g=!1;break}}if(g)return!0}return!1}getRows(){return this.rows}static constructResult(c){let h=da.buildBitArray(c),g=p2(h).parseInformation(),x=c[0].getFinderPattern().getResultPoints(),w=c[c.length-1].getFinderPattern().getResultPoints(),S=[x[0],x[1],w[0],w[1]];return new ie(g,null,null,S,oe.RSS_EXPANDED,null)}checkChecksum(){let c=this.pairs.get(0),h=c.getLeftChar(),m=c.getRightChar();if(m==null)return!1;let g=m.getChecksumPortion(),x=2;for(let S=1;S<this.pairs.size();++S){let R=this.pairs.get(S);g+=R.getLeftChar().getChecksumPortion(),x++;let _=R.getRightChar();_!=null&&(g+=_.getChecksumPortion(),x++)}return g%=211,211*(x-4)+g==h.getValue()}static getNextSecondBar(c,h){let m;return c.get(h)?(m=c.getNextUnset(h),m=c.getNextSet(m)):(m=c.getNextSet(h),m=c.getNextUnset(m)),m}retrieveNextPair(c,h,m){let g=h.length%2==0;this.startFromEven&&(g=!g);let x,w=!0,S=-1;do this.findNextPair(c,h,S),x=this.parseFoundFinderPattern(c,m,g),x==null?S=Te.getNextSecondBar(c,this.startEnd[0]):w=!1;while(w);let R=this.decodeDataCharacter(c,x,g,!0);if(!this.isEmptyPair(h)&&h[h.length-1].mustBeLast())throw new z;let _;try{_=this.decodeDataCharacter(c,x,g,!1)}catch(j){_=null,this.verbose&&console.log(j)}return new $a(R,_,x,!0)}isEmptyPair(c){return c.length===0}findNextPair(c,h,m){let g=this.getDecodeFinderCounters();g[0]=0,g[1]=0,g[2]=0,g[3]=0;let x=c.getSize(),w;m>=0?w=m:this.isEmptyPair(h)?w=0:w=h[h.length-1].getFinderPattern().getStartEnd()[1];let S=h.length%2!=0;this.startFromEven&&(S=!S);let R=!1;for(;w<x&&(R=!c.get(w),!!R);)w++;let _=0,j=w;for(let U=w;U<x;U++)if(c.get(U)!=R)g[_]++;else{if(_==3){if(S&&Te.reverseCounters(g),Te.isFinderPattern(g)){this.startEnd[0]=j,this.startEnd[1]=U;return}S&&Te.reverseCounters(g),j+=g[0]+g[1],g[0]=g[2],g[1]=g[3],g[2]=0,g[3]=0,_--}else _++;g[_]=1,R=!R}throw new z}static reverseCounters(c){let h=c.length;for(let m=0;m<h/2;++m){let g=c[m];c[m]=c[h-m-1],c[h-m-1]=g}}parseFoundFinderPattern(c,h,m){let g,x,w;if(m){let _=this.startEnd[0]-1;for(;_>=0&&!c.get(_);)_--;_++,g=this.startEnd[0]-_,x=_,w=this.startEnd[1]}else x=this.startEnd[0],w=c.getNextUnset(this.startEnd[1]+1),g=w-this.startEnd[1];let S=this.getDecodeFinderCounters();b.arraycopy(S,0,S,1,S.length-1),S[0]=g;let R;try{R=this.parseFinderValue(S,Te.FINDER_PATTERNS)}catch{return null}return new Rn(R,[x,w],x,w,h)}decodeDataCharacter(c,h,m,g){let x=this.getDataCharacterCounters();for(let Kt=0;Kt<x.length;Kt++)x[Kt]=0;if(g)Te.recordPatternInReverse(c,h.getStartEnd()[0],x);else{Te.recordPattern(c,h.getStartEnd()[1],x);for(let Kt=0,gn=x.length-1;Kt<gn;Kt++,gn--){let xs=x[Kt];x[Kt]=x[gn],x[gn]=xs}}let w=17,S=at.sum(new Int32Array(x))/w,R=(h.getStartEnd()[1]-h.getStartEnd()[0])/15;if(Math.abs(S-R)/R>.3)throw new z;let _=this.getOddCounts(),j=this.getEvenCounts(),U=this.getOddRoundingErrors(),V=this.getEvenRoundingErrors();for(let Kt=0;Kt<x.length;Kt++){let gn=1*x[Kt]/S,xs=gn+.5;if(xs<1){if(gn<.3)throw new z;xs=1}else if(xs>8){if(gn>8.7)throw new z;xs=8}let xc=Kt/2;Kt&1?(j[xc]=xs,V[xc]=gn-xs):(_[xc]=xs,U[xc]=gn-xs)}this.adjustOddEvenCounts(w);let W=4*h.getValue()+(m?0:2)+(g?0:1)-1,J=0,te=0;for(let Kt=_.length-1;Kt>=0;Kt--){if(Te.isNotA1left(h,m,g)){let gn=Te.WEIGHTS[W][2*Kt];te+=_[Kt]*gn}J+=_[Kt]}let de=0;for(let Kt=j.length-1;Kt>=0;Kt--)if(Te.isNotA1left(h,m,g)){let gn=Te.WEIGHTS[W][2*Kt+1];de+=j[Kt]*gn}let xe=te+de;if(J&1||J>13||J<4)throw new z;let ke=(13-J)/2,je=Te.SYMBOL_WIDEST[ke],Ie=9-je,Nt=Kr.getRSSvalue(_,je,!0),mt=Kr.getRSSvalue(j,Ie,!1),es=Te.EVEN_TOTAL_SUBSET[ke],li=Te.GSUM[ke],ts=Nt*es+mt+li;return new rn(ts,xe)}static isNotA1left(c,h,m){return!(c.getValue()==0&&h&&m)}adjustOddEvenCounts(c){let h=at.sum(new Int32Array(this.getOddCounts())),m=at.sum(new Int32Array(this.getEvenCounts())),g=!1,x=!1;h>13?x=!0:h<4&&(g=!0);let w=!1,S=!1;m>13?S=!0:m<4&&(w=!0);let R=h+m-c,_=(h&1)==1,j=(m&1)==0;if(R==1)if(_){if(j)throw new z;x=!0}else{if(!j)throw new z;S=!0}else if(R==-1)if(_){if(j)throw new z;g=!0}else{if(!j)throw new z;w=!0}else if(R==0){if(_){if(!j)throw new z;h<m?(g=!0,S=!0):(x=!0,w=!0)}else if(j)throw new z}else throw new z;if(g){if(x)throw new z;Te.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(x&&Te.decrement(this.getOddCounts(),this.getOddRoundingErrors()),w){if(S)throw new z;Te.increment(this.getEvenCounts(),this.getOddRoundingErrors())}S&&Te.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Te.SYMBOL_WIDEST=[7,5,4,3,1],Te.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Te.GSUM=[0,348,1388,2948,3988],Te.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Te.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Te.FINDER_PAT_A=0,Te.FINDER_PAT_B=1,Te.FINDER_PAT_C=2,Te.FINDER_PAT_D=3,Te.FINDER_PAT_E=4,Te.FINDER_PAT_F=5,Te.FINDER_PATTERN_SEQUENCES=[[Te.FINDER_PAT_A,Te.FINDER_PAT_A],[Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B],[Te.FINDER_PAT_A,Te.FINDER_PAT_C,Te.FINDER_PAT_B,Te.FINDER_PAT_D],[Te.FINDER_PAT_A,Te.FINDER_PAT_E,Te.FINDER_PAT_B,Te.FINDER_PAT_D,Te.FINDER_PAT_C],[Te.FINDER_PAT_A,Te.FINDER_PAT_E,Te.FINDER_PAT_B,Te.FINDER_PAT_D,Te.FINDER_PAT_D,Te.FINDER_PAT_F],[Te.FINDER_PAT_A,Te.FINDER_PAT_E,Te.FINDER_PAT_B,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_F,Te.FINDER_PAT_F],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_D],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_E],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_F,Te.FINDER_PAT_F],[Te.FINDER_PAT_A,Te.FINDER_PAT_A,Te.FINDER_PAT_B,Te.FINDER_PAT_B,Te.FINDER_PAT_C,Te.FINDER_PAT_D,Te.FINDER_PAT_D,Te.FINDER_PAT_E,Te.FINDER_PAT_E,Te.FINDER_PAT_F,Te.FINDER_PAT_F]],Te.MAX_PAIRS=11;class l8 extends rn{constructor(c,h,m){super(c,h),this.count=0,this.finderPattern=m}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class br extends gt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(c,h,m){const g=this.decodePair(h,!1,c,m);br.addOrTally(this.possibleLeftPairs,g),h.reverse();let x=this.decodePair(h,!0,c,m);br.addOrTally(this.possibleRightPairs,x),h.reverse();for(let w of this.possibleLeftPairs)if(w.getCount()>1){for(let S of this.possibleRightPairs)if(S.getCount()>1&&br.checkChecksum(w,S))return br.constructResult(w,S)}throw new z}static addOrTally(c,h){if(h==null)return;let m=!1;for(let g of c)if(g.getValue()===h.getValue()){g.incrementCount(),m=!0;break}m||c.push(h)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(c,h){let m=4537077*c.getValue()+h.getValue(),g=new String(m).toString(),x=new ne;for(let _=13-g.length;_>0;_--)x.append("0");x.append(g);let w=0;for(let _=0;_<13;_++){let j=x.charAt(_).charCodeAt(0)-48;w+=_&1?j:3*j}w=10-w%10,w===10&&(w=0),x.append(w.toString());let S=c.getFinderPattern().getResultPoints(),R=h.getFinderPattern().getResultPoints();return new ie(x.toString(),null,0,[S[0],S[1],R[0],R[1]],oe.RSS_14,new Date().getTime())}static checkChecksum(c,h){let m=(c.getChecksumPortion()+16*h.getChecksumPortion())%79,g=9*c.getFinderPattern().getValue()+h.getFinderPattern().getValue();return g>72&&g--,g>8&&g--,m===g}decodePair(c,h,m,g){try{let x=this.findFinderPattern(c,h),w=this.parseFoundFinderPattern(c,m,h,x),S=g==null?null:g.get(k.NEED_RESULT_POINT_CALLBACK);if(S!=null){let j=(x[0]+x[1])/2;h&&(j=c.getSize()-1-j),S.foundPossibleResultPoint(new $e(j,m))}let R=this.decodeDataCharacter(c,w,!0),_=this.decodeDataCharacter(c,w,!1);return new l8(1597*R.getValue()+_.getValue(),R.getChecksumPortion()+4*_.getChecksumPortion(),w)}catch{return null}}decodeDataCharacter(c,h,m){let g=this.getDataCharacterCounters();for(let de=0;de<g.length;de++)g[de]=0;if(m)ir.recordPatternInReverse(c,h.getStartEnd()[0],g);else{ir.recordPattern(c,h.getStartEnd()[1]+1,g);for(let de=0,xe=g.length-1;de<xe;de++,xe--){let ke=g[de];g[de]=g[xe],g[xe]=ke}}let x=m?16:15,w=at.sum(new Int32Array(g))/x,S=this.getOddCounts(),R=this.getEvenCounts(),_=this.getOddRoundingErrors(),j=this.getEvenRoundingErrors();for(let de=0;de<g.length;de++){let xe=g[de]/w,ke=Math.floor(xe+.5);ke<1?ke=1:ke>8&&(ke=8);let je=Math.floor(de/2);de&1?(R[je]=ke,j[je]=xe-ke):(S[je]=ke,_[je]=xe-ke)}this.adjustOddEvenCounts(m,x);let U=0,V=0;for(let de=S.length-1;de>=0;de--)V*=9,V+=S[de],U+=S[de];let W=0,J=0;for(let de=R.length-1;de>=0;de--)W*=9,W+=R[de],J+=R[de];let te=V+3*W;if(m){if(U&1||U>12||U<4)throw new z;let de=(12-U)/2,xe=br.OUTSIDE_ODD_WIDEST[de],ke=9-xe,je=Kr.getRSSvalue(S,xe,!1),Ie=Kr.getRSSvalue(R,ke,!0),Nt=br.OUTSIDE_EVEN_TOTAL_SUBSET[de],mt=br.OUTSIDE_GSUM[de];return new rn(je*Nt+Ie+mt,te)}else{if(J&1||J>10||J<4)throw new z;let de=(10-J)/2,xe=br.INSIDE_ODD_WIDEST[de],ke=9-xe,je=Kr.getRSSvalue(S,xe,!0),Ie=Kr.getRSSvalue(R,ke,!1),Nt=br.INSIDE_ODD_TOTAL_SUBSET[de],mt=br.INSIDE_GSUM[de];return new rn(Ie*Nt+je+mt,te)}}findFinderPattern(c,h){let m=this.getDecodeFinderCounters();m[0]=0,m[1]=0,m[2]=0,m[3]=0;let g=c.getSize(),x=!1,w=0;for(;w<g&&(x=!c.get(w),h!==x);)w++;let S=0,R=w;for(let _=w;_<g;_++)if(c.get(_)!==x)m[S]++;else{if(S===3){if(gt.isFinderPattern(m))return[R,_];R+=m[0]+m[1],m[0]=m[2],m[1]=m[3],m[2]=0,m[3]=0,S--}else S++;m[S]=1,x=!x}throw new z}parseFoundFinderPattern(c,h,m,g){let x=c.get(g[0]),w=g[0]-1;for(;w>=0&&x!==c.get(w);)w--;w++;const S=g[0]-w,R=this.getDecodeFinderCounters(),_=new Int32Array(R.length);b.arraycopy(R,0,_,1,R.length-1),_[0]=S;const j=this.parseFinderValue(_,br.FINDER_PATTERNS);let U=w,V=g[1];return m&&(U=c.getSize()-1-U,V=c.getSize()-1-V),new Rn(j,[w,g[1]],U,V,h)}adjustOddEvenCounts(c,h){let m=at.sum(new Int32Array(this.getOddCounts())),g=at.sum(new Int32Array(this.getEvenCounts())),x=!1,w=!1,S=!1,R=!1;c?(m>12?w=!0:m<4&&(x=!0),g>12?R=!0:g<4&&(S=!0)):(m>11?w=!0:m<5&&(x=!0),g>10?R=!0:g<4&&(S=!0));let _=m+g-h,j=(m&1)===(c?1:0),U=(g&1)===1;if(_===1)if(j){if(U)throw new z;w=!0}else{if(!U)throw new z;R=!0}else if(_===-1)if(j){if(U)throw new z;x=!0}else{if(!U)throw new z;S=!0}else if(_===0){if(j){if(!U)throw new z;m<g?(x=!0,R=!0):(w=!0,S=!0)}else if(U)throw new z}else throw new z;if(x){if(w)throw new z;gt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(w&&gt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),S){if(R)throw new z;gt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}R&&gt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}br.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],br.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],br.OUTSIDE_GSUM=[0,161,961,2015,2715],br.INSIDE_GSUM=[0,336,1036,1516],br.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],br.INSIDE_ODD_WIDEST=[2,4,6,8],br.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class fc extends ir{constructor(c,h){super(),this.readers=[],this.verbose=h===!0;const m=c?c.get(k.POSSIBLE_FORMATS):null,g=c&&c.get(k.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;m?((m.includes(oe.EAN_13)||m.includes(oe.UPC_A)||m.includes(oe.EAN_8)||m.includes(oe.UPC_E))&&this.readers.push(new Mt(c)),m.includes(oe.CODE_39)&&this.readers.push(new wr(g)),m.includes(oe.CODE_128)&&this.readers.push(new Oe),m.includes(oe.ITF)&&this.readers.push(new Lt),m.includes(oe.RSS_14)&&this.readers.push(new br),m.includes(oe.RSS_EXPANDED)&&this.readers.push(new Te(this.verbose))):(this.readers.push(new Mt(c)),this.readers.push(new wr),this.readers.push(new Mt(c)),this.readers.push(new Oe),this.readers.push(new Lt),this.readers.push(new br),this.readers.push(new Te(this.verbose)))}decodeRow(c,h,m){for(let g=0;g<this.readers.length;g++)try{return this.readers[g].decodeRow(c,h,m)}catch{}throw new z}reset(){this.readers.forEach(c=>c.reset())}}class c8 extends Ee{constructor(c=500,h){super(new fc(h),c,h)}}class Bt{constructor(c,h,m){this.ecCodewords=c,this.ecBlocks=[h],m&&this.ecBlocks.push(m)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ot{constructor(c,h){this.count=c,this.dataCodewords=h}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class _t{constructor(c,h,m,g,x,w){this.versionNumber=c,this.symbolSizeRows=h,this.symbolSizeColumns=m,this.dataRegionSizeRows=g,this.dataRegionSizeColumns=x,this.ecBlocks=w;let S=0;const R=w.getECCodewords(),_=w.getECBlocks();for(let j of _)S+=j.getCount()*(j.getDataCodewords()+R);this.totalCodewords=S}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(c,h){if(c&1||h&1)throw new D;for(let m of _t.VERSIONS)if(m.symbolSizeRows===c&&m.symbolSizeColumns===h)return m;throw new D}toString(){return""+this.versionNumber}static buildVersions(){return[new _t(1,10,10,8,8,new Bt(5,new Ot(1,3))),new _t(2,12,12,10,10,new Bt(7,new Ot(1,5))),new _t(3,14,14,12,12,new Bt(10,new Ot(1,8))),new _t(4,16,16,14,14,new Bt(12,new Ot(1,12))),new _t(5,18,18,16,16,new Bt(14,new Ot(1,18))),new _t(6,20,20,18,18,new Bt(18,new Ot(1,22))),new _t(7,22,22,20,20,new Bt(20,new Ot(1,30))),new _t(8,24,24,22,22,new Bt(24,new Ot(1,36))),new _t(9,26,26,24,24,new Bt(28,new Ot(1,44))),new _t(10,32,32,14,14,new Bt(36,new Ot(1,62))),new _t(11,36,36,16,16,new Bt(42,new Ot(1,86))),new _t(12,40,40,18,18,new Bt(48,new Ot(1,114))),new _t(13,44,44,20,20,new Bt(56,new Ot(1,144))),new _t(14,48,48,22,22,new Bt(68,new Ot(1,174))),new _t(15,52,52,24,24,new Bt(42,new Ot(2,102))),new _t(16,64,64,14,14,new Bt(56,new Ot(2,140))),new _t(17,72,72,16,16,new Bt(36,new Ot(4,92))),new _t(18,80,80,18,18,new Bt(48,new Ot(4,114))),new _t(19,88,88,20,20,new Bt(56,new Ot(4,144))),new _t(20,96,96,22,22,new Bt(68,new Ot(4,174))),new _t(21,104,104,24,24,new Bt(56,new Ot(6,136))),new _t(22,120,120,18,18,new Bt(68,new Ot(6,175))),new _t(23,132,132,20,20,new Bt(62,new Ot(8,163))),new _t(24,144,144,22,22,new Bt(62,new Ot(8,156),new Ot(2,155))),new _t(25,8,18,6,16,new Bt(7,new Ot(1,5))),new _t(26,8,32,6,14,new Bt(11,new Ot(1,10))),new _t(27,12,26,10,24,new Bt(14,new Ot(1,16))),new _t(28,12,36,10,16,new Bt(18,new Ot(1,22))),new _t(29,16,36,14,16,new Bt(24,new Ot(1,32))),new _t(30,16,48,14,22,new Bt(28,new Ot(1,49)))]}}_t.VERSIONS=_t.buildVersions();class $g{constructor(c){const h=c.getHeight();if(h<8||h>144||h&1)throw new D;this.version=$g.readVersion(c),this.mappingBitMatrix=this.extractDataRegion(c),this.readMappingMatrix=new X(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(c){const h=c.getHeight(),m=c.getWidth();return _t.getVersionForDimensions(h,m)}readCodewords(){const c=new Int8Array(this.version.getTotalCodewords());let h=0,m=4,g=0;const x=this.mappingBitMatrix.getHeight(),w=this.mappingBitMatrix.getWidth();let S=!1,R=!1,_=!1,j=!1;do if(m===x&&g===0&&!S)c[h++]=this.readCorner1(x,w)&255,m-=2,g+=2,S=!0;else if(m===x-2&&g===0&&w&3&&!R)c[h++]=this.readCorner2(x,w)&255,m-=2,g+=2,R=!0;else if(m===x+4&&g===2&&!(w&7)&&!_)c[h++]=this.readCorner3(x,w)&255,m-=2,g+=2,_=!0;else if(m===x-2&&g===0&&(w&7)===4&&!j)c[h++]=this.readCorner4(x,w)&255,m-=2,g+=2,j=!0;else{do m<x&&g>=0&&!this.readMappingMatrix.get(g,m)&&(c[h++]=this.readUtah(m,g,x,w)&255),m-=2,g+=2;while(m>=0&&g<w);m+=1,g+=3;do m>=0&&g<w&&!this.readMappingMatrix.get(g,m)&&(c[h++]=this.readUtah(m,g,x,w)&255),m+=2,g-=2;while(m<x&&g>=0);m+=3,g+=1}while(m<x||g<w);if(h!==this.version.getTotalCodewords())throw new D;return c}readModule(c,h,m,g){return c<0&&(c+=m,h+=4-(m+4&7)),h<0&&(h+=g,c+=4-(g+4&7)),this.readMappingMatrix.set(h,c),this.mappingBitMatrix.get(h,c)}readUtah(c,h,m,g){let x=0;return this.readModule(c-2,h-2,m,g)&&(x|=1),x<<=1,this.readModule(c-2,h-1,m,g)&&(x|=1),x<<=1,this.readModule(c-1,h-2,m,g)&&(x|=1),x<<=1,this.readModule(c-1,h-1,m,g)&&(x|=1),x<<=1,this.readModule(c-1,h,m,g)&&(x|=1),x<<=1,this.readModule(c,h-2,m,g)&&(x|=1),x<<=1,this.readModule(c,h-1,m,g)&&(x|=1),x<<=1,this.readModule(c,h,m,g)&&(x|=1),x}readCorner1(c,h){let m=0;return this.readModule(c-1,0,c,h)&&(m|=1),m<<=1,this.readModule(c-1,1,c,h)&&(m|=1),m<<=1,this.readModule(c-1,2,c,h)&&(m|=1),m<<=1,this.readModule(0,h-2,c,h)&&(m|=1),m<<=1,this.readModule(0,h-1,c,h)&&(m|=1),m<<=1,this.readModule(1,h-1,c,h)&&(m|=1),m<<=1,this.readModule(2,h-1,c,h)&&(m|=1),m<<=1,this.readModule(3,h-1,c,h)&&(m|=1),m}readCorner2(c,h){let m=0;return this.readModule(c-3,0,c,h)&&(m|=1),m<<=1,this.readModule(c-2,0,c,h)&&(m|=1),m<<=1,this.readModule(c-1,0,c,h)&&(m|=1),m<<=1,this.readModule(0,h-4,c,h)&&(m|=1),m<<=1,this.readModule(0,h-3,c,h)&&(m|=1),m<<=1,this.readModule(0,h-2,c,h)&&(m|=1),m<<=1,this.readModule(0,h-1,c,h)&&(m|=1),m<<=1,this.readModule(1,h-1,c,h)&&(m|=1),m}readCorner3(c,h){let m=0;return this.readModule(c-1,0,c,h)&&(m|=1),m<<=1,this.readModule(c-1,h-1,c,h)&&(m|=1),m<<=1,this.readModule(0,h-3,c,h)&&(m|=1),m<<=1,this.readModule(0,h-2,c,h)&&(m|=1),m<<=1,this.readModule(0,h-1,c,h)&&(m|=1),m<<=1,this.readModule(1,h-3,c,h)&&(m|=1),m<<=1,this.readModule(1,h-2,c,h)&&(m|=1),m<<=1,this.readModule(1,h-1,c,h)&&(m|=1),m}readCorner4(c,h){let m=0;return this.readModule(c-3,0,c,h)&&(m|=1),m<<=1,this.readModule(c-2,0,c,h)&&(m|=1),m<<=1,this.readModule(c-1,0,c,h)&&(m|=1),m<<=1,this.readModule(0,h-2,c,h)&&(m|=1),m<<=1,this.readModule(0,h-1,c,h)&&(m|=1),m<<=1,this.readModule(1,h-1,c,h)&&(m|=1),m<<=1,this.readModule(2,h-1,c,h)&&(m|=1),m<<=1,this.readModule(3,h-1,c,h)&&(m|=1),m}extractDataRegion(c){const h=this.version.getSymbolSizeRows(),m=this.version.getSymbolSizeColumns();if(c.getHeight()!==h)throw new p("Dimension of bitMatrix must match the version size");const g=this.version.getDataRegionSizeRows(),x=this.version.getDataRegionSizeColumns(),w=h/g|0,S=m/x|0,R=w*g,_=S*x,j=new X(_,R);for(let U=0;U<w;++U){const V=U*g;for(let W=0;W<S;++W){const J=W*x;for(let te=0;te<g;++te){const de=U*(g+2)+1+te,xe=V+te;for(let ke=0;ke<x;++ke){const je=W*(x+2)+1+ke;if(c.get(je,de)){const Ie=J+ke;j.set(Ie,xe)}}}}}return j}}class Vg{constructor(c,h){this.numDataCodewords=c,this.codewords=h}static getDataBlocks(c,h){const m=h.getECBlocks();let g=0;const x=m.getECBlocks();for(let te of x)g+=te.getCount();const w=new Array(g);let S=0;for(let te of x)for(let de=0;de<te.getCount();de++){const xe=te.getDataCodewords(),ke=m.getECCodewords()+xe;w[S++]=new Vg(xe,new Uint8Array(ke))}const _=w[0].codewords.length-m.getECCodewords(),j=_-1;let U=0;for(let te=0;te<j;te++)for(let de=0;de<S;de++)w[de].codewords[te]=c[U++];const V=h.getVersionNumber()===24,W=V?8:S;for(let te=0;te<W;te++)w[te].codewords[_-1]=c[U++];const J=w[0].codewords.length;for(let te=_;te<J;te++)for(let de=0;de<S;de++){const xe=V?(de+8)%S:de,ke=V&&xe>7?te-1:te;w[xe].codewords[ke]=c[U++]}if(U!==c.length)throw new p;return w}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Gg{constructor(c){this.bytes=c,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(c){if(c<1||c>32||c>this.available())throw new p(""+c);let h=0,m=this.bitOffset,g=this.byteOffset;const x=this.bytes;if(m>0){const w=8-m,S=c<w?c:w,R=w-S,_=255>>8-S<<R;h=(x[g]&_)>>R,c-=S,m+=S,m===8&&(m=0,g++)}if(c>0){for(;c>=8;)h=h<<8|x[g]&255,g++,c-=8;if(c>0){const w=8-c,S=255>>w<<w;h=h<<c|(x[g]&S)>>w,m+=c}}return this.bitOffset=m,this.byteOffset=g,h}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var qr;(function(B){B[B.PAD_ENCODE=0]="PAD_ENCODE",B[B.ASCII_ENCODE=1]="ASCII_ENCODE",B[B.C40_ENCODE=2]="C40_ENCODE",B[B.TEXT_ENCODE=3]="TEXT_ENCODE",B[B.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",B[B.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",B[B.BASE256_ENCODE=6]="BASE256_ENCODE"})(qr||(qr={}));class Va{static decode(c){const h=new Gg(c),m=new ne,g=new ne,x=new Array;let w=qr.ASCII_ENCODE;do if(w===qr.ASCII_ENCODE)w=this.decodeAsciiSegment(h,m,g);else{switch(w){case qr.C40_ENCODE:this.decodeC40Segment(h,m);break;case qr.TEXT_ENCODE:this.decodeTextSegment(h,m);break;case qr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(h,m);break;case qr.EDIFACT_ENCODE:this.decodeEdifactSegment(h,m);break;case qr.BASE256_ENCODE:this.decodeBase256Segment(h,m,x);break;default:throw new D}w=qr.ASCII_ENCODE}while(w!==qr.PAD_ENCODE&&h.available()>0);return g.length()>0&&m.append(g.toString()),new _e(c,m.toString(),x.length===0?null:x,null)}static decodeAsciiSegment(c,h,m){let g=!1;do{let x=c.readBits(8);if(x===0)throw new D;if(x<=128)return g&&(x+=128),h.append(String.fromCharCode(x-1)),qr.ASCII_ENCODE;if(x===129)return qr.PAD_ENCODE;if(x<=229){const w=x-130;w<10&&h.append("0"),h.append(""+w)}else switch(x){case 230:return qr.C40_ENCODE;case 231:return qr.BASE256_ENCODE;case 232:h.append("");break;case 233:case 234:break;case 235:g=!0;break;case 236:h.append("[)>05"),m.insert(0,"");break;case 237:h.append("[)>06"),m.insert(0,"");break;case 238:return qr.ANSIX12_ENCODE;case 239:return qr.TEXT_ENCODE;case 240:return qr.EDIFACT_ENCODE;case 241:break;default:if(x!==254||c.available()!==0)throw new D;break}}while(c.available()>0);return qr.ASCII_ENCODE}static decodeC40Segment(c,h){let m=!1;const g=[];let x=0;do{if(c.available()===8)return;const w=c.readBits(8);if(w===254)return;this.parseTwoBytes(w,c.readBits(8),g);for(let S=0;S<3;S++){const R=g[S];switch(x){case 0:if(R<3)x=R+1;else if(R<this.C40_BASIC_SET_CHARS.length){const _=this.C40_BASIC_SET_CHARS[R];m?(h.append(String.fromCharCode(_.charCodeAt(0)+128)),m=!1):h.append(_)}else throw new D;break;case 1:m?(h.append(String.fromCharCode(R+128)),m=!1):h.append(String.fromCharCode(R)),x=0;break;case 2:if(R<this.C40_SHIFT2_SET_CHARS.length){const _=this.C40_SHIFT2_SET_CHARS[R];m?(h.append(String.fromCharCode(_.charCodeAt(0)+128)),m=!1):h.append(_)}else switch(R){case 27:h.append("");break;case 30:m=!0;break;default:throw new D}x=0;break;case 3:m?(h.append(String.fromCharCode(R+224)),m=!1):h.append(String.fromCharCode(R+96)),x=0;break;default:throw new D}}}while(c.available()>0)}static decodeTextSegment(c,h){let m=!1,g=[],x=0;do{if(c.available()===8)return;const w=c.readBits(8);if(w===254)return;this.parseTwoBytes(w,c.readBits(8),g);for(let S=0;S<3;S++){const R=g[S];switch(x){case 0:if(R<3)x=R+1;else if(R<this.TEXT_BASIC_SET_CHARS.length){const _=this.TEXT_BASIC_SET_CHARS[R];m?(h.append(String.fromCharCode(_.charCodeAt(0)+128)),m=!1):h.append(_)}else throw new D;break;case 1:m?(h.append(String.fromCharCode(R+128)),m=!1):h.append(String.fromCharCode(R)),x=0;break;case 2:if(R<this.TEXT_SHIFT2_SET_CHARS.length){const _=this.TEXT_SHIFT2_SET_CHARS[R];m?(h.append(String.fromCharCode(_.charCodeAt(0)+128)),m=!1):h.append(_)}else switch(R){case 27:h.append("");break;case 30:m=!0;break;default:throw new D}x=0;break;case 3:if(R<this.TEXT_SHIFT3_SET_CHARS.length){const _=this.TEXT_SHIFT3_SET_CHARS[R];m?(h.append(String.fromCharCode(_.charCodeAt(0)+128)),m=!1):h.append(_),x=0}else throw new D;break;default:throw new D}}}while(c.available()>0)}static decodeAnsiX12Segment(c,h){const m=[];do{if(c.available()===8)return;const g=c.readBits(8);if(g===254)return;this.parseTwoBytes(g,c.readBits(8),m);for(let x=0;x<3;x++){const w=m[x];switch(w){case 0:h.append("\r");break;case 1:h.append("*");break;case 2:h.append(">");break;case 3:h.append(" ");break;default:if(w<14)h.append(String.fromCharCode(w+44));else if(w<40)h.append(String.fromCharCode(w+51));else throw new D;break}}}while(c.available()>0)}static parseTwoBytes(c,h,m){let g=(c<<8)+h-1,x=Math.floor(g/1600);m[0]=x,g-=x*1600,x=Math.floor(g/40),m[1]=x,m[2]=g-x*40}static decodeEdifactSegment(c,h){do{if(c.available()<=16)return;for(let m=0;m<4;m++){let g=c.readBits(6);if(g===31){const x=8-c.getBitOffset();x!==8&&c.readBits(x);return}g&32||(g|=64),h.append(String.fromCharCode(g))}}while(c.available()>0)}static decodeBase256Segment(c,h,m){let g=1+c.getByteOffset();const x=this.unrandomize255State(c.readBits(8),g++);let w;if(x===0?w=c.available()/8|0:x<250?w=x:w=250*(x-249)+this.unrandomize255State(c.readBits(8),g++),w<0)throw new D;const S=new Uint8Array(w);for(let R=0;R<w;R++){if(c.available()<8)throw new D;S[R]=this.unrandomize255State(c.readBits(8),g++)}m.push(S);try{h.append(G.decode(S,Y.ISO88591))}catch(R){throw new we("Platform does not support required encoding: "+R.message)}}static unrandomize255State(c,h){const m=149*h%255+1,g=c-m;return g>=0?g:g+256}}Va.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Va.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Va.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Va.TEXT_SHIFT2_SET_CHARS=Va.C40_SHIFT2_SET_CHARS,Va.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class u8{constructor(){this.rsDecoder=new Ne(Be.DATA_MATRIX_FIELD_256)}decode(c){const h=new $g(c),m=h.getVersion(),g=h.readCodewords(),x=Vg.getDataBlocks(g,m);let w=0;for(let _ of x)w+=_.getNumDataCodewords();const S=new Uint8Array(w),R=x.length;for(let _=0;_<R;_++){const j=x[_],U=j.getCodewords(),V=j.getNumDataCodewords();this.correctErrors(U,V);for(let W=0;W<V;W++)S[W*R+_]=U[W]}return Va.decode(S)}correctErrors(c,h){const m=new Int32Array(c);try{this.rsDecoder.decode(m,c.length-h)}catch{throw new v}for(let g=0;g<h;g++)c[g]=m[g]}}class Pr{constructor(c){this.image=c,this.rectangleDetector=new In(this.image)}detect(){const c=this.rectangleDetector.detect();let h=this.detectSolid1(c);if(h=this.detectSolid2(h),h[3]=this.correctTopRight(h),!h[3])throw new z;h=this.shiftToModuleCenter(h);const m=h[0],g=h[1],x=h[2],w=h[3];let S=this.transitionsBetween(m,w)+1,R=this.transitionsBetween(x,w)+1;(S&1)===1&&(S+=1),(R&1)===1&&(R+=1),4*S<7*R&&4*R<7*S&&(S=R=Math.max(S,R));let _=Pr.sampleGrid(this.image,m,g,x,w,S,R);return new Bn(_,[m,g,x,w])}static shiftPoint(c,h,m){let g=(h.getX()-c.getX())/(m+1),x=(h.getY()-c.getY())/(m+1);return new $e(c.getX()+g,c.getY()+x)}static moveAway(c,h,m){let g=c.getX(),x=c.getY();return g<h?g-=1:g+=1,x<m?x-=1:x+=1,new $e(g,x)}detectSolid1(c){let h=c[0],m=c[1],g=c[3],x=c[2],w=this.transitionsBetween(h,m),S=this.transitionsBetween(m,g),R=this.transitionsBetween(g,x),_=this.transitionsBetween(x,h),j=w,U=[x,h,m,g];return j>S&&(j=S,U[0]=h,U[1]=m,U[2]=g,U[3]=x),j>R&&(j=R,U[0]=m,U[1]=g,U[2]=x,U[3]=h),j>_&&(U[0]=g,U[1]=x,U[2]=h,U[3]=m),U}detectSolid2(c){let h=c[0],m=c[1],g=c[2],x=c[3],w=this.transitionsBetween(h,x),S=Pr.shiftPoint(m,g,(w+1)*4),R=Pr.shiftPoint(g,m,(w+1)*4),_=this.transitionsBetween(S,h),j=this.transitionsBetween(R,x);return _<j?(c[0]=h,c[1]=m,c[2]=g,c[3]=x):(c[0]=m,c[1]=g,c[2]=x,c[3]=h),c}correctTopRight(c){let h=c[0],m=c[1],g=c[2],x=c[3],w=this.transitionsBetween(h,x),S=this.transitionsBetween(m,x),R=Pr.shiftPoint(h,m,(S+1)*4),_=Pr.shiftPoint(g,m,(w+1)*4);w=this.transitionsBetween(R,x),S=this.transitionsBetween(_,x);let j=new $e(x.getX()+(g.getX()-m.getX())/(w+1),x.getY()+(g.getY()-m.getY())/(w+1)),U=new $e(x.getX()+(h.getX()-m.getX())/(S+1),x.getY()+(h.getY()-m.getY())/(S+1));if(!this.isValid(j))return this.isValid(U)?U:null;if(!this.isValid(U))return j;let V=this.transitionsBetween(R,j)+this.transitionsBetween(_,j),W=this.transitionsBetween(R,U)+this.transitionsBetween(_,U);return V>W?j:U}shiftToModuleCenter(c){let h=c[0],m=c[1],g=c[2],x=c[3],w=this.transitionsBetween(h,x)+1,S=this.transitionsBetween(g,x)+1,R=Pr.shiftPoint(h,m,S*4),_=Pr.shiftPoint(g,m,w*4);w=this.transitionsBetween(R,x)+1,S=this.transitionsBetween(_,x)+1,(w&1)===1&&(w+=1),(S&1)===1&&(S+=1);let j=(h.getX()+m.getX()+g.getX()+x.getX())/4,U=(h.getY()+m.getY()+g.getY()+x.getY())/4;h=Pr.moveAway(h,j,U),m=Pr.moveAway(m,j,U),g=Pr.moveAway(g,j,U),x=Pr.moveAway(x,j,U);let V,W;return R=Pr.shiftPoint(h,m,S*4),R=Pr.shiftPoint(R,x,w*4),V=Pr.shiftPoint(m,h,S*4),V=Pr.shiftPoint(V,g,w*4),_=Pr.shiftPoint(g,x,S*4),_=Pr.shiftPoint(_,m,w*4),W=Pr.shiftPoint(x,g,S*4),W=Pr.shiftPoint(W,h,w*4),[R,V,_,W]}isValid(c){return c.getX()>=0&&c.getX()<this.image.getWidth()&&c.getY()>0&&c.getY()<this.image.getHeight()}static sampleGrid(c,h,m,g,x,w,S){return Os.getInstance().sampleGrid(c,w,S,.5,.5,w-.5,.5,w-.5,S-.5,.5,S-.5,h.getX(),h.getY(),x.getX(),x.getY(),g.getX(),g.getY(),m.getX(),m.getY())}transitionsBetween(c,h){let m=Math.trunc(c.getX()),g=Math.trunc(c.getY()),x=Math.trunc(h.getX()),w=Math.trunc(h.getY()),S=Math.abs(w-g)>Math.abs(x-m);if(S){let te=m;m=g,g=te,te=x,x=w,w=te}let R=Math.abs(x-m),_=Math.abs(w-g),j=-R/2,U=g<w?1:-1,V=m<x?1:-1,W=0,J=this.image.get(S?g:m,S?m:g);for(let te=m,de=g;te!==x;te+=V){let xe=this.image.get(S?de:te,S?te:de);if(xe!==J&&(W++,J=xe),j+=_,j>0){if(de===w)break;de+=U,j-=R}}return W}}class Ga{constructor(){this.decoder=new u8}decode(c,h=null){let m,g;if(h!=null&&h.has(k.PURE_BARCODE)){const _=Ga.extractPureBits(c.getBlackMatrix());m=this.decoder.decode(_),g=Ga.NO_POINTS}else{const _=new Pr(c.getBlackMatrix()).detect();m=this.decoder.decode(_.getBits()),g=_.getPoints()}const x=m.getRawBytes(),w=new ie(m.getText(),x,8*x.length,g,oe.DATA_MATRIX,b.currentTimeMillis()),S=m.getByteSegments();S!=null&&w.putMetadata(Le.BYTE_SEGMENTS,S);const R=m.getECLevel();return R!=null&&w.putMetadata(Le.ERROR_CORRECTION_LEVEL,R),w}reset(){}static extractPureBits(c){const h=c.getTopLeftOnBit(),m=c.getBottomRightOnBit();if(h==null||m==null)throw new z;const g=this.moduleSize(h,c);let x=h[1];const w=m[1];let S=h[0];const _=(m[0]-S+1)/g,j=(w-x+1)/g;if(_<=0||j<=0)throw new z;const U=g/2;x+=U,S+=U;const V=new X(_,j);for(let W=0;W<j;W++){const J=x+W*g;for(let te=0;te<_;te++)c.get(S+te*g,J)&&V.set(te,W)}return V}static moduleSize(c,h){const m=h.getWidth();let g=c[0];const x=c[1];for(;g<m&&h.get(g,x);)g++;if(g===m)throw new z;const w=g-c[0];if(w===0)throw new z;return w}}Ga.NO_POINTS=[];class d8 extends Ee{constructor(c=500){super(new Ga,c)}}var mc;(function(B){B[B.L=0]="L",B[B.M=1]="M",B[B.Q=2]="Q",B[B.H=3]="H"})(mc||(mc={}));class Zt{constructor(c,h,m){this.value=c,this.stringValue=h,this.bits=m,Zt.FOR_BITS.set(m,this),Zt.FOR_VALUE.set(c,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(c){switch(c){case"L":return Zt.L;case"M":return Zt.M;case"Q":return Zt.Q;case"H":return Zt.H;default:throw new f(c+"not available")}}toString(){return this.stringValue}equals(c){if(!(c instanceof Zt))return!1;const h=c;return this.value===h.value}static forBits(c){if(c<0||c>=Zt.FOR_BITS.size)throw new p;return Zt.FOR_BITS.get(c)}}Zt.FOR_BITS=new Map,Zt.FOR_VALUE=new Map,Zt.L=new Zt(mc.L,"L",1),Zt.M=new Zt(mc.M,"M",0),Zt.Q=new Zt(mc.Q,"Q",3),Zt.H=new Zt(mc.H,"H",2);class _n{constructor(c){this.errorCorrectionLevel=Zt.forBits(c>>3&3),this.dataMask=c&7}static numBitsDiffering(c,h){return A.bitCount(c^h)}static decodeFormatInformation(c,h){const m=_n.doDecodeFormatInformation(c,h);return m!==null?m:_n.doDecodeFormatInformation(c^_n.FORMAT_INFO_MASK_QR,h^_n.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(c,h){let m=Number.MAX_SAFE_INTEGER,g=0;for(const x of _n.FORMAT_INFO_DECODE_LOOKUP){const w=x[0];if(w===c||w===h)return new _n(x[1]);let S=_n.numBitsDiffering(c,w);S<m&&(g=x[1],m=S),c!==h&&(S=_n.numBitsDiffering(h,w),S<m&&(g=x[1],m=S))}return m<=3?new _n(g):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(c){if(!(c instanceof _n))return!1;const h=c;return this.errorCorrectionLevel===h.errorCorrectionLevel&&this.dataMask===h.dataMask}}_n.FORMAT_INFO_MASK_QR=21522,_n.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class he{constructor(c,...h){this.ecCodewordsPerBlock=c,this.ecBlocks=h}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let c=0;const h=this.ecBlocks;for(const m of h)c+=m.getCount();return c}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class H{constructor(c,h){this.count=c,this.dataCodewords=h}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ze{constructor(c,h,...m){this.versionNumber=c,this.alignmentPatternCenters=h,this.ecBlocks=m;let g=0;const x=m[0].getECCodewordsPerBlock(),w=m[0].getECBlocks();for(const S of w)g+=S.getCount()*(S.getDataCodewords()+x);this.totalCodewords=g}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(c){return this.ecBlocks[c.getValue()]}static getProvisionalVersionForDimension(c){if(c%4!==1)throw new D;try{return this.getVersionForNumber((c-17)/4)}catch{throw new D}}static getVersionForNumber(c){if(c<1||c>40)throw new p;return Ze.VERSIONS[c-1]}static decodeVersionInformation(c){let h=Number.MAX_SAFE_INTEGER,m=0;for(let g=0;g<Ze.VERSION_DECODE_INFO.length;g++){const x=Ze.VERSION_DECODE_INFO[g];if(x===c)return Ze.getVersionForNumber(g+7);const w=_n.numBitsDiffering(c,x);w<h&&(m=g+7,h=w)}return h<=3?Ze.getVersionForNumber(m):null}buildFunctionPattern(){const c=this.getDimensionForVersion(),h=new X(c);h.setRegion(0,0,9,9),h.setRegion(c-8,0,8,9),h.setRegion(0,c-8,9,8);const m=this.alignmentPatternCenters.length;for(let g=0;g<m;g++){const x=this.alignmentPatternCenters[g]-2;for(let w=0;w<m;w++)g===0&&(w===0||w===m-1)||g===m-1&&w===0||h.setRegion(this.alignmentPatternCenters[w]-2,x,5,5)}return h.setRegion(6,9,1,c-17),h.setRegion(9,6,c-17,1),this.versionNumber>6&&(h.setRegion(c-11,0,3,6),h.setRegion(0,c-11,6,3)),h}toString(){return""+this.versionNumber}}Ze.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ze.VERSIONS=[new Ze(1,new Int32Array(0),new he(7,new H(1,19)),new he(10,new H(1,16)),new he(13,new H(1,13)),new he(17,new H(1,9))),new Ze(2,Int32Array.from([6,18]),new he(10,new H(1,34)),new he(16,new H(1,28)),new he(22,new H(1,22)),new he(28,new H(1,16))),new Ze(3,Int32Array.from([6,22]),new he(15,new H(1,55)),new he(26,new H(1,44)),new he(18,new H(2,17)),new he(22,new H(2,13))),new Ze(4,Int32Array.from([6,26]),new he(20,new H(1,80)),new he(18,new H(2,32)),new he(26,new H(2,24)),new he(16,new H(4,9))),new Ze(5,Int32Array.from([6,30]),new he(26,new H(1,108)),new he(24,new H(2,43)),new he(18,new H(2,15),new H(2,16)),new he(22,new H(2,11),new H(2,12))),new Ze(6,Int32Array.from([6,34]),new he(18,new H(2,68)),new he(16,new H(4,27)),new he(24,new H(4,19)),new he(28,new H(4,15))),new Ze(7,Int32Array.from([6,22,38]),new he(20,new H(2,78)),new he(18,new H(4,31)),new he(18,new H(2,14),new H(4,15)),new he(26,new H(4,13),new H(1,14))),new Ze(8,Int32Array.from([6,24,42]),new he(24,new H(2,97)),new he(22,new H(2,38),new H(2,39)),new he(22,new H(4,18),new H(2,19)),new he(26,new H(4,14),new H(2,15))),new Ze(9,Int32Array.from([6,26,46]),new he(30,new H(2,116)),new he(22,new H(3,36),new H(2,37)),new he(20,new H(4,16),new H(4,17)),new he(24,new H(4,12),new H(4,13))),new Ze(10,Int32Array.from([6,28,50]),new he(18,new H(2,68),new H(2,69)),new he(26,new H(4,43),new H(1,44)),new he(24,new H(6,19),new H(2,20)),new he(28,new H(6,15),new H(2,16))),new Ze(11,Int32Array.from([6,30,54]),new he(20,new H(4,81)),new he(30,new H(1,50),new H(4,51)),new he(28,new H(4,22),new H(4,23)),new he(24,new H(3,12),new H(8,13))),new Ze(12,Int32Array.from([6,32,58]),new he(24,new H(2,92),new H(2,93)),new he(22,new H(6,36),new H(2,37)),new he(26,new H(4,20),new H(6,21)),new he(28,new H(7,14),new H(4,15))),new Ze(13,Int32Array.from([6,34,62]),new he(26,new H(4,107)),new he(22,new H(8,37),new H(1,38)),new he(24,new H(8,20),new H(4,21)),new he(22,new H(12,11),new H(4,12))),new Ze(14,Int32Array.from([6,26,46,66]),new he(30,new H(3,115),new H(1,116)),new he(24,new H(4,40),new H(5,41)),new he(20,new H(11,16),new H(5,17)),new he(24,new H(11,12),new H(5,13))),new Ze(15,Int32Array.from([6,26,48,70]),new he(22,new H(5,87),new H(1,88)),new he(24,new H(5,41),new H(5,42)),new he(30,new H(5,24),new H(7,25)),new he(24,new H(11,12),new H(7,13))),new Ze(16,Int32Array.from([6,26,50,74]),new he(24,new H(5,98),new H(1,99)),new he(28,new H(7,45),new H(3,46)),new he(24,new H(15,19),new H(2,20)),new he(30,new H(3,15),new H(13,16))),new Ze(17,Int32Array.from([6,30,54,78]),new he(28,new H(1,107),new H(5,108)),new he(28,new H(10,46),new H(1,47)),new he(28,new H(1,22),new H(15,23)),new he(28,new H(2,14),new H(17,15))),new Ze(18,Int32Array.from([6,30,56,82]),new he(30,new H(5,120),new H(1,121)),new he(26,new H(9,43),new H(4,44)),new he(28,new H(17,22),new H(1,23)),new he(28,new H(2,14),new H(19,15))),new Ze(19,Int32Array.from([6,30,58,86]),new he(28,new H(3,113),new H(4,114)),new he(26,new H(3,44),new H(11,45)),new he(26,new H(17,21),new H(4,22)),new he(26,new H(9,13),new H(16,14))),new Ze(20,Int32Array.from([6,34,62,90]),new he(28,new H(3,107),new H(5,108)),new he(26,new H(3,41),new H(13,42)),new he(30,new H(15,24),new H(5,25)),new he(28,new H(15,15),new H(10,16))),new Ze(21,Int32Array.from([6,28,50,72,94]),new he(28,new H(4,116),new H(4,117)),new he(26,new H(17,42)),new he(28,new H(17,22),new H(6,23)),new he(30,new H(19,16),new H(6,17))),new Ze(22,Int32Array.from([6,26,50,74,98]),new he(28,new H(2,111),new H(7,112)),new he(28,new H(17,46)),new he(30,new H(7,24),new H(16,25)),new he(24,new H(34,13))),new Ze(23,Int32Array.from([6,30,54,78,102]),new he(30,new H(4,121),new H(5,122)),new he(28,new H(4,47),new H(14,48)),new he(30,new H(11,24),new H(14,25)),new he(30,new H(16,15),new H(14,16))),new Ze(24,Int32Array.from([6,28,54,80,106]),new he(30,new H(6,117),new H(4,118)),new he(28,new H(6,45),new H(14,46)),new he(30,new H(11,24),new H(16,25)),new he(30,new H(30,16),new H(2,17))),new Ze(25,Int32Array.from([6,32,58,84,110]),new he(26,new H(8,106),new H(4,107)),new he(28,new H(8,47),new H(13,48)),new he(30,new H(7,24),new H(22,25)),new he(30,new H(22,15),new H(13,16))),new Ze(26,Int32Array.from([6,30,58,86,114]),new he(28,new H(10,114),new H(2,115)),new he(28,new H(19,46),new H(4,47)),new he(28,new H(28,22),new H(6,23)),new he(30,new H(33,16),new H(4,17))),new Ze(27,Int32Array.from([6,34,62,90,118]),new he(30,new H(8,122),new H(4,123)),new he(28,new H(22,45),new H(3,46)),new he(30,new H(8,23),new H(26,24)),new he(30,new H(12,15),new H(28,16))),new Ze(28,Int32Array.from([6,26,50,74,98,122]),new he(30,new H(3,117),new H(10,118)),new he(28,new H(3,45),new H(23,46)),new he(30,new H(4,24),new H(31,25)),new he(30,new H(11,15),new H(31,16))),new Ze(29,Int32Array.from([6,30,54,78,102,126]),new he(30,new H(7,116),new H(7,117)),new he(28,new H(21,45),new H(7,46)),new he(30,new H(1,23),new H(37,24)),new he(30,new H(19,15),new H(26,16))),new Ze(30,Int32Array.from([6,26,52,78,104,130]),new he(30,new H(5,115),new H(10,116)),new he(28,new H(19,47),new H(10,48)),new he(30,new H(15,24),new H(25,25)),new he(30,new H(23,15),new H(25,16))),new Ze(31,Int32Array.from([6,30,56,82,108,134]),new he(30,new H(13,115),new H(3,116)),new he(28,new H(2,46),new H(29,47)),new he(30,new H(42,24),new H(1,25)),new he(30,new H(23,15),new H(28,16))),new Ze(32,Int32Array.from([6,34,60,86,112,138]),new he(30,new H(17,115)),new he(28,new H(10,46),new H(23,47)),new he(30,new H(10,24),new H(35,25)),new he(30,new H(19,15),new H(35,16))),new Ze(33,Int32Array.from([6,30,58,86,114,142]),new he(30,new H(17,115),new H(1,116)),new he(28,new H(14,46),new H(21,47)),new he(30,new H(29,24),new H(19,25)),new he(30,new H(11,15),new H(46,16))),new Ze(34,Int32Array.from([6,34,62,90,118,146]),new he(30,new H(13,115),new H(6,116)),new he(28,new H(14,46),new H(23,47)),new he(30,new H(44,24),new H(7,25)),new he(30,new H(59,16),new H(1,17))),new Ze(35,Int32Array.from([6,30,54,78,102,126,150]),new he(30,new H(12,121),new H(7,122)),new he(28,new H(12,47),new H(26,48)),new he(30,new H(39,24),new H(14,25)),new he(30,new H(22,15),new H(41,16))),new Ze(36,Int32Array.from([6,24,50,76,102,128,154]),new he(30,new H(6,121),new H(14,122)),new he(28,new H(6,47),new H(34,48)),new he(30,new H(46,24),new H(10,25)),new he(30,new H(2,15),new H(64,16))),new Ze(37,Int32Array.from([6,28,54,80,106,132,158]),new he(30,new H(17,122),new H(4,123)),new he(28,new H(29,46),new H(14,47)),new he(30,new H(49,24),new H(10,25)),new he(30,new H(24,15),new H(46,16))),new Ze(38,Int32Array.from([6,32,58,84,110,136,162]),new he(30,new H(4,122),new H(18,123)),new he(28,new H(13,46),new H(32,47)),new he(30,new H(48,24),new H(14,25)),new he(30,new H(42,15),new H(32,16))),new Ze(39,Int32Array.from([6,26,54,82,110,138,166]),new he(30,new H(20,117),new H(4,118)),new he(28,new H(40,47),new H(7,48)),new he(30,new H(43,24),new H(22,25)),new he(30,new H(10,15),new H(67,16))),new Ze(40,Int32Array.from([6,30,58,86,114,142,170]),new he(30,new H(19,118),new H(6,119)),new he(28,new H(18,47),new H(31,48)),new he(30,new H(34,24),new H(34,25)),new he(30,new H(20,15),new H(61,16)))];var nn;(function(B){B[B.DATA_MASK_000=0]="DATA_MASK_000",B[B.DATA_MASK_001=1]="DATA_MASK_001",B[B.DATA_MASK_010=2]="DATA_MASK_010",B[B.DATA_MASK_011=3]="DATA_MASK_011",B[B.DATA_MASK_100=4]="DATA_MASK_100",B[B.DATA_MASK_101=5]="DATA_MASK_101",B[B.DATA_MASK_110=6]="DATA_MASK_110",B[B.DATA_MASK_111=7]="DATA_MASK_111"})(nn||(nn={}));class $s{constructor(c,h){this.value=c,this.isMasked=h}unmaskBitMatrix(c,h){for(let m=0;m<h;m++)for(let g=0;g<h;g++)this.isMasked(m,g)&&c.flip(g,m)}}$s.values=new Map([[nn.DATA_MASK_000,new $s(nn.DATA_MASK_000,(B,c)=>(B+c&1)===0)],[nn.DATA_MASK_001,new $s(nn.DATA_MASK_001,(B,c)=>(B&1)===0)],[nn.DATA_MASK_010,new $s(nn.DATA_MASK_010,(B,c)=>c%3===0)],[nn.DATA_MASK_011,new $s(nn.DATA_MASK_011,(B,c)=>(B+c)%3===0)],[nn.DATA_MASK_100,new $s(nn.DATA_MASK_100,(B,c)=>(Math.floor(B/2)+Math.floor(c/3)&1)===0)],[nn.DATA_MASK_101,new $s(nn.DATA_MASK_101,(B,c)=>B*c%6===0)],[nn.DATA_MASK_110,new $s(nn.DATA_MASK_110,(B,c)=>B*c%6<3)],[nn.DATA_MASK_111,new $s(nn.DATA_MASK_111,(B,c)=>(B+c+B*c%3&1)===0)]]);class h8{constructor(c){const h=c.getHeight();if(h<21||(h&3)!==1)throw new D;this.bitMatrix=c}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let c=0;for(let x=0;x<6;x++)c=this.copyBit(x,8,c);c=this.copyBit(7,8,c),c=this.copyBit(8,8,c),c=this.copyBit(8,7,c);for(let x=5;x>=0;x--)c=this.copyBit(8,x,c);const h=this.bitMatrix.getHeight();let m=0;const g=h-7;for(let x=h-1;x>=g;x--)m=this.copyBit(8,x,m);for(let x=h-8;x<h;x++)m=this.copyBit(x,8,m);if(this.parsedFormatInfo=_n.decodeFormatInformation(c,m),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new D}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const c=this.bitMatrix.getHeight(),h=Math.floor((c-17)/4);if(h<=6)return Ze.getVersionForNumber(h);let m=0;const g=c-11;for(let w=5;w>=0;w--)for(let S=c-9;S>=g;S--)m=this.copyBit(S,w,m);let x=Ze.decodeVersionInformation(m);if(x!==null&&x.getDimensionForVersion()===c)return this.parsedVersion=x,x;m=0;for(let w=5;w>=0;w--)for(let S=c-9;S>=g;S--)m=this.copyBit(w,S,m);if(x=Ze.decodeVersionInformation(m),x!==null&&x.getDimensionForVersion()===c)return this.parsedVersion=x,x;throw new D}copyBit(c,h,m){return(this.isMirror?this.bitMatrix.get(h,c):this.bitMatrix.get(c,h))?m<<1|1:m<<1}readCodewords(){const c=this.readFormatInformation(),h=this.readVersion(),m=$s.values.get(c.getDataMask()),g=this.bitMatrix.getHeight();m.unmaskBitMatrix(this.bitMatrix,g);const x=h.buildFunctionPattern();let w=!0;const S=new Uint8Array(h.getTotalCodewords());let R=0,_=0,j=0;for(let U=g-1;U>0;U-=2){U===6&&U--;for(let V=0;V<g;V++){const W=w?g-1-V:V;for(let J=0;J<2;J++)x.get(U-J,W)||(j++,_<<=1,this.bitMatrix.get(U-J,W)&&(_|=1),j===8&&(S[R++]=_,j=0,_=0))}w=!w}if(R!==h.getTotalCodewords())throw new D;return S}remask(){if(this.parsedFormatInfo===null)return;const c=$s.values[this.parsedFormatInfo.getDataMask()],h=this.bitMatrix.getHeight();c.unmaskBitMatrix(this.bitMatrix,h)}setMirror(c){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=c}mirror(){const c=this.bitMatrix;for(let h=0,m=c.getWidth();h<m;h++)for(let g=h+1,x=c.getHeight();g<x;g++)c.get(h,g)!==c.get(g,h)&&(c.flip(g,h),c.flip(h,g))}}class Hg{constructor(c,h){this.numDataCodewords=c,this.codewords=h}static getDataBlocks(c,h,m){if(c.length!==h.getTotalCodewords())throw new p;const g=h.getECBlocksForLevel(m);let x=0;const w=g.getECBlocks();for(const J of w)x+=J.getCount();const S=new Array(x);let R=0;for(const J of w)for(let te=0;te<J.getCount();te++){const de=J.getDataCodewords(),xe=g.getECCodewordsPerBlock()+de;S[R++]=new Hg(de,new Uint8Array(xe))}const _=S[0].codewords.length;let j=S.length-1;for(;j>=0&&S[j].codewords.length!==_;)j--;j++;const U=_-g.getECCodewordsPerBlock();let V=0;for(let J=0;J<U;J++)for(let te=0;te<R;te++)S[te].codewords[J]=c[V++];for(let J=j;J<R;J++)S[J].codewords[U]=c[V++];const W=S[0].codewords.length;for(let J=U;J<W;J++)for(let te=0;te<R;te++){const de=te<j?J:J+1;S[te].codewords[de]=c[V++]}return S}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Vs;(function(B){B[B.TERMINATOR=0]="TERMINATOR",B[B.NUMERIC=1]="NUMERIC",B[B.ALPHANUMERIC=2]="ALPHANUMERIC",B[B.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",B[B.BYTE=4]="BYTE",B[B.ECI=5]="ECI",B[B.KANJI=6]="KANJI",B[B.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",B[B.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",B[B.HANZI=9]="HANZI"})(Vs||(Vs={}));class rt{constructor(c,h,m,g){this.value=c,this.stringValue=h,this.characterCountBitsForVersions=m,this.bits=g,rt.FOR_BITS.set(g,this),rt.FOR_VALUE.set(c,this)}static forBits(c){const h=rt.FOR_BITS.get(c);if(h===void 0)throw new p;return h}getCharacterCountBits(c){const h=c.getVersionNumber();let m;return h<=9?m=0:h<=26?m=1:m=2,this.characterCountBitsForVersions[m]}getValue(){return this.value}getBits(){return this.bits}equals(c){if(!(c instanceof rt))return!1;const h=c;return this.value===h.value}toString(){return this.stringValue}}rt.FOR_BITS=new Map,rt.FOR_VALUE=new Map,rt.TERMINATOR=new rt(Vs.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),rt.NUMERIC=new rt(Vs.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),rt.ALPHANUMERIC=new rt(Vs.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),rt.STRUCTURED_APPEND=new rt(Vs.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),rt.BYTE=new rt(Vs.BYTE,"BYTE",Int32Array.from([8,16,16]),4),rt.ECI=new rt(Vs.ECI,"ECI",Int32Array.from([0,0,0]),7),rt.KANJI=new rt(Vs.KANJI,"KANJI",Int32Array.from([8,10,12]),8),rt.FNC1_FIRST_POSITION=new rt(Vs.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),rt.FNC1_SECOND_POSITION=new rt(Vs.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),rt.HANZI=new rt(Vs.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class ur{static decode(c,h,m,g){const x=new Gg(c);let w=new ne;const S=new Array;let R=-1,_=-1;try{let j=null,U=!1,V;do{if(x.available()<4)V=rt.TERMINATOR;else{const W=x.readBits(4);V=rt.forBits(W)}switch(V){case rt.TERMINATOR:break;case rt.FNC1_FIRST_POSITION:case rt.FNC1_SECOND_POSITION:U=!0;break;case rt.STRUCTURED_APPEND:if(x.available()<16)throw new D;R=x.readBits(8),_=x.readBits(8);break;case rt.ECI:const W=ur.parseECIValue(x);if(j=F.getCharacterSetECIByValue(W),j===null)throw new D;break;case rt.HANZI:const J=x.readBits(4),te=x.readBits(V.getCharacterCountBits(h));J===ur.GB2312_SUBSET&&ur.decodeHanziSegment(x,w,te);break;default:const de=x.readBits(V.getCharacterCountBits(h));switch(V){case rt.NUMERIC:ur.decodeNumericSegment(x,w,de);break;case rt.ALPHANUMERIC:ur.decodeAlphanumericSegment(x,w,de,U);break;case rt.BYTE:ur.decodeByteSegment(x,w,de,j,S,g);break;case rt.KANJI:ur.decodeKanjiSegment(x,w,de);break;default:throw new D}break}}while(V!==rt.TERMINATOR)}catch{throw new D}return new _e(c,w.toString(),S.length===0?null:S,m===null?null:m.toString(),R,_)}static decodeHanziSegment(c,h,m){if(m*13>c.available())throw new D;const g=new Uint8Array(2*m);let x=0;for(;m>0;){const w=c.readBits(13);let S=w/96<<8&4294967295|w%96;S<959?S+=41377:S+=42657,g[x]=S>>8&255,g[x+1]=S&255,x+=2,m--}try{h.append(G.decode(g,Y.GB2312))}catch(w){throw new D(w)}}static decodeKanjiSegment(c,h,m){if(m*13>c.available())throw new D;const g=new Uint8Array(2*m);let x=0;for(;m>0;){const w=c.readBits(13);let S=w/192<<8&4294967295|w%192;S<7936?S+=33088:S+=49472,g[x]=S>>8,g[x+1]=S,x+=2,m--}try{h.append(G.decode(g,Y.SHIFT_JIS))}catch(w){throw new D(w)}}static decodeByteSegment(c,h,m,g,x,w){if(8*m>c.available())throw new D;const S=new Uint8Array(m);for(let _=0;_<m;_++)S[_]=c.readBits(8);let R;g===null?R=Y.guessEncoding(S,w):R=g.getName();try{h.append(G.decode(S,R))}catch(_){throw new D(_)}x.push(S)}static toAlphaNumericChar(c){if(c>=ur.ALPHANUMERIC_CHARS.length)throw new D;return ur.ALPHANUMERIC_CHARS[c]}static decodeAlphanumericSegment(c,h,m,g){const x=h.length();for(;m>1;){if(c.available()<11)throw new D;const w=c.readBits(11);h.append(ur.toAlphaNumericChar(Math.floor(w/45))),h.append(ur.toAlphaNumericChar(w%45)),m-=2}if(m===1){if(c.available()<6)throw new D;h.append(ur.toAlphaNumericChar(c.readBits(6)))}if(g)for(let w=x;w<h.length();w++)h.charAt(w)==="%"&&(w<h.length()-1&&h.charAt(w+1)==="%"?h.deleteCharAt(w+1):h.setCharAt(w,""))}static decodeNumericSegment(c,h,m){for(;m>=3;){if(c.available()<10)throw new D;const g=c.readBits(10);if(g>=1e3)throw new D;h.append(ur.toAlphaNumericChar(Math.floor(g/100))),h.append(ur.toAlphaNumericChar(Math.floor(g/10)%10)),h.append(ur.toAlphaNumericChar(g%10)),m-=3}if(m===2){if(c.available()<7)throw new D;const g=c.readBits(7);if(g>=100)throw new D;h.append(ur.toAlphaNumericChar(Math.floor(g/10))),h.append(ur.toAlphaNumericChar(g%10))}else if(m===1){if(c.available()<4)throw new D;const g=c.readBits(4);if(g>=10)throw new D;h.append(ur.toAlphaNumericChar(g))}}static parseECIValue(c){const h=c.readBits(8);if(!(h&128))return h&127;if((h&192)===128){const m=c.readBits(8);return(h&63)<<8&4294967295|m}if((h&224)===192){const m=c.readBits(16);return(h&31)<<16&4294967295|m}throw new D}}ur.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",ur.GB2312_SUBSET=1;class g2{constructor(c){this.mirrored=c}isMirrored(){return this.mirrored}applyMirroredCorrection(c){if(!this.mirrored||c===null||c.length<3)return;const h=c[0];c[0]=c[2],c[2]=h}}class f8{constructor(){this.rsDecoder=new Ne(Be.QR_CODE_FIELD_256)}decodeBooleanArray(c,h){return this.decodeBitMatrix(X.parseFromBooleanArray(c),h)}decodeBitMatrix(c,h){const m=new h8(c);let g=null;try{return this.decodeBitMatrixParser(m,h)}catch(x){g=x}try{m.remask(),m.setMirror(!0),m.readVersion(),m.readFormatInformation(),m.mirror();const x=this.decodeBitMatrixParser(m,h);return x.setOther(new g2(!0)),x}catch(x){throw g!==null?g:x}}decodeBitMatrixParser(c,h){const m=c.readVersion(),g=c.readFormatInformation().getErrorCorrectionLevel(),x=c.readCodewords(),w=Hg.getDataBlocks(x,m,g);let S=0;for(const j of w)S+=j.getNumDataCodewords();const R=new Uint8Array(S);let _=0;for(const j of w){const U=j.getCodewords(),V=j.getNumDataCodewords();this.correctErrors(U,V);for(let W=0;W<V;W++)R[_++]=U[W]}return ur.decode(R,m,g,h)}correctErrors(c,h){const m=new Int32Array(c);try{this.rsDecoder.decode(m,c.length-h)}catch{throw new v}for(let g=0;g<h;g++)c[g]=m[g]}}class zg extends $e{constructor(c,h,m){super(c,h),this.estimatedModuleSize=m}aboutEquals(c,h,m){if(Math.abs(h-this.getY())<=c&&Math.abs(m-this.getX())<=c){const g=Math.abs(c-this.estimatedModuleSize);return g<=1||g<=this.estimatedModuleSize}return!1}combineEstimate(c,h,m){const g=(this.getX()+h)/2,x=(this.getY()+c)/2,w=(this.estimatedModuleSize+m)/2;return new zg(g,x,w)}}class Pf{constructor(c,h,m,g,x,w,S){this.image=c,this.startX=h,this.startY=m,this.width=g,this.height=x,this.moduleSize=w,this.resultPointCallback=S,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const c=this.startX,h=this.height,m=this.width,g=c+m,x=this.startY+h/2,w=new Int32Array(3),S=this.image;for(let R=0;R<h;R++){const _=x+(R&1?-Math.floor((R+1)/2):Math.floor((R+1)/2));w[0]=0,w[1]=0,w[2]=0;let j=c;for(;j<g&&!S.get(j,_);)j++;let U=0;for(;j<g;){if(S.get(j,_))if(U===1)w[1]++;else if(U===2){if(this.foundPatternCross(w)){const V=this.handlePossibleCenter(w,_,j);if(V!==null)return V}w[0]=w[2],w[1]=1,w[2]=0,U=1}else w[++U]++;else U===1&&U++,w[U]++;j++}if(this.foundPatternCross(w)){const V=this.handlePossibleCenter(w,_,g);if(V!==null)return V}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new z}static centerFromEnd(c,h){return h-c[2]-c[1]/2}foundPatternCross(c){const h=this.moduleSize,m=h/2;for(let g=0;g<3;g++)if(Math.abs(h-c[g])>=m)return!1;return!0}crossCheckVertical(c,h,m,g){const x=this.image,w=x.getHeight(),S=this.crossCheckStateCount;S[0]=0,S[1]=0,S[2]=0;let R=c;for(;R>=0&&x.get(h,R)&&S[1]<=m;)S[1]++,R--;if(R<0||S[1]>m)return NaN;for(;R>=0&&!x.get(h,R)&&S[0]<=m;)S[0]++,R--;if(S[0]>m)return NaN;for(R=c+1;R<w&&x.get(h,R)&&S[1]<=m;)S[1]++,R++;if(R===w||S[1]>m)return NaN;for(;R<w&&!x.get(h,R)&&S[2]<=m;)S[2]++,R++;if(S[2]>m)return NaN;const _=S[0]+S[1]+S[2];return 5*Math.abs(_-g)>=2*g?NaN:this.foundPatternCross(S)?Pf.centerFromEnd(S,R):NaN}handlePossibleCenter(c,h,m){const g=c[0]+c[1]+c[2],x=Pf.centerFromEnd(c,m),w=this.crossCheckVertical(h,x,2*c[1],g);if(!isNaN(w)){const S=(c[0]+c[1]+c[2])/3;for(const _ of this.possibleCenters)if(_.aboutEquals(S,w,x))return _.combineEstimate(w,x,S);const R=new zg(x,w,S);this.possibleCenters.push(R),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(R)}return null}}class Wg extends $e{constructor(c,h,m,g){super(c,h),this.estimatedModuleSize=m,this.count=g,g===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(c,h,m){if(Math.abs(h-this.getY())<=c&&Math.abs(m-this.getX())<=c){const g=Math.abs(c-this.estimatedModuleSize);return g<=1||g<=this.estimatedModuleSize}return!1}combineEstimate(c,h,m){const g=this.count+1,x=(this.count*this.getX()+h)/g,w=(this.count*this.getY()+c)/g,S=(this.count*this.estimatedModuleSize+m)/g;return new Wg(x,w,S,g)}}class m8{constructor(c){this.bottomLeft=c[0],this.topLeft=c[1],this.topRight=c[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class sn{constructor(c,h){this.image=c,this.resultPointCallback=h,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=h}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(c){const h=c!=null&&c.get(k.TRY_HARDER)!==void 0,m=c!=null&&c.get(k.PURE_BARCODE)!==void 0,g=this.image,x=g.getHeight(),w=g.getWidth();let S=Math.floor(3*x/(4*sn.MAX_MODULES));(S<sn.MIN_SKIP||h)&&(S=sn.MIN_SKIP);let R=!1;const _=new Int32Array(5);for(let U=S-1;U<x&&!R;U+=S){_[0]=0,_[1]=0,_[2]=0,_[3]=0,_[4]=0;let V=0;for(let W=0;W<w;W++)if(g.get(W,U))(V&1)===1&&V++,_[V]++;else if(V&1)_[V]++;else if(V===4)if(sn.foundPatternCross(_)){if(this.handlePossibleCenter(_,U,W,m)===!0)if(S=2,this.hasSkipped===!0)R=this.haveMultiplyConfirmedCenters();else{const te=this.findRowSkip();te>_[2]&&(U+=te-_[2]-S,W=w-1)}else{_[0]=_[2],_[1]=_[3],_[2]=_[4],_[3]=1,_[4]=0,V=3;continue}V=0,_[0]=0,_[1]=0,_[2]=0,_[3]=0,_[4]=0}else _[0]=_[2],_[1]=_[3],_[2]=_[4],_[3]=1,_[4]=0,V=3;else _[++V]++;sn.foundPatternCross(_)&&this.handlePossibleCenter(_,U,w,m)===!0&&(S=_[0],this.hasSkipped&&(R=this.haveMultiplyConfirmedCenters()))}const j=this.selectBestPatterns();return $e.orderBestPatterns(j),new m8(j)}static centerFromEnd(c,h){return h-c[4]-c[3]-c[2]/2}static foundPatternCross(c){let h=0;for(let x=0;x<5;x++){const w=c[x];if(w===0)return!1;h+=w}if(h<7)return!1;const m=h/7,g=m/2;return Math.abs(m-c[0])<g&&Math.abs(m-c[1])<g&&Math.abs(3*m-c[2])<3*g&&Math.abs(m-c[3])<g&&Math.abs(m-c[4])<g}getCrossCheckStateCount(){const c=this.crossCheckStateCount;return c[0]=0,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c}crossCheckDiagonal(c,h,m,g){const x=this.getCrossCheckStateCount();let w=0;const S=this.image;for(;c>=w&&h>=w&&S.get(h-w,c-w);)x[2]++,w++;if(c<w||h<w)return!1;for(;c>=w&&h>=w&&!S.get(h-w,c-w)&&x[1]<=m;)x[1]++,w++;if(c<w||h<w||x[1]>m)return!1;for(;c>=w&&h>=w&&S.get(h-w,c-w)&&x[0]<=m;)x[0]++,w++;if(x[0]>m)return!1;const R=S.getHeight(),_=S.getWidth();for(w=1;c+w<R&&h+w<_&&S.get(h+w,c+w);)x[2]++,w++;if(c+w>=R||h+w>=_)return!1;for(;c+w<R&&h+w<_&&!S.get(h+w,c+w)&&x[3]<m;)x[3]++,w++;if(c+w>=R||h+w>=_||x[3]>=m)return!1;for(;c+w<R&&h+w<_&&S.get(h+w,c+w)&&x[4]<m;)x[4]++,w++;if(x[4]>=m)return!1;const j=x[0]+x[1]+x[2]+x[3]+x[4];return Math.abs(j-g)<2*g&&sn.foundPatternCross(x)}crossCheckVertical(c,h,m,g){const x=this.image,w=x.getHeight(),S=this.getCrossCheckStateCount();let R=c;for(;R>=0&&x.get(h,R);)S[2]++,R--;if(R<0)return NaN;for(;R>=0&&!x.get(h,R)&&S[1]<=m;)S[1]++,R--;if(R<0||S[1]>m)return NaN;for(;R>=0&&x.get(h,R)&&S[0]<=m;)S[0]++,R--;if(S[0]>m)return NaN;for(R=c+1;R<w&&x.get(h,R);)S[2]++,R++;if(R===w)return NaN;for(;R<w&&!x.get(h,R)&&S[3]<m;)S[3]++,R++;if(R===w||S[3]>=m)return NaN;for(;R<w&&x.get(h,R)&&S[4]<m;)S[4]++,R++;if(S[4]>=m)return NaN;const _=S[0]+S[1]+S[2]+S[3]+S[4];return 5*Math.abs(_-g)>=2*g?NaN:sn.foundPatternCross(S)?sn.centerFromEnd(S,R):NaN}crossCheckHorizontal(c,h,m,g){const x=this.image,w=x.getWidth(),S=this.getCrossCheckStateCount();let R=c;for(;R>=0&&x.get(R,h);)S[2]++,R--;if(R<0)return NaN;for(;R>=0&&!x.get(R,h)&&S[1]<=m;)S[1]++,R--;if(R<0||S[1]>m)return NaN;for(;R>=0&&x.get(R,h)&&S[0]<=m;)S[0]++,R--;if(S[0]>m)return NaN;for(R=c+1;R<w&&x.get(R,h);)S[2]++,R++;if(R===w)return NaN;for(;R<w&&!x.get(R,h)&&S[3]<m;)S[3]++,R++;if(R===w||S[3]>=m)return NaN;for(;R<w&&x.get(R,h)&&S[4]<m;)S[4]++,R++;if(S[4]>=m)return NaN;const _=S[0]+S[1]+S[2]+S[3]+S[4];return 5*Math.abs(_-g)>=g?NaN:sn.foundPatternCross(S)?sn.centerFromEnd(S,R):NaN}handlePossibleCenter(c,h,m,g){const x=c[0]+c[1]+c[2]+c[3]+c[4];let w=sn.centerFromEnd(c,m),S=this.crossCheckVertical(h,Math.floor(w),c[2],x);if(!isNaN(S)&&(w=this.crossCheckHorizontal(Math.floor(w),Math.floor(S),c[2],x),!isNaN(w)&&(!g||this.crossCheckDiagonal(Math.floor(S),Math.floor(w),c[2],x)))){const R=x/7;let _=!1;const j=this.possibleCenters;for(let U=0,V=j.length;U<V;U++){const W=j[U];if(W.aboutEquals(R,S,w)){j[U]=W.combineEstimate(S,w,R),_=!0;break}}if(!_){const U=new Wg(w,S,R);j.push(U),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(U)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let h=null;for(const m of this.possibleCenters)if(m.getCount()>=sn.CENTER_QUORUM)if(h==null)h=m;else return this.hasSkipped=!0,Math.floor((Math.abs(h.getX()-m.getX())-Math.abs(h.getY()-m.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let c=0,h=0;const m=this.possibleCenters.length;for(const w of this.possibleCenters)w.getCount()>=sn.CENTER_QUORUM&&(c++,h+=w.getEstimatedModuleSize());if(c<3)return!1;const g=h/m;let x=0;for(const w of this.possibleCenters)x+=Math.abs(w.getEstimatedModuleSize()-g);return x<=.05*h}selectBestPatterns(){const c=this.possibleCenters.length;if(c<3)throw new z;const h=this.possibleCenters;let m;if(c>3){let g=0,x=0;for(const R of this.possibleCenters){const _=R.getEstimatedModuleSize();g+=_,x+=_*_}m=g/c;let w=Math.sqrt(x/c-m*m);h.sort((R,_)=>{const j=Math.abs(_.getEstimatedModuleSize()-m),U=Math.abs(R.getEstimatedModuleSize()-m);return j<U?-1:j>U?1:0});const S=Math.max(.2*m,w);for(let R=0;R<h.length&&h.length>3;R++){const _=h[R];Math.abs(_.getEstimatedModuleSize()-m)>S&&(h.splice(R,1),R--)}}if(h.length>3){let g=0;for(const x of h)g+=x.getEstimatedModuleSize();m=g/h.length,h.sort((x,w)=>{if(w.getCount()===x.getCount()){const S=Math.abs(w.getEstimatedModuleSize()-m),R=Math.abs(x.getEstimatedModuleSize()-m);return S<R?1:S>R?-1:0}else return w.getCount()-x.getCount()}),h.splice(3)}return[h[0],h[1],h[2]]}}sn.CENTER_QUORUM=2,sn.MIN_SKIP=3,sn.MAX_MODULES=57;class od{constructor(c){this.image=c}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(c){this.resultPointCallback=c==null?null:c.get(k.NEED_RESULT_POINT_CALLBACK);const m=new sn(this.image,this.resultPointCallback).find(c);return this.processFinderPatternInfo(m)}processFinderPatternInfo(c){const h=c.getTopLeft(),m=c.getTopRight(),g=c.getBottomLeft(),x=this.calculateModuleSize(h,m,g);if(x<1)throw new z("No pattern found in proccess finder.");const w=od.computeDimension(h,m,g,x),S=Ze.getProvisionalVersionForDimension(w),R=S.getDimensionForVersion()-7;let _=null;if(S.getAlignmentPatternCenters().length>0){const W=m.getX()-h.getX()+g.getX(),J=m.getY()-h.getY()+g.getY(),te=1-3/R,de=Math.floor(h.getX()+te*(W-h.getX())),xe=Math.floor(h.getY()+te*(J-h.getY()));for(let ke=4;ke<=16;ke<<=1)try{_=this.findAlignmentInRegion(x,de,xe,ke);break}catch(je){if(!(je instanceof z))throw je}}const j=od.createTransform(h,m,g,_,w),U=od.sampleGrid(this.image,j,w);let V;return _===null?V=[g,h,m]:V=[g,h,m,_],new Bn(U,V)}static createTransform(c,h,m,g,x){const w=x-3.5;let S,R,_,j;return g!==null?(S=g.getX(),R=g.getY(),_=w-3,j=_):(S=h.getX()-c.getX()+m.getX(),R=h.getY()-c.getY()+m.getY(),_=w,j=w),Ft.quadrilateralToQuadrilateral(3.5,3.5,w,3.5,_,j,3.5,w,c.getX(),c.getY(),h.getX(),h.getY(),S,R,m.getX(),m.getY())}static sampleGrid(c,h,m){return Os.getInstance().sampleGridWithTransform(c,m,m,h)}static computeDimension(c,h,m,g){const x=at.round($e.distance(c,h)/g),w=at.round($e.distance(c,m)/g);let S=Math.floor((x+w)/2)+7;switch(S&3){case 0:S++;break;case 2:S--;break;case 3:throw new z("Dimensions could be not found.")}return S}calculateModuleSize(c,h,m){return(this.calculateModuleSizeOneWay(c,h)+this.calculateModuleSizeOneWay(c,m))/2}calculateModuleSizeOneWay(c,h){const m=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(c.getX()),Math.floor(c.getY()),Math.floor(h.getX()),Math.floor(h.getY())),g=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(h.getX()),Math.floor(h.getY()),Math.floor(c.getX()),Math.floor(c.getY()));return isNaN(m)?g/7:isNaN(g)?m/7:(m+g)/14}sizeOfBlackWhiteBlackRunBothWays(c,h,m,g){let x=this.sizeOfBlackWhiteBlackRun(c,h,m,g),w=1,S=c-(m-c);S<0?(w=c/(c-S),S=0):S>=this.image.getWidth()&&(w=(this.image.getWidth()-1-c)/(S-c),S=this.image.getWidth()-1);let R=Math.floor(h-(g-h)*w);return w=1,R<0?(w=h/(h-R),R=0):R>=this.image.getHeight()&&(w=(this.image.getHeight()-1-h)/(R-h),R=this.image.getHeight()-1),S=Math.floor(c+(S-c)*w),x+=this.sizeOfBlackWhiteBlackRun(c,h,S,R),x-1}sizeOfBlackWhiteBlackRun(c,h,m,g){const x=Math.abs(g-h)>Math.abs(m-c);if(x){let W=c;c=h,h=W,W=m,m=g,g=W}const w=Math.abs(m-c),S=Math.abs(g-h);let R=-w/2;const _=c<m?1:-1,j=h<g?1:-1;let U=0;const V=m+_;for(let W=c,J=h;W!==V;W+=_){const te=x?J:W,de=x?W:J;if(U===1===this.image.get(te,de)){if(U===2)return at.distance(W,J,c,h);U++}if(R+=S,R>0){if(J===g)break;J+=j,R-=w}}return U===2?at.distance(m+_,g,c,h):NaN}findAlignmentInRegion(c,h,m,g){const x=Math.floor(g*c),w=Math.max(0,h-x),S=Math.min(this.image.getWidth()-1,h+x);if(S-w<c*3)throw new z("Alignment top exceeds estimated module size.");const R=Math.max(0,m-x),_=Math.min(this.image.getHeight()-1,m+x);if(_-R<c*3)throw new z("Alignment bottom exceeds estimated module size.");return new Pf(this.image,w,R,S-w,_-R,c,this.resultPointCallback).find()}}class Ha{constructor(){this.decoder=new f8}getDecoder(){return this.decoder}decode(c,h){let m,g;if(h!=null&&h.get(k.PURE_BARCODE)!==void 0){const R=Ha.extractPureBits(c.getBlackMatrix());m=this.decoder.decodeBitMatrix(R,h),g=Ha.NO_POINTS}else{const R=new od(c.getBlackMatrix()).detect(h);m=this.decoder.decodeBitMatrix(R.getBits(),h),g=R.getPoints()}m.getOther()instanceof g2&&m.getOther().applyMirroredCorrection(g);const x=new ie(m.getText(),m.getRawBytes(),void 0,g,oe.QR_CODE,void 0),w=m.getByteSegments();w!==null&&x.putMetadata(Le.BYTE_SEGMENTS,w);const S=m.getECLevel();return S!==null&&x.putMetadata(Le.ERROR_CORRECTION_LEVEL,S),m.hasStructuredAppend()&&(x.putMetadata(Le.STRUCTURED_APPEND_SEQUENCE,m.getStructuredAppendSequenceNumber()),x.putMetadata(Le.STRUCTURED_APPEND_PARITY,m.getStructuredAppendParity())),x}reset(){}static extractPureBits(c){const h=c.getTopLeftOnBit(),m=c.getBottomRightOnBit();if(h===null||m===null)throw new z;const g=this.moduleSize(h,c);let x=h[1],w=m[1],S=h[0],R=m[0];if(S>=R||x>=w)throw new z;if(w-x!==R-S&&(R=S+(w-x),R>=c.getWidth()))throw new z;const _=Math.round((R-S+1)/g),j=Math.round((w-x+1)/g);if(_<=0||j<=0)throw new z;if(j!==_)throw new z;const U=Math.floor(g/2);x+=U,S+=U;const V=S+Math.floor((_-1)*g)-R;if(V>0){if(V>U)throw new z;S-=V}const W=x+Math.floor((j-1)*g)-w;if(W>0){if(W>U)throw new z;x-=W}const J=new X(_,j);for(let te=0;te<j;te++){const de=x+Math.floor(te*g);for(let xe=0;xe<_;xe++)c.get(S+Math.floor(xe*g),de)&&J.set(xe,te)}return J}static moduleSize(c,h){const m=h.getHeight(),g=h.getWidth();let x=c[0],w=c[1],S=!0,R=0;for(;x<g&&w<m;){if(S!==h.get(x,w)){if(++R===5)break;S=!S}x++,w++}if(x===g||w===m)throw new z;return(x-c[0])/7}}Ha.NO_POINTS=new Array;class it{PDF417Common(){}static getBitCountSum(c){return at.sum(c)}static toIntArray(c){if(c==null||!c.length)return it.EMPTY_INT_ARRAY;const h=new Int32Array(c.length);let m=0;for(const g of c)h[m++]=g;return h}static getCodeword(c){const h=N.binarySearch(it.SYMBOL_TABLE,c&262143);return h<0?-1:(it.CODEWORD_TABLE[h]-1)%it.NUMBER_OF_CODEWORDS}}it.NUMBER_OF_CODEWORDS=929,it.MAX_CODEWORDS_IN_BARCODE=it.NUMBER_OF_CODEWORDS-1,it.MIN_ROWS_IN_BARCODE=3,it.MAX_ROWS_IN_BARCODE=90,it.MODULES_IN_CODEWORD=17,it.MODULES_IN_STOP_PATTERN=18,it.BARS_IN_MODULE=8,it.EMPTY_INT_ARRAY=new Int32Array([]),it.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),it.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class p8{constructor(c,h){this.bits=c,this.points=h}getBits(){return this.bits}getPoints(){return this.points}}class vt{static detectMultiple(c,h,m){let g=c.getBlackMatrix(),x=vt.detect(m,g);return x.length||(g=g.clone(),g.rotate180(),x=vt.detect(m,g)),new p8(g,x)}static detect(c,h){const m=new Array;let g=0,x=0,w=!1;for(;g<h.getHeight();){const S=vt.findVertices(h,g,x);if(S[0]==null&&S[3]==null){if(!w)break;w=!1,x=0;for(const R of m)R[1]!=null&&(g=Math.trunc(Math.max(g,R[1].getY()))),R[3]!=null&&(g=Math.max(g,Math.trunc(R[3].getY())));g+=vt.ROW_STEP;continue}if(w=!0,m.push(S),!c)break;S[2]!=null?(x=Math.trunc(S[2].getX()),g=Math.trunc(S[2].getY())):(x=Math.trunc(S[4].getX()),g=Math.trunc(S[4].getY()))}return m}static findVertices(c,h,m){const g=c.getHeight(),x=c.getWidth(),w=new Array(8);return vt.copyToResult(w,vt.findRowsWithPattern(c,g,x,h,m,vt.START_PATTERN),vt.INDEXES_START_PATTERN),w[4]!=null&&(m=Math.trunc(w[4].getX()),h=Math.trunc(w[4].getY())),vt.copyToResult(w,vt.findRowsWithPattern(c,g,x,h,m,vt.STOP_PATTERN),vt.INDEXES_STOP_PATTERN),w}static copyToResult(c,h,m){for(let g=0;g<m.length;g++)c[m[g]]=h[g]}static findRowsWithPattern(c,h,m,g,x,w){const S=new Array(4);let R=!1;const _=new Int32Array(w.length);for(;g<h;g+=vt.ROW_STEP){let U=vt.findGuardPattern(c,x,g,m,!1,w,_);if(U!=null){for(;g>0;){const V=vt.findGuardPattern(c,x,--g,m,!1,w,_);if(V!=null)U=V;else{g++;break}}S[0]=new $e(U[0],g),S[1]=new $e(U[1],g),R=!0;break}}let j=g+1;if(R){let U=0,V=Int32Array.from([Math.trunc(S[0].getX()),Math.trunc(S[1].getX())]);for(;j<h;j++){const W=vt.findGuardPattern(c,V[0],j,m,!1,w,_);if(W!=null&&Math.abs(V[0]-W[0])<vt.MAX_PATTERN_DRIFT&&Math.abs(V[1]-W[1])<vt.MAX_PATTERN_DRIFT)V=W,U=0;else{if(U>vt.SKIPPED_ROW_COUNT_MAX)break;U++}}j-=U+1,S[2]=new $e(V[0],j),S[3]=new $e(V[1],j)}return j-g<vt.BARCODE_MIN_HEIGHT&&N.fill(S,null),S}static findGuardPattern(c,h,m,g,x,w,S){N.fillWithin(S,0,S.length,0);let R=h,_=0;for(;c.get(R,m)&&R>0&&_++<vt.MAX_PIXEL_DRIFT;)R--;let j=R,U=0,V=w.length;for(let W=x;j<g;j++)if(c.get(j,m)!==W)S[U]++;else{if(U===V-1){if(vt.patternMatchVariance(S,w,vt.MAX_INDIVIDUAL_VARIANCE)<vt.MAX_AVG_VARIANCE)return new Int32Array([R,j]);R+=S[0]+S[1],b.arraycopy(S,2,S,0,U-1),S[U-1]=0,S[U]=0,U--}else U++;S[U]=1,W=!W}return U===V-1&&vt.patternMatchVariance(S,w,vt.MAX_INDIVIDUAL_VARIANCE)<vt.MAX_AVG_VARIANCE?new Int32Array([R,j-1]):null}static patternMatchVariance(c,h,m){let g=c.length,x=0,w=0;for(let _=0;_<g;_++)x+=c[_],w+=h[_];if(x<w)return 1/0;let S=x/w;m*=S;let R=0;for(let _=0;_<g;_++){let j=c[_],U=h[_]*S,V=j>U?j-U:U-j;if(V>m)return 1/0;R+=V}return R/x}}vt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),vt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),vt.MAX_AVG_VARIANCE=.42,vt.MAX_INDIVIDUAL_VARIANCE=.8,vt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),vt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),vt.MAX_PIXEL_DRIFT=3,vt.MAX_PATTERN_DRIFT=5,vt.SKIPPED_ROW_COUNT_MAX=25,vt.ROW_STEP=5,vt.BARCODE_MIN_HEIGHT=10;class mn{constructor(c,h){if(h.length===0)throw new p;this.field=c;let m=h.length;if(m>1&&h[0]===0){let g=1;for(;g<m&&h[g]===0;)g++;g===m?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(m-g),b.arraycopy(h,g,this.coefficients,0,this.coefficients.length))}else this.coefficients=h}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(c){return this.coefficients[this.coefficients.length-1-c]}evaluateAt(c){if(c===0)return this.getCoefficient(0);if(c===1){let g=0;for(let x of this.coefficients)g=this.field.add(g,x);return g}let h=this.coefficients[0],m=this.coefficients.length;for(let g=1;g<m;g++)h=this.field.add(this.field.multiply(c,h),this.coefficients[g]);return h}add(c){if(!this.field.equals(c.field))throw new p("ModulusPolys do not have same ModulusGF field");if(this.isZero())return c;if(c.isZero())return this;let h=this.coefficients,m=c.coefficients;if(h.length>m.length){let w=h;h=m,m=w}let g=new Int32Array(m.length),x=m.length-h.length;b.arraycopy(m,0,g,0,x);for(let w=x;w<m.length;w++)g[w]=this.field.add(h[w-x],m[w]);return new mn(this.field,g)}subtract(c){if(!this.field.equals(c.field))throw new p("ModulusPolys do not have same ModulusGF field");return c.isZero()?this:this.add(c.negative())}multiply(c){return c instanceof mn?this.multiplyOther(c):this.multiplyScalar(c)}multiplyOther(c){if(!this.field.equals(c.field))throw new p("ModulusPolys do not have same ModulusGF field");if(this.isZero()||c.isZero())return new mn(this.field,new Int32Array([0]));let h=this.coefficients,m=h.length,g=c.coefficients,x=g.length,w=new Int32Array(m+x-1);for(let S=0;S<m;S++){let R=h[S];for(let _=0;_<x;_++)w[S+_]=this.field.add(w[S+_],this.field.multiply(R,g[_]))}return new mn(this.field,w)}negative(){let c=this.coefficients.length,h=new Int32Array(c);for(let m=0;m<c;m++)h[m]=this.field.subtract(0,this.coefficients[m]);return new mn(this.field,h)}multiplyScalar(c){if(c===0)return new mn(this.field,new Int32Array([0]));if(c===1)return this;let h=this.coefficients.length,m=new Int32Array(h);for(let g=0;g<h;g++)m[g]=this.field.multiply(this.coefficients[g],c);return new mn(this.field,m)}multiplyByMonomial(c,h){if(c<0)throw new p;if(h===0)return new mn(this.field,new Int32Array([0]));let m=this.coefficients.length,g=new Int32Array(m+c);for(let x=0;x<m;x++)g[x]=this.field.multiply(this.coefficients[x],h);return new mn(this.field,g)}toString(){let c=new ne;for(let h=this.getDegree();h>=0;h--){let m=this.getCoefficient(h);m!==0&&(m<0?(c.append(" - "),m=-m):c.length()>0&&c.append(" + "),(h===0||m!==1)&&c.append(m),h!==0&&(h===1?c.append("x"):(c.append("x^"),c.append(h))))}return c.toString()}}class g8{add(c,h){return(c+h)%this.modulus}subtract(c,h){return(this.modulus+c-h)%this.modulus}exp(c){return this.expTable[c]}log(c){if(c===0)throw new p;return this.logTable[c]}inverse(c){if(c===0)throw new Pe;return this.expTable[this.modulus-this.logTable[c]-1]}multiply(c,h){return c===0||h===0?0:this.expTable[(this.logTable[c]+this.logTable[h])%(this.modulus-1)]}getSize(){return this.modulus}equals(c){return c===this}}class Kg extends g8{constructor(c,h){super(),this.modulus=c,this.expTable=new Int32Array(c),this.logTable=new Int32Array(c);let m=1;for(let g=0;g<c;g++)this.expTable[g]=m,m=m*h%c;for(let g=0;g<c-1;g++)this.logTable[this.expTable[g]]=g;this.zero=new mn(this,new Int32Array([0])),this.one=new mn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(c,h){if(c<0)throw new p;if(h===0)return this.zero;let m=new Int32Array(c+1);return m[0]=h,new mn(this,m)}}Kg.PDF417_GF=new Kg(it.NUMBER_OF_CODEWORDS,3);class x2{constructor(){this.field=Kg.PDF417_GF}decode(c,h,m){let g=new mn(this.field,c),x=new Int32Array(h),w=!1;for(let J=h;J>0;J--){let te=g.evaluateAt(this.field.exp(J));x[h-J]=te,te!==0&&(w=!0)}if(!w)return 0;let S=this.field.getOne();if(m!=null)for(const J of m){let te=this.field.exp(c.length-1-J),de=new mn(this.field,new Int32Array([this.field.subtract(0,te),1]));S=S.multiply(de)}let R=new mn(this.field,x),_=this.runEuclideanAlgorithm(this.field.buildMonomial(h,1),R,h),j=_[0],U=_[1],V=this.findErrorLocations(j),W=this.findErrorMagnitudes(U,j,V);for(let J=0;J<V.length;J++){let te=c.length-1-this.field.log(V[J]);if(te<0)throw v.getChecksumInstance();c[te]=this.field.subtract(c[te],W[J])}return V.length}runEuclideanAlgorithm(c,h,m){if(c.getDegree()<h.getDegree()){let V=c;c=h,h=V}let g=c,x=h,w=this.field.getZero(),S=this.field.getOne();for(;x.getDegree()>=Math.round(m/2);){let V=g,W=w;if(g=x,w=S,g.isZero())throw v.getChecksumInstance();x=V;let J=this.field.getZero(),te=g.getCoefficient(g.getDegree()),de=this.field.inverse(te);for(;x.getDegree()>=g.getDegree()&&!x.isZero();){let xe=x.getDegree()-g.getDegree(),ke=this.field.multiply(x.getCoefficient(x.getDegree()),de);J=J.add(this.field.buildMonomial(xe,ke)),x=x.subtract(g.multiplyByMonomial(xe,ke))}S=J.multiply(w).subtract(W).negative()}let R=S.getCoefficient(0);if(R===0)throw v.getChecksumInstance();let _=this.field.inverse(R),j=S.multiply(_),U=x.multiply(_);return[j,U]}findErrorLocations(c){let h=c.getDegree(),m=new Int32Array(h),g=0;for(let x=1;x<this.field.getSize()&&g<h;x++)c.evaluateAt(x)===0&&(m[g]=this.field.inverse(x),g++);if(g!==h)throw v.getChecksumInstance();return m}findErrorMagnitudes(c,h,m){let g=h.getDegree(),x=new Int32Array(g);for(let _=1;_<=g;_++)x[g-_]=this.field.multiply(_,h.getCoefficient(_));let w=new mn(this.field,x),S=m.length,R=new Int32Array(S);for(let _=0;_<S;_++){let j=this.field.inverse(m[_]),U=this.field.subtract(0,c.evaluateAt(j)),V=this.field.inverse(w.evaluateAt(j));R[_]=this.field.multiply(U,V)}return R}}class rl{constructor(c,h,m,g,x){c instanceof rl?this.constructor_2(c):this.constructor_1(c,h,m,g,x)}constructor_1(c,h,m,g,x){const w=h==null||m==null,S=g==null||x==null;if(w&&S)throw new z;w?(h=new $e(0,g.getY()),m=new $e(0,x.getY())):S&&(g=new $e(c.getWidth()-1,h.getY()),x=new $e(c.getWidth()-1,m.getY())),this.image=c,this.topLeft=h,this.bottomLeft=m,this.topRight=g,this.bottomRight=x,this.minX=Math.trunc(Math.min(h.getX(),m.getX())),this.maxX=Math.trunc(Math.max(g.getX(),x.getX())),this.minY=Math.trunc(Math.min(h.getY(),g.getY())),this.maxY=Math.trunc(Math.max(m.getY(),x.getY()))}constructor_2(c){this.image=c.image,this.topLeft=c.getTopLeft(),this.bottomLeft=c.getBottomLeft(),this.topRight=c.getTopRight(),this.bottomRight=c.getBottomRight(),this.minX=c.getMinX(),this.maxX=c.getMaxX(),this.minY=c.getMinY(),this.maxY=c.getMaxY()}static merge(c,h){return c==null?h:h==null?c:new rl(c.image,c.topLeft,c.bottomLeft,h.topRight,h.bottomRight)}addMissingRows(c,h,m){let g=this.topLeft,x=this.bottomLeft,w=this.topRight,S=this.bottomRight;if(c>0){let R=m?this.topLeft:this.topRight,_=Math.trunc(R.getY()-c);_<0&&(_=0);let j=new $e(R.getX(),_);m?g=j:w=j}if(h>0){let R=m?this.bottomLeft:this.bottomRight,_=Math.trunc(R.getY()+h);_>=this.image.getHeight()&&(_=this.image.getHeight()-1);let j=new $e(R.getX(),_);m?x=j:S=j}return new rl(this.image,g,x,w,S)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class x8{constructor(c,h,m,g){this.columnCount=c,this.errorCorrectionLevel=g,this.rowCountUpperPart=h,this.rowCountLowerPart=m,this.rowCount=h+m}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class ld{constructor(){this.buffer=""}static form(c,h){let m=-1;function g(w,S,R,_,j,U){if(w==="%%")return"%";if(h[++m]===void 0)return;w=_?parseInt(_.substr(1)):void 0;let V=j?parseInt(j.substr(1)):void 0,W;switch(U){case"s":W=h[m];break;case"c":W=h[m][0];break;case"f":W=parseFloat(h[m]).toFixed(w);break;case"p":W=parseFloat(h[m]).toPrecision(w);break;case"e":W=parseFloat(h[m]).toExponential(w);break;case"x":W=parseInt(h[m]).toString(V||16);break;case"d":W=parseFloat(parseInt(h[m],V||10).toPrecision(w)).toFixed(0);break}W=typeof W=="object"?JSON.stringify(W):(+W).toString(V);let J=parseInt(R),te=R&&R[0]+""=="0"?"0":" ";for(;W.length<J;)W=S!==void 0?W+te:te+W;return W}let x=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return c.replace(x,g)}format(c,...h){this.buffer+=ld.form(c,h)}toString(){return this.buffer}}class cd{constructor(c){this.boundingBox=new rl(c),this.codewords=new Array(c.getMaxY()-c.getMinY()+1)}getCodewordNearby(c){let h=this.getCodeword(c);if(h!=null)return h;for(let m=1;m<cd.MAX_NEARBY_DISTANCE;m++){let g=this.imageRowToCodewordIndex(c)-m;if(g>=0&&(h=this.codewords[g],h!=null)||(g=this.imageRowToCodewordIndex(c)+m,g<this.codewords.length&&(h=this.codewords[g],h!=null)))return h}return null}imageRowToCodewordIndex(c){return c-this.boundingBox.getMinY()}setCodeword(c,h){this.codewords[this.imageRowToCodewordIndex(c)]=h}getCodeword(c){return this.codewords[this.imageRowToCodewordIndex(c)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const c=new ld;let h=0;for(const m of this.codewords){if(m==null){c.format("%3d:    |   %n",h++);continue}c.format("%3d: %3d|%3d%n",h++,m.getRowNumber(),m.getValue())}return c.toString()}}cd.MAX_NEARBY_DISTANCE=5;class ud{constructor(){this.values=new Map}setValue(c){c=Math.trunc(c);let h=this.values.get(c);h==null&&(h=0),h++,this.values.set(c,h)}getValue(){let c=-1,h=new Array;for(const[m,g]of this.values.entries()){const x={getKey:()=>m,getValue:()=>g};x.getValue()>c?(c=x.getValue(),h=[],h.push(x.getKey())):x.getValue()===c&&h.push(x.getKey())}return it.toIntArray(h)}getConfidence(c){return this.values.get(c)}}class y2 extends cd{constructor(c,h){super(c),this._isLeft=h}setRowNumbers(){for(let c of this.getCodewords())c!=null&&c.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(c){let h=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(h,c);let m=this.getBoundingBox(),g=this._isLeft?m.getTopLeft():m.getTopRight(),x=this._isLeft?m.getBottomLeft():m.getBottomRight(),w=this.imageRowToCodewordIndex(Math.trunc(g.getY())),S=this.imageRowToCodewordIndex(Math.trunc(x.getY())),R=-1,_=1,j=0;for(let U=w;U<S;U++){if(h[U]==null)continue;let V=h[U],W=V.getRowNumber()-R;if(W===0)j++;else if(W===1)_=Math.max(_,j),j=1,R=V.getRowNumber();else if(W<0||V.getRowNumber()>=c.getRowCount()||W>U)h[U]=null;else{let J;_>2?J=(_-2)*W:J=W;let te=J>=U;for(let de=1;de<=J&&!te;de++)te=h[U-de]!=null;te?h[U]=null:(R=V.getRowNumber(),j=1)}}}getRowHeights(){let c=this.getBarcodeMetadata();if(c==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(c);let h=new Int32Array(c.getRowCount());for(let m of this.getCodewords())if(m!=null){let g=m.getRowNumber();if(g>=h.length)continue;h[g]++}return h}adjustIncompleteIndicatorColumnRowNumbers(c){let h=this.getBoundingBox(),m=this._isLeft?h.getTopLeft():h.getTopRight(),g=this._isLeft?h.getBottomLeft():h.getBottomRight(),x=this.imageRowToCodewordIndex(Math.trunc(m.getY())),w=this.imageRowToCodewordIndex(Math.trunc(g.getY())),S=this.getCodewords(),R=-1;for(let _=x;_<w;_++){if(S[_]==null)continue;let j=S[_];j.setRowNumberAsRowIndicatorColumn();let U=j.getRowNumber()-R;U===0||(U===1?R=j.getRowNumber():j.getRowNumber()>=c.getRowCount()?S[_]=null:R=j.getRowNumber())}}getBarcodeMetadata(){let c=this.getCodewords(),h=new ud,m=new ud,g=new ud,x=new ud;for(let S of c){if(S==null)continue;S.setRowNumberAsRowIndicatorColumn();let R=S.getValue()%30,_=S.getRowNumber();switch(this._isLeft||(_+=2),_%3){case 0:m.setValue(R*3+1);break;case 1:x.setValue(R/3),g.setValue(R%3);break;case 2:h.setValue(R+1);break}}if(h.getValue().length===0||m.getValue().length===0||g.getValue().length===0||x.getValue().length===0||h.getValue()[0]<1||m.getValue()[0]+g.getValue()[0]<it.MIN_ROWS_IN_BARCODE||m.getValue()[0]+g.getValue()[0]>it.MAX_ROWS_IN_BARCODE)return null;let w=new x8(h.getValue()[0],m.getValue()[0],g.getValue()[0],x.getValue()[0]);return this.removeIncorrectCodewords(c,w),w}removeIncorrectCodewords(c,h){for(let m=0;m<c.length;m++){let g=c[m];if(c[m]==null)continue;let x=g.getValue()%30,w=g.getRowNumber();if(w>h.getRowCount()){c[m]=null;continue}switch(this._isLeft||(w+=2),w%3){case 0:x*3+1!==h.getRowCountUpperPart()&&(c[m]=null);break;case 1:(Math.trunc(x/3)!==h.getErrorCorrectionLevel()||x%3!==h.getRowCountLowerPart())&&(c[m]=null);break;case 2:x+1!==h.getColumnCount()&&(c[m]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class dd{constructor(c,h){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=c,this.barcodeColumnCount=c.getColumnCount(),this.boundingBox=h,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let c=it.MAX_CODEWORDS_IN_BARCODE,h;do h=c,c=this.adjustRowNumbersAndGetCount();while(c>0&&c<h);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(c){c!=null&&c.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let c=this.adjustRowNumbersByRow();if(c===0)return 0;for(let h=1;h<this.barcodeColumnCount+1;h++){let m=this.detectionResultColumns[h].getCodewords();for(let g=0;g<m.length;g++)m[g]!=null&&(m[g].hasValidRowNumber()||this.adjustRowNumbers(h,g,m))}return c}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let c=this.detectionResultColumns[0].getCodewords(),h=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let m=0;m<c.length;m++)if(c[m]!=null&&h[m]!=null&&c[m].getRowNumber()===h[m].getRowNumber())for(let g=1;g<=this.barcodeColumnCount;g++){let x=this.detectionResultColumns[g].getCodewords()[m];x!=null&&(x.setRowNumber(c[m].getRowNumber()),x.hasValidRowNumber()||(this.detectionResultColumns[g].getCodewords()[m]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let c=0,h=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let m=0;m<h.length;m++){if(h[m]==null)continue;let g=h[m].getRowNumber(),x=0;for(let w=this.barcodeColumnCount+1;w>0&&x<this.ADJUST_ROW_NUMBER_SKIP;w--){let S=this.detectionResultColumns[w].getCodewords()[m];S!=null&&(x=dd.adjustRowNumberIfValid(g,x,S),S.hasValidRowNumber()||c++)}}return c}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let c=0,h=this.detectionResultColumns[0].getCodewords();for(let m=0;m<h.length;m++){if(h[m]==null)continue;let g=h[m].getRowNumber(),x=0;for(let w=1;w<this.barcodeColumnCount+1&&x<this.ADJUST_ROW_NUMBER_SKIP;w++){let S=this.detectionResultColumns[w].getCodewords()[m];S!=null&&(x=dd.adjustRowNumberIfValid(g,x,S),S.hasValidRowNumber()||c++)}}return c}static adjustRowNumberIfValid(c,h,m){return m==null||m.hasValidRowNumber()||(m.isValidRowNumber(c)?(m.setRowNumber(c),h=0):++h),h}adjustRowNumbers(c,h,m){if(!this.detectionResultColumns[c-1])return;let g=m[h],x=this.detectionResultColumns[c-1].getCodewords(),w=x;this.detectionResultColumns[c+1]!=null&&(w=this.detectionResultColumns[c+1].getCodewords());let S=new Array(14);S[2]=x[h],S[3]=w[h],h>0&&(S[0]=m[h-1],S[4]=x[h-1],S[5]=w[h-1]),h>1&&(S[8]=m[h-2],S[10]=x[h-2],S[11]=w[h-2]),h<m.length-1&&(S[1]=m[h+1],S[6]=x[h+1],S[7]=w[h+1]),h<m.length-2&&(S[9]=m[h+2],S[12]=x[h+2],S[13]=w[h+2]);for(let R of S)if(dd.adjustRowNumber(g,R))return}static adjustRowNumber(c,h){return h==null?!1:h.hasValidRowNumber()&&h.getBucket()===c.getBucket()?(c.setRowNumber(h.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(c){this.boundingBox=c}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(c,h){this.detectionResultColumns[c]=h}getDetectionResultColumn(c){return this.detectionResultColumns[c]}toString(){let c=this.detectionResultColumns[0];c==null&&(c=this.detectionResultColumns[this.barcodeColumnCount+1]);let h=new ld;for(let m=0;m<c.getCodewords().length;m++){h.format("CW %3d:",m);for(let g=0;g<this.barcodeColumnCount+2;g++){if(this.detectionResultColumns[g]==null){h.format("    |   ");continue}let x=this.detectionResultColumns[g].getCodewords()[m];if(x==null){h.format("    |   ");continue}h.format(" %3d|%3d",x.getRowNumber(),x.getValue())}h.format("%n")}return h.toString()}}class hd{constructor(c,h,m,g){this.rowNumber=hd.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(c),this.endX=Math.trunc(h),this.bucket=Math.trunc(m),this.value=Math.trunc(g)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(c){return c!==hd.BARCODE_ROW_UNKNOWN&&this.bucket===c%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(c){this.rowNumber=c}toString(){return this.rowNumber+"|"+this.value}}hd.BARCODE_ROW_UNKNOWN=-1;class Jn{static initialize(){for(let c=0;c<it.SYMBOL_TABLE.length;c++){let h=it.SYMBOL_TABLE[c],m=h&1;for(let g=0;g<it.BARS_IN_MODULE;g++){let x=0;for(;(h&1)===m;)x+=1,h>>=1;m=h&1,Jn.RATIOS_TABLE[c]||(Jn.RATIOS_TABLE[c]=new Array(it.BARS_IN_MODULE)),Jn.RATIOS_TABLE[c][it.BARS_IN_MODULE-g-1]=Math.fround(x/it.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(c){let h=Jn.getDecodedCodewordValue(Jn.sampleBitCounts(c));return h!==-1?h:Jn.getClosestDecodedValue(c)}static sampleBitCounts(c){let h=at.sum(c),m=new Int32Array(it.BARS_IN_MODULE),g=0,x=0;for(let w=0;w<it.MODULES_IN_CODEWORD;w++){let S=h/(2*it.MODULES_IN_CODEWORD)+w*h/it.MODULES_IN_CODEWORD;x+c[g]<=S&&(x+=c[g],g++),m[g]++}return m}static getDecodedCodewordValue(c){let h=Jn.getBitValue(c);return it.getCodeword(h)===-1?-1:h}static getBitValue(c){let h=0;for(let m=0;m<c.length;m++)for(let g=0;g<c[m];g++)h=h<<1|(m%2===0?1:0);return Math.trunc(h)}static getClosestDecodedValue(c){let h=at.sum(c),m=new Array(it.BARS_IN_MODULE);if(h>1)for(let w=0;w<m.length;w++)m[w]=Math.fround(c[w]/h);let g=Wr.MAX_VALUE,x=-1;this.bSymbolTableReady||Jn.initialize();for(let w=0;w<Jn.RATIOS_TABLE.length;w++){let S=0,R=Jn.RATIOS_TABLE[w];for(let _=0;_<it.BARS_IN_MODULE;_++){let j=Math.fround(R[_]-m[_]);if(S+=Math.fround(j*j),S>=g)break}S<g&&(g=S,x=it.SYMBOL_TABLE[w])}return x}}Jn.bSymbolTableReady=!1,Jn.RATIOS_TABLE=new Array(it.SYMBOL_TABLE.length).map(B=>new Array(it.BARS_IN_MODULE));class v2{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(c){this.segmentIndex=c}getFileId(){return this.fileId}setFileId(c){this.fileId=c}getOptionalData(){return this.optionalData}setOptionalData(c){this.optionalData=c}isLastSegment(){return this.lastSegment}setLastSegment(c){this.lastSegment=c}getSegmentCount(){return this.segmentCount}setSegmentCount(c){this.segmentCount=c}getSender(){return this.sender||null}setSender(c){this.sender=c}getAddressee(){return this.addressee||null}setAddressee(c){this.addressee=c}getFileName(){return this.fileName}setFileName(c){this.fileName=c}getFileSize(){return this.fileSize}setFileSize(c){this.fileSize=c}getChecksum(){return this.checksum}setChecksum(c){this.checksum=c}getTimestamp(){return this.timestamp}setTimestamp(c){this.timestamp=c}}class w2{static parseLong(c,h=void 0){return parseInt(c,h)}}class b2 extends u{}b2.kind="NullPointerException";class y8{writeBytes(c){this.writeBytesOffset(c,0,c.length)}writeBytesOffset(c,h,m){if(c==null)throw new b2;if(h<0||h>c.length||m<0||h+m>c.length||h+m<0)throw new T;if(m===0)return;for(let g=0;g<m;g++)this.write(c[h+g])}flush(){}close(){}}class v8 extends u{}class w8 extends y8{constructor(c=32){if(super(),this.count=0,c<0)throw new p("Negative initial size: "+c);this.buf=new Uint8Array(c)}ensureCapacity(c){c-this.buf.length>0&&this.grow(c)}grow(c){let m=this.buf.length<<1;if(m-c<0&&(m=c),m<0){if(c<0)throw new v8;m=A.MAX_VALUE}this.buf=N.copyOfUint8Array(this.buf,m)}write(c){this.ensureCapacity(this.count+1),this.buf[this.count]=c,this.count+=1}writeBytesOffset(c,h,m){if(h<0||h>c.length||m<0||h+m-c.length>0)throw new T;this.ensureCapacity(this.count+m),b.arraycopy(c,h,this.buf,this.count,m),this.count+=m}writeTo(c){c.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return N.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(c){return c?typeof c=="string"?this.toString_string(c):this.toString_number(c):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(c){return new String(this.buf).toString()}toString_number(c){return new String(this.buf).toString()}close(){}}var Ht;(function(B){B[B.ALPHA=0]="ALPHA",B[B.LOWER=1]="LOWER",B[B.MIXED=2]="MIXED",B[B.PUNCT=3]="PUNCT",B[B.ALPHA_SHIFT=4]="ALPHA_SHIFT",B[B.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Ht||(Ht={}));function E2(){if(typeof window<"u")return window.BigInt||null;if(typeof pd<"u")return pd.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let Df;function za(B){if(typeof Df>"u"&&(Df=E2()),Df===null)throw new Error("BigInt is not supported!");return Df(B)}function b8(){let B=[];B[0]=za(1);let c=za(900);B[1]=c;for(let h=2;h<16;h++)B[h]=B[h-1]*c;return B}class pe{static decode(c,h){let m=new ne(""),g=F.ISO8859_1;m.enableDecoding(g);let x=1,w=c[x++],S=new v2;for(;x<c[0];){switch(w){case pe.TEXT_COMPACTION_MODE_LATCH:x=pe.textCompaction(c,x,m);break;case pe.BYTE_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH_6:x=pe.byteCompaction(w,c,g,x,m);break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:m.append(c[x++]);break;case pe.NUMERIC_COMPACTION_MODE_LATCH:x=pe.numericCompaction(c,x,m);break;case pe.ECI_CHARSET:F.getCharacterSetECIByValue(c[x++]);break;case pe.ECI_GENERAL_PURPOSE:x+=2;break;case pe.ECI_USER_DEFINED:x++;break;case pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:x=pe.decodeMacroBlock(c,x,S);break;case pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pe.MACRO_PDF417_TERMINATOR:throw new D;default:x--,x=pe.textCompaction(c,x,m);break}if(x<c.length)w=c[x++];else throw D.getFormatInstance()}if(m.length()===0)throw D.getFormatInstance();let R=new _e(null,m.toString(),null,h);return R.setOther(S),R}static decodeMacroBlock(c,h,m){if(h+pe.NUMBER_OF_SEQUENCE_CODEWORDS>c[0])throw D.getFormatInstance();let g=new Int32Array(pe.NUMBER_OF_SEQUENCE_CODEWORDS);for(let S=0;S<pe.NUMBER_OF_SEQUENCE_CODEWORDS;S++,h++)g[S]=c[h];m.setSegmentIndex(A.parseInt(pe.decodeBase900toBase10(g,pe.NUMBER_OF_SEQUENCE_CODEWORDS)));let x=new ne;h=pe.textCompaction(c,h,x),m.setFileId(x.toString());let w=-1;for(c[h]===pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(w=h+1);h<c[0];)switch(c[h]){case pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(h++,c[h]){case pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let S=new ne;h=pe.textCompaction(c,h+1,S),m.setFileName(S.toString());break;case pe.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let R=new ne;h=pe.textCompaction(c,h+1,R),m.setSender(R.toString());break;case pe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let _=new ne;h=pe.textCompaction(c,h+1,_),m.setAddressee(_.toString());break;case pe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let j=new ne;h=pe.numericCompaction(c,h+1,j),m.setSegmentCount(A.parseInt(j.toString()));break;case pe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let U=new ne;h=pe.numericCompaction(c,h+1,U),m.setTimestamp(w2.parseLong(U.toString()));break;case pe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let V=new ne;h=pe.numericCompaction(c,h+1,V),m.setChecksum(A.parseInt(V.toString()));break;case pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let W=new ne;h=pe.numericCompaction(c,h+1,W),m.setFileSize(w2.parseLong(W.toString()));break;default:throw D.getFormatInstance()}break;case pe.MACRO_PDF417_TERMINATOR:h++,m.setLastSegment(!0);break;default:throw D.getFormatInstance()}if(w!==-1){let S=h-w;m.isLastSegment()&&S--,m.setOptionalData(N.copyOfRange(c,w,w+S))}return h}static textCompaction(c,h,m){let g=new Int32Array((c[0]-h)*2),x=new Int32Array((c[0]-h)*2),w=0,S=!1;for(;h<c[0]&&!S;){let R=c[h++];if(R<pe.TEXT_COMPACTION_MODE_LATCH)g[w]=R/30,g[w+1]=R%30,w+=2;else switch(R){case pe.TEXT_COMPACTION_MODE_LATCH:g[w++]=pe.TEXT_COMPACTION_MODE_LATCH;break;case pe.BYTE_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH_6:case pe.NUMERIC_COMPACTION_MODE_LATCH:case pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pe.MACRO_PDF417_TERMINATOR:h--,S=!0;break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g[w]=pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,R=c[h++],x[w]=R,w++;break}}return pe.decodeTextCompaction(g,x,w,m),h}static decodeTextCompaction(c,h,m,g){let x=Ht.ALPHA,w=Ht.ALPHA,S=0;for(;S<m;){let R=c[S],_="";switch(x){case Ht.ALPHA:if(R<26)_=String.fromCharCode(65+R);else switch(R){case 26:_=" ";break;case pe.LL:x=Ht.LOWER;break;case pe.ML:x=Ht.MIXED;break;case pe.PS:w=x,x=Ht.PUNCT_SHIFT;break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(h[S]);break;case pe.TEXT_COMPACTION_MODE_LATCH:x=Ht.ALPHA;break}break;case Ht.LOWER:if(R<26)_=String.fromCharCode(97+R);else switch(R){case 26:_=" ";break;case pe.AS:w=x,x=Ht.ALPHA_SHIFT;break;case pe.ML:x=Ht.MIXED;break;case pe.PS:w=x,x=Ht.PUNCT_SHIFT;break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(h[S]);break;case pe.TEXT_COMPACTION_MODE_LATCH:x=Ht.ALPHA;break}break;case Ht.MIXED:if(R<pe.PL)_=pe.MIXED_CHARS[R];else switch(R){case pe.PL:x=Ht.PUNCT;break;case 26:_=" ";break;case pe.LL:x=Ht.LOWER;break;case pe.AL:x=Ht.ALPHA;break;case pe.PS:w=x,x=Ht.PUNCT_SHIFT;break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(h[S]);break;case pe.TEXT_COMPACTION_MODE_LATCH:x=Ht.ALPHA;break}break;case Ht.PUNCT:if(R<pe.PAL)_=pe.PUNCT_CHARS[R];else switch(R){case pe.PAL:x=Ht.ALPHA;break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(h[S]);break;case pe.TEXT_COMPACTION_MODE_LATCH:x=Ht.ALPHA;break}break;case Ht.ALPHA_SHIFT:if(x=w,R<26)_=String.fromCharCode(65+R);else switch(R){case 26:_=" ";break;case pe.TEXT_COMPACTION_MODE_LATCH:x=Ht.ALPHA;break}break;case Ht.PUNCT_SHIFT:if(x=w,R<pe.PAL)_=pe.PUNCT_CHARS[R];else switch(R){case pe.PAL:x=Ht.ALPHA;break;case pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:g.append(h[S]);break;case pe.TEXT_COMPACTION_MODE_LATCH:x=Ht.ALPHA;break}break}_!==""&&g.append(_),S++}}static byteCompaction(c,h,m,g,x){let w=new w8,S=0,R=0,_=!1;switch(c){case pe.BYTE_COMPACTION_MODE_LATCH:let j=new Int32Array(6),U=h[g++];for(;g<h[0]&&!_;)switch(j[S++]=U,R=900*R+U,U=h[g++],U){case pe.TEXT_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH:case pe.NUMERIC_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH_6:case pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pe.MACRO_PDF417_TERMINATOR:g--,_=!0;break;default:if(S%5===0&&S>0){for(let V=0;V<6;++V)w.write(Number(za(R)>>za(8*(5-V))));R=0,S=0}break}g===h[0]&&U<pe.TEXT_COMPACTION_MODE_LATCH&&(j[S++]=U);for(let V=0;V<S;V++)w.write(j[V]);break;case pe.BYTE_COMPACTION_MODE_LATCH_6:for(;g<h[0]&&!_;){let V=h[g++];if(V<pe.TEXT_COMPACTION_MODE_LATCH)S++,R=900*R+V;else switch(V){case pe.TEXT_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH:case pe.NUMERIC_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH_6:case pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pe.MACRO_PDF417_TERMINATOR:g--,_=!0;break}if(S%5===0&&S>0){for(let W=0;W<6;++W)w.write(Number(za(R)>>za(8*(5-W))));R=0,S=0}}break}return x.append(G.decode(w.toByteArray(),m)),g}static numericCompaction(c,h,m){let g=0,x=!1,w=new Int32Array(pe.MAX_NUMERIC_CODEWORDS);for(;h<c[0]&&!x;){let S=c[h++];if(h===c[0]&&(x=!0),S<pe.TEXT_COMPACTION_MODE_LATCH)w[g]=S,g++;else switch(S){case pe.TEXT_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH:case pe.BYTE_COMPACTION_MODE_LATCH_6:case pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case pe.MACRO_PDF417_TERMINATOR:h--,x=!0;break}(g%pe.MAX_NUMERIC_CODEWORDS===0||S===pe.NUMERIC_COMPACTION_MODE_LATCH||x)&&g>0&&(m.append(pe.decodeBase900toBase10(w,g)),g=0)}return h}static decodeBase900toBase10(c,h){let m=za(0);for(let x=0;x<h;x++)m+=pe.EXP900[h-x-1]*za(c[x]);let g=m.toString();if(g.charAt(0)!=="1")throw new D;return g.substring(1)}}pe.TEXT_COMPACTION_MODE_LATCH=900,pe.BYTE_COMPACTION_MODE_LATCH=901,pe.NUMERIC_COMPACTION_MODE_LATCH=902,pe.BYTE_COMPACTION_MODE_LATCH_6=924,pe.ECI_USER_DEFINED=925,pe.ECI_GENERAL_PURPOSE=926,pe.ECI_CHARSET=927,pe.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,pe.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,pe.MACRO_PDF417_TERMINATOR=922,pe.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,pe.MAX_NUMERIC_CODEWORDS=15,pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,pe.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,pe.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,pe.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,pe.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,pe.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,pe.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,pe.PL=25,pe.LL=27,pe.AS=27,pe.ML=28,pe.AL=28,pe.PS=29,pe.PAL=29,pe.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,pe.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",pe.EXP900=E2()?b8():[],pe.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Et{constructor(){}static decode(c,h,m,g,x,w,S){let R=new rl(c,h,m,g,x),_=null,j=null,U;for(let J=!0;;J=!1){if(h!=null&&(_=Et.getRowIndicatorColumn(c,R,h,!0,w,S)),g!=null&&(j=Et.getRowIndicatorColumn(c,R,g,!1,w,S)),U=Et.merge(_,j),U==null)throw z.getNotFoundInstance();let te=U.getBoundingBox();if(J&&te!=null&&(te.getMinY()<R.getMinY()||te.getMaxY()>R.getMaxY()))R=te;else break}U.setBoundingBox(R);let V=U.getBarcodeColumnCount()+1;U.setDetectionResultColumn(0,_),U.setDetectionResultColumn(V,j);let W=_!=null;for(let J=1;J<=V;J++){let te=W?J:V-J;if(U.getDetectionResultColumn(te)!==void 0)continue;let de;te===0||te===V?de=new y2(R,te===0):de=new cd(R),U.setDetectionResultColumn(te,de);let xe=-1,ke=xe;for(let je=R.getMinY();je<=R.getMaxY();je++){if(xe=Et.getStartColumn(U,te,je,W),xe<0||xe>R.getMaxX()){if(ke===-1)continue;xe=ke}let Ie=Et.detectCodeword(c,R.getMinX(),R.getMaxX(),W,xe,je,w,S);Ie!=null&&(de.setCodeword(je,Ie),ke=xe,w=Math.min(w,Ie.getWidth()),S=Math.max(S,Ie.getWidth()))}}return Et.createDecoderResult(U)}static merge(c,h){if(c==null&&h==null)return null;let m=Et.getBarcodeMetadata(c,h);if(m==null)return null;let g=rl.merge(Et.adjustBoundingBox(c),Et.adjustBoundingBox(h));return new dd(m,g)}static adjustBoundingBox(c){if(c==null)return null;let h=c.getRowHeights();if(h==null)return null;let m=Et.getMax(h),g=0;for(let S of h)if(g+=m-S,S>0)break;let x=c.getCodewords();for(let S=0;g>0&&x[S]==null;S++)g--;let w=0;for(let S=h.length-1;S>=0&&(w+=m-h[S],!(h[S]>0));S--);for(let S=x.length-1;w>0&&x[S]==null;S--)w--;return c.getBoundingBox().addMissingRows(g,w,c.isLeft())}static getMax(c){let h=-1;for(let m of c)h=Math.max(h,m);return h}static getBarcodeMetadata(c,h){let m;if(c==null||(m=c.getBarcodeMetadata())==null)return h==null?null:h.getBarcodeMetadata();let g;return h==null||(g=h.getBarcodeMetadata())==null?m:m.getColumnCount()!==g.getColumnCount()&&m.getErrorCorrectionLevel()!==g.getErrorCorrectionLevel()&&m.getRowCount()!==g.getRowCount()?null:m}static getRowIndicatorColumn(c,h,m,g,x,w){let S=new y2(h,g);for(let R=0;R<2;R++){let _=R===0?1:-1,j=Math.trunc(Math.trunc(m.getX()));for(let U=Math.trunc(Math.trunc(m.getY()));U<=h.getMaxY()&&U>=h.getMinY();U+=_){let V=Et.detectCodeword(c,0,c.getWidth(),g,j,U,x,w);V!=null&&(S.setCodeword(U,V),g?j=V.getStartX():j=V.getEndX())}}return S}static adjustCodewordCount(c,h){let m=h[0][1],g=m.getValue(),x=c.getBarcodeColumnCount()*c.getBarcodeRowCount()-Et.getNumberOfECCodeWords(c.getBarcodeECLevel());if(g.length===0){if(x<1||x>it.MAX_CODEWORDS_IN_BARCODE)throw z.getNotFoundInstance();m.setValue(x)}else g[0]!==x&&m.setValue(x)}static createDecoderResult(c){let h=Et.createBarcodeMatrix(c);Et.adjustCodewordCount(c,h);let m=new Array,g=new Int32Array(c.getBarcodeRowCount()*c.getBarcodeColumnCount()),x=[],w=new Array;for(let R=0;R<c.getBarcodeRowCount();R++)for(let _=0;_<c.getBarcodeColumnCount();_++){let j=h[R][_+1].getValue(),U=R*c.getBarcodeColumnCount()+_;j.length===0?m.push(U):j.length===1?g[U]=j[0]:(w.push(U),x.push(j))}let S=new Array(x.length);for(let R=0;R<S.length;R++)S[R]=x[R];return Et.createDecoderResultFromAmbiguousValues(c.getBarcodeECLevel(),g,it.toIntArray(m),it.toIntArray(w),S)}static createDecoderResultFromAmbiguousValues(c,h,m,g,x){let w=new Int32Array(g.length),S=100;for(;S-- >0;){for(let R=0;R<w.length;R++)h[g[R]]=x[R][w[R]];try{return Et.decodeCodewords(h,c,m)}catch(R){if(!(R instanceof v))throw R}if(w.length===0)throw v.getChecksumInstance();for(let R=0;R<w.length;R++)if(w[R]<x[R].length-1){w[R]++;break}else if(w[R]=0,R===w.length-1)throw v.getChecksumInstance()}throw v.getChecksumInstance()}static createBarcodeMatrix(c){let h=Array.from({length:c.getBarcodeRowCount()},()=>new Array(c.getBarcodeColumnCount()+2));for(let g=0;g<h.length;g++)for(let x=0;x<h[g].length;x++)h[g][x]=new ud;let m=0;for(let g of c.getDetectionResultColumns()){if(g!=null){for(let x of g.getCodewords())if(x!=null){let w=x.getRowNumber();if(w>=0){if(w>=h.length)continue;h[w][m].setValue(x.getValue())}}}m++}return h}static isValidBarcodeColumn(c,h){return h>=0&&h<=c.getBarcodeColumnCount()+1}static getStartColumn(c,h,m,g){let x=g?1:-1,w=null;if(Et.isValidBarcodeColumn(c,h-x)&&(w=c.getDetectionResultColumn(h-x).getCodeword(m)),w!=null)return g?w.getEndX():w.getStartX();if(w=c.getDetectionResultColumn(h).getCodewordNearby(m),w!=null)return g?w.getStartX():w.getEndX();if(Et.isValidBarcodeColumn(c,h-x)&&(w=c.getDetectionResultColumn(h-x).getCodewordNearby(m)),w!=null)return g?w.getEndX():w.getStartX();let S=0;for(;Et.isValidBarcodeColumn(c,h-x);){h-=x;for(let R of c.getDetectionResultColumn(h).getCodewords())if(R!=null)return(g?R.getEndX():R.getStartX())+x*S*(R.getEndX()-R.getStartX());S++}return g?c.getBoundingBox().getMinX():c.getBoundingBox().getMaxX()}static detectCodeword(c,h,m,g,x,w,S,R){x=Et.adjustCodewordStartColumn(c,h,m,g,x,w);let _=Et.getModuleBitCount(c,h,m,g,x,w);if(_==null)return null;let j,U=at.sum(_);if(g)j=x+U;else{for(let J=0;J<_.length/2;J++){let te=_[J];_[J]=_[_.length-1-J],_[_.length-1-J]=te}j=x,x=j-U}if(!Et.checkCodewordSkew(U,S,R))return null;let V=Jn.getDecodedValue(_),W=it.getCodeword(V);return W===-1?null:new hd(x,j,Et.getCodewordBucketNumber(V),W)}static getModuleBitCount(c,h,m,g,x,w){let S=x,R=new Int32Array(8),_=0,j=g?1:-1,U=g;for(;(g?S<m:S>=h)&&_<R.length;)c.get(S,w)===U?(R[_]++,S+=j):(_++,U=!U);return _===R.length||S===(g?m:h)&&_===R.length-1?R:null}static getNumberOfECCodeWords(c){return 2<<c}static adjustCodewordStartColumn(c,h,m,g,x,w){let S=x,R=g?-1:1;for(let _=0;_<2;_++){for(;(g?S>=h:S<m)&&g===c.get(S,w);){if(Math.abs(x-S)>Et.CODEWORD_SKEW_SIZE)return x;S+=R}R=-R,g=!g}return S}static checkCodewordSkew(c,h,m){return h-Et.CODEWORD_SKEW_SIZE<=c&&c<=m+Et.CODEWORD_SKEW_SIZE}static decodeCodewords(c,h,m){if(c.length===0)throw D.getFormatInstance();let g=1<<h+1,x=Et.correctErrors(c,m,g);Et.verifyCodewordCount(c,g);let w=pe.decode(c,""+h);return w.setErrorsCorrected(x),w.setErasures(m.length),w}static correctErrors(c,h,m){if(h!=null&&h.length>m/2+Et.MAX_ERRORS||m<0||m>Et.MAX_EC_CODEWORDS)throw v.getChecksumInstance();return Et.errorCorrection.decode(c,m,h)}static verifyCodewordCount(c,h){if(c.length<4)throw D.getFormatInstance();let m=c[0];if(m>c.length)throw D.getFormatInstance();if(m===0)if(h<c.length)c[0]=c.length-h;else throw D.getFormatInstance()}static getBitCountForCodeword(c){let h=new Int32Array(8),m=0,g=h.length-1;for(;!((c&1)!==m&&(m=c&1,g--,g<0));)h[g]++,c>>=1;return h}static getCodewordBucketNumber(c){return c instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(c):this.getCodewordBucketNumber_number(c)}static getCodewordBucketNumber_number(c){return Et.getCodewordBucketNumber(Et.getBitCountForCodeword(c))}static getCodewordBucketNumber_Int32Array(c){return(c[0]-c[2]+c[4]-c[6]+9)%9}static toString(c){let h=new ld;for(let m=0;m<c.length;m++){h.format("Row %2d: ",m);for(let g=0;g<c[m].length;g++){let x=c[m][g];x.getValue().length===0?h.format("        ",null):h.format("%4d(%2d)",x.getValue()[0],x.getConfidence(x.getValue()[0]))}h.format("%n")}return h.toString()}}Et.CODEWORD_SKEW_SIZE=2,Et.MAX_ERRORS=3,Et.MAX_EC_CODEWORDS=512,Et.errorCorrection=new x2;class pn{decode(c,h=null){let m=pn.decode(c,h,!1);if(m==null||m.length===0||m[0]==null)throw z.getNotFoundInstance();return m[0]}decodeMultiple(c,h=null){try{return pn.decode(c,h,!0)}catch(m){throw m instanceof D||m instanceof v?z.getNotFoundInstance():m}}static decode(c,h,m){const g=new Array,x=vt.detectMultiple(c,h,m);for(const w of x.getPoints()){const S=Et.decode(x.getBits(),w[4],w[5],w[6],w[7],pn.getMinCodewordWidth(w),pn.getMaxCodewordWidth(w)),R=new ie(S.getText(),S.getRawBytes(),void 0,w,oe.PDF_417);R.putMetadata(Le.ERROR_CORRECTION_LEVEL,S.getECLevel());const _=S.getOther();_!=null&&R.putMetadata(Le.PDF417_EXTRA_METADATA,_),g.push(R)}return g.map(w=>w)}static getMaxWidth(c,h){return c==null||h==null?0:Math.trunc(Math.abs(c.getX()-h.getX()))}static getMinWidth(c,h){return c==null||h==null?A.MAX_VALUE:Math.trunc(Math.abs(c.getX()-h.getX()))}static getMaxCodewordWidth(c){return Math.floor(Math.max(Math.max(pn.getMaxWidth(c[0],c[4]),pn.getMaxWidth(c[6],c[2])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN),Math.max(pn.getMaxWidth(c[1],c[5]),pn.getMaxWidth(c[7],c[3])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(c){return Math.floor(Math.min(Math.min(pn.getMinWidth(c[0],c[4]),pn.getMinWidth(c[6],c[2])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN),Math.min(pn.getMinWidth(c[1],c[5]),pn.getMinWidth(c[7],c[3])*it.MODULES_IN_CODEWORD/it.MODULES_IN_STOP_PATTERN)))}reset(){}}class kf extends u{}kf.kind="ReaderException";class S2{constructor(c,h){this.verbose=c===!0,h&&this.setHints(h)}decode(c,h){return h&&this.setHints(h),this.decodeInternal(c)}decodeWithState(c){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(c)}setHints(c){this.hints=c;const h=!n(c)&&c.get(k.TRY_HARDER)===!0,m=n(c)?null:c.get(k.POSSIBLE_FORMATS),g=new Array;if(!n(m)){const x=m.some(w=>w===oe.UPC_A||w===oe.UPC_E||w===oe.EAN_13||w===oe.EAN_8||w===oe.CODABAR||w===oe.CODE_39||w===oe.CODE_93||w===oe.CODE_128||w===oe.ITF||w===oe.RSS_14||w===oe.RSS_EXPANDED);x&&!h&&g.push(new fc(c,this.verbose)),m.includes(oe.QR_CODE)&&g.push(new Ha),m.includes(oe.DATA_MATRIX)&&g.push(new Ga),m.includes(oe.AZTEC)&&g.push(new Fs),m.includes(oe.PDF_417)&&g.push(new pn),x&&h&&g.push(new fc(c,this.verbose))}g.length===0&&(h||g.push(new fc(c,this.verbose)),g.push(new Ha),g.push(new Ga),g.push(new Fs),g.push(new pn),h&&g.push(new fc(c,this.verbose))),this.readers=g}reset(){if(this.readers!==null)for(const c of this.readers)c.reset()}decodeInternal(c){if(this.readers===null)throw new kf("No readers where selected, nothing can be read.");for(const h of this.readers)try{return h.decode(c,this.hints)}catch(m){if(m instanceof kf)continue}throw new z("No MultiFormat Readers were able to detect the code.")}}class E8 extends Ee{constructor(c=null,h=500){const m=new S2;m.setHints(c),super(m,h)}decodeBitmap(c){return this.reader.decodeWithState(c)}}class S8 extends Ee{constructor(c=500){super(new pn,c)}}class T8 extends Ee{constructor(c=500){super(new Ha,c)}}var Yg;(function(B){B[B.ERROR_CORRECTION=0]="ERROR_CORRECTION",B[B.CHARACTER_SET=1]="CHARACTER_SET",B[B.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",B[B.MIN_SIZE=3]="MIN_SIZE",B[B.MAX_SIZE=4]="MAX_SIZE",B[B.MARGIN=5]="MARGIN",B[B.PDF417_COMPACT=6]="PDF417_COMPACT",B[B.PDF417_COMPACTION=7]="PDF417_COMPACTION",B[B.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",B[B.AZTEC_LAYERS=9]="AZTEC_LAYERS",B[B.QR_VERSION=10]="QR_VERSION"})(Yg||(Yg={}));var Xr=Yg;class qg{constructor(c){this.field=c,this.cachedGenerators=[],this.cachedGenerators.push(new Se(c,Int32Array.from([1])))}buildGenerator(c){const h=this.cachedGenerators;if(c>=h.length){let m=h[h.length-1];const g=this.field;for(let x=h.length;x<=c;x++){const w=m.multiply(new Se(g,Int32Array.from([1,g.exp(x-1+g.getGeneratorBase())])));h.push(w),m=w}}return h[c]}encode(c,h){if(h===0)throw new p("No error correction bytes");const m=c.length-h;if(m<=0)throw new p("No data bytes provided");const g=this.buildGenerator(h),x=new Int32Array(m);b.arraycopy(c,0,x,0,m);let w=new Se(this.field,x);w=w.multiplyByMonomial(h,1);const R=w.divide(g)[1].getCoefficients(),_=h-R.length;for(let j=0;j<_;j++)c[m+j]=0;b.arraycopy(R,0,c,m+_,R.length)}}class Er{constructor(){}static applyMaskPenaltyRule1(c){return Er.applyMaskPenaltyRule1Internal(c,!0)+Er.applyMaskPenaltyRule1Internal(c,!1)}static applyMaskPenaltyRule2(c){let h=0;const m=c.getArray(),g=c.getWidth(),x=c.getHeight();for(let w=0;w<x-1;w++){const S=m[w];for(let R=0;R<g-1;R++){const _=S[R];_===S[R+1]&&_===m[w+1][R]&&_===m[w+1][R+1]&&h++}}return Er.N2*h}static applyMaskPenaltyRule3(c){let h=0;const m=c.getArray(),g=c.getWidth(),x=c.getHeight();for(let w=0;w<x;w++)for(let S=0;S<g;S++){const R=m[w];S+6<g&&R[S]===1&&R[S+1]===0&&R[S+2]===1&&R[S+3]===1&&R[S+4]===1&&R[S+5]===0&&R[S+6]===1&&(Er.isWhiteHorizontal(R,S-4,S)||Er.isWhiteHorizontal(R,S+7,S+11))&&h++,w+6<x&&m[w][S]===1&&m[w+1][S]===0&&m[w+2][S]===1&&m[w+3][S]===1&&m[w+4][S]===1&&m[w+5][S]===0&&m[w+6][S]===1&&(Er.isWhiteVertical(m,S,w-4,w)||Er.isWhiteVertical(m,S,w+7,w+11))&&h++}return h*Er.N3}static isWhiteHorizontal(c,h,m){h=Math.max(h,0),m=Math.min(m,c.length);for(let g=h;g<m;g++)if(c[g]===1)return!1;return!0}static isWhiteVertical(c,h,m,g){m=Math.max(m,0),g=Math.min(g,c.length);for(let x=m;x<g;x++)if(c[x][h]===1)return!1;return!0}static applyMaskPenaltyRule4(c){let h=0;const m=c.getArray(),g=c.getWidth(),x=c.getHeight();for(let R=0;R<x;R++){const _=m[R];for(let j=0;j<g;j++)_[j]===1&&h++}const w=c.getHeight()*c.getWidth();return Math.floor(Math.abs(h*2-w)*10/w)*Er.N4}static getDataMaskBit(c,h,m){let g,x;switch(c){case 0:g=m+h&1;break;case 1:g=m&1;break;case 2:g=h%3;break;case 3:g=(m+h)%3;break;case 4:g=Math.floor(m/2)+Math.floor(h/3)&1;break;case 5:x=m*h,g=(x&1)+x%3;break;case 6:x=m*h,g=(x&1)+x%3&1;break;case 7:x=m*h,g=x%3+(m+h&1)&1;break;default:throw new p("Invalid mask pattern: "+c)}return g===0}static applyMaskPenaltyRule1Internal(c,h){let m=0;const g=h?c.getHeight():c.getWidth(),x=h?c.getWidth():c.getHeight(),w=c.getArray();for(let S=0;S<g;S++){let R=0,_=-1;for(let j=0;j<x;j++){const U=h?w[S][j]:w[j][S];U===_?R++:(R>=5&&(m+=Er.N1+(R-5)),R=1,_=U)}R>=5&&(m+=Er.N1+(R-5))}return m}}Er.N1=3,Er.N2=3,Er.N3=40,Er.N4=10;class jf{constructor(c,h){this.width=c,this.height=h;const m=new Array(h);for(let g=0;g!==h;g++)m[g]=new Uint8Array(c);this.bytes=m}getHeight(){return this.height}getWidth(){return this.width}get(c,h){return this.bytes[h][c]}getArray(){return this.bytes}setNumber(c,h,m){this.bytes[h][c]=m}setBoolean(c,h,m){this.bytes[h][c]=m?1:0}clear(c){for(const h of this.bytes)N.fill(h,c)}equals(c){if(!(c instanceof jf))return!1;const h=c;if(this.width!==h.width||this.height!==h.height)return!1;for(let m=0,g=this.height;m<g;++m){const x=this.bytes[m],w=h.bytes[m];for(let S=0,R=this.width;S<R;++S)if(x[S]!==w[S])return!1}return!0}toString(){const c=new ne;for(let h=0,m=this.height;h<m;++h){const g=this.bytes[h];for(let x=0,w=this.width;x<w;++x)switch(g[x]){case 0:c.append(" 0");break;case 1:c.append(" 1");break;default:c.append("  ");break}c.append(`
`)}return c.toString()}}class nl{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const c=new ne;return c.append(`<<
`),c.append(" mode: "),c.append(this.mode?this.mode.toString():"null"),c.append(`
 ecLevel: `),c.append(this.ecLevel?this.ecLevel.toString():"null"),c.append(`
 version: `),c.append(this.version?this.version.toString():"null"),c.append(`
 maskPattern: `),c.append(this.maskPattern.toString()),this.matrix?(c.append(`
 matrix:
`),c.append(this.matrix.toString())):c.append(`
 matrix: null
`),c.append(`>>
`),c.toString()}setMode(c){this.mode=c}setECLevel(c){this.ecLevel=c}setVersion(c){this.version=c}setMaskPattern(c){this.maskPattern=c}setMatrix(c){this.matrix=c}static isValidMaskPattern(c){return c>=0&&c<nl.NUM_MASK_PATTERNS}}nl.NUM_MASK_PATTERNS=8;class Wt extends u{}Wt.kind="WriterException";class nt{constructor(){}static clearMatrix(c){c.clear(255)}static buildMatrix(c,h,m,g,x){nt.clearMatrix(x),nt.embedBasicPatterns(m,x),nt.embedTypeInfo(h,g,x),nt.maybeEmbedVersionInfo(m,x),nt.embedDataBits(c,g,x)}static embedBasicPatterns(c,h){nt.embedPositionDetectionPatternsAndSeparators(h),nt.embedDarkDotAtLeftBottomCorner(h),nt.maybeEmbedPositionAdjustmentPatterns(c,h),nt.embedTimingPatterns(h)}static embedTypeInfo(c,h,m){const g=new L;nt.makeTypeInfoBits(c,h,g);for(let x=0,w=g.getSize();x<w;++x){const S=g.get(g.getSize()-1-x),R=nt.TYPE_INFO_COORDINATES[x],_=R[0],j=R[1];if(m.setBoolean(_,j,S),x<8){const U=m.getWidth()-x-1;m.setBoolean(U,8,S)}else{const V=m.getHeight()-7+(x-8);m.setBoolean(8,V,S)}}}static maybeEmbedVersionInfo(c,h){if(c.getVersionNumber()<7)return;const m=new L;nt.makeVersionInfoBits(c,m);let g=6*3-1;for(let x=0;x<6;++x)for(let w=0;w<3;++w){const S=m.get(g);g--,h.setBoolean(x,h.getHeight()-11+w,S),h.setBoolean(h.getHeight()-11+w,x,S)}}static embedDataBits(c,h,m){let g=0,x=-1,w=m.getWidth()-1,S=m.getHeight()-1;for(;w>0;){for(w===6&&(w-=1);S>=0&&S<m.getHeight();){for(let R=0;R<2;++R){const _=w-R;if(!nt.isEmpty(m.get(_,S)))continue;let j;g<c.getSize()?(j=c.get(g),++g):j=!1,h!==255&&Er.getDataMaskBit(h,_,S)&&(j=!j),m.setBoolean(_,S,j)}S+=x}x=-x,S+=x,w-=2}if(g!==c.getSize())throw new Wt("Not all bits consumed: "+g+"/"+c.getSize())}static findMSBSet(c){return 32-A.numberOfLeadingZeros(c)}static calculateBCHCode(c,h){if(h===0)throw new p("0 polynomial");const m=nt.findMSBSet(h);for(c<<=m-1;nt.findMSBSet(c)>=m;)c^=h<<nt.findMSBSet(c)-m;return c}static makeTypeInfoBits(c,h,m){if(!nl.isValidMaskPattern(h))throw new Wt("Invalid mask pattern");const g=c.getBits()<<3|h;m.appendBits(g,5);const x=nt.calculateBCHCode(g,nt.TYPE_INFO_POLY);m.appendBits(x,10);const w=new L;if(w.appendBits(nt.TYPE_INFO_MASK_PATTERN,15),m.xor(w),m.getSize()!==15)throw new Wt("should not happen but we got: "+m.getSize())}static makeVersionInfoBits(c,h){h.appendBits(c.getVersionNumber(),6);const m=nt.calculateBCHCode(c.getVersionNumber(),nt.VERSION_INFO_POLY);if(h.appendBits(m,12),h.getSize()!==18)throw new Wt("should not happen but we got: "+h.getSize())}static isEmpty(c){return c===255}static embedTimingPatterns(c){for(let h=8;h<c.getWidth()-8;++h){const m=(h+1)%2;nt.isEmpty(c.get(h,6))&&c.setNumber(h,6,m),nt.isEmpty(c.get(6,h))&&c.setNumber(6,h,m)}}static embedDarkDotAtLeftBottomCorner(c){if(c.get(8,c.getHeight()-8)===0)throw new Wt;c.setNumber(8,c.getHeight()-8,1)}static embedHorizontalSeparationPattern(c,h,m){for(let g=0;g<8;++g){if(!nt.isEmpty(m.get(c+g,h)))throw new Wt;m.setNumber(c+g,h,0)}}static embedVerticalSeparationPattern(c,h,m){for(let g=0;g<7;++g){if(!nt.isEmpty(m.get(c,h+g)))throw new Wt;m.setNumber(c,h+g,0)}}static embedPositionAdjustmentPattern(c,h,m){for(let g=0;g<5;++g){const x=nt.POSITION_ADJUSTMENT_PATTERN[g];for(let w=0;w<5;++w)m.setNumber(c+w,h+g,x[w])}}static embedPositionDetectionPattern(c,h,m){for(let g=0;g<7;++g){const x=nt.POSITION_DETECTION_PATTERN[g];for(let w=0;w<7;++w)m.setNumber(c+w,h+g,x[w])}}static embedPositionDetectionPatternsAndSeparators(c){const h=nt.POSITION_DETECTION_PATTERN[0].length;nt.embedPositionDetectionPattern(0,0,c),nt.embedPositionDetectionPattern(c.getWidth()-h,0,c),nt.embedPositionDetectionPattern(0,c.getWidth()-h,c);const m=8;nt.embedHorizontalSeparationPattern(0,m-1,c),nt.embedHorizontalSeparationPattern(c.getWidth()-m,m-1,c),nt.embedHorizontalSeparationPattern(0,c.getWidth()-m,c);const g=7;nt.embedVerticalSeparationPattern(g,0,c),nt.embedVerticalSeparationPattern(c.getHeight()-g-1,0,c),nt.embedVerticalSeparationPattern(g,c.getHeight()-g,c)}static maybeEmbedPositionAdjustmentPatterns(c,h){if(c.getVersionNumber()<2)return;const m=c.getVersionNumber()-1,g=nt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[m];for(let x=0,w=g.length;x!==w;x++){const S=g[x];if(S>=0)for(let R=0;R!==w;R++){const _=g[R];_>=0&&nt.isEmpty(h.get(_,S))&&nt.embedPositionAdjustmentPattern(_-2,S-2,h)}}}}nt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),nt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),nt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),nt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),nt.VERSION_INFO_POLY=7973,nt.TYPE_INFO_POLY=1335,nt.TYPE_INFO_MASK_PATTERN=21522;class C8{constructor(c,h){this.dataBytes=c,this.errorCorrectionBytes=h}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class er{constructor(){}static calculateMaskPenalty(c){return Er.applyMaskPenaltyRule1(c)+Er.applyMaskPenaltyRule2(c)+Er.applyMaskPenaltyRule3(c)+Er.applyMaskPenaltyRule4(c)}static encode(c,h,m=null){let g=er.DEFAULT_BYTE_MODE_ENCODING;const x=m!==null&&m.get(Xr.CHARACTER_SET)!==void 0;x&&(g=m.get(Xr.CHARACTER_SET).toString());const w=this.chooseMode(c,g),S=new L;if(w===rt.BYTE&&(x||er.DEFAULT_BYTE_MODE_ENCODING!==g)){const je=F.getCharacterSetECIByName(g);je!==void 0&&this.appendECI(je,S)}this.appendModeInfo(w,S);const R=new L;this.appendBytes(c,w,R,g);let _;if(m!==null&&m.get(Xr.QR_VERSION)!==void 0){const je=Number.parseInt(m.get(Xr.QR_VERSION).toString(),10);_=Ze.getVersionForNumber(je);const Ie=this.calculateBitsNeeded(w,S,R,_);if(!this.willFit(Ie,_,h))throw new Wt("Data too big for requested version")}else _=this.recommendVersion(h,w,S,R);const j=new L;j.appendBitArray(S);const U=w===rt.BYTE?R.getSizeInBytes():c.length;this.appendLengthInfo(U,_,w,j),j.appendBitArray(R);const V=_.getECBlocksForLevel(h),W=_.getTotalCodewords()-V.getTotalECCodewords();this.terminateBits(W,j);const J=this.interleaveWithECBytes(j,_.getTotalCodewords(),W,V.getNumBlocks()),te=new nl;te.setECLevel(h),te.setMode(w),te.setVersion(_);const de=_.getDimensionForVersion(),xe=new jf(de,de),ke=this.chooseMaskPattern(J,h,_,xe);return te.setMaskPattern(ke),nt.buildMatrix(J,h,_,ke,xe),te.setMatrix(xe),te}static recommendVersion(c,h,m,g){const x=this.calculateBitsNeeded(h,m,g,Ze.getVersionForNumber(1)),w=this.chooseVersion(x,c),S=this.calculateBitsNeeded(h,m,g,w);return this.chooseVersion(S,c)}static calculateBitsNeeded(c,h,m,g){return h.getSize()+c.getCharacterCountBits(g)+m.getSize()}static getAlphanumericCode(c){return c<er.ALPHANUMERIC_TABLE.length?er.ALPHANUMERIC_TABLE[c]:-1}static chooseMode(c,h=null){if(F.SJIS.getName()===h&&this.isOnlyDoubleByteKanji(c))return rt.KANJI;let m=!1,g=!1;for(let x=0,w=c.length;x<w;++x){const S=c.charAt(x);if(er.isDigit(S))m=!0;else if(this.getAlphanumericCode(S.charCodeAt(0))!==-1)g=!0;else return rt.BYTE}return g?rt.ALPHANUMERIC:m?rt.NUMERIC:rt.BYTE}static isOnlyDoubleByteKanji(c){let h;try{h=G.encode(c,F.SJIS)}catch{return!1}const m=h.length;if(m%2!==0)return!1;for(let g=0;g<m;g+=2){const x=h[g]&255;if((x<129||x>159)&&(x<224||x>235))return!1}return!0}static chooseMaskPattern(c,h,m,g){let x=Number.MAX_SAFE_INTEGER,w=-1;for(let S=0;S<nl.NUM_MASK_PATTERNS;S++){nt.buildMatrix(c,h,m,S,g);let R=this.calculateMaskPenalty(g);R<x&&(x=R,w=S)}return w}static chooseVersion(c,h){for(let m=1;m<=40;m++){const g=Ze.getVersionForNumber(m);if(er.willFit(c,g,h))return g}throw new Wt("Data too big")}static willFit(c,h,m){const g=h.getTotalCodewords(),w=h.getECBlocksForLevel(m).getTotalECCodewords(),S=g-w,R=(c+7)/8;return S>=R}static terminateBits(c,h){const m=c*8;if(h.getSize()>m)throw new Wt("data bits cannot fit in the QR Code"+h.getSize()+" > "+m);for(let w=0;w<4&&h.getSize()<m;++w)h.appendBit(!1);const g=h.getSize()&7;if(g>0)for(let w=g;w<8;w++)h.appendBit(!1);const x=c-h.getSizeInBytes();for(let w=0;w<x;++w)h.appendBits(w&1?17:236,8);if(h.getSize()!==m)throw new Wt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(c,h,m,g,x,w){if(g>=m)throw new Wt("Block ID too large");const S=c%m,R=m-S,_=Math.floor(c/m),j=_+1,U=Math.floor(h/m),V=U+1,W=_-U,J=j-V;if(W!==J)throw new Wt("EC bytes mismatch");if(m!==R+S)throw new Wt("RS blocks mismatch");if(c!==(U+W)*R+(V+J)*S)throw new Wt("Total bytes mismatch");g<R?(x[0]=U,w[0]=W):(x[0]=V,w[0]=J)}static interleaveWithECBytes(c,h,m,g){if(c.getSizeInBytes()!==m)throw new Wt("Number of bits and data bytes does not match");let x=0,w=0,S=0;const R=new Array;for(let j=0;j<g;++j){const U=new Int32Array(1),V=new Int32Array(1);er.getNumDataBytesAndNumECBytesForBlockID(h,m,g,j,U,V);const W=U[0],J=new Uint8Array(W);c.toBytes(8*x,J,0,W);const te=er.generateECBytes(J,V[0]);R.push(new C8(J,te)),w=Math.max(w,W),S=Math.max(S,te.length),x+=U[0]}if(m!==x)throw new Wt("Data bytes does not match offset");const _=new L;for(let j=0;j<w;++j)for(const U of R){const V=U.getDataBytes();j<V.length&&_.appendBits(V[j],8)}for(let j=0;j<S;++j)for(const U of R){const V=U.getErrorCorrectionBytes();j<V.length&&_.appendBits(V[j],8)}if(h!==_.getSizeInBytes())throw new Wt("Interleaving error: "+h+" and "+_.getSizeInBytes()+" differ.");return _}static generateECBytes(c,h){const m=c.length,g=new Int32Array(m+h);for(let w=0;w<m;w++)g[w]=c[w]&255;new qg(Be.QR_CODE_FIELD_256).encode(g,h);const x=new Uint8Array(h);for(let w=0;w<h;w++)x[w]=g[m+w];return x}static appendModeInfo(c,h){h.appendBits(c.getBits(),4)}static appendLengthInfo(c,h,m,g){const x=m.getCharacterCountBits(h);if(c>=1<<x)throw new Wt(c+" is bigger than "+((1<<x)-1));g.appendBits(c,x)}static appendBytes(c,h,m,g){switch(h){case rt.NUMERIC:er.appendNumericBytes(c,m);break;case rt.ALPHANUMERIC:er.appendAlphanumericBytes(c,m);break;case rt.BYTE:er.append8BitBytes(c,m,g);break;case rt.KANJI:er.appendKanjiBytes(c,m);break;default:throw new Wt("Invalid mode: "+h)}}static getDigit(c){return c.charCodeAt(0)-48}static isDigit(c){const h=er.getDigit(c);return h>=0&&h<=9}static appendNumericBytes(c,h){const m=c.length;let g=0;for(;g<m;){const x=er.getDigit(c.charAt(g));if(g+2<m){const w=er.getDigit(c.charAt(g+1)),S=er.getDigit(c.charAt(g+2));h.appendBits(x*100+w*10+S,10),g+=3}else if(g+1<m){const w=er.getDigit(c.charAt(g+1));h.appendBits(x*10+w,7),g+=2}else h.appendBits(x,4),g++}}static appendAlphanumericBytes(c,h){const m=c.length;let g=0;for(;g<m;){const x=er.getAlphanumericCode(c.charCodeAt(g));if(x===-1)throw new Wt;if(g+1<m){const w=er.getAlphanumericCode(c.charCodeAt(g+1));if(w===-1)throw new Wt;h.appendBits(x*45+w,11),g+=2}else h.appendBits(x,6),g++}}static append8BitBytes(c,h,m){let g;try{g=G.encode(c,m)}catch(x){throw new Wt(x)}for(let x=0,w=g.length;x!==w;x++){const S=g[x];h.appendBits(S,8)}}static appendKanjiBytes(c,h){let m;try{m=G.encode(c,F.SJIS)}catch(x){throw new Wt(x)}const g=m.length;for(let x=0;x<g;x+=2){const w=m[x]&255,S=m[x+1]&255,R=w<<8&4294967295|S;let _=-1;if(R>=33088&&R<=40956?_=R-33088:R>=57408&&R<=60351&&(_=R-49472),_===-1)throw new Wt("Invalid byte sequence");const j=(_>>8)*192+(_&255);h.appendBits(j,13)}}static appendECI(c,h){h.appendBits(rt.ECI.getBits(),4),h.appendBits(c.getValue(),8)}}er.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),er.DEFAULT_BYTE_MODE_ENCODING=F.UTF8.getName();class sl{write(c,h,m,g=null){if(c.length===0)throw new p("Found empty contents");if(h<0||m<0)throw new p("Requested dimensions are too small: "+h+"x"+m);let x=Zt.L,w=sl.QUIET_ZONE_SIZE;g!==null&&(g.get(Xr.ERROR_CORRECTION)!==void 0&&(x=Zt.fromString(g.get(Xr.ERROR_CORRECTION).toString())),g.get(Xr.MARGIN)!==void 0&&(w=Number.parseInt(g.get(Xr.MARGIN).toString(),10)));const S=er.encode(c,x,g);return this.renderResult(S,h,m,w)}writeToDom(c,h,m,g,x=null){typeof c=="string"&&(c=document.querySelector(c));const w=this.write(h,m,g,x);c&&c.appendChild(w)}renderResult(c,h,m,g){const x=c.getMatrix();if(x===null)throw new we;const w=x.getWidth(),S=x.getHeight(),R=w+g*2,_=S+g*2,j=Math.max(h,R),U=Math.max(m,_),V=Math.min(Math.floor(j/R),Math.floor(U/_)),W=Math.floor((j-w*V)/2),J=Math.floor((U-S*V)/2),te=this.createSVGElement(j,U);for(let de=0,xe=J;de<S;de++,xe+=V)for(let ke=0,je=W;ke<w;ke++,je+=V)if(x.get(ke,de)===1){const Ie=this.createSvgRectElement(je,xe,V,V);te.appendChild(Ie)}return te}createSVGElement(c,h){const m=document.createElementNS(sl.SVG_NS,"svg");return m.setAttributeNS(null,"height",c.toString()),m.setAttributeNS(null,"width",h.toString()),m}createSvgRectElement(c,h,m,g){const x=document.createElementNS(sl.SVG_NS,"rect");return x.setAttributeNS(null,"x",c.toString()),x.setAttributeNS(null,"y",h.toString()),x.setAttributeNS(null,"height",m.toString()),x.setAttributeNS(null,"width",g.toString()),x.setAttributeNS(null,"fill","#000000"),x}}sl.QUIET_ZONE_SIZE=4,sl.SVG_NS="http://www.w3.org/2000/svg";class pc{encode(c,h,m,g,x){if(c.length===0)throw new p("Found empty contents");if(h!==oe.QR_CODE)throw new p("Can only encode QR_CODE, but got "+h);if(m<0||g<0)throw new p(`Requested dimensions are too small: ${m}x${g}`);let w=Zt.L,S=pc.QUIET_ZONE_SIZE;x!==null&&(x.get(Xr.ERROR_CORRECTION)!==void 0&&(w=Zt.fromString(x.get(Xr.ERROR_CORRECTION).toString())),x.get(Xr.MARGIN)!==void 0&&(S=Number.parseInt(x.get(Xr.MARGIN).toString(),10)));const R=er.encode(c,w,x);return pc.renderResult(R,m,g,S)}static renderResult(c,h,m,g){const x=c.getMatrix();if(x===null)throw new we;const w=x.getWidth(),S=x.getHeight(),R=w+g*2,_=S+g*2,j=Math.max(h,R),U=Math.max(m,_),V=Math.min(Math.floor(j/R),Math.floor(U/_)),W=Math.floor((j-w*V)/2),J=Math.floor((U-S*V)/2),te=new X(j,U);for(let de=0,xe=J;de<S;de++,xe+=V)for(let ke=0,je=W;ke<w;ke++,je+=V)x.get(ke,de)===1&&te.setRegion(je,xe,V,V);return te}}pc.QUIET_ZONE_SIZE=4;class A8{encode(c,h,m,g,x){let w;switch(h){case oe.QR_CODE:w=new pc;break;default:throw new p("No encoder available for format "+h)}return w.encode(c,h,m,g,x)}}class ki extends q{constructor(c,h,m,g,x,w,S,R){if(super(w,S),this.yuvData=c,this.dataWidth=h,this.dataHeight=m,this.left=g,this.top=x,g+w>h||x+S>m)throw new p("Crop rectangle does not fit within image data.");R&&this.reverseHorizontal(w,S)}getRow(c,h){if(c<0||c>=this.getHeight())throw new p("Requested row is outside the image: "+c);const m=this.getWidth();(h==null||h.length<m)&&(h=new Uint8ClampedArray(m));const g=(c+this.top)*this.dataWidth+this.left;return b.arraycopy(this.yuvData,g,h,0,m),h}getMatrix(){const c=this.getWidth(),h=this.getHeight();if(c===this.dataWidth&&h===this.dataHeight)return this.yuvData;const m=c*h,g=new Uint8ClampedArray(m);let x=this.top*this.dataWidth+this.left;if(c===this.dataWidth)return b.arraycopy(this.yuvData,x,g,0,m),g;for(let w=0;w<h;w++){const S=w*c;b.arraycopy(this.yuvData,x,g,S,c),x+=this.dataWidth}return g}isCropSupported(){return!0}crop(c,h,m,g){return new ki(this.yuvData,this.dataWidth,this.dataHeight,this.left+c,this.top+h,m,g,!1)}renderThumbnail(){const c=this.getWidth()/ki.THUMBNAIL_SCALE_FACTOR,h=this.getHeight()/ki.THUMBNAIL_SCALE_FACTOR,m=new Int32Array(c*h),g=this.yuvData;let x=this.top*this.dataWidth+this.left;for(let w=0;w<h;w++){const S=w*c;for(let R=0;R<c;R++){const _=g[x+R*ki.THUMBNAIL_SCALE_FACTOR]&255;m[S+R]=4278190080|_*65793}x+=this.dataWidth*ki.THUMBNAIL_SCALE_FACTOR}return m}getThumbnailWidth(){return this.getWidth()/ki.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/ki.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(c,h){const m=this.yuvData;for(let g=0,x=this.top*this.dataWidth+this.left;g<h;g++,x+=this.dataWidth){const w=x+c/2;for(let S=x,R=x+c-1;S<w;S++,R--){const _=m[S];m[S]=m[R],m[R]=_}}}invert(){return new K(this)}}ki.THUMBNAIL_SCALE_FACTOR=2;class Xg extends q{constructor(c,h,m,g,x,w,S){if(super(h,m),this.dataWidth=g,this.dataHeight=x,this.left=w,this.top=S,c.BYTES_PER_ELEMENT===4){const R=h*m,_=new Uint8ClampedArray(R);for(let j=0;j<R;j++){const U=c[j],V=U>>16&255,W=U>>7&510,J=U&255;_[j]=(V+W+J)/4&255}this.luminances=_}else this.luminances=c;if(g===void 0&&(this.dataWidth=h),x===void 0&&(this.dataHeight=m),w===void 0&&(this.left=0),S===void 0&&(this.top=0),this.left+h>this.dataWidth||this.top+m>this.dataHeight)throw new p("Crop rectangle does not fit within image data.")}getRow(c,h){if(c<0||c>=this.getHeight())throw new p("Requested row is outside the image: "+c);const m=this.getWidth();(h==null||h.length<m)&&(h=new Uint8ClampedArray(m));const g=(c+this.top)*this.dataWidth+this.left;return b.arraycopy(this.luminances,g,h,0,m),h}getMatrix(){const c=this.getWidth(),h=this.getHeight();if(c===this.dataWidth&&h===this.dataHeight)return this.luminances;const m=c*h,g=new Uint8ClampedArray(m);let x=this.top*this.dataWidth+this.left;if(c===this.dataWidth)return b.arraycopy(this.luminances,x,g,0,m),g;for(let w=0;w<h;w++){const S=w*c;b.arraycopy(this.luminances,x,g,S,c),x+=this.dataWidth}return g}isCropSupported(){return!0}crop(c,h,m,g){return new Xg(this.luminances,m,g,this.dataWidth,this.dataHeight,this.left+c,this.top+h)}invert(){return new K(this)}}class T2 extends F{static forName(c){return this.getCharacterSetECIByName(c)}}class Qg{}Qg.ISO_8859_1=F.ISO8859_1;class C2{isCompact(){return this.compact}setCompact(c){this.compact=c}getSize(){return this.size}setSize(c){this.size=c}getLayers(){return this.layers}setLayers(c){this.layers=c}getCodeWords(){return this.codeWords}setCodeWords(c){this.codeWords=c}getMatrix(){return this.matrix}setMatrix(c){this.matrix=c}}class A2{static singletonList(c){return[c]}static min(c,h){return c.sort(h)[0]}}class N8{constructor(c){this.previous=c}getPrevious(){return this.previous}}class gc extends N8{constructor(c,h,m){super(c),this.value=h,this.bitCount=m}appendTo(c,h){c.appendBits(this.value,this.bitCount)}add(c,h){return new gc(this,c,h)}addBinaryShift(c,h){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new gc(this,c,h)}toString(){let c=this.value&(1<<this.bitCount)-1;return c|=1<<this.bitCount,"<"+A.toBinaryString(c|1<<this.bitCount).substring(1)+">"}}class Zg extends gc{constructor(c,h,m){super(c,0,0),this.binaryShiftStart=h,this.binaryShiftByteCount=m}appendTo(c,h){for(let m=0;m<this.binaryShiftByteCount;m++)(m===0||m===31&&this.binaryShiftByteCount<=62)&&(c.appendBits(31,5),this.binaryShiftByteCount>62?c.appendBits(this.binaryShiftByteCount-31,16):m===0?c.appendBits(Math.min(this.binaryShiftByteCount,31),5):c.appendBits(this.binaryShiftByteCount-31,5)),c.appendBits(h[this.binaryShiftStart+m],8)}addBinaryShift(c,h){return new Zg(this,c,h)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function I8(B,c,h){return new Zg(B,c,h)}function fd(B,c,h){return new gc(B,c,h)}const R8=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Wa=0,Mf=1,Gs=2,N2=3,ji=4,_8=new gc(null,0,0),Jg=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function L8(B){for(let c of B)N.fill(c,-1);return B[Wa][ji]=0,B[Mf][ji]=0,B[Mf][Wa]=28,B[N2][ji]=0,B[Gs][ji]=0,B[Gs][Wa]=15,B}const I2=L8(N.createInt32Array(6,6));class Mi{constructor(c,h,m,g){this.token=c,this.mode=h,this.binaryShiftByteCount=m,this.bitCount=g}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(c,h){let m=this.bitCount,g=this.token;if(c!==this.mode){let w=Jg[this.mode][c];g=fd(g,w&65535,w>>16),m+=w>>16}let x=c===Gs?4:5;return g=fd(g,h,x),new Mi(g,c,0,m+x)}shiftAndAppend(c,h){let m=this.token,g=this.mode===Gs?4:5;return m=fd(m,I2[this.mode][c],g),m=fd(m,h,5),new Mi(m,this.mode,0,this.bitCount+g+5)}addBinaryShiftChar(c){let h=this.token,m=this.mode,g=this.bitCount;if(this.mode===ji||this.mode===Gs){let S=Jg[m][Wa];h=fd(h,S&65535,S>>16),g+=S>>16,m=Wa}let x=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,w=new Mi(h,m,this.binaryShiftByteCount+1,g+x);return w.binaryShiftByteCount===2078&&(w=w.endBinaryShift(c+1)),w}endBinaryShift(c){if(this.binaryShiftByteCount===0)return this;let h=this.token;return h=I8(h,c-this.binaryShiftByteCount,this.binaryShiftByteCount),new Mi(h,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(c){let h=this.bitCount+(Jg[this.mode][c.mode]>>16);return this.binaryShiftByteCount<c.binaryShiftByteCount?h+=Mi.calculateBinaryShiftCost(c)-Mi.calculateBinaryShiftCost(this):this.binaryShiftByteCount>c.binaryShiftByteCount&&c.binaryShiftByteCount>0&&(h+=10),h<=c.bitCount}toBitArray(c){let h=[];for(let g=this.endBinaryShift(c.length).token;g!==null;g=g.getPrevious())h.unshift(g);let m=new L;for(const g of h)g.appendTo(m,c);return m}toString(){return Y.format("%s bits=%d bytes=%d",R8[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(c){return c.binaryShiftByteCount>62?21:c.binaryShiftByteCount>31?20:c.binaryShiftByteCount>0?10:0}}Mi.INITIAL_STATE=new Mi(_8,Wa,0,0);function P8(B){const c=Y.getCharCode(" "),h=Y.getCharCode("."),m=Y.getCharCode(",");B[Wa][c]=1;const g=Y.getCharCode("Z"),x=Y.getCharCode("A");for(let V=x;V<=g;V++)B[Wa][V]=V-x+2;B[Mf][c]=1;const w=Y.getCharCode("z"),S=Y.getCharCode("a");for(let V=S;V<=w;V++)B[Mf][V]=V-S+2;B[Gs][c]=1;const R=Y.getCharCode("9"),_=Y.getCharCode("0");for(let V=_;V<=R;V++)B[Gs][V]=V-_+2;B[Gs][m]=12,B[Gs][h]=13;const j=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let V=0;V<j.length;V++)B[N2][Y.getCharCode(j[V])]=V;const U=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let V=0;V<U.length;V++)Y.getCharCode(U[V])>0&&(B[ji][Y.getCharCode(U[V])]=V);return B}const ex=P8(N.createInt32Array(5,256));class md{constructor(c){this.text=c}encode(){const c=Y.getCharCode(" "),h=Y.getCharCode(`
`);let m=A2.singletonList(Mi.INITIAL_STATE);for(let x=0;x<this.text.length;x++){let w,S=x+1<this.text.length?this.text[x+1]:0;switch(this.text[x]){case Y.getCharCode("\r"):w=S===h?2:0;break;case Y.getCharCode("."):w=S===c?3:0;break;case Y.getCharCode(","):w=S===c?4:0;break;case Y.getCharCode(":"):w=S===c?5:0;break;default:w=0}w>0?(m=md.updateStateListForPair(m,x,w),x++):m=this.updateStateListForChar(m,x)}return A2.min(m,(x,w)=>x.getBitCount()-w.getBitCount()).toBitArray(this.text)}updateStateListForChar(c,h){const m=[];for(let g of c)this.updateStateForChar(g,h,m);return md.simplifyStates(m)}updateStateForChar(c,h,m){let g=this.text[h]&255,x=ex[c.getMode()][g]>0,w=null;for(let S=0;S<=ji;S++){let R=ex[S][g];if(R>0){if(w==null&&(w=c.endBinaryShift(h)),!x||S===c.getMode()||S===Gs){const _=w.latchAndAppend(S,R);m.push(_)}if(!x&&I2[c.getMode()][S]>=0){const _=w.shiftAndAppend(S,R);m.push(_)}}}if(c.getBinaryShiftByteCount()>0||ex[c.getMode()][g]===0){let S=c.addBinaryShiftChar(h);m.push(S)}}static updateStateListForPair(c,h,m){const g=[];for(let x of c)this.updateStateForPair(x,h,m,g);return this.simplifyStates(g)}static updateStateForPair(c,h,m,g){let x=c.endBinaryShift(h);if(g.push(x.latchAndAppend(ji,m)),c.getMode()!==ji&&g.push(x.shiftAndAppend(ji,m)),m===3||m===4){let w=x.latchAndAppend(Gs,16-m).latchAndAppend(Gs,1);g.push(w)}if(c.getBinaryShiftByteCount()>0){let w=c.addBinaryShiftChar(h).addBinaryShiftChar(h+1);g.push(w)}}static simplifyStates(c){let h=[];for(const m of c){let g=!0;for(const x of h){if(x.isBetterThanOrEqualTo(m)){g=!1;break}m.isBetterThanOrEqualTo(x)&&(h=h.filter(w=>w!==x))}g&&h.push(m)}return h}}class Dt{constructor(){}static encodeBytes(c){return Dt.encode(c,Dt.DEFAULT_EC_PERCENT,Dt.DEFAULT_AZTEC_LAYERS)}static encode(c,h,m){let g=new md(c).encode(),x=A.truncDivision(g.getSize()*h,100)+11,w=g.getSize()+x,S,R,_,j,U;if(m!==Dt.DEFAULT_AZTEC_LAYERS){if(S=m<0,R=Math.abs(m),R>(S?Dt.MAX_NB_BITS_COMPACT:Dt.MAX_NB_BITS))throw new p(Y.format("Illegal value %s for layers",m));_=Dt.totalBitsInLayer(R,S),j=Dt.WORD_SIZE[R];let Ie=_-_%j;if(U=Dt.stuffBits(g,j),U.getSize()+x>Ie)throw new p("Data to large for user specified layer");if(S&&U.getSize()>j*64)throw new p("Data to large for user specified layer")}else{j=0,U=null;for(let Ie=0;;Ie++){if(Ie>Dt.MAX_NB_BITS)throw new p("Data too large for an Aztec code");if(S=Ie<=3,R=S?Ie+1:Ie,_=Dt.totalBitsInLayer(R,S),w>_)continue;(U==null||j!==Dt.WORD_SIZE[R])&&(j=Dt.WORD_SIZE[R],U=Dt.stuffBits(g,j));let Nt=_-_%j;if(!(S&&U.getSize()>j*64)&&U.getSize()+x<=Nt)break}}let V=Dt.generateCheckWords(U,_,j),W=U.getSize()/j,J=Dt.generateModeMessage(S,R,W),te=(S?11:14)+R*4,de=new Int32Array(te),xe;if(S){xe=te;for(let Ie=0;Ie<de.length;Ie++)de[Ie]=Ie}else{xe=te+1+2*A.truncDivision(A.truncDivision(te,2)-1,15);let Ie=A.truncDivision(te,2),Nt=A.truncDivision(xe,2);for(let mt=0;mt<Ie;mt++){let es=mt+A.truncDivision(mt,15);de[Ie-mt-1]=Nt-es-1,de[Ie+mt]=Nt+es+1}}let ke=new X(xe);for(let Ie=0,Nt=0;Ie<R;Ie++){let mt=(R-Ie)*4+(S?9:12);for(let es=0;es<mt;es++){let li=es*2;for(let ts=0;ts<2;ts++)V.get(Nt+li+ts)&&ke.set(de[Ie*2+ts],de[Ie*2+es]),V.get(Nt+mt*2+li+ts)&&ke.set(de[Ie*2+es],de[te-1-Ie*2-ts]),V.get(Nt+mt*4+li+ts)&&ke.set(de[te-1-Ie*2-ts],de[te-1-Ie*2-es]),V.get(Nt+mt*6+li+ts)&&ke.set(de[te-1-Ie*2-es],de[Ie*2+ts])}Nt+=mt*8}if(Dt.drawModeMessage(ke,S,xe,J),S)Dt.drawBullsEye(ke,A.truncDivision(xe,2),5);else{Dt.drawBullsEye(ke,A.truncDivision(xe,2),7);for(let Ie=0,Nt=0;Ie<A.truncDivision(te,2)-1;Ie+=15,Nt+=16)for(let mt=A.truncDivision(xe,2)&1;mt<xe;mt+=2)ke.set(A.truncDivision(xe,2)-Nt,mt),ke.set(A.truncDivision(xe,2)+Nt,mt),ke.set(mt,A.truncDivision(xe,2)-Nt),ke.set(mt,A.truncDivision(xe,2)+Nt)}let je=new C2;return je.setCompact(S),je.setSize(xe),je.setLayers(R),je.setCodeWords(W),je.setMatrix(ke),je}static drawBullsEye(c,h,m){for(let g=0;g<m;g+=2)for(let x=h-g;x<=h+g;x++)c.set(x,h-g),c.set(x,h+g),c.set(h-g,x),c.set(h+g,x);c.set(h-m,h-m),c.set(h-m+1,h-m),c.set(h-m,h-m+1),c.set(h+m,h-m),c.set(h+m,h-m+1),c.set(h+m,h+m-1)}static generateModeMessage(c,h,m){let g=new L;return c?(g.appendBits(h-1,2),g.appendBits(m-1,6),g=Dt.generateCheckWords(g,28,4)):(g.appendBits(h-1,5),g.appendBits(m-1,11),g=Dt.generateCheckWords(g,40,4)),g}static drawModeMessage(c,h,m,g){let x=A.truncDivision(m,2);if(h)for(let w=0;w<7;w++){let S=x-3+w;g.get(w)&&c.set(S,x-5),g.get(w+7)&&c.set(x+5,S),g.get(20-w)&&c.set(S,x+5),g.get(27-w)&&c.set(x-5,S)}else for(let w=0;w<10;w++){let S=x-5+w+A.truncDivision(w,5);g.get(w)&&c.set(S,x-7),g.get(w+10)&&c.set(x+7,S),g.get(29-w)&&c.set(S,x+7),g.get(39-w)&&c.set(x-7,S)}}static generateCheckWords(c,h,m){let g=c.getSize()/m,x=new qg(Dt.getGF(m)),w=A.truncDivision(h,m),S=Dt.bitsToWords(c,m,w);x.encode(S,w-g);let R=h%m,_=new L;_.appendBits(0,R);for(const j of Array.from(S))_.appendBits(j,m);return _}static bitsToWords(c,h,m){let g=new Int32Array(m),x,w;for(x=0,w=c.getSize()/h;x<w;x++){let S=0;for(let R=0;R<h;R++)S|=c.get(x*h+R)?1<<h-R-1:0;g[x]=S}return g}static getGF(c){switch(c){case 4:return Be.AZTEC_PARAM;case 6:return Be.AZTEC_DATA_6;case 8:return Be.AZTEC_DATA_8;case 10:return Be.AZTEC_DATA_10;case 12:return Be.AZTEC_DATA_12;default:throw new p("Unsupported word size "+c)}}static stuffBits(c,h){let m=new L,g=c.getSize(),x=(1<<h)-2;for(let w=0;w<g;w+=h){let S=0;for(let R=0;R<h;R++)(w+R>=g||c.get(w+R))&&(S|=1<<h-1-R);(S&x)===x?(m.appendBits(S&x,h),w--):S&x?m.appendBits(S,h):(m.appendBits(S|1,h),w--)}return m}static totalBitsInLayer(c,h){return((h?88:112)+16*c)*c}}Dt.DEFAULT_EC_PERCENT=33,Dt.DEFAULT_AZTEC_LAYERS=0,Dt.MAX_NB_BITS=32,Dt.MAX_NB_BITS_COMPACT=4,Dt.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Of{encode(c,h,m,g){return this.encodeWithHints(c,h,m,g,null)}encodeWithHints(c,h,m,g,x){let w=Qg.ISO_8859_1,S=Dt.DEFAULT_EC_PERCENT,R=Dt.DEFAULT_AZTEC_LAYERS;return x!=null&&(x.has(Xr.CHARACTER_SET)&&(w=T2.forName(x.get(Xr.CHARACTER_SET).toString())),x.has(Xr.ERROR_CORRECTION)&&(S=A.parseInt(x.get(Xr.ERROR_CORRECTION).toString())),x.has(Xr.AZTEC_LAYERS)&&(R=A.parseInt(x.get(Xr.AZTEC_LAYERS).toString()))),Of.encodeLayers(c,h,m,g,w,S,R)}static encodeLayers(c,h,m,g,x,w,S){if(h!==oe.AZTEC)throw new p("Can only encode AZTEC, but got "+h);let R=Dt.encode(Y.getBytes(c,x),w,S);return Of.renderResult(R,m,g)}static renderResult(c,h,m){let g=c.getMatrix();if(g==null)throw new we;let x=g.getWidth(),w=g.getHeight(),S=Math.max(h,x),R=Math.max(m,w),_=Math.min(S/x,R/w),j=(S-x*_)/2,U=(R-w*_)/2,V=new X(S,R);for(let W=0,J=U;W<w;W++,J+=_)for(let te=0,de=j;te<x;te++,de+=_)g.get(te,W)&&V.setRegion(de,J,_,_);return V}}r.AbstractExpandedDecoder=Bg,r.ArgumentException=f,r.ArithmeticException=Pe,r.AztecCode=C2,r.AztecCodeReader=Fs,r.AztecCodeWriter=Of,r.AztecDecoder=Xe,r.AztecDetector=Li,r.AztecDetectorResult=gs,r.AztecEncoder=Dt,r.AztecHighLevelEncoder=md,r.AztecPoint=Ur,r.BarcodeFormat=oe,r.Binarizer=E,r.BinaryBitmap=y,r.BitArray=L,r.BitMatrix=X,r.BitSource=Gg,r.BrowserAztecCodeReader=If,r.BrowserBarcodeReader=c8,r.BrowserCodeReader=Ee,r.BrowserDatamatrixCodeReader=d8,r.BrowserMultiFormatReader=E8,r.BrowserPDF417Reader=S8,r.BrowserQRCodeReader=T8,r.BrowserQRCodeSvgWriter=sl,r.CharacterSetECI=F,r.ChecksumException=v,r.Code128Reader=Oe,r.Code39Reader=wr,r.DataMatrixDecodedBitStreamParser=Va,r.DataMatrixReader=Ga,r.DecodeHintType=k,r.DecoderResult=_e,r.DefaultGridSampler=Ms,r.DetectorResult=Bn,r.EAN13Reader=ai,r.EncodeHintType=Xr,r.Exception=u,r.FormatException=D,r.GenericGF=Be,r.GenericGFPoly=Se,r.GlobalHistogramBinarizer=Z,r.GridSampler=Ua,r.GridSamplerInstance=Os,r.HTMLCanvasElementLuminanceSource=ae,r.HybridBinarizer=ee,r.ITFReader=Lt,r.IllegalArgumentException=p,r.IllegalStateException=we,r.InvertedLuminanceSource=K,r.LuminanceSource=q,r.MathUtils=at,r.MultiFormatOneDReader=fc,r.MultiFormatReader=S2,r.MultiFormatWriter=A8,r.NotFoundException=z,r.OneDReader=ir,r.PDF417DecodedBitStreamParser=pe,r.PDF417DecoderErrorCorrection=x2,r.PDF417Reader=pn,r.PDF417ResultMetadata=v2,r.PerspectiveTransform=Ft,r.PlanarYUVLuminanceSource=ki,r.QRCodeByteMatrix=jf,r.QRCodeDataMask=$s,r.QRCodeDecodedBitStreamParser=ur,r.QRCodeDecoderErrorCorrectionLevel=Zt,r.QRCodeDecoderFormatInformation=_n,r.QRCodeEncoder=er,r.QRCodeEncoderQRCode=nl,r.QRCodeMaskUtil=Er,r.QRCodeMatrixUtil=nt,r.QRCodeMode=rt,r.QRCodeReader=Ha,r.QRCodeVersion=Ze,r.QRCodeWriter=pc,r.RGBLuminanceSource=Xg,r.RSS14Reader=br,r.RSSExpandedReader=Te,r.ReaderException=kf,r.ReedSolomonDecoder=Ne,r.ReedSolomonEncoder=qg,r.ReedSolomonException=tt,r.Result=ie,r.ResultMetadataType=Le,r.ResultPoint=$e,r.StringUtils=Y,r.UnsupportedOperationException=$,r.VideoInputDevice=Q,r.WhiteRectangleDetector=In,r.WriterException=Wt,r.ZXingArrays=N,r.ZXingCharset=T2,r.ZXingInteger=A,r.ZXingStandardCharsets=Qg,r.ZXingStringBuilder=ne,r.ZXingStringEncoding=G,r.ZXingSystem=b,r.createAbstractExpandedDecoder=p2,Object.defineProperty(r,"__esModule",{value:!0})})})(Pv,Pv.exports);var nr=Pv.exports;const ZZ=nw(nr),JZ=cI({__proto__:null,default:ZZ},[nr]);var EA=function(){function t(e,r,n){if(this.formatMap=new Map([[Ke.QR_CODE,nr.BarcodeFormat.QR_CODE],[Ke.AZTEC,nr.BarcodeFormat.AZTEC],[Ke.CODABAR,nr.BarcodeFormat.CODABAR],[Ke.CODE_39,nr.BarcodeFormat.CODE_39],[Ke.CODE_93,nr.BarcodeFormat.CODE_93],[Ke.CODE_128,nr.BarcodeFormat.CODE_128],[Ke.DATA_MATRIX,nr.BarcodeFormat.DATA_MATRIX],[Ke.MAXICODE,nr.BarcodeFormat.MAXICODE],[Ke.ITF,nr.BarcodeFormat.ITF],[Ke.EAN_13,nr.BarcodeFormat.EAN_13],[Ke.EAN_8,nr.BarcodeFormat.EAN_8],[Ke.PDF_417,nr.BarcodeFormat.PDF_417],[Ke.RSS_14,nr.BarcodeFormat.RSS_14],[Ke.RSS_EXPANDED,nr.BarcodeFormat.RSS_EXPANDED],[Ke.UPC_A,nr.BarcodeFormat.UPC_A],[Ke.UPC_E,nr.BarcodeFormat.UPC_E],[Ke.UPC_EAN_EXTENSION,nr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!JZ)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=n;var s=this.createZXingFormats(e),i=new Map;i.set(nr.DecodeHintType.POSSIBLE_FORMATS,s),i.set(nr.DecodeHintType.TRY_HARDER,!1),this.hints=i}return t.prototype.decodeAsync=function(e){var r=this;return new Promise(function(n,s){try{n(r.decode(e))}catch(i){s(i)}})},t.prototype.decode=function(e){var r=new nr.MultiFormatReader(this.verbose,this.hints),n=new nr.HTMLCanvasElementLuminanceSource(e),s=new nr.BinaryBitmap(new nr.HybridBinarizer(n)),i=r.decode(s);return{text:i.text,format:bj.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(r,n,s){e.set(r,n)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var r=[],n=0,s=e;n<s.length;n++){var i=s[n];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return r},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),eJ=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{u(n.next(f))}catch(p){a(p)}}function d(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(l,d)}u((n=n.apply(t,e||[])).next())})},tJ=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(f){return d([u,f])}}function d(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(f){u=[6,f],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},SA=function(){function t(e,r,n){if(this.formatMap=new Map([[Ke.QR_CODE,"qr_code"],[Ke.AZTEC,"aztec"],[Ke.CODABAR,"codabar"],[Ke.CODE_39,"code_39"],[Ke.CODE_93,"code_93"],[Ke.CODE_128,"code_128"],[Ke.DATA_MATRIX,"data_matrix"],[Ke.ITF,"itf"],[Ke.EAN_13,"ean_13"],[Ke.EAN_8,"ean_8"],[Ke.PDF_417,"pdf417"],[Ke.UPC_A,"upc_a"],[Ke.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=n;var s=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(s),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return eJ(this,void 0,void 0,function(){var r,n;return tJ(this,function(s){switch(s.label){case 0:return[4,this.detector.detect(e)];case 1:if(r=s.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return n=this.selectLargestBarcode(r),[2,{text:n.rawValue,format:bj.create(this.toHtml5QrcodeSupportedFormats(n.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var r=null,n=0,s=0,i=e;s<i.length;s++){var a=i[s],l=a.boundingBox.width*a.boundingBox.height;l>n&&(n=l,r=a)}if(!r)throw"No largest barcode found";return r},t.prototype.createBarcodeDetectorFormats=function(e){for(var r=[],n=0,s=e;n<s.length;n++){var i=s[n];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(r,n,s){e.set(r,n)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),TA=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{u(n.next(f))}catch(p){a(p)}}function d(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(l,d)}u((n=n.apply(t,e||[])).next())})},CA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(f){return d([u,f])}}function d(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(f){u=[6,f],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},rJ=function(){function t(e,r,n,s){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=n,r&&SA.isSupported()?(this.primaryDecoder=new SA(e,n,s),this.secondaryDecoder=new EA(e,n,s)):this.primaryDecoder=new EA(e,n,s)}return t.prototype.decodeAsync=function(e){return TA(this,void 0,void 0,function(){var r;return CA(this,function(n){switch(n.label){case 0:r=performance.now(),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,n.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return TA(this,void 0,void 0,function(){var r,n;return CA(this,function(s){switch(s.label){case 0:r=performance.now(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,s.sent()];case 3:if(n=s.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw n;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var r=performance.now()-e;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,r=0,n=this.executionResults;r<n.length;r++){var s=n[r];e+=s}var i=e/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),BE=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),up=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{u(n.next(f))}catch(p){a(p)}}function d(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(l,d)}u((n=n.apply(t,e||[])).next())})},dp=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(f){return d([u,f])}}function d(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(f){u=[6,f],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},Sj=function(){function t(e,r){this.name=e,this.track=r}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var r={};r[this.name]=e;var n={advanced:[r]};return this.track.applyConstraints(n)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var r=e[this.name];return r}return null},t}(),nJ=function(t){BE(e,t);function e(r,n){return t.call(this,r,n)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(r){var n={};n[this.name]=r;var s={advanced:[n]};return this.track.applyConstraints(s)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),n=r[this.name];return{min:n.min,max:n.max,step:n.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(Sj),sJ=function(t){BE(e,t);function e(r){return t.call(this,"zoom",r)||this}return e}(nJ),iJ=function(t){BE(e,t);function e(r){return t.call(this,"torch",r)||this}return e}(Sj),aJ=function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new sJ(this.track)},t.prototype.torchFeature=function(){return new iJ(this.track)},t}(),oJ=function(){function t(e,r,n){this.isClosed=!1,this.parentElement=e,this.mediaStream=r,this.callbacks=n,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var r=document.createElement("video");return r.style.width="".concat(e,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var n=e.surface.clientWidth,s=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(n,s),e.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,r,n,s){return up(this,void 0,void 0,function(){var i,a;return dp(this,function(l){switch(l.label){case 0:return i=new t(e,r,s),n.aspectRatio?(a={aspectRatio:n.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(a)]):[3,2];case 1:l.sent(),l.label=2;case 2:return i.setupSurface(),[2,i]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var r=this,n=function(){setTimeout(e,200),r.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return up(this,void 0,void 0,function(){return dp(this,function(r){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(r,n){var s=e.mediaStream.getVideoTracks(),i=s.length,a=0;e.mediaStream.getVideoTracks().forEach(function(l){e.mediaStream.removeTrack(l),l.stop(),++a,a>=i&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),r())})})},t.prototype.getCapabilities=function(){return new aJ(this.getFirstTrackOrFail())},t}(),lJ=function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,r,n){return up(this,void 0,void 0,function(){return dp(this,function(s){return[2,oJ.create(e,this.mediaStream,r,n)]})})},t.create=function(e){return up(this,void 0,void 0,function(){var r,n;return dp(this,function(s){switch(s.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return n=s.sent(),[2,new t(n)]}})})},t}(),AA=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{u(n.next(f))}catch(p){a(p)}}function d(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(l,d)}u((n=n.apply(t,e||[])).next())})},NA=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(f){return d([u,f])}}function d(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(f){u=[6,f],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},cJ=function(){function t(){}return t.failIfNotSupported=function(){return AA(this,void 0,void 0,function(){return NA(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return AA(this,void 0,void 0,function(){return NA(this,function(r){return[2,lJ.create(e)]})})},t}(),uJ=function(t,e,r,n){function s(i){return i instanceof r?i:new r(function(a){a(i)})}return new(r||(r=Promise))(function(i,a){function l(f){try{u(n.next(f))}catch(p){a(p)}}function d(f){try{u(n.throw(f))}catch(p){a(p)}}function u(f){f.done?i(f.value):s(f.value).then(l,d)}u((n=n.apply(t,e||[])).next())})},dJ=function(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,a;return a={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function l(u){return function(f){return d([u,f])}}function d(u){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(r=0)),r;)try{if(n=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,s=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){r.label=u[1];break}if(u[0]===6&&r.label<i[1]){r.label=i[1],i=u;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(u);break}i[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(f){u=[6,f],s=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},hJ=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=Yc.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=Yc.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return uJ(this,void 0,void 0,function(){var e,r,n,s,i,a,l;return dJ(this,function(d){switch(d.label){case 0:return e=function(u){for(var f=u.getVideoTracks(),p=0,y=f;p<y.length;p++){var v=y[p];v.enabled=!1,v.stop(),u.removeTrack(v)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(n=d.sent(),s=[],i=0,a=n;i<a.length;i++)l=a[i],l.kind==="videoinput"&&s.push({id:l.deviceId,label:l.label});return e(r),[2,s]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,r){var n=function(i){for(var a=[],l=0,d=i;l<d.length;l++){var u=d[l];u.kind==="video"&&a.push({id:u.id,label:u.label})}e(a)},s=MediaStreamTrack;s.getSources(n)})},t}(),Cr;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(Cr||(Cr={}));var fJ=function(){function t(){this.state=Cr.NOT_STARTED,this.onGoingTransactionNewState=Cr.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===Cr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Cr.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===Cr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Cr.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Cr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case Cr.UNKNOWN:throw"Transition from unknown is not allowed";case Cr.NOT_STARTED:this.failIfNewStateIs(e,[Cr.PAUSED]);break;case Cr.SCANNING:break;case Cr.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,r){for(var n=0,s=r;n<s.length;n++){var i=s[n];if(e===i)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t}(),mJ=function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===Cr.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==Cr.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Cr.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===Cr.PAUSED},t}(),pJ=function(){function t(){}return t.create=function(){return new mJ(new fJ)},t}(),gJ=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,s){n.__proto__=s}||function(n,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(n[i]=s[i])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),vs=function(t){gJ(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(qZ),xJ=function(){function t(e,r){this.logger=r,this.fps=vs.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=vs.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?Ej.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!xa(this.qrbox)},t.create=function(e,r){return new t(e,r)},t}(),yJ=function(){function t(e,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var n;typeof r=="boolean"?this.verbose=r===!0:r&&(n=r,this.verbose=n.verbose===!0,n.experimentalFeatures),this.logger=new QZ(this.verbose),this.qrcode=new rJ(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(n),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=pJ.create()}return t.prototype.start=function(e,r,n,s){var i=this;if(!e)throw"cameraIdOrConfig is required";if(!n||typeof n!="function")throw"qrCodeSuccessCallback is required and should be a function.";var a;s?a=s:a=this.verbose?this.logger.log:function(){};var l=xJ.create(r,this.logger);this.clearElement();var d=!1;l.videoConstraints&&(l.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var u=d,f=document.getElementById(this.elementId);f.clientWidth?f.clientWidth:vs.DEFAULT_WIDTH,f.style.position="relative",this.shouldScan=!0,this.element=f;var p=this,y=this.stateManagerProxy.startTransition(Cr.SCANNING);return new Promise(function(v,E){var b=u?l.videoConstraints:p.createVideoConstraints(e);if(!b){y.cancel(),E("videoConstraints should be defined");return}var T={};(!u||l.aspectRatio)&&(T.aspectRatio=l.aspectRatio);var I={onRenderSurfaceReady:function(N,A){p.setupUi(N,A,l),p.isScanning=!0,p.foreverScan(l,n,a)}};cJ.failIfNotSupported().then(function(N){N.create(b).then(function(A){return A.render(i.element,T,I).then(function(L){p.renderedCamera=L,y.execute(),v(null)}).catch(function(L){y.cancel(),E(L)})}).catch(function(A){y.cancel(),E(Yc.errorGettingUserMedia(A))})}).catch(function(N){y.cancel(),E(Yc.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Cr.PAUSED),this.showPausedState(),(xa(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,r=function(){e.stateManagerProxy.directTransition(Cr.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(Cr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var n=function(){if(e.element){var i=document.getElementById(vs.SHADED_REGION_ELEMENT_ID);i&&e.element.removeChild(i)}},s=this;return this.renderedCamera.close().then(function(){return s.renderedCamera=null,s.element&&(s.element.removeChild(s.canvasElement),s.canvasElement=null),n(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),r.execute(),s.hidePausedState(),s.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,r){return this.scanFileV2(e,r).then(function(n){return n.decodedText})},t.prototype.scanFileV2=function(e,r){var n=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(xa(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(s,i){n.possiblyCloseLastScanImageFile(),n.clearElement(),n.lastScanImageFile=URL.createObjectURL(e);var a=new Image;a.onload=function(){var l=a.width,d=a.height,u=document.getElementById(n.elementId),f=u.clientWidth?u.clientWidth:vs.DEFAULT_WIDTH,p=Math.max(u.clientHeight?u.clientHeight:d,vs.FILE_SCAN_MIN_HEIGHT),y=n.computeCanvasDrawConfig(l,d,f,p);if(r){var v=n.createCanvasElement(f,p,"qr-canvas-visible");v.style.display="inline-block",u.appendChild(v);var E=v.getContext("2d");if(!E)throw"Unable to get 2d context from canvas";E.canvas.width=f,E.canvas.height=p,E.drawImage(a,0,0,l,d,y.x,y.y,y.width,y.height)}var b=vs.FILE_SCAN_HIDDEN_CANVAS_PADDING,T=Math.max(a.width,y.width),I=Math.max(a.height,y.height),N=T+2*b,A=I+2*b,L=n.createCanvasElement(N,A);u.appendChild(L);var P=L.getContext("2d");if(!P)throw"Unable to get 2d context from canvas";P.canvas.width=N,P.canvas.height=A,P.drawImage(a,0,0,l,d,b,b,T,I);try{n.qrcode.decodeRobustlyAsync(L).then(function(k){s(bA.createFromQrcodeResult(k))}).catch(i)}catch(k){i("QR code parse error, error = ".concat(k))}},a.onerror=i,a.onabort=i,a.onstalled=i,a.onsuspend=i,a.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return hJ.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!Ej.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var r=[Ke.QR_CODE,Ke.AZTEC,Ke.CODABAR,Ke.CODE_39,Ke.CODE_93,Ke.CODE_128,Ke.DATA_MATRIX,Ke.MAXICODE,Ke.ITF,Ke.EAN_13,Ke.EAN_8,Ke.PDF_417,Ke.RSS_14,Ke.RSS_EXPANDED,Ke.UPC_A,Ke.UPC_E,Ke.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return r;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var n=[],s=0,i=e.formatsToSupport;s<i.length;s++){var a=i[s];YZ(a)?n.push(a):this.logger.warn("Invalid format: ".concat(a," passed in config, ignoring."))}if(n.length===0)throw"None of formatsToSupport match supported values.";return n},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if(xa(e))return!0;if(!xa(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(xa(e.experimentalFeatures))return!0;var r=e.experimentalFeatures;return xa(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,r,n){var s=this,i=n.qrbox;this.validateQrboxConfig(i);var a=this.toQrdimensions(e,r,i),l=function(u){if(u<vs.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(vs.MIN_QR_BOX_SIZE,"px.")},d=function(u){return u>e&&(s.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),u=e),u};l(a.width),l(a.height),a.width=d(a.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,r,n){if(typeof n=="number")return{width:n,height:n};if(typeof n=="function")try{return n(e,r)}catch(s){throw new Error("qrbox config was passed as a function but it failed with unknown error"+s)}return n},t.prototype.setupUi=function(e,r,n){n.isShadedBoxEnabled()&&this.validateQrboxSize(e,r,n);var s=xa(n.qrbox)?{width:e,height:r}:n.qrbox;this.validateQrboxConfig(s);var i=this.toQrdimensions(e,r,s);i.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var a=n.isShadedBoxEnabled()&&i.height<=r,l={x:0,y:0,width:e,height:r},d=a?this.getShadedRegionBounds(e,r,i):l,u=this.createCanvasElement(d.width,d.height),f={willReadFrequently:!0},p=u.getContext("2d",f);p.canvas.width=d.width,p.canvas.height=d.height,this.element.append(u),a&&this.possiblyInsertShadingElement(this.element,e,r,i),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=p,this.canvasElement=u},t.prototype.createScannerPausedUiElement=function(e){var r=document.createElement("div");r.innerText=Yc.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",e.appendChild(r),this.scannerPausedUiElement=r},t.prototype.scanContext=function(e,r){var n=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(s){return e(s.text,bA.createFromQrcodeResult(s)),n.possiblyUpdateShaders(!0),!0}).catch(function(s){n.possiblyUpdateShaders(!1);var i=Yc.codeParseError(s);return r(i,XZ.createFrom(i)),!1})},t.prototype.foreverScan=function(e,r,n){var s=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),a=i.videoWidth/i.clientWidth,l=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*a,u=this.qrRegion.height*l,f=this.qrRegion.x*a,p=this.qrRegion.y*l;this.context.drawImage(i,f,p,d,u,0,0,this.qrRegion.width,this.qrRegion.height);var y=function(){s.foreverScanTimeout=setTimeout(function(){s.foreverScan(e,r,n)},s.getTimeoutFps(e.fps))};this.scanContext(r,n).then(function(v){!v&&e.disableFlip!==!0?(s.context.translate(s.context.canvas.width,0),s.context.scale(-1,1),s.scanContext(r,n).finally(function(){y()})):y()}).catch(function(v){s.logger.logError("Error happend while scanning context",v),y()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var r="facingMode",n="deviceId",s={user:!0,environment:!0},i="exact",a=function(E){if(E in s)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(E,"'")},l=Object.keys(e);if(l.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(l.length," keys");var d=Object.keys(e)[0];if(d!==r&&d!==n)throw"Only '".concat(r,"' and '").concat(n,"' ")+" are supported for 'cameraIdOrConfig'";if(d===r){var u=e.facingMode;if(typeof u=="string"){if(a(u))return{facingMode:u}}else if(typeof u=="object")if(i in u){if(a(u["".concat(i)]))return{facingMode:{exact:u["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var f=typeof u;throw"Invalid type of 'facingMode' = ".concat(f)}}else{var p=e.deviceId;if(typeof p=="string")return{deviceId:p};if(typeof p=="object"){if(i in p)return{deviceId:{exact:p["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var y=typeof p;throw"Invalid type of 'deviceId' = ".concat(y)}}}var v=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(v)},t.prototype.computeCanvasDrawConfig=function(e,r,n,s){if(e<=n&&r<=s){var i=(n-e)/2,a=(s-r)/2;return{x:i,y:a,width:e,height:r}}else{var l=e,d=r;return e>n&&(r=n/e*r,e=n),r>s&&(e=s/r*e,r=s),this.logger.log("Image downsampled from "+"".concat(l,"X").concat(d)+" to ".concat(e,"X").concat(r,".")),this.computeCanvasDrawConfig(e,r,n,s)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=e?vs.BORDER_SHADER_MATCH_COLOR:vs.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,r,n){var s=e,i=r,a=document.createElement("canvas");return a.style.width="".concat(s,"px"),a.style.height="".concat(i,"px"),a.style.display="none",a.id=xa(n)?"qr-canvas":n,a},t.prototype.getShadedRegionBounds=function(e,r,n){if(n.width>e||n.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-n.width)/2,y:(r-n.height)/2,width:n.width,height:n.height}},t.prototype.possiblyInsertShadingElement=function(e,r,n,s){if(!(r-s.width<1||n-s.height<1)){var i=document.createElement("div");i.style.position="absolute";var a=(r-s.width)/2,l=(n-s.height)/2;if(i.style.borderLeft="".concat(a,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(a,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(vs.SHADED_REGION_ELEMENT_ID),r-s.width<11||n-s.height<11)this.hasBorderShaders=!1;else{var d=5,u=40;this.insertShaderBorders(i,u,d,-d,null,0,!0),this.insertShaderBorders(i,u,d,-d,null,0,!1),this.insertShaderBorders(i,u,d,null,-d,0,!0),this.insertShaderBorders(i,u,d,null,-d,0,!1),this.insertShaderBorders(i,d,u+d,-d,null,-d,!0),this.insertShaderBorders(i,d,u+d,null,-d,-d,!0),this.insertShaderBorders(i,d,u+d,-d,null,-d,!1),this.insertShaderBorders(i,d,u+d,null,-d,-d,!1),this.hasBorderShaders=!0}e.append(i)}},t.prototype.insertShaderBorders=function(e,r,n,s,i,a,l){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=vs.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(r,"px"),d.style.height="".concat(n,"px"),s!==null&&(d.style.top="".concat(s,"px")),i!==null&&(d.style.bottom="".concat(i,"px")),l?d.style.left="".concat(a,"px"):d.style.right="".concat(a,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),e.appendChild(d)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t}(),IA;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(IA||(IA={}));const vJ=({onScanSuccess:t,onScanError:e})=>{const r=C.useRef(null),n=C.useRef(null);return C.useEffect(()=>{const s={fps:10,qrbox:{width:250,height:250},aspectRatio:1};return n.current=new yJ("qr-reader"),(async()=>{try{await n.current.start({facingMode:"environment"},s,a=>{console.log(" QR Code scanned:",a),t&&t(a)},a=>{!a.includes("No")&&!a.includes("NotFoundException")&&console.warn("QR Scanner error:",a)})}catch(a){console.error(" Failed to start QR scanner:",a),e&&e(a)}})(),()=>{n.current&&n.current.isScanning&&n.current.stop().then(()=>{console.log("QR Scanner stopped"),n.current.clear()}).catch(a=>{console.error("Error stopping QR scanner:",a)})}},[t,e]),o.jsx("div",{className:"w-full",children:o.jsx("div",{id:"qr-reader",ref:r,className:"rounded-lg overflow-hidden border-2 border-blue-500",style:{width:"100%"}})})},wJ=({isOpen:t,onClose:e,onCodeScanned:r})=>{const[n,s]=C.useState(""),[i,a]=C.useState(""),[l,d]=C.useState(!1),[u,f]=C.useState(""),p=b=>{s(b),a(""),setTimeout(()=>{r&&r(b),E()},500)},y=b=>{console.error("Scanner error:",b),a("Impossible d'accder  la camra. Veuillez vrifier les permissions ou utiliser la saisie manuelle."),d(!0)},v=()=>{u.trim()&&(r&&r(u.trim()),E())},E=()=>{s(""),a(""),d(!1),f(""),e&&e()};return o.jsx(Ir,{open:t,onOpenChange:E,children:o.jsxs(fr,{className:"w-[95vw] max-w-lg mx-auto p-4 sm:p-6",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{className:"flex items-center gap-2",children:[o.jsx(bh,{className:"h-5 w-5 text-blue-600"}),"Scanner le QR Code du terrain"]}),o.jsx(bn,{children:"Pointez votre camra vers le QR code affich sur le terrain"})]}),o.jsxs("div",{className:"space-y-4",children:[i&&o.jsxs(Xt,{variant:"destructive",children:[o.jsx(Ho,{className:"h-4 w-4"}),o.jsx(Qt,{children:i})]}),n&&o.jsxs(Xt,{className:"border-green-500 bg-green-50",children:[o.jsx(Eh,{className:"h-4 w-4 text-green-600"}),o.jsxs(Qt,{className:"text-green-800",children:[o.jsx("strong",{children:"Code scann :"})," ",n]})]}),l?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"manual-code",children:"Code du terrain"}),o.jsx(Ue,{id:"manual-code",placeholder:"Entrez le code manuellement",value:u,onChange:b=>f(b.target.value),onKeyDown:b=>{b.key==="Enter"&&v()},autoFocus:!0})]}),o.jsxs("div",{className:"flex justify-between gap-3",children:[o.jsxs(ve,{type:"button",variant:"outline",onClick:()=>d(!1),className:"flex-1",children:[o.jsx(bh,{className:"h-4 w-4 mr-1"}),"Utiliser camra"]}),o.jsx(ve,{type:"button",onClick:v,disabled:!u.trim(),className:"flex-1",children:"Valider"})]})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:o.jsx("p",{className:"text-blue-900",children:" Positionnez le QR code dans le cadre ci-dessous"})}),o.jsx("div",{className:"relative w-full aspect-square max-w-sm mx-auto",children:o.jsx(vJ,{onScanSuccess:p,onScanError:y})}),o.jsx("div",{className:"text-center",children:o.jsxs(ve,{type:"button",variant:"outline",size:"sm",onClick:()=>d(!0),className:"text-xs",children:[o.jsx(xB,{className:"h-3 w-3 mr-1"}),"Saisir manuellement"]})})]}),!n&&o.jsx("div",{className:"pt-2 border-t",children:o.jsx(ve,{type:"button",variant:"ghost",onClick:E,className:"w-full",children:"Annuler"})})]})]})})},RA=[{value:60,label:"60 minutes",description:"Match court"},{value:90,label:"90 minutes",description:"Dure standard"},{value:120,label:"120 minutes",description:"Match long"},{value:200,label:"MAX (200 min)",description:"Dure maximale"}];function bJ({open:t,onOpenChange:e,onRecordingStarted:r}){const{user:n}=ps(),[s,i]=C.useState(""),[a,l]=C.useState(""),[d,u]=C.useState(90),[f,p]=C.useState(""),[y,v]=C.useState(""),[E,b]=C.useState(""),[T,I]=C.useState([]),[N,A]=C.useState([]),[L,P]=C.useState(!1),[k,D]=C.useState(!1),[O,F]=C.useState(!1),[$,G]=C.useState(""),[Y,ne]=C.useState(!1);C.useEffect(()=>{t&&(X(),i(""),l(""),u(90),p(""),v(""),b(""),G(""))},[t]),C.useEffect(()=>{f?z(f):(A([]),v(""))},[f]);const X=async()=>{P(!0);try{const Q=await Vc.getFollowedClubs();I(Q.data.clubs||[]),(Q.data.clubs||[]).length===0?G(`Vous ne suivez aucun club. Rendez-vous dans l'onglet "Clubs" pour suivre un club.`):G("")}catch(Q){console.error("Failed to load followed clubs:",Q),Ge.error("Impossible de charger vos clubs suivis"),G("Erreur lors du chargement de vos clubs suivis")}finally{P(!1)}},z=async Q=>{D(!0),G("");try{const re=await Ph.getClubCourtsForPlayers(Q);A(re.data.courts||[]),(!re.data.courts||re.data.courts.length===0)&&G("Aucun terrain trouv pour ce club")}catch(re){console.error("Failed to load courts:",re),Ge.error("Impossible de charger les terrains"),G("Erreur lors du chargement des terrains"),A([])}finally{D(!1)}},Z=async Q=>{var re,Ee,ie;console.log(" QR Code scann:",Q),b(Q),ne(!1),G(""),F(!0);try{const se=await qs.scanQrCode(Q),{court:oe,club:fe}=se.data;console.log(" QR Code valid - Club:",fe==null?void 0:fe.name,"Terrain:",oe==null?void 0:oe.name),p(((re=fe==null?void 0:fe.id)==null?void 0:re.toString())||""),v(((Ee=oe==null?void 0:oe.id)==null?void 0:Ee.toString())||""),fe!=null&&fe.id&&N.length===0&&await z(fe.id.toString()),Ge.success(`Code QR valid: ${fe==null?void 0:fe.name} - ${oe==null?void 0:oe.name}`)}catch(se){console.error(" Erreur validation QR:",se),((ie=se.response)==null?void 0:ie.status)===404?Ge.error("Code QR invalide. Veuillez scanner un QR code valide."):G("Erreur lors de la validation du QR code. Veuillez ressayer.")}finally{F(!1)}},ee=async()=>{var Q,re;if(!f||!y){G("Veuillez slectionner un club et un terrain"),Ge.error("Veuillez slectionner un club et un terrain");return}if(!E){G("Le code QR du terrain est requis"),Ge.error("Le code QR du terrain est requis");return}if(!n||!n.id){G("Utilisateur non authentifi"),Ge.error("Utilisateur non authentifi");return}if(n.credits!==void 0&&n.credits<1){G("Crdit insuffisant. Veuillez acheter des crdits."),Ge.error("Crdit insuffisant. Veuillez acheter des crdits.");return}F(!0),G("");try{const Ee=await qs.scanQrCode(E);if(Ee.data.court.id.toString()!==y){G(`Le code QR ne correspond pas au terrain slectionn. Ce code est pour le terrain "${Ee.data.court.name}"`),Ge.error("Le code QR ne correspond pas au terrain slectionn"),F(!1);return}const ie=await Ph.startAdvancedRecording({club_id:parseInt(f),court_id:parseInt(y),duration_minutes:d,qr_code:E,title:s||void 0,description:a||void 0});Ge.success("Enregistrement dmarr avec succs !"),r&&r(ie.data.recording_session),e(!1),i(""),l(""),p(""),v(""),b("")}catch(Ee){console.error("Failed to start recording:",Ee);const ie=((re=(Q=Ee.response)==null?void 0:Q.data)==null?void 0:re.error)||"Erreur lors du dmarrage de l'enregistrement";G(ie),Ge.error(ie)}finally{F(!1)}},q=({court:Q})=>o.jsxs(Me.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>Q.available&&v(Q.id.toString()),disabled:!Q.available,className:`w-full p-3 rounded-xl border flex flex-col transition-all text-left ${y===Q.id.toString()?"border-primary bg-primary/10":Q.available?"border-border/50 bg-background/30 hover:border-primary/50":"border-border/30 bg-background/10 opacity-50 cursor-not-allowed"}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:Q.name}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:["Terrain #",Q.number||Q.id]})]}),Q.available?o.jsxs(Hr,{variant:"secondary",className:"flex items-center gap-1",children:[o.jsx(Eh,{className:"h-3 w-3 text-green-600"}),o.jsx("span",{children:"Disponible"})]}):o.jsxs(Hr,{variant:"destructive",className:"flex items-center gap-1",children:[o.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),o.jsx("span",{children:"Occup"})]})]}),!Q.available&&Q.recording_info&&o.jsxs("div",{className:"mt-2 p-2 bg-red-50 rounded border text-xs",children:[o.jsxs("div",{className:"flex items-center gap-1 text-red-700",children:[o.jsx(Nn,{className:"h-3 w-3"}),o.jsx("span",{className:"font-medium",children:Q.recording_info.player_name||"En cours"})]}),Q.recording_info.remaining_minutes&&o.jsxs("div",{className:"flex items-center gap-1 text-red-600 mt-1",children:[o.jsx(hs,{className:"h-3 w-3"}),o.jsxs("span",{children:["Reste: ",Q.recording_info.remaining_minutes," min"]})]})]}),!Q.available&&!Q.recording_info&&o.jsx("div",{className:"mt-2 text-xs text-red-600",children:o.jsx("p",{children:" Terrain temporairement indisponible"})})]}),K=RA.find(Q=>Q.value===d),ae=N.find(Q=>Q.id.toString()===y);return o.jsxs(o.Fragment,{children:[o.jsx(Ir,{open:t,onOpenChange:e,children:o.jsxs(fr,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto bg-card border-border/50",children:[o.jsxs(Rr,{children:[o.jsx(_r,{className:"text-xl font-orbitron",children:"Nouvel Enregistrement avec Dure"}),o.jsx(bn,{children:"Configurez votre enregistrement de match avec une dure personnalise"})]}),o.jsxs("div",{className:"space-y-6 py-4",children:[$&&o.jsxs(Xt,{variant:"destructive",children:[o.jsx(Ho,{className:"h-4 w-4"}),o.jsx(Qt,{children:$})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"title",children:"Titre du match"}),o.jsx(Ue,{id:"title",placeholder:"Ex: Match contre quipe X",value:s,onChange:Q=>i(Q.target.value),className:"bg-background/50 border-border/50"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"description",children:"Description"}),o.jsx(qo,{id:"description",placeholder:"Notes sur le match...",value:a,onChange:Q=>l(Q.target.value),className:"bg-background/50 border-border/50 resize-none",rows:2})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(Ce,{className:"flex items-center gap-2",children:[o.jsx(hs,{className:"h-4 w-4 text-primary"}),"Dure d'enregistrement"]}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:RA.map(Q=>o.jsxs(Me.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u(Q.value),className:`p-3 rounded-xl border text-left transition-all ${d===Q.value?"border-primary bg-primary/10 shadow-[0_0_20px_hsl(var(--primary)/0.2)]":"border-border/50 bg-background/30 hover:border-primary/50"}`,children:[o.jsxs("div",{className:"flex items-center gap-2",children:[Q.value===200?o.jsx(pB,{className:"h-4 w-4 text-muted-foreground"}):o.jsx(hs,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{className:"font-medium",children:Q.label})]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Q.description})]},Q.value))}),K&&o.jsx("div",{className:"p-3 rounded-lg bg-primary/10 border border-primary/20",children:o.jsxs("p",{className:"text-sm",children:[o.jsx("span",{className:"text-muted-foreground",children:"Dure slectionne: "}),o.jsxs("span",{className:"text-primary font-medium",children:[d," minutes"]})]})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Club *"}),L?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx(ft,{className:"h-5 w-5 animate-spin text-primary"})}):o.jsxs(Yl,{value:f,onValueChange:p,children:[o.jsx(Oo,{className:"bg-background/50 border-border/50",children:o.jsx(ql,{placeholder:"Slectionner un club"})}),o.jsx(Fo,{children:T.map(Q=>o.jsx(Dr,{value:Q.id.toString(),children:Q.name},Q.id))})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(Ce,{className:"flex items-center gap-2",children:[o.jsx(Oa,{className:"h-4 w-4"}),"Terrain disponible *"]}),f?k?o.jsx("div",{className:"flex items-center justify-center py-4",children:o.jsx(ft,{className:"h-5 w-5 animate-spin text-primary"})}):N.length>0?o.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:N.map(Q=>o.jsx(q,{court:Q},Q.id))}):o.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Aucun terrain disponible"}):o.jsx("p",{className:"text-sm text-muted-foreground",children:"Slectionnez d'abord un club"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"qrCode",className:"flex items-center gap-2",children:"QR Code du terrain *"}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Ue,{id:"qrCode",placeholder:"Code du terrain",value:E,onChange:Q=>b(Q.target.value),onBlur:Q=>{const re=Q.target.value.trim();re&&re!==E&&Z(re)},className:"bg-background/50 border-border/50"}),o.jsx(ve,{type:"button",variant:"outline",size:"icon",onClick:()=>ne(!0),title:"Scanner avec la camra",children:o.jsx(ub,{className:"h-4 w-4"})})]})]})]}),o.jsxs("div",{className:"flex gap-3 pt-4 border-t border-border/50",children:[o.jsx(ve,{variant:"ghost",onClick:()=>e(!1),className:"flex-1",children:"Annuler"}),o.jsx(ve,{variant:"neon",onClick:ee,disabled:O||!f||!y||!E||(ae==null?void 0:ae.available)===!1,className:"flex-1 gap-2",children:O?o.jsxs(o.Fragment,{children:[o.jsx(ft,{className:"h-4 w-4 animate-spin"}),"Dmarrage..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ps,{className:"h-4 w-4"}),"Dmarrer l'enregistrement"]})})]})]})}),o.jsx(wJ,{isOpen:Y,onClose:()=>ne(!1),onCodeScanned:Z})]})}function EJ({open:t,onOpenChange:e,videoId:r,videoTitle:n}){const{toast:s}=la(),[i,a]=C.useState(""),[l,d]=C.useState(""),[u,f]=C.useState(!1),p=async()=>{var v,E;if(!i.trim()){s({title:"Erreur",description:"Veuillez entrer un email.",variant:"destructive"});return}if(!r){s({title:"Erreur",description:"ID de vido invalide.",variant:"destructive"});return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i.trim())){s({title:"Erreur",description:"Format d'email invalide.",variant:"destructive"});return}f(!0);try{await qs.shareVideoWithUser(r.toString(),i.trim(),l.trim()),s({title:" Vido partage",description:`La vido a t partage avec ${i}. Un email de notification a t envoy.`}),a(""),d(""),e(!1)}catch(b){console.error("Failed to share video:",b);const T=((E=(v=b.response)==null?void 0:v.data)==null?void 0:E.error)||b.message||"Erreur lors du partage";s({title:" Erreur de partage",description:T,variant:"destructive"})}finally{f(!1)}};return o.jsx(Ir,{open:t,onOpenChange:e,children:o.jsxs(fr,{className:"glass border-border/50 sm:max-w-md",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx("div",{className:"h-10 w-10 rounded-xl bg-primary/10 flex items-center justify-center",children:o.jsx(Ch,{className:"h-5 w-5 text-primary"})}),"Partager la vido"]}),o.jsxs(bn,{className:"text-muted-foreground",children:['Partagez "',n,'" avec un autre joueur MySmash. Il recevra un email de notification.']})]}),o.jsxs(Me.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-5 pt-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"email",className:"flex items-center gap-2",children:[o.jsx(Lo,{className:"h-4 w-4 text-muted-foreground"}),"Email du destinataire *"]}),o.jsx(Ue,{id:"email",type:"email",placeholder:"exemple@email.com",value:i,onChange:y=>a(y.target.value),className:"bg-card/50",disabled:u}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Le destinataire doit avoir un compte MySmash"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"message",className:"flex items-center gap-2",children:[o.jsx($l,{className:"h-4 w-4 text-muted-foreground"}),"Message (optionnel)"]}),o.jsx(qo,{id:"message",placeholder:"Ajouter un message personnel...",value:l,onChange:y=>d(y.target.value),className:"bg-card/50 min-h-[100px] resize-none",maxLength:500,disabled:u}),o.jsxs("p",{className:"text-xs text-muted-foreground text-right",children:[l.length,"/500 caractres"]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[o.jsx(ve,{variant:"ghost",onClick:()=>e(!1),disabled:u,children:"Annuler"}),o.jsxs(ve,{variant:"neon",onClick:p,disabled:u,className:"gap-2",children:[u?o.jsx("div",{className:"h-4 w-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):o.jsx(Ch,{className:"h-4 w-4"}),"Partager"]})]})]})]})})}const Ve=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)},SJ=Number.isSafeInteger||function(t){return typeof t=="number"&&Math.abs(t)<=TJ},TJ=Number.MAX_SAFE_INTEGER||9007199254740991;let Qe=function(t){return t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError",t}({}),ue=function(t){return t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",t.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",t.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",t.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",t.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",t.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",t.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",t.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_PARSING_ERROR="levelParsingError",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",t.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.FRAG_GAP="fragGap",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.ASSET_LIST_LOAD_ERROR="assetListLoadError",t.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",t.ASSET_LIST_PARSING_ERROR="assetListParsingError",t.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",t.INTERNAL_EXCEPTION="internalException",t.INTERNAL_ABORTED="aborted",t.ATTACH_MEDIA_ERROR="attachMediaError",t.UNKNOWN="unknown",t}({}),M=function(t){return t.MEDIA_ATTACHING="hlsMediaAttaching",t.MEDIA_ATTACHED="hlsMediaAttached",t.MEDIA_DETACHING="hlsMediaDetaching",t.MEDIA_DETACHED="hlsMediaDetached",t.MEDIA_ENDED="hlsMediaEnded",t.STALL_RESOLVED="hlsStallResolved",t.BUFFER_RESET="hlsBufferReset",t.BUFFER_CODECS="hlsBufferCodecs",t.BUFFER_CREATED="hlsBufferCreated",t.BUFFER_APPENDING="hlsBufferAppending",t.BUFFER_APPENDED="hlsBufferAppended",t.BUFFER_EOS="hlsBufferEos",t.BUFFERED_TO_END="hlsBufferedToEnd",t.BUFFER_FLUSHING="hlsBufferFlushing",t.BUFFER_FLUSHED="hlsBufferFlushed",t.MANIFEST_LOADING="hlsManifestLoading",t.MANIFEST_LOADED="hlsManifestLoaded",t.MANIFEST_PARSED="hlsManifestParsed",t.LEVEL_SWITCHING="hlsLevelSwitching",t.LEVEL_SWITCHED="hlsLevelSwitched",t.LEVEL_LOADING="hlsLevelLoading",t.LEVEL_LOADED="hlsLevelLoaded",t.LEVEL_UPDATED="hlsLevelUpdated",t.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",t.LEVELS_UPDATED="hlsLevelsUpdated",t.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",t.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",t.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",t.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",t.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",t.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",t.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",t.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",t.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",t.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",t.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",t.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",t.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",t.CUES_PARSED="hlsCuesParsed",t.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",t.INIT_PTS_FOUND="hlsInitPtsFound",t.FRAG_LOADING="hlsFragLoading",t.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",t.FRAG_LOADED="hlsFragLoaded",t.FRAG_DECRYPTED="hlsFragDecrypted",t.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",t.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",t.FRAG_PARSING_METADATA="hlsFragParsingMetadata",t.FRAG_PARSED="hlsFragParsed",t.FRAG_BUFFERED="hlsFragBuffered",t.FRAG_CHANGED="hlsFragChanged",t.FPS_DROP="hlsFpsDrop",t.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",t.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",t.ERROR="hlsError",t.DESTROYING="hlsDestroying",t.KEY_LOADING="hlsKeyLoading",t.KEY_LOADED="hlsKeyLoaded",t.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",t.BACK_BUFFER_REACHED="hlsBackBufferReached",t.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",t.ASSET_LIST_LOADING="hlsAssetListLoading",t.ASSET_LIST_LOADED="hlsAssetListLoaded",t.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",t.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",t.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",t.INTERSTITIAL_STARTED="hlsInterstitialStarted",t.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",t.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",t.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",t.INTERSTITIAL_ENDED="hlsInterstitialEnded",t.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",t.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",t.EVENT_CUE_ENTER="hlsEventCueEnter",t}({});var Ct={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},ze={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class Sc{constructor(e,r=0,n=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=r,this.totalWeight_=n}sample(e,r){const n=Math.pow(this.alpha_,e);this.estimate_=r*(1-n)+n*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class CJ{constructor(e,r,n,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Sc(e),this.fast_=new Sc(r),this.defaultTTFB_=s,this.ttfb_=new Sc(e)}update(e,r){const{slow_:n,fast_:s,ttfb_:i}=this;n.halfLife!==e&&(this.slow_=new Sc(e,n.getEstimate(),n.getTotalWeight())),s.halfLife!==r&&(this.fast_=new Sc(r,s.getEstimate(),s.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new Sc(e,i.getEstimate(),i.getTotalWeight()))}sample(e,r){e=Math.max(e,this.minDelayMs_);const n=8*r,s=e/1e3,i=n/s;this.fast_.sample(s,i),this.slow_.sample(s,i)}sampleTTFB(e){const r=e/1e3,n=Math.sqrt(2)*Math.exp(-Math.pow(r,2)/2);this.ttfb_.sample(n,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function AJ(t,e,r){return(e=IJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zt(){return zt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zt.apply(null,arguments)}function _A(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function $t(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?_A(Object(r),!0).forEach(function(n){AJ(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_A(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function NJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:e+""}class ii{constructor(e,r){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const n=`[${e}]:`;this.trace=no,this.debug=r.debug.bind(null,n),this.log=r.log.bind(null,n),this.warn=r.warn.bind(null,n),this.info=r.info.bind(null,n),this.error=r.error.bind(null,n)}}const no=function(){},RJ={trace:no,debug:no,log:no,warn:no,info:no,error:no};function Dv(){return zt({},RJ)}function _J(t,e){const r=self.console[t];return r?r.bind(self.console,`${e?"["+e+"] ":""}[${t}] >`):no}function LA(t,e,r){return e[t]?e[t].bind(e):_J(t,r)}const kv=Dv();function LJ(t,e,r){const n=Dv();if(typeof console=="object"&&t===!0||typeof t=="object"){const s=["debug","log","info","warn","error"];s.forEach(i=>{n[i]=LA(i,t,r)});try{n.log(`Debug logs enabled for "${e}" in hls.js version 1.6.15`)}catch{return Dv()}s.forEach(i=>{kv[i]=LA(i,t)})}else zt(kv,n);return n}const Vt=kv;function Bo(t=!0){return typeof self>"u"?void 0:(t||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function PJ(t){return typeof self<"u"&&t===self.ManagedMediaSource}function Tj(t,e){const r=Object.keys(t),n=Object.keys(e),s=r.length,i=n.length;return!s||!i||s===i&&!r.some(a=>n.indexOf(a)===-1)}function _s(t,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(t);if(e){const f=u.indexOf("\0");return f!==-1?u.substring(0,f):u}return u.replace(/\0/g,"")}const r=t.length;let n,s,i,a="",l=0;for(;l<r;){if(n=t[l++],n===0&&e)return a;if(n===0||n===3)continue;switch(n>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(n);break;case 12:case 13:s=t[l++],a+=String.fromCharCode((n&31)<<6|s&63);break;case 14:s=t[l++],i=t[l++],a+=String.fromCharCode((n&15)<<12|(s&63)<<6|(i&63)<<0);break}}return a}function wn(t){let e="";for(let r=0;r<t.length;r++){let n=t[r].toString(16);n.length<2&&(n="0"+n),e+=n}return e}function Cj(t){return Uint8Array.from(t.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}function DJ(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var f1={exports:{}},PA;function kJ(){return PA||(PA=1,function(t,e){(function(r){var n=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,s=/^(?=([^\/?#]*))\1([^]*)$/,i=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,l={buildAbsoluteURL:function(d,u,f){if(f=f||{},d=d.trim(),u=u.trim(),!u){if(!f.alwaysNormalize)return d;var p=l.parseURL(d);if(!p)throw new Error("Error trying to parse base URL.");return p.path=l.normalizePath(p.path),l.buildURLFromParts(p)}var y=l.parseURL(u);if(!y)throw new Error("Error trying to parse relative URL.");if(y.scheme)return f.alwaysNormalize?(y.path=l.normalizePath(y.path),l.buildURLFromParts(y)):u;var v=l.parseURL(d);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var E=s.exec(v.path);v.netLoc=E[1],v.path=E[2]}v.netLoc&&!v.path&&(v.path="/");var b={scheme:v.scheme,netLoc:y.netLoc,path:null,params:y.params,query:y.query,fragment:y.fragment};if(!y.netLoc&&(b.netLoc=v.netLoc,y.path[0]!=="/"))if(!y.path)b.path=v.path,y.params||(b.params=v.params,y.query||(b.query=v.query));else{var T=v.path,I=T.substring(0,T.lastIndexOf("/")+1)+y.path;b.path=l.normalizePath(I)}return b.path===null&&(b.path=f.alwaysNormalize?l.normalizePath(y.path):y.path),l.buildURLFromParts(b)},parseURL:function(d){var u=n.exec(d);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(d){for(d=d.split("").reverse().join("").replace(i,"");d.length!==(d=d.replace(a,"")).length;);return d.split("").reverse().join("")},buildURLFromParts:function(d){return d.scheme+d.netLoc+d.path+d.params+d.query+d.fragment}};t.exports=l})()}(f1)),f1.exports}var UE=kJ();class $E{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Yt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class Aj{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,MJ(this,"stats")}setByteRange(e,r){const n=e.split("@",2);let s;n.length===1?s=(r==null?void 0:r.byteRangeEndOffset)||0:s=parseInt(n[1]),this._byteRange=[s,parseInt(n[0])+s]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Yt.AUDIO]:null,[Yt.VIDEO]:null,[Yt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new $E),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=UE.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Yt.AUDIO]=null,e[Yt.VIDEO]=null,e[Yt.AUDIOVIDEO]=null}}function Or(t){return t.sn!=="initSegment"}class m1 extends Aj{constructor(e,r){super(r),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange.length){const e=this.byteRange[0],r=this.byteRange[1];if(Ve(e)&&Ve(r))return r-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){var e;const{levelkeys:r}=this;if(!r||r.NONE)return null;if(r.identity)this._decryptdata||(this._decryptdata=r.identity.getDecryptData(this.sn));else if(!((e=this._decryptdata)!=null&&e.keyId)){const n=Object.keys(r);if(n.length===1){const s=this._decryptdata=r[n[0]]||null;s&&(this._decryptdata=s.getDecryptData(this.sn,r))}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=Ve(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){var r;const n=Object.keys(this.levelkeys),s=n.length;if(s>1||s===1&&(r=this.levelkeys[n[0]])!=null&&r.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!Ve(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Or(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){const r=this.levelkeys;if(r){var n;const s=r[e];s&&!((n=this._decryptdata)!=null&&n.keyId)&&(this._decryptdata=s.getDecryptData(this.sn,r))}}abortRequests(){var e,r;(e=this.loader)==null||e.abort(),(r=this.keyLoader)==null||r.abort()}setElementaryStreamInfo(e,r,n,s,i,a=!1){const{elementaryStreams:l}=this,d=l[e];if(!d){l[e]={startPTS:r,endPTS:n,startDTS:s,endDTS:i,partial:a};return}d.startPTS=Math.min(d.startPTS,r),d.endPTS=Math.max(d.endPTS,n),d.startDTS=Math.min(d.startDTS,s),d.endDTS=Math.max(d.endDTS,i)}}class jJ extends Aj{constructor(e,r,n,s,i){super(n),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=r,this.index=s;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,i),i&&(this.fragOffset=i.fragOffset+i.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function Nj(t,e){const r=Object.getPrototypeOf(t);if(r){const n=Object.getOwnPropertyDescriptor(r,e);return n||Nj(r,e)}}function MJ(t,e){const r=Nj(t,e);r&&(r.enumerable=!0,Object.defineProperty(t,e,r))}const DA=Math.pow(2,32)-1,OJ=[].push,Ij={video:1,audio:2,id3:3,text:4};function Zr(t){return String.fromCharCode.apply(null,t)}function Rj(t,e){const r=t[e]<<8|t[e+1];return r<0?65536+r:r}function dt(t,e){const r=_j(t,e);return r<0?4294967296+r:r}function kA(t,e){let r=dt(t,e);return r*=Math.pow(2,32),r+=dt(t,e+4),r}function _j(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function FJ(t){const e=t.byteLength;for(let r=0;r<e;){const n=dt(t,r);if(n>8&&t[r+4]===109&&t[r+5]===111&&t[r+6]===111&&t[r+7]===102)return!0;r=n>1?r+n:e}return!1}function Tt(t,e){const r=[];if(!e.length)return r;const n=t.byteLength;for(let s=0;s<n;){const i=dt(t,s),a=Zr(t.subarray(s+4,s+8)),l=i>1?s+i:n;if(a===e[0])if(e.length===1)r.push(t.subarray(s+8,l));else{const d=Tt(t.subarray(s+8,l),e.slice(1));d.length&&OJ.apply(r,d)}s=l}return r}function BJ(t){const e=[],r=t[0];let n=8;const s=dt(t,n);n+=4;let i=0,a=0;r===0?(i=dt(t,n),a=dt(t,n+4),n+=8):(i=kA(t,n),a=kA(t,n+8),n+=16),n+=2;let l=t.length+a;const d=Rj(t,n);n+=2;for(let u=0;u<d;u++){let f=n;const p=dt(t,f);f+=4;const y=p&2147483647;if((p&2147483648)>>>31===1)return Vt.warn("SIDX has hierarchical references (not supported)"),null;const E=dt(t,f);f+=4,e.push({referenceSize:y,subsegmentDuration:E,info:{duration:E/s,start:l,end:l+y-1}}),l+=y,f+=4,n=f}return{earliestPresentationTime:i,timescale:s,version:r,referencesCount:d,references:e}}function Lj(t){const e=[],r=Tt(t,["moov","trak"]);for(let s=0;s<r.length;s++){const i=r[s],a=Tt(i,["tkhd"])[0];if(a){let l=a[0];const d=dt(a,l===0?12:20),u=Tt(i,["mdia","mdhd"])[0];if(u){l=u[0];const f=dt(u,l===0?12:20),p=Tt(i,["mdia","hdlr"])[0];if(p){const y=Zr(p.subarray(8,12)),v={soun:Yt.AUDIO,vide:Yt.VIDEO}[y],E=Tt(i,["mdia","minf","stbl","stsd"])[0],b=UJ(E);v?(e[d]={timescale:f,type:v,stsd:b},e[v]=$t({timescale:f,id:d},b)):e[d]={timescale:f,type:y,stsd:b}}}}}return Tt(t,["moov","mvex","trex"]).forEach(s=>{const i=dt(s,4),a=e[i];a&&(a.default={duration:dt(s,12),flags:dt(s,20)})}),e}function UJ(t){const e=t.subarray(8),r=e.subarray(86),n=Zr(e.subarray(4,8));let s=n,i;const a=n==="enca"||n==="encv";if(a){const u=Tt(e,[n])[0].subarray(n==="enca"?28:78);Tt(u,["sinf"]).forEach(p=>{const y=Tt(p,["schm"])[0];if(y){const v=Zr(y.subarray(4,8));if(v==="cbcs"||v==="cenc"){const E=Tt(p,["frma"])[0];E&&(s=Zr(E))}}})}const l=s;switch(s){case"avc1":case"avc2":case"avc3":case"avc4":{const d=Tt(r,["avcC"])[0];d&&d.length>3&&(s+="."+ym(d[1])+ym(d[2])+ym(d[3]),i=xm(l==="avc1"?"dva1":"dvav",r));break}case"mp4a":{const d=Tt(e,[n])[0],u=Tt(d.subarray(28),["esds"])[0];if(u&&u.length>7){let f=4;if(u[f++]!==3)break;f=p1(u,f),f+=2;const p=u[f++];if(p&128&&(f+=2),p&64&&(f+=u[f++]),u[f++]!==4)break;f=p1(u,f);const y=u[f++];if(y===64)s+="."+ym(y);else break;if(f+=12,u[f++]!==5)break;f=p1(u,f);const v=u[f++];let E=(v&248)>>3;E===31&&(E+=1+((v&7)<<3)+((u[f]&224)>>5)),s+="."+E}break}case"hvc1":case"hev1":{const d=Tt(r,["hvcC"])[0];if(d&&d.length>12){const u=d[1],f=["","A","B","C"][u>>6],p=u&31,y=dt(d,2),v=(u&32)>>5?"H":"L",E=d[12],b=d.subarray(6,12);s+="."+f+p,s+="."+$J(y).toString(16).toUpperCase(),s+="."+v+E;let T="";for(let I=b.length;I--;){const N=b[I];(N||T)&&(T="."+N.toString(16).toUpperCase()+T)}s+=T}i=xm(l=="hev1"?"dvhe":"dvh1",r);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{s=xm(s,r)||s;break}case"vp09":{const d=Tt(r,["vpcC"])[0];if(d&&d.length>6){const u=d[4],f=d[5],p=d[6]>>4&15;s+="."+Vi(u)+"."+Vi(f)+"."+Vi(p)}break}case"av01":{const d=Tt(r,["av1C"])[0];if(d&&d.length>2){const u=d[1]>>>5,f=d[1]&31,p=d[2]>>>7?"H":"M",y=(d[2]&64)>>6,v=(d[2]&32)>>5,E=u===2&&y?v?12:10:y?10:8,b=(d[2]&16)>>4,T=(d[2]&8)>>3,I=(d[2]&4)>>2,N=d[2]&3;s+="."+u+"."+Vi(f)+p+"."+Vi(E)+"."+b+"."+T+I+N+"."+Vi(1)+"."+Vi(1)+"."+Vi(1)+"."+0,i=xm("dav1",r)}break}}return{codec:s,encrypted:a,supplemental:i}}function xm(t,e){const r=Tt(e,["dvvC"]),n=r.length?r[0]:Tt(e,["dvcC"])[0];if(n){const s=n[2]>>1&127,i=n[2]<<5&32|n[3]>>3&31;return t+"."+Vi(s)+"."+Vi(i)}}function $J(t){let e=0;for(let r=0;r<32;r++)e|=(t>>r&1)<<31-r;return e>>>0}function p1(t,e){const r=e+5;for(;t[e++]&128&&e<r;);return e}function ym(t){return("0"+t.toString(16).toUpperCase()).slice(-2)}function Vi(t){return(t<10?"0":"")+t}function VJ(t,e){if(!t||!e)return;const r=e.keyId;r&&e.isCommonEncryption&&Pj(t,(n,s)=>{const i=n.subarray(8,24);i.some(a=>a!==0)||(Vt.log(`[eme] Patching keyId in 'enc${s?"a":"v"}>sinf>>tenc' box: ${wn(i)} -> ${wn(r)}`),n.set(r,8))})}function GJ(t){const e=[];return Pj(t,r=>e.push(r.subarray(8,24))),e}function Pj(t,e){Tt(t,["moov","trak"]).forEach(n=>{const s=Tt(n,["mdia","minf","stbl","stsd"])[0];if(!s)return;const i=s.subarray(8);let a=Tt(i,["enca"]);const l=a.length>0;l||(a=Tt(i,["encv"])),a.forEach(d=>{const u=l?d.subarray(28):d.subarray(78);Tt(u,["sinf"]).forEach(p=>{const y=Dj(p);y&&e(y,l)})})})}function Dj(t){const e=Tt(t,["schm"])[0];if(e){const r=Zr(e.subarray(4,8));if(r==="cbcs"||r==="cenc"){const n=Tt(t,["schi","tenc"])[0];if(n)return n}}}function HJ(t,e,r){const n={},s=Tt(t,["moof","traf"]);for(let i=0;i<s.length;i++){const a=s[i],l=Tt(a,["tfhd"])[0],d=dt(l,4),u=e[d];if(!u)continue;n[d]||(n[d]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});const f=n[d],p=Tt(a,["tfdt"])[0];if(p){const A=p[0];let L=dt(p,4);A===1&&(L===DA?r.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(L*=DA+1,L+=dt(p,8))),Ve(L)&&(!Ve(f.start)||L<f.start)&&(f.start=L)}const y=u.default,v=dt(l,0)|(y==null?void 0:y.flags);let E=(y==null?void 0:y.duration)||0;v&8&&(v&2?E=dt(l,12):E=dt(l,8));const b=Tt(a,["trun"]);let T=f.start||0,I=0,N=E;for(let A=0;A<b.length;A++){const L=b[A],P=dt(L,4),k=f.sampleCount;f.sampleCount+=P;const D=L[3]&1,O=L[3]&4,F=L[2]&1,$=L[2]&2,G=L[2]&4,Y=L[2]&8;let ne=8,X=P;for(D&&(ne+=4),O&&P&&(!(L[ne+1]&1)&&f.keyFrameIndex===void 0&&(f.keyFrameIndex=k),ne+=4,F?(N=dt(L,ne),ne+=4):N=E,$&&(ne+=4),Y&&(ne+=4),T+=N,I+=N,X--);X--;)F?(N=dt(L,ne),ne+=4):N=E,$&&(ne+=4),G&&(L[ne+1]&1||f.keyFrameIndex===void 0&&(f.keyFrameIndex=f.sampleCount-(X+1),f.keyFrameStart=T),ne+=4),Y&&(ne+=4),T+=N,I+=N;!I&&E&&(I+=E*P)}f.duration+=I}if(!Object.keys(n).some(i=>n[i].duration)){let i=1/0,a=0;const l=Tt(t,["sidx"]);for(let d=0;d<l.length;d++){const u=BJ(l[d]);if(u!=null&&u.references){i=Math.min(i,u.earliestPresentationTime/u.timescale);const f=u.references.reduce((p,y)=>p+y.info.duration||0,0);a=Math.max(a,f+u.earliestPresentationTime/u.timescale)}}a&&Ve(a)&&Object.keys(n).forEach(d=>{n[d].duration||(n[d].duration=a*n[d].timescale-n[d].start)})}return n}function zJ(t){const e={valid:null,remainder:null},r=Tt(t,["moof"]);if(r.length<2)return e.remainder=t,e;const n=r[r.length-1];return e.valid=t.slice(0,n.byteOffset-8),e.remainder=t.slice(n.byteOffset-8),e}function ri(t,e){const r=new Uint8Array(t.length+e.length);return r.set(t),r.set(e,t.length),r}function jA(t,e){const r=[],n=e.samples,s=e.timescale,i=e.id;let a=!1;return Tt(n,["moof"]).map(d=>{const u=d.byteOffset-8;Tt(d,["traf"]).map(p=>{const y=Tt(p,["tfdt"]).map(v=>{const E=v[0];let b=dt(v,4);return E===1&&(b*=Math.pow(2,32),b+=dt(v,8)),b/s})[0];return y!==void 0&&(t=y),Tt(p,["tfhd"]).map(v=>{const E=dt(v,4),b=dt(v,0)&16777215,T=(b&1)!==0,I=(b&2)!==0,N=(b&8)!==0;let A=0;const L=(b&16)!==0;let P=0;const k=(b&32)!==0;let D=8;E===i&&(T&&(D+=8),I&&(D+=4),N&&(A=dt(v,D),D+=4),L&&(P=dt(v,D),D+=4),k&&(D+=4),e.type==="video"&&(a=Pg(e.codec)),Tt(p,["trun"]).map(O=>{const F=O[0],$=dt(O,0)&16777215,G=($&1)!==0;let Y=0;const ne=($&4)!==0,X=($&256)!==0;let z=0;const Z=($&512)!==0;let ee=0;const q=($&1024)!==0,K=($&2048)!==0;let ae=0;const Q=dt(O,4);let re=8;G&&(Y=dt(O,re),re+=4),ne&&(re+=4);let Ee=Y+u;for(let ie=0;ie<Q;ie++){if(X?(z=dt(O,re),re+=4):z=A,Z?(ee=dt(O,re),re+=4):ee=P,q&&(re+=4),K&&(F===0?ae=dt(O,re):ae=_j(O,re),re+=4),e.type===Yt.VIDEO){let se=0;for(;se<ee;){const oe=dt(n,Ee);if(Ee+=4,WJ(a,n[Ee])){const fe=n.subarray(Ee,Ee+oe);VE(fe,a?2:1,t+ae/s,r)}Ee+=oe,se+=oe+4}}t+=z/s}}))})})}),r}function Pg(t){if(!t)return!1;const e=t.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function WJ(t,e){if(t){const r=e>>1&63;return r===39||r===40}else return(e&31)===6}function VE(t,e,r,n){const s=kj(t);let i=0;i+=e;let a=0,l=0,d=0;for(;i<s.length;){a=0;do{if(i>=s.length)break;d=s[i++],a+=d}while(d===255);l=0;do{if(i>=s.length)break;d=s[i++],l+=d}while(d===255);const u=s.length-i;let f=i;if(l<u)i+=l;else if(l>u){Vt.error(`Malformed SEI payload. ${l} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(s[f++]===181){const y=Rj(s,f);if(f+=2,y===49){const v=dt(s,f);if(f+=4,v===1195456820){const E=s[f++];if(E===3){const b=s[f++],T=31&b,I=64&b,N=I?2+T*3:0,A=new Uint8Array(N);if(I){A[0]=b;for(let L=1;L<N;L++)A[L]=s[f++]}n.push({type:E,payloadType:a,pts:r,bytes:A})}}}}}else if(a===5&&l>16){const p=[];for(let E=0;E<16;E++){const b=s[f++].toString(16);p.push(b.length==1?"0"+b:b),(E===3||E===5||E===7||E===9)&&p.push("-")}const y=l-16,v=new Uint8Array(y);for(let E=0;E<y;E++)v[E]=s[f++];n.push({payloadType:a,pts:r,uuid:p.join(""),userData:_s(v),userDataBytes:v})}}}function kj(t){const e=t.byteLength,r=[];let n=1;for(;n<e-2;)t[n]===0&&t[n+1]===0&&t[n+2]===3?(r.push(n+2),n+=2):n++;if(r.length===0)return t;const s=e-r.length,i=new Uint8Array(s);let a=0;for(n=0;n<s;a++,n++)a===r[0]&&(a++,r.shift()),i[n]=t[a];return i}function KJ(t){const e=t[0];let r="",n="",s=0,i=0,a=0,l=0,d=0,u=0;if(e===0){for(;Zr(t.subarray(u,u+1))!=="\0";)r+=Zr(t.subarray(u,u+1)),u+=1;for(r+=Zr(t.subarray(u,u+1)),u+=1;Zr(t.subarray(u,u+1))!=="\0";)n+=Zr(t.subarray(u,u+1)),u+=1;n+=Zr(t.subarray(u,u+1)),u+=1,s=dt(t,12),i=dt(t,16),l=dt(t,20),d=dt(t,24),u=28}else if(e===1){u+=4,s=dt(t,u),u+=4;const p=dt(t,u);u+=4;const y=dt(t,u);for(u+=4,a=2**32*p+y,SJ(a)||(a=Number.MAX_SAFE_INTEGER,Vt.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),l=dt(t,u),u+=4,d=dt(t,u),u+=4;Zr(t.subarray(u,u+1))!=="\0";)r+=Zr(t.subarray(u,u+1)),u+=1;for(r+=Zr(t.subarray(u,u+1)),u+=1;Zr(t.subarray(u,u+1))!=="\0";)n+=Zr(t.subarray(u,u+1)),u+=1;n+=Zr(t.subarray(u,u+1)),u+=1}const f=t.subarray(u,t.byteLength);return{schemeIdUri:r,value:n,timeScale:s,presentationTime:a,presentationTimeDelta:i,eventDuration:l,id:d,payload:f}}function YJ(t,...e){const r=e.length;let n=8,s=r;for(;s--;)n+=e[s].byteLength;const i=new Uint8Array(n);for(i[0]=n>>24&255,i[1]=n>>16&255,i[2]=n>>8&255,i[3]=n&255,i.set(t,4),s=0,n=8;s<r;s++)i.set(e[s],n),n+=e[s].byteLength;return i}function qJ(t,e,r){if(t.byteLength!==16)throw new RangeError("Invalid system id");let n,s;n=0,s=new Uint8Array;let i;n>0?(i=new Uint8Array(4),e.length>0&&new DataView(i.buffer).setUint32(0,e.length,!1)):i=new Uint8Array;const a=new Uint8Array(4);return r.byteLength>0&&new DataView(a.buffer).setUint32(0,r.byteLength,!1),YJ([112,115,115,104],new Uint8Array([n,0,0,0]),t,i,s,a,r)}function XJ(t){const e=[];if(t instanceof ArrayBuffer){const r=t.byteLength;let n=0;for(;n+32<r;){const s=new DataView(t,n),i=QJ(s);e.push(i),n+=i.size}}return e}function QJ(t){const e=t.getUint32(0),r=t.byteOffset,n=t.byteLength;if(n<e)return{offset:r,size:n};if(t.getUint32(4)!==1886614376)return{offset:r,size:e};const i=t.getUint32(8)>>>24;if(i!==0&&i!==1)return{offset:r,size:e};const a=t.buffer,l=wn(new Uint8Array(a,r+12,16));let d=null,u=null,f=0;if(i===0)f=28;else{const y=t.getUint32(28);if(!y||n<32+y*16)return{offset:r,size:e};d=[];for(let v=0;v<y;v++)d.push(new Uint8Array(a,r+32+v*16,16));f=32+y*16}if(!f)return{offset:r,size:e};const p=t.getUint32(f);return e-32<p?{offset:r,size:e}:(u=new Uint8Array(a,r+f+4,p),{version:i,systemId:l,kids:d,data:u,offset:r,size:e})}const jj=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Ou={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function GE(t,e){const r=Ou[e];return!!r&&!!r[t.slice(0,4)]}function $h(t,e,r=!0){return!t.split(",").some(n=>!HE(n,e,r))}function HE(t,e,r=!0){var n;const s=Bo(r);return(n=s==null?void 0:s.isTypeSupported(Vh(t,e)))!=null?n:!1}function Vh(t,e){return`${e}/mp4;codecs=${t}`}function MA(t){if(t){const e=t.substring(0,4);return Ou.video[e]}return 2}function hp(t){const e=jj();return t.split(",").reduce((r,n)=>{const i=e&&Pg(n)?9:Ou.video[n];return i?(i*2+r)/(r?3:2):(Ou.audio[n]+r)/(r?2:1)},0)}const g1={};function ZJ(t,e=!0){if(g1[t])return g1[t];const r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[t];for(let s=0;s<r.length;s++){var n;if(HE(r[s],"audio",e))return g1[t]=r[s],r[s];if(r[s]==="mp3"&&(n=Bo(e))!=null&&n.isTypeSupported("audio/mpeg"))return""}return t}const JJ=/flac|opus|mp4a\.40\.34/i;function fp(t,e=!0){return t.replace(JJ,r=>ZJ(r.toLowerCase(),e))}function eee(t,e){const r=[];if(t){const n=t.split(",");for(let s=0;s<n.length;s++)GE(n[s],"video")||r.push(n[s])}return e&&r.push(e),r.join(",")}function s0(t,e){if(t&&(t.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(t)!==-1)&&(OA(t,"audio")||OA(t,"video")))return t;if(e){const r=e.split(",");if(r.length>1){if(t){for(let n=r.length;n--;)if(r[n].substring(0,4)===t.substring(0,4))return r[n]}return r[0]}}return e||t}function OA(t,e){return GE(t,e)&&HE(t,e)}function tee(t){const e=t.split(",");for(let r=0;r<e.length;r++){const n=e[r].split(".");n.length>2&&n[0]==="avc1"&&(e[r]=`avc1.${parseInt(n[1]).toString(16)}${("000"+parseInt(n[2]).toString(16)).slice(-4)}`)}return e.join(",")}function ree(t){if(t.startsWith("av01.")){const e=t.split("."),r=["0","111","01","01","01","0"];for(let n=e.length;n>4&&n<10;n++)e[n]=r[n-4];return e.join(".")}return t}function FA(t){const e=Bo(t)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function jv(t){return t.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const nee={supported:!0,powerEfficient:!0,smooth:!0},see={supported:!1,smooth:!1,powerEfficient:!1},Mj={supported:!0,configurations:[],decodingInfoResults:[nee]};function Oj(t,e){return{supported:!1,configurations:e,decodingInfoResults:[see],error:t}}function iee(t,e,r,n,s,i){const a=t.videoCodec,l=t.audioCodec?t.audioGroups:null,d=i==null?void 0:i.audioCodec,u=i==null?void 0:i.channels,f=u?parseInt(u):d?1/0:2;let p=null;if(l!=null&&l.length)try{l.length===1&&l[0]?p=e.groups[l[0]].channels:p=l.reduce((y,v)=>{if(v){const E=e.groups[v];if(!E)throw new Error(`Audio track group ${v} not found`);Object.keys(E.channels).forEach(b=>{y[b]=(y[b]||0)+E.channels[b]})}return y},{2:0})}catch{return!0}return a!==void 0&&(a.split(",").some(y=>Pg(y))||t.width>1920&&t.height>1088||t.height>1920&&t.width>1088||t.frameRate>Math.max(n,30)||t.videoRange!=="SDR"&&t.videoRange!==r||t.bitrate>Math.max(s,8e6))||!!p&&Ve(f)&&Object.keys(p).some(y=>parseInt(y)>f)}function Fj(t,e,r,n={}){const s=t.videoCodec;if(!s&&!t.audioCodec||!r)return Promise.resolve(Mj);const i=[],a=aee(t),l=a.length,d=oee(t,e,l>0),u=d.length;for(let f=l||1*u||1;f--;){const p={type:"media-source"};if(l&&(p.video=a[f%l]),u){p.audio=d[f%u];const y=p.audio.bitrate;p.video&&y&&(p.video.bitrate-=y)}i.push(p)}if(s){const f=navigator.userAgent;if(s.split(",").some(p=>Pg(p))&&jj())return Promise.resolve(Oj(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${f})`),i))}return Promise.all(i.map(f=>{const p=cee(f);return n[p]||(n[p]=r.decodingInfo(f))})).then(f=>({supported:!f.some(p=>!p.supported),configurations:i,decodingInfoResults:f})).catch(f=>({supported:!1,configurations:i,decodingInfoResults:[],error:f}))}function aee(t){var e;const r=(e=t.videoCodec)==null?void 0:e.split(","),n=Bj(t),s=t.width||640,i=t.height||480,a=t.frameRate||30,l=t.videoRange.toLowerCase();return r?r.map(d=>{const u={contentType:Vh(ree(d),"video"),width:s,height:i,bitrate:n,framerate:a};return l!=="sdr"&&(u.transferFunction=l),u}):[]}function oee(t,e,r){var n;const s=(n=t.audioCodec)==null?void 0:n.split(","),i=Bj(t);return s&&t.audioGroups?t.audioGroups.reduce((a,l)=>{var d;const u=l?(d=e.groups[l])==null?void 0:d.tracks:null;return u?u.reduce((f,p)=>{if(p.groupId===l){const y=parseFloat(p.channels||"");s.forEach(v=>{const E={contentType:Vh(v,"audio"),bitrate:r?lee(v,i):i};y&&(E.channels=""+y),f.push(E)})}return f},a):a},[]):[]}function lee(t,e){if(e<=1)return 1;let r=128e3;return t==="ec-3"?r=768e3:t==="ac-3"&&(r=64e4),Math.min(e/2,r)}function Bj(t){return Math.ceil(Math.max(t.bitrate*.9,t.averageBitrate)/1e3)*1e3||1}function cee(t){let e="";const{audio:r,video:n}=t;if(n){const s=jv(n.contentType);e+=`${s}_r${n.height}x${n.width}f${Math.ceil(n.framerate)}${n.transferFunction||"sd"}_${Math.ceil(n.bitrate/1e5)}`}if(r){const s=jv(r.contentType);e+=`${n?"_":""}${s}_c${r.channels}`}return e}const Mv=["NONE","TYPE-0","TYPE-1",null];function uee(t){return Mv.indexOf(t)>-1}const mp=["SDR","PQ","HLG"];function dee(t){return!!t&&mp.indexOf(t)>-1}var i0={No:"",Yes:"YES",v2:"v2"};function BA(t){const{canSkipUntil:e,canSkipDateRanges:r,age:n}=t,s=n<e/2;return e&&s?r?i0.v2:i0.Yes:i0.No}class UA{constructor(e,r,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=r,this.skip=n}addDirectives(e){const r=new self.URL(e);return this.msn!==void 0&&r.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&r.searchParams.set("_HLS_part",this.part.toString()),this.skip&&r.searchParams.set("_HLS_skip",this.skip),r.href}}class Gh{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(n=>!!n).map(n=>n.substring(0,4)).join(","),"supplemental"in e){var r;this.supplemental=e.supplemental;const n=(r=e.supplemental)==null?void 0:r.videoCodec;n&&n!==e.videoCodec&&(this.codecSet+=`,${n.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return $A(this._audioGroups,e)}hasSubtitleGroup(e){return $A(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,r){if(r){if(e==="audio"){let n=this._audioGroups;n||(n=this._audioGroups=[]),n.indexOf(r)===-1&&n.push(r)}else if(e==="text"){let n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),n.indexOf(r)===-1&&n.push(r)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function $A(t,e){return!e||!t?!1:t.indexOf(e)!==-1}function hee(){if(typeof matchMedia=="function"){const t=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(t.media!==e.media)return t.matches===!0}return!1}function fee(t,e){let r=!1,n=[];if(t&&(r=t!=="SDR",n=[t]),e){n=e.allowedVideoRanges||mp.slice(0);const s=n.join("")!=="SDR"&&!e.videoCodec;r=e.preferHDR!==void 0?e.preferHDR:s&&hee(),r||(n=["SDR"])}return{preferHDR:r,allowedVideoRanges:n}}const mee=t=>{const e=new WeakSet;return(r,n)=>{if(t&&(n=t(r,n)),typeof n=="object"&&n!==null){if(e.has(n))return;e.add(n)}return n}},qt=(t,e)=>JSON.stringify(t,mee(e));function pee(t,e,r,n,s){const i=Object.keys(t),a=n==null?void 0:n.channels,l=n==null?void 0:n.audioCodec,d=s==null?void 0:s.videoCodec,u=a&&parseInt(a)===2;let f=!1,p=!1,y=1/0,v=1/0,E=1/0,b=1/0,T=0,I=[];const{preferHDR:N,allowedVideoRanges:A}=fee(e,s);for(let O=i.length;O--;){const F=t[i[O]];f||(f=F.channels[2]>0),y=Math.min(y,F.minHeight),v=Math.min(v,F.minFramerate),E=Math.min(E,F.minBitrate),A.filter(G=>F.videoRanges[G]>0).length>0&&(p=!0)}y=Ve(y)?y:0,v=Ve(v)?v:0;const L=Math.max(1080,y),P=Math.max(30,v);E=Ve(E)?E:r,r=Math.max(E,r),p||(e=void 0);const k=i.length>1;return{codecSet:i.reduce((O,F)=>{const $=t[F];if(F===O)return O;if(I=p?A.filter(G=>$.videoRanges[G]>0):[],k){if($.minBitrate>r)return Bi(F,`min bitrate of ${$.minBitrate} > current estimate of ${r}`),O;if(!$.hasDefaultAudio)return Bi(F,"no renditions with default or auto-select sound found"),O;if(l&&F.indexOf(l.substring(0,4))%5!==0)return Bi(F,`audio codec preference "${l}" not found`),O;if(a&&!u){if(!$.channels[a])return Bi(F,`no renditions with ${a} channel sound found (channels options: ${Object.keys($.channels)})`),O}else if((!l||u)&&f&&$.channels[2]===0)return Bi(F,"no renditions with stereo sound found"),O;if($.minHeight>L)return Bi(F,`min resolution of ${$.minHeight} > maximum of ${L}`),O;if($.minFramerate>P)return Bi(F,`min framerate of ${$.minFramerate} > maximum of ${P}`),O;if(!I.some(G=>$.videoRanges[G]>0))return Bi(F,`no variants with VIDEO-RANGE of ${qt(I)} found`),O;if(d&&F.indexOf(d.substring(0,4))%5!==0)return Bi(F,`video codec preference "${d}" not found`),O;if($.maxScore<T)return Bi(F,`max score of ${$.maxScore} < selected max of ${T}`),O}return O&&(hp(F)>=hp(O)||$.fragmentError>t[O].fragmentError)?O:(b=$.minIndex,T=$.maxScore,F)},void 0),videoRanges:I,preferHDR:N,minFramerate:v,minBitrate:E,minIndex:b}}function Bi(t,e){Vt.log(`[abr] start candidates with "${t}" ignored because ${e}`)}function Uj(t){return t.reduce((e,r)=>{let n=e.groups[r.groupId];n||(n=e.groups[r.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),n.tracks.push(r);const s=r.channels||"2";return n.channels[s]=(n.channels[s]||0)+1,n.hasDefault=n.hasDefault||r.default,n.hasAutoSelect=n.hasAutoSelect||r.autoselect,n.hasDefault&&(e.hasDefaultAudio=!0),n.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function gee(t,e,r,n){return t.slice(r,n+1).reduce((s,i,a)=>{if(!i.codecSet)return s;const l=i.audioGroups;let d=s[i.codecSet];d||(s[i.codecSet]=d={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!l,fragmentError:0}),d.minBitrate=Math.min(d.minBitrate,i.bitrate);const u=Math.min(i.height,i.width);return d.minHeight=Math.min(d.minHeight,u),d.minFramerate=Math.min(d.minFramerate,i.frameRate),d.minIndex=Math.min(d.minIndex,a),d.maxScore=Math.max(d.maxScore,i.score),d.fragmentError+=i.fragmentError,d.videoRanges[i.videoRange]=(d.videoRanges[i.videoRange]||0)+1,l&&l.forEach(f=>{if(!f)return;const p=e.groups[f];p&&(d.hasDefaultAudio=d.hasDefaultAudio||e.hasDefaultAudio?p.hasDefault:p.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(p.channels).forEach(y=>{d.channels[y]=(d.channels[y]||0)+p.channels[y]}))}),s},{})}function VA(t){if(!t)return t;const{lang:e,assocLang:r,characteristics:n,channels:s,audioCodec:i}=t;return{lang:e,assocLang:r,characteristics:n,channels:s,audioCodec:i}}function Qi(t,e,r){if("attrs"in t){const n=e.indexOf(t);if(n!==-1)return n}for(let n=0;n<e.length;n++){const s=e[n];if(Dl(t,s,r))return n}return-1}function Dl(t,e,r){const{groupId:n,name:s,lang:i,assocLang:a,default:l}=t,d=t.forced;return(n===void 0||e.groupId===n)&&(s===void 0||e.name===s)&&(i===void 0||xee(i,e.lang))&&(i===void 0||e.assocLang===a)&&(l===void 0||e.default===l)&&(d===void 0||e.forced===d)&&(!("characteristics"in t)||yee(t.characteristics||"",e.characteristics))&&(r===void 0||r(t,e))}function xee(t,e="--"){return t.length===e.length?t===e:t.startsWith(e)||e.startsWith(t)}function yee(t,e=""){const r=t.split(","),n=e.split(",");return r.length===n.length&&!r.some(s=>n.indexOf(s)===-1)}function dl(t,e){const{audioCodec:r,channels:n}=t;return(r===void 0||(e.audioCodec||"").substring(0,4)===r.substring(0,4))&&(n===void 0||n===(e.channels||"2"))}function vee(t,e,r,n,s){const i=e[n],l=e.reduce((y,v,E)=>{const b=v.uri;return(y[b]||(y[b]=[])).push(E),y},{})[i.uri];l.length>1&&(n=Math.max.apply(Math,l));const d=i.videoRange,u=i.frameRate,f=i.codecSet.substring(0,4),p=GA(e,n,y=>{if(y.videoRange!==d||y.frameRate!==u||y.codecSet.substring(0,4)!==f)return!1;const v=y.audioGroups,E=r.filter(b=>!v||v.indexOf(b.groupId)!==-1);return Qi(t,E,s)>-1});return p>-1?p:GA(e,n,y=>{const v=y.audioGroups,E=r.filter(b=>!v||v.indexOf(b.groupId)!==-1);return Qi(t,E,s)>-1})}function GA(t,e,r){for(let n=e;n>-1;n--)if(r(t[n]))return n;for(let n=e+1;n<t.length;n++)if(r(t[n]))return n;return-1}function pp(t,e){var r;return!!t&&t!==((r=e.loadLevelObj)==null?void 0:r.uri)}class wee extends ii{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=r=>{var n;const{fragCurrent:s,partCurrent:i,hls:a}=this,{autoLevelEnabled:l,media:d}=a;if(!s||!d)return;const u=performance.now(),f=i?i.stats:s.stats,p=i?i.duration:s.duration,y=u-f.loading.start,v=a.minAutoLevel,E=s.level,b=this._nextAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||E<=v){this.clearTimer(),this._nextAutoLevel=-1;return}if(!l)return;const T=b>-1&&b!==E,I=!!r||T;if(!I&&(d.paused||!d.playbackRate||!d.readyState))return;const N=a.mainForwardBufferInfo;if(!I&&N===null)return;const A=this.bwEstimator.getEstimateTTFB(),L=Math.abs(d.playbackRate);if(y<=Math.max(A,1e3*(p/(L*2))))return;const P=N?N.len/L:0,k=f.loading.first?f.loading.first-f.loading.start:-1,D=f.loaded&&k>-1,O=this.getBwEstimate(),F=a.levels,$=F[E],G=Math.max(f.loaded,Math.round(p*(s.bitrate||$.averageBitrate)/8));let Y=D?y-k:y;Y<1&&D&&(Y=Math.min(y,f.loaded*8/O));const ne=D?f.loaded*1e3/Y:0,X=A/1e3,z=ne?(G-f.loaded)/ne:G*8/O+X;if(z<=P)return;const Z=ne?ne*8:O,ee=((n=(r==null?void 0:r.details)||this.hls.latestLevelDetails)==null?void 0:n.live)===!0,q=this.hls.config.abrBandWidthUpFactor;let K=Number.POSITIVE_INFINITY,ae;for(ae=E-1;ae>v;ae--){const ie=F[ae].maxBitrate,se=!F[ae].details||ee;if(K=this.getTimeToLoadFrag(X,Z,p*ie,se),K<Math.min(P,p+X))break}if(K>=z||K>p*10)return;D?this.bwEstimator.sample(y-Math.min(A,k),f.loaded):this.bwEstimator.sampleTTFB(y);const Q=F[ae].maxBitrate;this.getBwEstimate()*q>Q&&this.resetEstimator(Q);const re=this.findBestLevel(Q,v,ae,0,P,1,1);re>-1&&(ae=re),this.warn(`Fragment ${s.sn}${i?" part "+i.index:""} of level ${E} is loading too slowly;
      Fragment duration: ${s.duration.toFixed(3)}
      Time to underbuffer: ${P.toFixed(3)} s
      Estimated load time for current fragment: ${z.toFixed(3)} s
      Estimated load time for down switch fragment: ${K.toFixed(3)} s
      TTFB estimate: ${k|0} ms
      Current BW estimate: ${Ve(O)?O|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${ae} @ ${Q|0} bps`),a.nextLoadLevel=a.nextAutoLevel=ae,this.clearTimer();const Ee=()=>{if(this.clearTimer(),this.fragCurrent===s&&this.hls.loadLevel===ae&&ae>0){const ie=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${ae>0?"and switching down":""}
      Fragment duration: ${s.duration.toFixed(3)} s
      Time to underbuffer: ${ie.toFixed(3)} s`),s.abortRequests(),this.fragCurrent=this.partCurrent=null,ae>v){let se=this.findBestLevel(this.hls.levels[v].bitrate,v,ae,0,ie,1,1);se===-1&&(se=v),this.hls.nextLoadLevel=this.hls.nextAutoLevel=se,this.resetEstimator(this.hls.levels[se].bitrate)}}};T||z>K*2?Ee():this.timer=self.setInterval(Ee,K*1e3),a.trigger(M.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:i,stats:f})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new CJ(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.FRAG_LOADING,this.onFragLoading,this),e.on(M.FRAG_LOADED,this.onFragLoaded,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this),e.on(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.FRAG_LOADING,this.onFragLoading,this),e.off(M.FRAG_LOADED,this.onFragLoaded,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this),e.off(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(M.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,r){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,r){const n=r.frag;if(!this.ignoreFragment(n)){if(!n.bitrateTest){var s;this.fragCurrent=n,this.partCurrent=(s=r.part)!=null?s:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,r){this.clearTimer()}onError(e,r){if(!r.fatal)switch(r.details){case ue.BUFFER_ADD_CODEC_ERROR:case ue.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case ue.FRAG_LOAD_TIMEOUT:{const n=r.frag,{fragCurrent:s,partCurrent:i}=this;if(n&&s&&n.sn===s.sn&&n.level===s.level){const a=performance.now(),l=i?i.stats:n.stats,d=a-l.loading.start,u=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&u>-1){const p=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(d-Math.min(p,u),l.loaded)}else this.bwEstimator.sampleTTFB(d)}break}}}getTimeToLoadFrag(e,r,n,s){const i=e+n/r,a=s?e+this.lastLevelLoadSec:0;return i+a}onLevelLoaded(e,r){const n=this.hls.config,{loading:s}=r.stats,i=s.end-s.first;Ve(i)&&(this.lastLevelLoadSec=i/1e3),r.details.live?this.bwEstimator.update(n.abrEwmaSlowLive,n.abrEwmaFastLive):this.bwEstimator.update(n.abrEwmaSlowVoD,n.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(r.levelInfo)}onFragLoaded(e,{frag:r,part:n}){const s=n?n.stats:r.stats;if(r.type===ze.MAIN&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const i=n?n.duration:r.duration,a=this.hls.levels[r.level],l=(a.loaded?a.loaded.bytes:0)+s.loaded,d=(a.loaded?a.loaded.duration:0)+i;a.loaded={bytes:l,duration:d},a.realBitrate=Math.round(8*l/d)}if(r.bitrateTest){const i={stats:s,frag:r,part:n,id:r.type};this.onFragBuffered(M.FRAG_BUFFERED,i),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}}onFragBuffered(e,r){const{frag:n,part:s}=r,i=s!=null&&s.stats.loaded?s.stats:n.stats;if(i.aborted||this.ignoreFragment(n))return;const a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.getBwEstimate(),n.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==ze.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:r}=this.hls,n=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,i=this.findBestLevel(n,r,e,0,s,1,1);if(i>-1)return i;const a=this.hls.firstLevel,l=Math.min(Math.max(a,r),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,n=this.bwEstimator.canEstimate(),s=this.lastLoadedFragLevel>-1;if(e!==-1&&(!n||!s||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const i=n&&s?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,i)&&a[e].loadError<=a[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:r,hls:n}=this;if(n.levels.length<=1)return n.loadLevel;const{maxAutoLevel:s,config:i,minAutoLevel:a}=n,l=r?r.duration:e?e.duration:0,d=this.getBwEstimate(),u=this.getStarvationDelay();let f=i.abrBandWidthFactor,p=i.abrBandWidthUpFactor;if(u){const T=this.findBestLevel(d,a,s,u,0,f,p);if(T>=0)return this.rebufferNotice=-1,T}let y=l?Math.min(l,i.maxStarvationDelay):i.maxStarvationDelay;if(!u){const T=this.bitrateTestDelay;T&&(y=(l?Math.min(l,i.maxLoadingDelay):i.maxLoadingDelay)-T,this.info(`bitrate test took ${Math.round(1e3*T)}ms, set first fragment max fetchDuration to ${Math.round(1e3*y)} ms`),f=p=1)}const v=this.findBestLevel(d,a,s,u,y,f,p);if(this.rebufferNotice!==v&&(this.rebufferNotice=v,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${v}`)),v>-1)return v;const E=n.levels[a],b=n.loadLevelObj;return b&&(E==null?void 0:E.bitrate)<b.bitrate?a:n.loadLevel}getStarvationDelay(){const e=this.hls,r=e.media;if(!r)return 1/0;const n=r&&r.playbackRate!==0?Math.abs(r.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/n}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,r,n,s,i,a,l){var d;const u=s+i,f=this.lastLoadedFragLevel,p=f===-1?this.hls.firstLevel:f,{fragCurrent:y,partCurrent:v}=this,{levels:E,allAudioTracks:b,loadLevel:T,config:I}=this.hls;if(E.length===1)return 0;const N=E[p],A=!!((d=this.hls.latestLevelDetails)!=null&&d.live),L=T===-1||f===-1;let P,k="SDR",D=(N==null?void 0:N.frameRate)||0;const{audioPreference:O,videoPreference:F}=I,$=this.audioTracksByGroup||(this.audioTracksByGroup=Uj(b));let G=-1;if(L){if(this.firstSelection!==-1)return this.firstSelection;const Z=this.codecTiers||(this.codecTiers=gee(E,$,r,n)),ee=pee(Z,k,e,O,F),{codecSet:q,videoRanges:K,minFramerate:ae,minBitrate:Q,minIndex:re,preferHDR:Ee}=ee;G=re,P=q,k=Ee?K[K.length-1]:K[0],D=ae,e=Math.max(e,Q),this.log(`picked start tier ${qt(ee)}`)}else P=N==null?void 0:N.codecSet,k=N==null?void 0:N.videoRange;const Y=v?v.duration:y?y.duration:0,ne=this.bwEstimator.getEstimateTTFB()/1e3,X=[];for(let Z=n;Z>=r;Z--){var z;const ee=E[Z],q=Z>p;if(!ee)continue;if(I.useMediaCapabilities&&!ee.supportedResult&&!ee.supportedPromise){const se=navigator.mediaCapabilities;typeof(se==null?void 0:se.decodingInfo)=="function"&&iee(ee,$,k,D,e,O)?(ee.supportedPromise=Fj(ee,$,se,this.supportedCache),ee.supportedPromise.then(oe=>{if(!this.hls)return;ee.supportedResult=oe;const fe=this.hls.levels,Le=fe.indexOf(ee);oe.error?this.warn(`MediaCapabilities decodingInfo error: "${oe.error}" for level ${Le} ${qt(oe)}`):oe.supported?oe.decodingInfoResults.some(_e=>_e.smooth===!1||_e.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${Le} not smooth or powerEfficient: ${qt(oe)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Le} ${qt(oe)}`),Le>-1&&fe.length>1&&(this.log(`Removing unsupported level ${Le}`),this.hls.removeLevel(Le),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(oe=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${oe}`)})):ee.supportedResult=Mj}if((P&&ee.codecSet!==P||k&&ee.videoRange!==k||q&&D>ee.frameRate||!q&&D>0&&D<ee.frameRate||(z=ee.supportedResult)!=null&&(z=z.decodingInfoResults)!=null&&z.some(se=>se.smooth===!1))&&(!L||Z!==G)){X.push(Z);continue}const K=ee.details,ae=(v?K==null?void 0:K.partTarget:K==null?void 0:K.averagetargetduration)||Y;let Q;q?Q=l*e:Q=a*e;const re=Y&&s>=Y*2&&i===0?ee.averageBitrate:ee.maxBitrate,Ee=this.getTimeToLoadFrag(ne,Q,re*ae,K===void 0);if(Q>=re&&(Z===f||ee.loadError===0&&ee.fragmentError===0)&&(Ee<=ne||!Ve(Ee)||A&&!this.bitrateTestDelay||Ee<u)){const se=this.forcedAutoLevel;return Z!==T&&(se===-1||se!==T)&&(X.length&&this.trace(`Skipped level(s) ${X.join(",")} of ${n} max with CODECS and VIDEO-RANGE:"${E[X[0]].codecs}" ${E[X[0]].videoRange}; not compatible with "${P}" ${k}`),this.info(`switch candidate:${p}->${Z} adjustedbw(${Math.round(Q)})-bitrate=${Math.round(Q-re)} ttfb:${ne.toFixed(1)} avgDuration:${ae.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${Ee.toFixed(1)} firstSelection:${L} codecSet:${ee.codecSet} videoRange:${ee.videoRange} hls.loadLevel:${T}`)),L&&(this.firstSelection=Z),Z}}return-1}set nextAutoLevel(e){const r=this.deriveNextAutoLevel(e);this._nextAutoLevel!==r&&(this.nextAutoLevelKey="",this._nextAutoLevel=r)}deriveNextAutoLevel(e){const{maxAutoLevel:r,minAutoLevel:n}=this.hls;return Math.min(Math.max(e,n),r)}}const $j={search:function(t,e){let r=0,n=t.length-1,s=null,i=null;for(;r<=n;){s=(r+n)/2|0,i=t[s];const a=e(i);if(a>0)r=s+1;else if(a<0)n=s-1;else return i}return null}};function bee(t,e,r){if(e===null||!Array.isArray(t)||!t.length||!Ve(e))return null;const n=t[0].programDateTime;if(e<(n||0))return null;const s=t[t.length-1].endProgramDateTime;if(e>=(s||0))return null;for(let i=0;i<t.length;++i){const a=t[i];if(See(e,r,a))return a}return null}function Xl(t,e,r=0,n=0,s=.005){let i=null;if(t){i=e[1+t.sn-e[0].sn]||null;const l=t.endDTS-r;l>0&&l<15e-7&&(r+=15e-7),i&&t.level!==i.level&&i.end<=t.end&&(i=e[2+t.sn-e[0].sn]||null)}else r===0&&e[0].start===0&&(i=e[0]);if(i&&((!t||t.level===i.level)&&HA(r,n,i)===0||Eee(i,t,Math.min(s,n))))return i;const a=$j.search(e,HA.bind(null,r,n));return a&&(a!==t||!i)?a:i}function Eee(t,e,r){if(e&&e.start===0&&e.level<t.level&&(e.endPTS||0)>0){const n=e.tagList.reduce((s,i)=>(i[0]==="INF"&&(s+=parseFloat(i[1])),s),r);return t.start<=n}return!1}function HA(t=0,e=0,r){if(r.start<=t&&r.start+r.duration>t)return 0;const n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=t?1:r.start-n>t&&r.start?-1:0}function See(t,e,r){const n=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0))*1e3;return(r.endProgramDateTime||0)-n>t}function Vj(t,e,r){if(t&&t.startCC<=e&&t.endCC>=e){let n=t.fragments;const{fragmentHint:s}=t;s&&(n=n.concat(s));let i;return $j.search(n,a=>a.cc<e?1:a.cc>e?-1:(i=a,a.end<=r?1:a.start>r?-1:0)),i||null}return null}function gp(t){switch(t.details){case ue.FRAG_LOAD_TIMEOUT:case ue.KEY_LOAD_TIMEOUT:case ue.LEVEL_LOAD_TIMEOUT:case ue.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Gj(t){return t.details.startsWith("key")}function Hj(t){return Gj(t)&&!!t.frag&&!t.frag.decryptdata}function zA(t,e){const r=gp(e);return t.default[`${r?"timeout":"error"}Retry`]}function zE(t,e){const r=t.backoff==="linear"?1:Math.pow(2,e);return Math.min(r*t.retryDelayMs,t.maxRetryDelayMs)}function WA(t){return $t($t({},t),{errorRetry:null,timeoutRetry:null})}function xp(t,e,r,n){if(!t)return!1;const s=n==null?void 0:n.code,i=e<t.maxNumRetry&&(Tee(s)||!!r);return t.shouldRetry?t.shouldRetry(t,e,r,n,i):i}function Tee(t){return Ov(t)||!!t&&(t<400||t>499)}function Ov(t){return t===0&&navigator.onLine===!1}var vn={DoNothing:0,SendEndCallback:1,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,InsertDiscontinuity:4,RetryRequest:5},ws={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4,SwitchToSDR:8};class Cee extends ii{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(M.ERROR,this.onError,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(M.ERROR,this.onError,this),e.off(M.ERROR,this.onErrorOut,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===ze.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;const r=this.hls,n=r.currentLevel;return(e=r.loadLevelObj)!=null&&e.details||n===-1?r.loadLevel:n}variantHasKey(e,r){if(e){var n;if((n=e.details)!=null&&n.hasKey(r))return!0;const s=e.audioGroups;if(s)return this.hls.allAudioTracks.filter(a=>s.indexOf(a.groupId)>=0).some(a=>{var l;return(l=a.details)==null?void 0:l.hasKey(r)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,r){var n;if(r.fatal)return;const s=this.hls,i=r.context;switch(r.details){case ue.FRAG_LOAD_ERROR:case ue.FRAG_LOAD_TIMEOUT:case ue.KEY_LOAD_ERROR:case ue.KEY_LOAD_TIMEOUT:r.errorAction=this.getFragRetryOrSwitchAction(r);return;case ue.FRAG_PARSING_ERROR:if((n=r.frag)!=null&&n.gap){r.errorAction=lu();return}case ue.FRAG_GAP:case ue.FRAG_DECRYPT_ERROR:{r.errorAction=this.getFragRetryOrSwitchAction(r),r.errorAction.action=vn.SendAlternateToPenaltyBox;return}case ue.LEVEL_EMPTY_ERROR:case ue.LEVEL_PARSING_ERROR:{var a;const d=r.parent===ze.MAIN?r.level:s.loadLevel;r.details===ue.LEVEL_EMPTY_ERROR&&((a=r.context)!=null&&(a=a.levelDetails)!=null&&a.live)?r.errorAction=this.getPlaylistRetryOrSwitchAction(r,d):(r.levelRetry=!1,r.errorAction=this.getLevelSwitchAction(r,d))}return;case ue.LEVEL_LOAD_ERROR:case ue.LEVEL_LOAD_TIMEOUT:typeof(i==null?void 0:i.level)=="number"&&(r.errorAction=this.getPlaylistRetryOrSwitchAction(r,i.level));return;case ue.AUDIO_TRACK_LOAD_ERROR:case ue.AUDIO_TRACK_LOAD_TIMEOUT:case ue.SUBTITLE_LOAD_ERROR:case ue.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){const d=s.loadLevelObj;if(d&&(i.type===Ct.AUDIO_TRACK&&d.hasAudioGroup(i.groupId)||i.type===Ct.SUBTITLE_TRACK&&d.hasSubtitleGroup(i.groupId))){r.errorAction=this.getPlaylistRetryOrSwitchAction(r,s.loadLevel),r.errorAction.action=vn.SendAlternateToPenaltyBox,r.errorAction.flags=ws.MoveAllAlternatesMatchingHost;return}}return;case ue.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:r.errorAction={action:vn.SendAlternateToPenaltyBox,flags:ws.MoveAllAlternatesMatchingHDCP};return;case ue.KEY_SYSTEM_SESSION_UPDATE_FAILED:case ue.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case ue.KEY_SYSTEM_NO_SESSION:r.errorAction={action:vn.SendAlternateToPenaltyBox,flags:ws.MoveAllAlternatesMatchingKey};return;case ue.BUFFER_ADD_CODEC_ERROR:case ue.REMUX_ALLOC_ERROR:case ue.BUFFER_APPEND_ERROR:if(!r.errorAction){var l;r.errorAction=this.getLevelSwitchAction(r,(l=r.level)!=null?l:s.loadLevel)}return;case ue.INTERNAL_EXCEPTION:case ue.BUFFER_APPENDING_ERROR:case ue.BUFFER_FULL_ERROR:case ue.LEVEL_SWITCH_ERROR:case ue.BUFFER_STALLED_ERROR:case ue.BUFFER_SEEK_OVER_HOLE:case ue.BUFFER_NUDGE_ON_STALL:r.errorAction=lu();return}r.type===Qe.KEY_SYSTEM_ERROR&&(r.levelRetry=!1,r.errorAction=lu())}getPlaylistRetryOrSwitchAction(e,r){const n=this.hls,s=zA(n.config.playlistLoadPolicy,e),i=this.playlistError++;if(xp(s,i,gp(e),e.response))return{action:vn.RetryRequest,flags:ws.None,retryConfig:s,retryCount:i};const l=this.getLevelSwitchAction(e,r);return s&&(l.retryConfig=s,l.retryCount=i),l}getFragRetryOrSwitchAction(e){const r=this.hls,n=this.getVariantLevelIndex(e.frag),s=r.levels[n],{fragLoadPolicy:i,keyLoadPolicy:a}=r.config,l=zA(Gj(e)?a:i,e),d=r.levels.reduce((f,p)=>f+p.fragmentError,0);if(s&&(e.details!==ue.FRAG_GAP&&s.fragmentError++,!Hj(e)&&xp(l,d,gp(e),e.response)))return{action:vn.RetryRequest,flags:ws.None,retryConfig:l,retryCount:d};const u=this.getLevelSwitchAction(e,n);return l&&(u.retryConfig=l,u.retryCount=d),u}getLevelSwitchAction(e,r){const n=this.hls;r==null&&(r=n.loadLevel);const s=this.hls.levels[r];if(s){var i,a;const u=e.details;s.loadError++,u===ue.BUFFER_APPEND_ERROR&&s.fragmentError++;let f=-1;const{levels:p,loadLevel:y,minAutoLevel:v,maxAutoLevel:E}=n;!n.autoLevelEnabled&&!n.config.preserveManualLevelOnError&&(n.loadLevel=-1);const b=(i=e.frag)==null?void 0:i.type,I=(b===ze.AUDIO&&u===ue.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===ue.BUFFER_ADD_CODEC_ERROR||u===ue.BUFFER_APPEND_ERROR))&&p.some(({audioCodec:k})=>s.audioCodec!==k),A=e.sourceBufferName==="video"&&(u===ue.BUFFER_ADD_CODEC_ERROR||u===ue.BUFFER_APPEND_ERROR)&&p.some(({codecSet:k,audioCodec:D})=>s.codecSet!==k&&s.audioCodec===D),{type:L,groupId:P}=(a=e.context)!=null?a:{};for(let k=p.length;k--;){const D=(k+y)%p.length;if(D!==y&&D>=v&&D<=E&&p[D].loadError===0){var l,d;const O=p[D];if(u===ue.FRAG_GAP&&b===ze.MAIN&&e.frag){const F=p[D].details;if(F){const $=Xl(e.frag,F.fragments,e.frag.start);if($!=null&&$.gap)continue}}else{if(L===Ct.AUDIO_TRACK&&O.hasAudioGroup(P)||L===Ct.SUBTITLE_TRACK&&O.hasSubtitleGroup(P))continue;if(b===ze.AUDIO&&(l=s.audioGroups)!=null&&l.some(F=>O.hasAudioGroup(F))||b===ze.SUBTITLE&&(d=s.subtitleGroups)!=null&&d.some(F=>O.hasSubtitleGroup(F))||I&&s.audioCodec===O.audioCodec||A&&s.codecSet===O.codecSet||!I&&s.codecSet!==O.codecSet)continue}f=D;break}}if(f>-1&&n.loadLevel!==f)return e.levelRetry=!0,this.playlistError=0,{action:vn.SendAlternateToPenaltyBox,flags:ws.None,nextAutoLevel:f}}return{action:vn.SendAlternateToPenaltyBox,flags:ws.MoveAllAlternatesMatchingHost}}onErrorOut(e,r){var n;switch((n=r.errorAction)==null?void 0:n.action){case vn.DoNothing:break;case vn.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(r),!r.errorAction.resolved&&r.details!==ue.FRAG_GAP?r.fatal=!0:/MediaSource readyState: ended/.test(r.error.message)&&(this.warn(`MediaSource ended after "${r.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(r.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const r=this.hls,n=e.errorAction;if(!n)return;const{flags:s}=n,i=n.nextAutoLevel;switch(s){case ws.None:this.switchLevel(e,i);break;case ws.MoveAllAlternatesMatchingHDCP:{const d=this.getVariantLevelIndex(e.frag),u=r.levels[d],f=u==null?void 0:u.attrs["HDCP-LEVEL"];if(n.hdcpLevel=f,f==="NONE")this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(f){r.maxHdcpLevel=Mv[Mv.indexOf(f)-1],n.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${r.maxHdcpLevel}" or lower`);break}}case ws.MoveAllAlternatesMatchingKey:{const d=e.decryptdata;if(d){const u=this.hls.levels,f=u.length;for(let y=f;y--;)if(this.variantHasKey(u[y],d)){var a,l;this.log(`Banned key found in level ${y} (${u[y].bitrate}bps) or audio group "${(a=u[y].audioGroups)==null?void 0:a.join(",")}" (${(l=e.frag)==null?void 0:l.type} fragment) ${wn(d.keyId||[])}`),u[y].fragmentError++,u[y].loadError++,this.log(`Removing level ${y} with key error (${e.error})`),this.hls.removeLevel(y)}const p=e.frag;if(this.hls.levels.length<f)n.resolved=!0;else if(p&&p.type!==ze.MAIN){const y=p.decryptdata;y&&!d.matches(y)&&(n.resolved=!0)}}break}}n.resolved||this.switchLevel(e,i)}switchLevel(e,r){if(r!==void 0&&e.errorAction&&(this.warn(`switching to level ${r} after ${e.details}`),this.hls.nextAutoLevel=r,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===ue.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const n=jv(e.mimeType),s=this.hls.levels;for(let i=s.length;i--;)s[i][`${e.sourceBufferName}Codec`]===n&&(this.log(`Removing level ${i} for ${e.details} ("${n}" not supported)`),this.hls.removeLevel(i))}}}function lu(t){const e={action:vn.DoNothing,flags:ws.None};return t&&(e.resolved=!0),e}var en={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Aee{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e&&(e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.BUFFER_APPENDED,this.onBufferAppended,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this),e.on(M.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.BUFFER_APPENDED,this.onBufferAppended,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this),e.off(M.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,r){const n=this.activePartLists[r];if(n)for(let s=n.length;s--;){const i=n[s];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,r)}getBufferedFrag(e,r){return this.getFragAtPos(e,r,!0)}getFragAtPos(e,r,n){const{fragments:s}=this,i=Object.keys(s);for(let a=i.length;a--;){const l=s[i[a]];if((l==null?void 0:l.body.type)===r&&(!n||l.buffered)){const d=l.body;if(d.start<=e&&e<=d.end)return d}}return null}detectEvictedFragments(e,r,n,s,i){this.timeRanges&&(this.timeRanges[e]=r);const a=(s==null?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach(l=>{const d=this.fragments[l];if(!d||a>=d.body.sn)return;if(!d.buffered&&(!d.loaded||i)){d.body.type===n&&this.removeFragment(d.body);return}const u=d.range[e];if(u){if(u.time.length===0){this.removeFragment(d.body);return}u.time.some(f=>{const p=!this.isTimeBuffered(f.startPTS,f.endPTS,r);return p&&this.removeFragment(d.body),p})}})}detectPartialFragments(e){const r=this.timeRanges;if(!r||e.frag.sn==="initSegment")return;const n=e.frag,s=Tc(n),i=this.fragments[s];if(!i||i.buffered&&n.gap)return;const a=!n.relurl;Object.keys(r).forEach(l=>{const d=n.elementaryStreams[l];if(!d)return;const u=r[l],f=a||d.partial===!0;i.range[l]=this.getBufferedTimes(n,e.part,f,u)}),i.loaded=null,Object.keys(i.range).length?(this.bufferedEnd(i,n),vm(i)||this.removeParts(n.sn-1,n.type)):this.removeFragment(i.body)}bufferedEnd(e,r){e.buffered=!0,(e.body.endList=r.endList||e.body.endList)&&(this.endListFragments[e.body.type]=e)}removeParts(e,r){const n=this.activePartLists[r];n&&(this.activePartLists[r]=KA(n,s=>s.fragment.sn>=e))}fragBuffered(e,r){const n=Tc(e);let s=this.fragments[n];!s&&r&&(s=this.fragments[n]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,this.bufferedEnd(s,e))}getBufferedTimes(e,r,n,s){const i={time:[],partial:n},a=e.start,l=e.end,d=e.minEndPTS||l,u=e.maxStartPTS||a;for(let f=0;f<s.length;f++){const p=s.start(f)-this.bufferPadding,y=s.end(f)+this.bufferPadding;if(u>=p&&d<=y){i.time.push({startPTS:Math.max(a,s.start(f)),endPTS:Math.min(l,s.end(f))});break}else if(a<y&&l>p){const v=Math.max(a,s.start(f)),E=Math.min(l,s.end(f));E>v&&(i.partial=!0,i.time.push({startPTS:v,endPTS:E}))}else if(l<=p)break}return i}getPartialFragment(e){let r=null,n,s,i,a=0;const{bufferPadding:l,fragments:d}=this;return Object.keys(d).forEach(u=>{const f=d[u];f&&vm(f)&&(s=f.body.start-l,i=f.body.end+l,e>=s&&e<=i&&(n=Math.min(e-s,i-e),a<=n&&(r=f.body,a=n)))}),r}isEndListAppended(e){const r=this.endListFragments[e];return r!==void 0&&(r.buffered||vm(r))}getState(e){const r=Tc(e),n=this.fragments[r];return n?n.buffered?vm(n)?en.PARTIAL:en.OK:en.APPENDING:en.NOT_LOADED}isTimeBuffered(e,r,n){let s,i;for(let a=0;a<n.length;a++){if(s=n.start(a)-this.bufferPadding,i=n.end(a)+this.bufferPadding,e>=s&&r<=i)return!0;if(r<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,r){if(r.frag.sn==="initSegment"||r.frag.bitrateTest)return;const n=r.frag,s=r.part?null:r,i=Tc(n);this.fragments[i]={body:n,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,r){const{frag:n,part:s,timeRanges:i,type:a}=r;if(n.sn==="initSegment")return;const l=n.type;if(s){let u=this.activePartLists[l];u||(this.activePartLists[l]=u=[]),u.push(s)}this.timeRanges=i;const d=i[a];this.detectEvictedFragments(a,d,l,s)}onFragBuffered(e,r){this.detectPartialFragments(r)}hasFragment(e){const r=Tc(e);return!!this.fragments[r]}hasFragments(e){const{fragments:r}=this,n=Object.keys(r);if(!e)return n.length>0;for(let s=n.length;s--;){const i=r[n[s]];if((i==null?void 0:i.body.type)===e)return!0}return!1}hasParts(e){var r;return!!((r=this.activePartLists[e])!=null&&r.length)}removeFragmentsInRange(e,r,n,s,i){s&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const l=this.fragments[a];if(!l)return;const d=l.body;d.type!==n||s&&!d.gap||d.start<r&&d.end>e&&(l.buffered||i)&&this.removeFragment(d)})}removeFragment(e){const r=Tc(e);e.clearElementaryStreamInfo();const n=this.activePartLists[e.type];if(n){const s=e.sn;this.activePartLists[e.type]=KA(n,i=>i.fragment.sn!==s)}delete this.fragments[r],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const r=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;r&&r.forEach(n=>n.clearElementaryStreamInfo())}}function vm(t){var e,r,n;return t.buffered&&!!(t.body.gap||(e=t.range.video)!=null&&e.partial||(r=t.range.audio)!=null&&r.partial||(n=t.range.audiovideo)!=null&&n.partial)}function Tc(t){return`${t.type}_${t.level}_${t.sn}`}function KA(t,e){return t.filter(r=>{const n=e(r);return n||r.clearElementaryStreamInfo(),n})}var Uo={cbc:0,ctr:1};class Nee{constructor(e,r,n){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=r,this.aesMode=n}decrypt(e,r){switch(this.aesMode){case Uo.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},r,e);case Uo.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},r,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function Iee(t){const e=t.byteLength,r=e&&new DataView(t.buffer).getUint8(e-1);return r?t.slice(0,e-r):t}class Ree{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const r=new DataView(e),n=new Uint32Array(4);for(let s=0;s<4;s++)n[s]=r.getUint32(s*4);return n}initTable(){const e=this.sBox,r=this.invSBox,n=this.subMix,s=n[0],i=n[1],a=n[2],l=n[3],d=this.invSubMix,u=d[0],f=d[1],p=d[2],y=d[3],v=new Uint32Array(256);let E=0,b=0,T=0;for(T=0;T<256;T++)T<128?v[T]=T<<1:v[T]=T<<1^283;for(T=0;T<256;T++){let I=b^b<<1^b<<2^b<<3^b<<4;I=I>>>8^I&255^99,e[E]=I,r[I]=E;const N=v[E],A=v[N],L=v[A];let P=v[I]*257^I*16843008;s[E]=P<<24|P>>>8,i[E]=P<<16|P>>>16,a[E]=P<<8|P>>>24,l[E]=P,P=L*16843009^A*65537^N*257^E*16843008,u[I]=P<<24|P>>>8,f[I]=P<<16|P>>>16,p[I]=P<<8|P>>>24,y[I]=P,E?(E=N^v[v[v[L^N]]],b^=v[v[b]]):E=b=1}}expandKey(e){const r=this.uint8ArrayToUint32Array_(e);let n=!0,s=0;for(;s<r.length&&n;)n=r[s]===this.key[s],s++;if(n)return;this.key=r;const i=this.keySize=r.length;if(i!==4&&i!==6&&i!==8)throw new Error("Invalid aes key size="+i);const a=this.ksRows=(i+6+1)*4;let l,d;const u=this.keySchedule=new Uint32Array(a),f=this.invKeySchedule=new Uint32Array(a),p=this.sBox,y=this.rcon,v=this.invSubMix,E=v[0],b=v[1],T=v[2],I=v[3];let N,A;for(l=0;l<a;l++){if(l<i){N=u[l]=r[l];continue}A=N,l%i===0?(A=A<<8|A>>>24,A=p[A>>>24]<<24|p[A>>>16&255]<<16|p[A>>>8&255]<<8|p[A&255],A^=y[l/i|0]<<24):i>6&&l%i===4&&(A=p[A>>>24]<<24|p[A>>>16&255]<<16|p[A>>>8&255]<<8|p[A&255]),u[l]=N=(u[l-i]^A)>>>0}for(d=0;d<a;d++)l=a-d,d&3?A=u[l]:A=u[l-4],d<4||l<=4?f[d]=A:f[d]=E[p[A>>>24]]^b[p[A>>>16&255]]^T[p[A>>>8&255]]^I[p[A&255]],f[d]=f[d]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,r,n){const s=this.keySize+6,i=this.invKeySchedule,a=this.invSBox,l=this.invSubMix,d=l[0],u=l[1],f=l[2],p=l[3],y=this.uint8ArrayToUint32Array_(n);let v=y[0],E=y[1],b=y[2],T=y[3];const I=new Int32Array(e),N=new Int32Array(I.length);let A,L,P,k,D,O,F,$,G,Y,ne,X,z,Z;const ee=this.networkToHostOrderSwap;for(;r<I.length;){for(G=ee(I[r]),Y=ee(I[r+1]),ne=ee(I[r+2]),X=ee(I[r+3]),D=G^i[0],O=X^i[1],F=ne^i[2],$=Y^i[3],z=4,Z=1;Z<s;Z++)A=d[D>>>24]^u[O>>16&255]^f[F>>8&255]^p[$&255]^i[z],L=d[O>>>24]^u[F>>16&255]^f[$>>8&255]^p[D&255]^i[z+1],P=d[F>>>24]^u[$>>16&255]^f[D>>8&255]^p[O&255]^i[z+2],k=d[$>>>24]^u[D>>16&255]^f[O>>8&255]^p[F&255]^i[z+3],D=A,O=L,F=P,$=k,z=z+4;A=a[D>>>24]<<24^a[O>>16&255]<<16^a[F>>8&255]<<8^a[$&255]^i[z],L=a[O>>>24]<<24^a[F>>16&255]<<16^a[$>>8&255]<<8^a[D&255]^i[z+1],P=a[F>>>24]<<24^a[$>>16&255]<<16^a[D>>8&255]<<8^a[O&255]^i[z+2],k=a[$>>>24]<<24^a[D>>16&255]<<16^a[O>>8&255]<<8^a[F&255]^i[z+3],N[r]=ee(A^v),N[r+1]=ee(k^E),N[r+2]=ee(P^b),N[r+3]=ee(L^T),v=G,E=Y,b=ne,T=X,r=r+4}return N.buffer}}class _ee{constructor(e,r,n){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=r,this.aesMode=n}expandKey(){const e=Lee(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function Lee(t){switch(t){case Uo.cbc:return"AES-CBC";case Uo.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${t}`)}}const Pee=16;class WE{constructor(e,{removePKCS7Padding:r=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=r,r)try{const n=self.crypto;n&&(this.subtle=n.subtle||n.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:r}=this;if(!e||r)return this.reset(),null;const n=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?Iee(n):n}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,r,n,s){return this.useSoftware?new Promise((i,a)=>{const l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,r,n,s);const d=this.flush();d?i(d.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),r,n,s)}softwareDecrypt(e,r,n,s){const{currentIV:i,currentResult:a,remainderData:l}=this;if(s!==Uo.cbc||r.byteLength!==16)return Vt.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=ri(l,e),this.remainderData=null);const d=this.getValidChunk(e);if(!d.length)return null;i&&(n=i);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new Ree),u.expandKey(r);const f=a;return this.currentResult=u.decrypt(d.buffer,0,n),this.currentIV=d.slice(-16).buffer,f||null}webCryptoDecrypt(e,r,n,s){if(this.key!==r||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,r,n,s));this.key=r,this.fastAesKey=new _ee(this.subtle,r,s)}return this.fastAesKey.expandKey().then(i=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new Nee(this.subtle,new Uint8Array(n),s).decrypt(e.buffer,i)):Promise.reject(new Error("web crypto not initialized"))).catch(i=>(Vt.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${i.name}: ${i.message}`),this.onWebCryptoError(e,r,n,s)))}onWebCryptoError(e,r,n,s){const i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,r,n,s);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let r=e;const n=e.length-e.length%Pee;return n!==e.length&&(r=e.slice(0,n),this.remainderData=e.slice(n)),r}logOnce(e){this.logEnabled&&(Vt.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const YA=Math.pow(2,17);class Dee{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,r){const n=e.url;if(!n)return Promise.reject(new va({type:Qe.NETWORK_ERROR,details:ue.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${n?"part list":"url"}`),networkDetails:null}));this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((l,d)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(E=>E[0]==="GAP")){d(XA(e));return}else e.gap=!1;const u=this.loader=i?new i(s):new a(s),f=qA(e);e.loader=u;const p=WA(s.fragLoadPolicy.default),y={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:YA};e.stats=u.stats;const v={onSuccess:(E,b,T,I)=>{this.resetLoader(e,u);let N=E.data;T.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(N.slice(0,16)),N=N.slice(16)),l({frag:e,part:null,payload:N,networkDetails:I})},onError:(E,b,T,I)=>{this.resetLoader(e,u),d(new va({type:Qe.NETWORK_ERROR,details:ue.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:$t({url:n,data:void 0},E),error:new Error(`HTTP Error ${E.code} ${E.text}`),networkDetails:T,stats:I}))},onAbort:(E,b,T)=>{this.resetLoader(e,u),d(new va({type:Qe.NETWORK_ERROR,details:ue.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:T,stats:E}))},onTimeout:(E,b,T)=>{this.resetLoader(e,u),d(new va({type:Qe.NETWORK_ERROR,details:ue.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:T,stats:E}))}};r&&(v.onProgress=(E,b,T,I)=>r({frag:e,part:null,payload:T,networkDetails:I})),u.load(f,y,v)})}loadPart(e,r,n){this.abort();const s=this.config,i=s.fLoader,a=s.loader;return new Promise((l,d)=>{if(this.loader&&this.loader.destroy(),e.gap||r.gap){d(XA(e,r));return}const u=this.loader=i?new i(s):new a(s),f=qA(e,r);e.loader=u;const p=WA(s.fragLoadPolicy.default),y={loadPolicy:p,timeout:p.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:YA};r.stats=u.stats,u.load(f,y,{onSuccess:(v,E,b,T)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,r);const I={frag:e,part:r,payload:v.data,networkDetails:T};n(I),l(I)},onError:(v,E,b,T)=>{this.resetLoader(e,u),d(new va({type:Qe.NETWORK_ERROR,details:ue.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:r,response:$t({url:f.url,data:void 0},v),error:new Error(`HTTP Error ${v.code} ${v.text}`),networkDetails:b,stats:T}))},onAbort:(v,E,b)=>{e.stats.aborted=r.stats.aborted,this.resetLoader(e,u),d(new va({type:Qe.NETWORK_ERROR,details:ue.INTERNAL_ABORTED,fatal:!1,frag:e,part:r,error:new Error("Aborted"),networkDetails:b,stats:v}))},onTimeout:(v,E,b)=>{this.resetLoader(e,u),d(new va({type:Qe.NETWORK_ERROR,details:ue.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:r,error:new Error(`Timeout after ${y.timeout}ms`),networkDetails:b,stats:v}))}})})}updateStatsFromPart(e,r){const n=e.stats,s=r.stats,i=s.total;if(n.loaded+=s.loaded,i){const d=Math.round(e.duration/r.duration),u=Math.min(Math.round(n.loaded/i),d),p=(d-u)*Math.round(n.loaded/u);n.total=n.loaded+p}else n.total=Math.max(n.loaded,n.total);const a=n.loading,l=s.loading;a.start?a.first+=l.first-l.start:(a.start=l.start,a.first=l.first),a.end=l.end}resetLoader(e,r){e.loader=null,this.loader===r&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),r.destroy()}}function qA(t,e=null){const r=e||t,n={frag:t,part:e,responseType:"arraybuffer",url:r.url,headers:{},rangeStart:0,rangeEnd:0},s=r.byteRangeStartOffset,i=r.byteRangeEndOffset;if(Ve(s)&&Ve(i)){var a;let l=s,d=i;if(t.sn==="initSegment"&&kee((a=t.decryptdata)==null?void 0:a.method)){const u=i-s;u%16&&(d=i+(16-u%16)),s!==0&&(n.resetIV=!0,l=s-16)}n.rangeStart=l,n.rangeEnd=d}return n}function XA(t,e){const r=new Error(`GAP ${t.gap?"tag":"attribute"} found`),n={type:Qe.MEDIA_ERROR,details:ue.FRAG_GAP,fatal:!1,frag:t,error:r,networkDetails:null};return e&&(n.part=e),(e||t).stats.aborted=!0,new va(n)}function kee(t){return t==="AES-128"||t==="AES-256"}class va extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class zj extends ii{constructor(e,r){super(e,r),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class KE{constructor(e,r,n,s=0,i=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=wm(),this.buffering={audio:wm(),video:wm(),audiovideo:wm()},this.level=e,this.sn=r,this.id=n,this.size=s,this.part=i,this.partial=a}}function wm(){return{start:0,executeStart:0,executeEnd:0,end:0}}const QA={length:0,start:()=>0,end:()=>0};class ht{static isBuffered(e,r){if(e){const n=ht.getBuffered(e);for(let s=n.length;s--;)if(r>=n.start(s)&&r<=n.end(s))return!0}return!1}static bufferedRanges(e){if(e){const r=ht.getBuffered(e);return ht.timeRangesToArray(r)}return[]}static timeRangesToArray(e){const r=[];for(let n=0;n<e.length;n++)r.push({start:e.start(n),end:e.end(n)});return r}static bufferInfo(e,r,n){if(e){const s=ht.bufferedRanges(e);if(s.length)return ht.bufferedInfo(s,r,n)}return{len:0,start:r,end:r,bufferedIndex:-1}}static bufferedInfo(e,r,n){r=Math.max(0,r),e.length>1&&e.sort((f,p)=>f.start-p.start||p.end-f.end);let s=-1,i=[];if(n)for(let f=0;f<e.length;f++){r>=e[f].start&&r<=e[f].end&&(s=f);const p=i.length;if(p){const y=i[p-1].end;e[f].start-y<n?e[f].end>y&&(i[p-1].end=e[f].end):i.push(e[f])}else i.push(e[f])}else i=e;let a=0,l,d=r,u=r;for(let f=0;f<i.length;f++){const p=i[f].start,y=i[f].end;if(s===-1&&r>=p&&r<=y&&(s=f),r+n>=p&&r<y)d=p,u=y,a=u-r;else if(r+n<p){l=p;break}}return{len:a,start:d||0,end:u||0,nextStart:l,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||QA}catch(r){return Vt.log("failed to get media.buffered",r),QA}}}const Wj=/\{\$([a-zA-Z0-9-_]+)\}/g;function ZA(t){return Wj.test(t)}function Fv(t,e){if(t.variableList!==null||t.hasVariableRefs){const r=t.variableList;return e.replace(Wj,n=>{const s=n.substring(2,n.length-1),i=r==null?void 0:r[s];return i===void 0?(t.playlistParsingError||(t.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),n):i})}return e}function JA(t,e,r){let n=t.variableList;n||(t.variableList=n={});let s,i;if("QUERYPARAM"in e){s=e.QUERYPARAM;try{const a=new self.URL(r).searchParams;if(a.has(s))i=a.get(s);else throw new Error(`"${s}" does not match any query parameter in URI: "${r}"`)}catch(a){t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else s=e.NAME,i=e.VALUE;s in n?t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):n[s]=i||""}function jee(t,e,r){const n=e.IMPORT;if(r&&n in r){let s=t.variableList;s||(t.variableList=s={}),s[n]=r[n]}else t.playlistParsingError||(t.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${n}"`))}const Mee=/^(\d+)x(\d+)$/,eN=/(.+?)=(".*?"|.*?)(?:,|$)/g;class dr{constructor(e,r){typeof e=="string"&&(e=dr.parseAttrList(e,r)),zt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const r=parseInt(this[e],10);return r>Number.MAX_SAFE_INTEGER?1/0:r}hexadecimalInteger(e){if(this[e]){let r=(this[e]||"0x").slice(2);r=(r.length&1?"0":"")+r;const n=new Uint8Array(r.length/2);for(let s=0;s<r.length/2;s++)n[s]=parseInt(r.slice(s*2,s*2+2),16);return n}return null}hexadecimalIntegerAsNumber(e){const r=parseInt(this[e],16);return r>Number.MAX_SAFE_INTEGER?1/0:r}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,r){const n=this[e];return n?parseFloat(n):r}enumeratedString(e){return this[e]}enumeratedStringList(e,r){const n=this[e];return(n?n.split(/[ ,]+/):[]).reduce((s,i)=>(s[i.toLowerCase()]=!0,s),r)}bool(e){return this[e]==="YES"}decimalResolution(e){const r=Mee.exec(this[e]);if(r!==null)return{width:parseInt(r[1],10),height:parseInt(r[2],10)}}static parseAttrList(e,r){let n;const s={},i='"';for(eN.lastIndex=0;(n=eN.exec(e))!==null;){const a=n[1].trim();let l=n[2];const d=l.indexOf(i)===0&&l.lastIndexOf(i)===l.length-1;let u=!1;if(d)l=l.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(r&&(d||u))l=Fv(r,l);else if(!u&&!d)switch(a){case"CLOSED-CAPTIONS":if(l==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Vt.warn(`${e}: attribute ${a} is missing quotes`)}s[a]=l}return s}}const Oee="com.apple.hls.interstitial";function Fee(t){return t!=="ID"&&t!=="CLASS"&&t!=="CUE"&&t!=="START-DATE"&&t!=="DURATION"&&t!=="END-DATE"&&t!=="END-ON-NEXT"}function Bee(t){return t==="SCTE35-OUT"||t==="SCTE35-IN"||t==="SCTE35-CMD"}class Kj{constructor(e,r,n=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(r==null?void 0:r.tagAnchor)||null,this.tagOrder=(s=r==null?void 0:r.tagOrder)!=null?s:n,r){const i=r.attr;for(const a in i)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==i[a]){Vt.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=zt(new dr({}),i,e)}if(this.attr=e,r?(this._startDate=r._startDate,this._cue=r._cue,this._endDate=r._endDate,this._dateAtEnd=r._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const i=(r==null?void 0:r.endDate)||new Date(this.attr["END-DATE"]);Ve(i.getTime())&&(this._endDate=i)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Vt.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const r=this.duration;return r!==null?this._dateAtEnd=new Date(this._startDate.getTime()+r*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(Ve(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===Oee}get isValid(){return!!this.id&&!this._badValueForSameId&&Ve(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const Uee=10;class $ee{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const r=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!r||!this.live,this.advanced=this.endSN>e.endSN||r>0||r===0&&n>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(r=>{let n=r.decryptdata;return n||(r.setKeyFormat(e.keyFormat),n=r.decryptdata),!!n&&e.matches(n)})}get hasProgramDateTime(){return this.fragments.length?Ve(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||Uee}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const r=this.lastPartIndex;if(r!==-1){for(let n=e.length;n--;)if(e[n].index>r)return e[n].index;return r}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function yp(t,e){return t.length===e.length?!t.some((r,n)=>r!==e[n]):!1}function tN(t,e){return!t&&!e?!0:!t||!e?!1:yp(t,e)}function cu(t){return t==="AES-128"||t==="AES-256"||t==="AES-256-CTR"}function YE(t){switch(t){case"AES-128":case"AES-256":return Uo.cbc;case"AES-256-CTR":return Uo.ctr;default:throw new Error(`invalid full segment method ${t}`)}}function qE(t){return Uint8Array.from(atob(t),e=>e.charCodeAt(0))}function Bv(t){return Uint8Array.from(unescape(encodeURIComponent(t)),e=>e.charCodeAt(0))}function Vee(t){const e=Bv(t).subarray(0,16),r=new Uint8Array(16);return r.set(e,16-e.length),r}function Yj(t){const e=function(n,s,i){const a=n[s];n[s]=n[i],n[i]=a};e(t,0,3),e(t,1,2),e(t,4,5),e(t,6,7)}function qj(t){const e=t.split(":");let r=null;if(e[0]==="data"&&e.length===2){const n=e[1].split(";"),s=n[n.length-1].split(",");if(s.length===2){const i=s[0]==="base64",a=s[1];i?(n.splice(-1,1),r=qE(a)):r=Vee(a)}}return r}const vp=typeof self<"u"?self:void 0;var mr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},En={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function a0(t){switch(t){case En.FAIRPLAY:return mr.FAIRPLAY;case En.PLAYREADY:return mr.PLAYREADY;case En.WIDEVINE:return mr.WIDEVINE;case En.CLEARKEY:return mr.CLEARKEY}}function x1(t){switch(t){case mr.FAIRPLAY:return En.FAIRPLAY;case mr.PLAYREADY:return En.PLAYREADY;case mr.WIDEVINE:return En.WIDEVINE;case mr.CLEARKEY:return En.CLEARKEY}}function Fd(t){const{drmSystems:e,widevineLicenseUrl:r}=t,n=e?[mr.FAIRPLAY,mr.WIDEVINE,mr.PLAYREADY,mr.CLEARKEY].filter(s=>!!e[s]):[];return!n[mr.WIDEVINE]&&r&&n.push(mr.WIDEVINE),n}const Xj=function(t){return vp!=null&&(t=vp.navigator)!=null&&t.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function Gee(t,e,r,n){let s;switch(t){case mr.FAIRPLAY:s=["cenc","sinf"];break;case mr.WIDEVINE:case mr.PLAYREADY:s=["cenc"];break;case mr.CLEARKEY:s=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${t}`)}return Hee(s,e,r,n)}function Hee(t,e,r,n){return[{initDataTypes:t,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:e.map(i=>({contentType:`audio/mp4; codecs=${i}`,robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null})),videoCapabilities:r.map(i=>({contentType:`video/mp4; codecs=${i}`,robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}))}]}function zee(t){var e;return!!t&&(t.sessionType==="persistent-license"||!!((e=t.sessionTypes)!=null&&e.some(r=>r==="persistent-license")))}function Qj(t){const e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(e)),n=r.substring(r.indexOf("<"),r.length),a=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(a){const l=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(l){const d=qE(l).subarray(0,16);return Yj(d),d}}return null}let Cc={};class Ao{static clearKeyUriToKeyIdMap(){Cc={}}static setKeyIdForUri(e,r){Cc[e]=r}static addKeyIdForUri(e){const r=Object.keys(Cc).length%Number.MAX_SAFE_INTEGER,n=new Uint8Array(16);return new DataView(n.buffer,12,4).setUint32(0,r),Cc[e]=n,n}constructor(e,r,n,s=[1],i=null,a){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=r,this.keyFormat=n,this.keyFormatVersions=s,this.iv=i,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!cu(e),a!=null&&a.startsWith("0x")&&(this.keyId=new Uint8Array(Cj(a)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&yp(e.keyFormatVersions,this.keyFormatVersions)&&tN(e.iv,this.iv)&&tN(e.keyId,this.keyId)}isSupported(){if(this.method){if(cu(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case En.FAIRPLAY:case En.WIDEVINE:case En.PLAYREADY:case En.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e,r){if(!this.encrypted||!this.uri)return null;if(cu(this.method)){let i=this.iv;return i||(typeof e!="number"&&(Vt.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0),i=Kee(e)),new Ao(this.method,this.uri,"identity",this.keyFormatVersions,i)}if(this.keyId){const i=Cc[this.uri];if(i&&!yp(this.keyId,i)&&Ao.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}const n=qj(this.uri);if(n)switch(this.keyFormat){case En.WIDEVINE:if(this.pssh=n,!this.keyId){const i=XJ(n.buffer);if(i.length){var s;const a=i[0];this.keyId=(s=a.kids)!=null&&s.length?a.kids[0]:null}}this.keyId||(this.keyId=rN(r));break;case En.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=qJ(i,null,n),this.keyId=Qj(n);break}default:{let i=n.subarray(0,16);if(i.length!==16){const a=new Uint8Array(16);a.set(i,16-i.length),i=a}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i;i=Wee(r),i||(i=rN(r),i||(i=Cc[this.uri])),i&&(this.keyId=i,Ao.setKeyIdForUri(this.uri,i))}return this}}function Wee(t){const e=t==null?void 0:t[En.WIDEVINE];return e?e.keyId:null}function rN(t){const e=t==null?void 0:t[En.PLAYREADY];if(e){const r=qj(e.uri);if(r)return Qj(r)}return null}function Kee(t){const e=new Uint8Array(16);for(let r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e}const nN=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,sN=/#EXT-X-MEDIA:(.*)/g,Yee=/^#EXT(?:INF|-X-TARGETDURATION):/m,y1=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),qee=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class Zi{static findGroup(e,r){for(let n=0;n<e.length;n++){const s=e[n];if(s.id===r)return s}}static resolve(e,r){return UE.buildAbsoluteURL(r,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Yee.test(e)}static parseMasterPlaylist(e,r){const n=ZA(e),s={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},i=[];if(nN.lastIndex=0,!e.startsWith("#EXTM3U"))return s.playlistParsingError=new Error("no EXTM3U delimiter"),s;let a;for(;(a=nN.exec(e))!=null;)if(a[1]){var l;const u=new dr(a[1],s),f=Fv(s,a[2]),p={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:Zi.resolve(f,r)},y=u.decimalResolution("RESOLUTION");y&&(p.width=y.width,p.height=y.height),oN(u.CODECS,p);const v=u["SUPPLEMENTAL-CODECS"];v&&(p.supplemental={},oN(v,p.supplemental)),(l=p.unknownCodecs)!=null&&l.length||i.push(p),s.levels.push(p)}else if(a[3]){const u=a[3],f=a[4];switch(u){case"SESSION-DATA":{const p=new dr(f,s),y=p["DATA-ID"];y&&(s.sessionData===null&&(s.sessionData={}),s.sessionData[y]=p);break}case"SESSION-KEY":{const p=iN(f,r,s);p.encrypted&&p.isSupported()?(s.sessionKeys===null&&(s.sessionKeys=[]),s.sessionKeys.push(p)):Vt.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${f}"`);break}case"DEFINE":{{const p=new dr(f,s);JA(s,p,r)}break}case"CONTENT-STEERING":{const p=new dr(f,s);s.contentSteering={uri:Zi.resolve(p["SERVER-URI"],r),pathwayId:p["PATHWAY-ID"]||"."};break}case"START":{s.startTimeOffset=aN(f);break}}}const d=i.length>0&&i.length<s.levels.length;return s.levels=d?i:s.levels,s.levels.length===0&&(s.playlistParsingError=new Error("no levels found in manifest")),s}static parseMasterPlaylistMedia(e,r,n){let s;const i={},a=n.levels,l={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let d=0;for(sN.lastIndex=0;(s=sN.exec(e))!==null;){const u=new dr(s[1],n),f=u.TYPE;if(f){const p=l[f],y=i[f]||[];i[f]=y;const v=u.LANGUAGE,E=u["ASSOC-LANGUAGE"],b=u.CHANNELS,T=u.CHARACTERISTICS,I=u["INSTREAM-ID"],N={attrs:u,bitrate:0,id:d++,groupId:u["GROUP-ID"]||"",name:u.NAME||v||"",type:f,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:v,url:u.URI?Zi.resolve(u.URI,r):""};if(E&&(N.assocLang=E),b&&(N.channels=b),T&&(N.characteristics=T),I&&(N.instreamId=I),p!=null&&p.length){const A=Zi.findGroup(p,N.groupId)||p[0];lN(N,A,"audioCodec"),lN(N,A,"textCodec")}y.push(N)}}return i}static parseLevelPlaylist(e,r,n,s,i,a){var l;const d={url:r},u=new $ee(r),f=u.fragments,p=[];let y=null,v=0,E=0,b=0,T=0,I=0,N=null,A=new m1(s,d),L,P,k,D=-1,O=!1,F=null,$;if(y1.lastIndex=0,u.m3u8=e,u.hasVariableRefs=ZA(e),((l=y1.exec(e))==null?void 0:l[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(L=y1.exec(e))!==null;){O&&(O=!1,A=new m1(s,d),A.playlistOffset=b,A.setStart(b),A.sn=v,A.cc=T,I&&(A.bitrate=I),A.level=n,y&&(A.initSegment=y,y.rawProgramDateTime&&(A.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null),F&&(A.setByteRange(F),F=null)));const X=L[1];if(X){A.duration=parseFloat(X);const z=(" "+L[2]).slice(1);A.title=z||null,A.tagList.push(z?["INF",X,z]:["INF",X])}else if(L[3]){if(Ve(A.duration)){A.playlistOffset=b,A.setStart(b),k&&uN(A,k,u),A.sn=v,A.level=n,A.cc=T,f.push(A);const z=(" "+L[3]).slice(1);A.relurl=Fv(u,z),Uv(A,N,p),N=A,b+=A.duration,v++,E=0,O=!0}}else{if(L=L[0].match(qee),!L){Vt.warn("No matches on slow regex match for level playlist!");continue}for(P=1;P<L.length&&L[P]===void 0;P++);const z=(" "+L[P]).slice(1),Z=(" "+L[P+1]).slice(1),ee=L[P+2]?(" "+L[P+2]).slice(1):null;switch(z){case"BYTERANGE":N?A.setByteRange(Z,N):A.setByteRange(Z);break;case"PROGRAM-DATE-TIME":A.rawProgramDateTime=Z,A.tagList.push(["PROGRAM-DATE-TIME",Z]),D===-1&&(D=f.length);break;case"PLAYLIST-TYPE":u.type&&ma(u,z,L),u.type=Z.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?ma(u,z,L):f.length>0&&dN(u,z,L),v=u.startSN=parseInt(Z);break;case"SKIP":{u.skippedSegments&&ma(u,z,L);const q=new dr(Z,u),K=q.decimalInteger("SKIPPED-SEGMENTS");if(Ve(K)){u.skippedSegments+=K;for(let Q=K;Q--;)f.push(null);v+=K}const ae=q.enumeratedString("RECENTLY-REMOVED-DATERANGES");ae&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(ae.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&ma(u,z,L),u.targetduration=Math.max(parseInt(Z),1);break;case"VERSION":u.version!==null&&ma(u,z,L),u.version=parseInt(Z);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||ma(u,z,L),u.live=!1;break;case"#":(Z||ee)&&A.tagList.push(ee?[Z,ee]:[Z]);break;case"DISCONTINUITY":T++,A.tagList.push(["DIS"]);break;case"GAP":A.gap=!0,A.tagList.push([z]);break;case"BITRATE":A.tagList.push([z,Z]),I=parseInt(Z)*1e3,Ve(I)?A.bitrate=I:I=0;break;case"DATERANGE":{const q=new dr(Z,u),K=new Kj(q,u.dateRanges[q.ID],u.dateRangeTagCount);u.dateRangeTagCount++,K.isValid||u.skippedSegments?u.dateRanges[K.id]=K:Vt.warn(`Ignoring invalid DATERANGE tag: "${Z}"`),A.tagList.push(["EXT-X-DATERANGE",Z]);break}case"DEFINE":{{const q=new dr(Z,u);"IMPORT"in q?jee(u,q,a):JA(u,q,r)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?ma(u,z,L):f.length>0&&dN(u,z,L),u.startCC=T=parseInt(Z);break;case"KEY":{const q=iN(Z,r,u);if(q.isSupported()){if(q.method==="NONE"){k=void 0;break}k||(k={});const K=k[q.keyFormat];K!=null&&K.matches(q)||(K&&(k=zt({},k)),k[q.keyFormat]=q)}else Vt.warn(`[Keys] Ignoring unsupported EXT-X-KEY tag: "${Z}"`);break}case"START":u.startTimeOffset=aN(Z);break;case"MAP":{const q=new dr(Z,u);if(A.duration){const K=new m1(s,d);cN(K,q,n,k),y=K,A.initSegment=y,y.rawProgramDateTime&&!A.rawProgramDateTime&&(A.rawProgramDateTime=y.rawProgramDateTime)}else{const K=A.byteRangeEndOffset;if(K){const ae=A.byteRangeStartOffset;F=`${K-ae}@${ae}`}else F=null;cN(A,q,n,k),y=A,O=!0}y.cc=T;break}case"SERVER-CONTROL":{$&&ma(u,z,L),$=new dr(Z),u.canBlockReload=$.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=$.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&$.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=$.optionalFloat("PART-HOLD-BACK",0),u.holdBack=$.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&ma(u,z,L);const q=new dr(Z);u.partTarget=q.decimalFloatingPoint("PART-TARGET");break}case"PART":{let q=u.partList;q||(q=u.partList=[]);const K=E>0?q[q.length-1]:void 0,ae=E++,Q=new dr(Z,u),re=new jJ(Q,A,d,ae,K);q.push(re),A.duration+=re.duration;break}case"PRELOAD-HINT":{const q=new dr(Z,u);u.preloadHint=q;break}case"RENDITION-REPORT":{const q=new dr(Z,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(q);break}default:Vt.warn(`line parsed but not handled: ${L}`);break}}}N&&!N.relurl?(f.pop(),b-=N.duration,u.partList&&(u.fragmentHint=N)):u.partList&&(Uv(A,N,p),A.cc=T,u.fragmentHint=A,k&&uN(A,k,u)),u.targetduration||(u.playlistParsingError=new Error("Missing Target Duration"));const G=f.length,Y=f[0],ne=f[G-1];if(b+=u.skippedSegments*u.targetduration,b>0&&G&&ne){u.averagetargetduration=b/G;const X=ne.sn;u.endSN=X!=="initSegment"?X:0,u.live||(ne.endList=!0),D>0&&(Qee(f,D),Y&&p.unshift(Y))}return u.fragmentHint&&(b+=u.fragmentHint.duration),u.totalduration=b,p.length&&u.dateRangeTagCount&&Y&&Zj(p,u),u.endCC=T,u}}function Zj(t,e){let r=t.length;if(!r)if(e.hasProgramDateTime){const l=e.fragments[e.fragments.length-1];t.push(l),r++}else return;const n=t[r-1],s=e.live?1/0:e.totalduration,i=Object.keys(e.dateRanges);for(let l=i.length;l--;){const d=e.dateRanges[i[l]],u=d.startDate.getTime();d.tagAnchor=n.ref;for(let f=r;f--;){var a;if(((a=t[f])==null?void 0:a.sn)<e.startSN)break;const p=Xee(e,u,t,f,s);if(p!==-1){d.tagAnchor=e.fragments[p].ref;break}}}}function Xee(t,e,r,n,s){const i=r[n];if(i){const l=i.programDateTime;if(e>=l||n===0){var a;const d=(((a=r[n+1])==null?void 0:a.start)||s)-i.start;if(e<=l+d*1e3){const u=r[n].sn-t.startSN;if(u<0)return-1;const f=t.fragments;if(f.length>r.length){const y=(r[n+1]||f[f.length-1]).sn-t.startSN;for(let v=y;v>u;v--){const E=f[v].programDateTime;if(e>=E&&e<E+f[v].duration*1e3)return v}}return u}}}return-1}function iN(t,e,r){var n,s;const i=new dr(t,r),a=(n=i.METHOD)!=null?n:"",l=i.URI,d=i.hexadecimalInteger("IV"),u=i.KEYFORMATVERSIONS,f=(s=i.KEYFORMAT)!=null?s:"identity";l&&i.IV&&!d&&Vt.error(`Invalid IV: ${i.IV}`);const p=l?Zi.resolve(l,e):"",y=(u||"1").split("/").map(Number).filter(Number.isFinite);return new Ao(a,p,f,y,d,i.KEYID)}function aN(t){const r=new dr(t).decimalFloatingPoint("TIME-OFFSET");return Ve(r)?r:null}function oN(t,e){let r=(t||"").split(/[ ,]+/).filter(n=>n);["video","audio","text"].forEach(n=>{const s=r.filter(i=>GE(i,n));s.length&&(e[`${n}Codec`]=s.map(i=>i.split("/")[0]).join(","),r=r.filter(i=>s.indexOf(i)===-1))}),e.unknownCodecs=r}function lN(t,e,r){const n=e[r];n&&(t[r]=n)}function Qee(t,e){let r=t[e];for(let n=e;n--;){const s=t[n];if(!s)return;s.programDateTime=r.programDateTime-s.duration*1e3,r=s}}function Uv(t,e,r){t.rawProgramDateTime?r.push(t):e!=null&&e.programDateTime&&(t.programDateTime=e.endProgramDateTime)}function cN(t,e,r,n){t.relurl=e.URI,e.BYTERANGE&&t.setByteRange(e.BYTERANGE),t.level=r,t.sn="initSegment",n&&(t.levelkeys=n),t.initSegment=null}function uN(t,e,r){t.levelkeys=e;const{encryptedFragments:n}=r;(!n.length||n[n.length-1].levelkeys!==e)&&Object.keys(e).some(s=>e[s].isCommonEncryption)&&n.push(t)}function ma(t,e,r){t.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${r[0]})`)}function dN(t,e,r){t.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${r[0]})`)}function v1(t,e){const r=e.startPTS;if(Ve(r)){let n=0,s;e.sn>t.sn?(n=r-t.start,s=t):(n=t.start-r,s=e),s.duration!==n&&s.setDuration(n)}else e.sn>t.sn?t.cc===e.cc&&t.minEndPTS?e.setStart(t.start+(t.minEndPTS-t.start)):e.setStart(t.start+t.duration):e.setStart(Math.max(t.start-e.duration,0))}function Jj(t,e,r,n,s,i,a){n-r<=0&&(a.warn("Fragment should have a positive duration",e),n=r+e.duration,i=s+e.duration);let d=r,u=n;const f=e.startPTS,p=e.endPTS;if(Ve(f)){const I=Math.abs(f-r);t&&I>t.totalduration?a.warn(`media timestamps and playlist times differ by ${I}s for level ${e.level} ${t.url}`):Ve(e.deltaPTS)?e.deltaPTS=Math.max(I,e.deltaPTS):e.deltaPTS=I,d=Math.max(r,f),r=Math.min(r,f),s=e.startDTS!==void 0?Math.min(s,e.startDTS):s,u=Math.min(n,p),n=Math.max(n,p),i=e.endDTS!==void 0?Math.max(i,e.endDTS):i}const y=r-e.start;e.start!==0&&e.setStart(r),e.setDuration(n-e.start),e.startPTS=r,e.maxStartPTS=d,e.startDTS=s,e.endPTS=n,e.minEndPTS=u,e.endDTS=i;const v=e.sn;if(!t||v<t.startSN||v>t.endSN)return 0;let E;const b=v-t.startSN,T=t.fragments;for(T[b]=e,E=b;E>0;E--)v1(T[E],T[E-1]);for(E=b;E<T.length-1;E++)v1(T[E],T[E+1]);return t.fragmentHint&&v1(T[T.length-1],t.fragmentHint),t.PTSKnown=t.alignedSliding=!0,y}function Zee(t,e,r){if(t===e)return;let n=null;const s=t.fragments;for(let f=s.length-1;f>=0;f--){const p=s[f].initSegment;if(p){n=p;break}}t.fragmentHint&&delete t.fragmentHint.endPTS;let i;tte(t,e,(f,p,y,v)=>{if((!e.startCC||e.skippedSegments)&&p.cc!==f.cc){const E=f.cc-p.cc;for(let b=y;b<v.length;b++)v[b].cc+=E;e.endCC=v[v.length-1].cc}Ve(f.startPTS)&&Ve(f.endPTS)&&(p.setStart(p.startPTS=f.startPTS),p.startDTS=f.startDTS,p.maxStartPTS=f.maxStartPTS,p.endPTS=f.endPTS,p.endDTS=f.endDTS,p.minEndPTS=f.minEndPTS,p.setDuration(f.endPTS-f.startPTS),p.duration&&(i=p),e.PTSKnown=e.alignedSliding=!0),f.hasStreams&&(p.elementaryStreams=f.elementaryStreams),p.loader=f.loader,f.hasStats&&(p.stats=f.stats),f.initSegment&&(p.initSegment=f.initSegment,n=f.initSegment)});const a=e.fragments,l=e.fragmentHint?a.concat(e.fragmentHint):a;if(n&&l.forEach(f=>{var p;f&&(!f.initSegment||f.initSegment.relurl===((p=n)==null?void 0:p.relurl))&&(f.initSegment=n)}),e.skippedSegments){if(e.deltaUpdateFailed=a.some(f=>!f),e.deltaUpdateFailed){r.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let f=e.skippedSegments;f--;)a.shift();e.startSN=a[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=Jee(t.dateRanges,e,r));const f=t.fragments.filter(p=>p.rawProgramDateTime);if(t.hasProgramDateTime&&!e.hasProgramDateTime)for(let p=1;p<l.length;p++)l[p].programDateTime===null&&Uv(l[p],l[p-1],f);Zj(f,e)}e.endCC=a[a.length-1].cc}if(!e.startCC){var d;const f=rM(t,e.startSN-1);e.startCC=(d=f==null?void 0:f.cc)!=null?d:a[0].cc}ete(t.partList,e.partList,(f,p)=>{p.elementaryStreams=f.elementaryStreams,p.stats=f.stats}),i?Jj(e,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS,r):eM(t,e),a.length&&(e.totalduration=e.edge-a[0].start),e.driftStartTime=t.driftStartTime,e.driftStart=t.driftStart;const u=e.advancedDateTime;if(e.advanced&&u){const f=e.edge;e.driftStart||(e.driftStartTime=u,e.driftStart=f),e.driftEndTime=u,e.driftEnd=f}else e.driftEndTime=t.driftEndTime,e.driftEnd=t.driftEnd,e.advancedDateTime=t.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=t.requestScheduled)}function Jee(t,e,r){const{dateRanges:n,recentlyRemovedDateranges:s}=e,i=zt({},t);s&&s.forEach(d=>{delete i[d]});const l=Object.keys(i).length;return l?(Object.keys(n).forEach(d=>{const u=i[d],f=new Kj(n[d].attr,u);f.isValid?(i[d]=f,u||(f.tagOrder+=l)):r.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${qt(n[d].attr)}"`)}),i):n}function ete(t,e,r){if(t&&e){let n=0;for(let s=0,i=t.length;s<=i;s++){const a=t[s],l=e[s+n];a&&l&&a.index===l.index&&a.fragment.sn===l.fragment.sn?r(a,l):n--}}}function tte(t,e,r){const n=e.skippedSegments,s=Math.max(t.startSN,e.startSN)-e.startSN,i=(t.fragmentHint?1:0)+(n?e.endSN:Math.min(t.endSN,e.endSN))-e.startSN,a=e.startSN-t.startSN,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,d=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;for(let u=s;u<=i;u++){const f=d[a+u];let p=l[u];if(n&&!p&&f&&(p=e.fragments[u]=f),f&&p){r(f,p,u,l);const y=f.relurl,v=p.relurl;if(y&&rte(y,v)){e.playlistParsingError=hN(`media sequence mismatch ${p.sn}:`,t,e,f,p);return}else if(f.cc!==p.cc){e.playlistParsingError=hN(`discontinuity sequence mismatch (${f.cc}!=${p.cc})`,t,e,f,p);return}}}}function hN(t,e,r,n,s){return new Error(`${t} ${s.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${r.startSN}
${r.m3u8}`)}function eM(t,e,r=!0){const n=e.startSN+e.skippedSegments-t.startSN,s=t.fragments,i=n>=0;let a=0;if(i&&n<s.length)a=s[n].start;else if(i&&e.startSN===t.endSN+1)a=t.fragmentEnd;else if(i&&r)a=t.fragmentStart+n*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=t.fragmentStart;else return;$v(e,a)}function $v(t,e){if(e){const r=t.fragments;for(let n=t.skippedSegments;n<r.length;n++)r[n].addStart(e);t.fragmentHint&&t.fragmentHint.addStart(e)}}function tM(t,e=1/0){let r=1e3*t.targetduration;if(t.updated){const n=t.fragments;if(n.length&&r*4>e){const i=n[n.length-1].duration*1e3;i<r&&(r=i)}}else r/=2;return Math.round(r)}function rM(t,e,r){if(!t)return null;let n=t.fragments[e-t.startSN];return n||(n=t.fragmentHint,n&&n.sn===e)?n:e<t.startSN&&r&&r.sn===e?r:null}function fN(t,e,r){return t?nM(t.partList,e,r):null}function nM(t,e,r){if(t)for(let n=t.length;n--;){const s=t[n];if(s.index===r&&s.fragment.sn===e)return s}return null}function sM(t){t.forEach((e,r)=>{var n;(n=e.details)==null||n.fragments.forEach(s=>{s.level=r,s.initSegment&&(s.initSegment.level=r)})})}function rte(t,e){return t!==e&&e?mN(t)!==mN(e):!1}function mN(t){return t.replace(/\?[^?]*$/,"")}function Jd(t,e){for(let n=0,s=t.length;n<s;n++){var r;if(((r=t[n])==null?void 0:r.cc)===e)return t[n]}return null}function nte(t,e){return!!(t&&e.startCC<t.endCC&&e.endCC>t.startCC)}function pN(t,e){const r=t.start+e;t.startPTS=r,t.setStart(r),t.endPTS=r+t.duration}function iM(t,e){const r=e.fragments;for(let n=0,s=r.length;n<s;n++)pN(r[n],t);e.fragmentHint&&pN(e.fragmentHint,t),e.alignedSliding=!0}function ste(t,e){t&&(aM(e,t),e.alignedSliding||wp(e,t),!e.alignedSliding&&!e.skippedSegments&&eM(t,e,!1))}function aM(t,e){if(!nte(e,t))return;const r=Math.min(e.endCC,t.endCC),n=Jd(e.fragments,r),s=Jd(t.fragments,r);if(!n||!s)return;Vt.log(`Aligning playlist at start of dicontinuity sequence ${r}`);const i=n.start-s.start;iM(i,t)}function wp(t,e){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;const r=t.fragments,n=e.fragments;if(!r.length||!n.length)return;let s,i;const a=Math.min(e.endCC,t.endCC);e.startCC<a&&t.startCC<a&&(s=Jd(n,a),i=Jd(r,a)),(!s||!i)&&(s=n[Math.floor(n.length/2)],i=Jd(r,s.cc)||r[Math.floor(r.length/2)]);const l=s.programDateTime,d=i.programDateTime;if(!l||!d)return;const u=(d-l)/1e3-(i.start-s.start);iM(u,t)}function Wn(t,e,r){ls(t,e,r),t.addEventListener(e,r)}function ls(t,e,r){t.removeEventListener(e,r)}const ite={toString:function(t){let e="";const r=t.length;for(let n=0;n<r;n++)e+=`[${t.start(n).toFixed(3)}-${t.end(n).toFixed(3)}]`;return e}},be={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class XE extends zj{constructor(e,r,n,s,i){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=be.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:l,media:d,mediaBuffer:u,state:f}=this,p=d?d.currentTime:0,y=ht.bufferInfo(u||d,p,a.maxBufferHole),v=!y.len;if(this.log(`Media seeking to ${Ve(p)?p.toFixed(3):p}, state: ${f}, ${v?"out of":"in"} buffer`),this.state===be.ENDED)this.resetLoadingState();else if(l){const E=a.maxFragLookUpTolerance,b=l.start-E,T=l.start+l.duration+E;if(v||T<y.start||b>y.end){const I=p>T;(p<b||I)&&(I&&l.loader&&(this.log(`Cancelling fragment load for seek (sn: ${l.sn})`),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(d){this.fragmentTracker.removeFragmentsInRange(p,1/0,this.playlistType,!0);const E=this.lastCurrentTime;if(p>E&&(this.lastCurrentTime=p),!this.loadingParts){const b=Math.max(y.end,p),T=this.shouldLoadParts(this.getLevelDetails(),b);T&&(this.log(`LL-Part loading ON after seeking to ${p.toFixed(2)} with buffer @${b.toFixed(2)}`),this.loadingParts=T)}}this.hls.hasEnoughToStart||(this.log(`Setting ${v?"startPosition":"nextLoadPosition"} to ${p} for seek without enough to start`),this.nextLoadPosition=p,v&&(this.startPosition=p)),v&&this.state===be.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=i,this.hls=e,this.fragmentLoader=new Dee(e.config),this.keyLoader=n,this.fragmentTracker=r,this.config=e.config,this.decrypter=new WE(e.config)}registerListeners(){const{hls:e}=this;e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===be.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=be.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:r}=this;return r===-1&&e?e:r}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,r){if(r.live||!this.media)return!1;const n=e.end||0,s=this.config.timelineOffset||0;if(n<=s)return!1;const i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=ht.bufferedInfo(i,e.start,0));const a=e.nextStart;if(a&&a>s&&a<r.edge||this.media.currentTime<e.start)return!1;const d=r.partList;if(d!=null&&d.length){const f=d[d.length-1];return ht.isBuffered(this.media,f.start+f.duration/2)}const u=r.fragments[r.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){const e=this.config.timelineOffset;if(e){var r;return((r=this.getLevelDetails())==null?void 0:r.appliedTimelineOffset)||e}return 0}onMediaAttached(e,r){const n=this.media=this.mediaBuffer=r.media;Wn(n,"seeking",this.onMediaSeeking),Wn(n,"ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===be.STOPPED&&this.startLoad(s.startPosition)}onMediaDetaching(e,r){const n=!!r.transferMedia,s=this.media;if(s!==null){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ls(s,"seeking",this.onMediaSeeking),ls(s,"ended",this.onMediaEnded),this.keyLoader&&!n&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,n){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,r){}onManifestLoaded(e,r){this.startTimeOffset=r.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=be.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,r,n){this.startFragRequested=!0,this._loadFragForPlayback(e,r,n)}_loadFragForPlayback(e,r,n){const s=i=>{const a=i.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(a,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(i)};this._doFragLoad(e,r,n,s).then(i=>{if(!i)return;const a=this.state,l=i.frag;if(this.fragContextChanged(l)){(a===be.FRAG_LOADING||!this.fragCurrent&&a===be.PARSING)&&(this.fragmentTracker.removeFragment(l),this.state=be.IDLE);return}"payload"in i&&(this.log(`Loaded ${l.type} sn: ${l.sn} of ${this.playlistLabel()} ${l.level}`),this.hls.trigger(M.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state===be.STOPPED||this.state===be.ERROR||(this.warn(`Frag error: ${(i==null?void 0:i.message)||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var r;const{fragmentTracker:n}=this;if(n.getState(e)===en.APPENDING){const i=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,i),l=Math.max(e.duration,a?a.len:this.config.maxBufferLength),d=this.backtrackFragment;((d?e.sn-d.sn:0)===1||this.reduceMaxBufferLength(l,e.duration))&&n.removeFragment(e)}else((r=this.mediaBuffer)==null?void 0:r.buffered.length)===0?n.removeAllFragments():n.hasParts(e.type)&&(n.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),n.getState(e)===en.PARTIAL&&n.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const r=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:r,part:null,stats:r.stats,id:r.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const r=e.details;return(r==null?void 0:r.live)&&r.type!=="EVENT"&&(this.levelLastLoaded!==e||r.expired)}flushMainBuffer(e,r,n=null){if(!(e-r))return;const s={startOffset:e,endOffset:r,type:n};this.hls.trigger(M.BUFFER_FLUSHING,s)}_loadInitSegment(e,r){this._doFragLoad(e,r).then(n=>{const s=n==null?void 0:n.frag;if(!s||this.fragContextChanged(s)||!this.levels)throw new Error("init load aborted");return n}).then(n=>{const{hls:s}=this,{frag:i,payload:a}=n,l=i.decryptdata;if(a&&a.byteLength>0&&l!=null&&l.key&&l.iv&&cu(l.method)){const d=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),l.key.buffer,l.iv.buffer,YE(l.method)).catch(u=>{throw s.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:i}),u}).then(u=>{const f=self.performance.now();return s.trigger(M.FRAG_DECRYPTED,{frag:i,payload:u,stats:{tstart:d,tdecrypt:f}}),n.payload=u,this.completeInitSegmentLoad(n)})}return this.completeInitSegmentLoad(n)}).catch(n=>{this.state===be.STOPPED||this.state===be.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:r}=this;if(!r)throw new Error("init load aborted, missing levels");const n=e.frag.stats;this.state!==be.STOPPED&&(this.state=be.IDLE),e.frag.data=new Uint8Array(e.payload),n.parsing.start=n.buffering.start=self.performance.now(),n.parsing.end=n.buffering.end=self.performance.now(),this.tick()}unhandledEncryptionError(e,r){var n,s;const i=e.tracks;if(i&&!r.encrypted&&((n=i.audio)!=null&&n.encrypted||(s=i.video)!=null&&s.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){const a=this.media,l=new Error(`Encrypted track with no key in ${this.fragInfo(r)} (media ${a?"attached mediaKeys: "+a.mediaKeys:"detached"})`);return this.warn(l.message),!a||a.mediaKeys?!1:(this.hls.trigger(M.ERROR,{type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_NO_KEYS,fatal:!1,error:l,frag:r}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){const{fragCurrent:r}=this;return!e||!r||e.sn!==r.sn||e.level!==r.level}fragBufferedComplete(e,r){const n=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${r?" part: "+r.index:""} of ${this.fragInfo(e,!1,r)} > buffer:${n?ite.toString(ht.getBuffered(n)):"(detached)"})`),Or(e)){var s;if(e.type!==ze.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(l=>!!a[l])){this.state=be.IDLE;return}}const i=(s=this.levels)==null?void 0:s[e.level];i!=null&&i.fragmentError&&(this.log(`Resetting level fragment error count of ${i.fragmentError} on frag buffered`),i.fragmentError=0)}this.state=be.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:r}=this;if(!r)return;const{frag:n,part:s,partsLoaded:i}=e,a=!i||i.length===0||i.some(d=>!d),l=new KE(n.level,n.sn,n.stats.chunkCount+1,0,s?s.index:-1,!a);r.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,r,n=null,s){var i;this.fragCurrent=e;const a=r.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let l=null;if(e.encrypted&&!((i=e.decryptdata)!=null&&i.key)){if(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=be.KEY_LOADING,this.fragCurrent=e,l=this.keyLoader.load(e).then(y=>{if(!this.fragContextChanged(y.frag))return this.hls.trigger(M.KEY_LOADED,y),this.state===be.KEY_LOADING&&(this.state=be.IDLE),y}),this.hls.trigger(M.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else e.encrypted||(l=this.keyLoader.loadClear(e,a.encryptedFragments,this.startFragRequested),l&&this.log("[eme] blocking frag load until media-keys acquired"));const d=this.fragPrevious;if(Or(e)&&(!d||e.sn!==d.sn)){const y=this.shouldLoadParts(r.details,e.end);y!==this.loadingParts&&(this.log(`LL-Part loading ${y?"ON":"OFF"} loading sn ${d==null?void 0:d.sn}->${e.sn}`),this.loadingParts=y)}if(n=Math.max(e.start,n||0),this.loadingParts&&Or(e)){const y=a.partList;if(y&&s){n>a.fragmentEnd&&a.fragmentHint&&(e=a.fragmentHint);const v=this.getNextPart(y,e,n);if(v>-1){const E=y[v];e=this.fragCurrent=E.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${E.index} (${v}/${y.length-1}) of ${this.fragInfo(e,!1,E)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(n.toFixed(3))}`),this.nextLoadPosition=E.start+E.duration,this.state=be.FRAG_LOADING;let b;return l?b=l.then(T=>!T||this.fragContextChanged(T.frag)?null:this.doFragPartsLoad(e,E,r,s)).catch(T=>this.handleFragLoadError(T)):b=this.doFragPartsLoad(e,E,r,s).catch(T=>this.handleFragLoadError(T)),this.hls.trigger(M.FRAG_LOADING,{frag:e,part:E,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):b}else if(!e.url||this.loadedEndOfParts(y,n))return Promise.resolve(null)}}if(Or(e)&&this.loadingParts){var u;this.log(`LL-Part loading OFF after next part miss @${n.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(u=a.partList)==null?void 0:u.filter(y=>y.loaded).map(y=>`[${y.start}-${y.end}]`)}`),this.loadingParts=!1}else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+a.startSN+"-"+a.endSN+"]"}, target: ${parseFloat(n.toFixed(3))}`),Ve(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=be.FRAG_LOADING;const f=this.config.progressive&&e.type!==ze.SUBTITLE;let p;return f&&l?p=l.then(y=>!y||this.fragContextChanged(y.frag)?null:this.fragmentLoader.load(e,s)).catch(y=>this.handleFragLoadError(y)):p=Promise.all([this.fragmentLoader.load(e,f?s:void 0),l]).then(([y])=>(!f&&s&&s(y),y)).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(M.FRAG_LOADING,{frag:e,targetBufferTime:n}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):p}doFragPartsLoad(e,r,n,s){return new Promise((i,a)=>{var l;const d=[],u=(l=n.details)==null?void 0:l.partList,f=p=>{this.fragmentLoader.loadPart(e,p,s).then(y=>{d[p.index]=y;const v=y.part;this.hls.trigger(M.FRAG_LOADED,y);const E=fN(n.details,e.sn,p.index+1)||nM(u,e.sn,p.index+1);if(E)f(E);else return i({frag:e,part:v,partsLoaded:d})}).catch(a)};f(r)})}handleFragLoadError(e){if("data"in e){const r=e.data;r.frag&&r.details===ue.INTERNAL_ABORTED?this.handleFragLoadAborted(r.frag,r.part):r.frag&&r.type===Qe.KEY_SYSTEM_ERROR?(r.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(r.frag)):this.hls.trigger(M.ERROR,r)}else this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const r=this.getCurrentContext(e);if(!r||this.state!==be.PARSING){!this.fragCurrent&&this.state!==be.STOPPED&&this.state!==be.ERROR&&(this.state=be.IDLE);return}const{frag:n,part:s,level:i}=r,a=self.performance.now();n.stats.parsing.end=a,s&&(s.stats.parsing.end=a);const l=this.getLevelDetails(),u=l&&n.sn>l.endSN||this.shouldLoadParts(l,n.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${n.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(n,s,i,e.partial)}shouldLoadParts(e,r){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var n;const i=e.partList[0];if(i.fragment.type===ze.SUBTITLE)return!1;const a=i.end+(((n=e.fragmentHint)==null?void 0:n.duration)||0);if(r>=a){var s;if((this.hls.hasEnoughToStart?((s=this.media)==null?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:r,fragCurrent:n}=this,{level:s,sn:i,part:a}=e;if(!(r!=null&&r[s]))return this.warn(`Levels object was unset while buffering fragment ${i} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const l=r[s],d=l.details,u=a>-1?fN(d,i,a):null,f=u?u.fragment:rM(d,i,n);return f?(n&&n!==f&&(f.stats=n.stats),{frag:f,part:u,level:l}):null}bufferFragmentData(e,r,n,s,i){if(this.state!==be.PARSING)return;const{data1:a,data2:l}=e;let d=a;if(l&&(d=ri(a,l)),!d.length)return;const u=this.initPTS[r.cc],f=u?-u.baseTime/u.timescale:void 0,p={type:e.type,frag:r,part:n,chunkMeta:s,offset:f,parent:r.type,data:d};if(this.hls.trigger(M.BUFFER_APPENDING,p),e.dropped&&e.independent&&!n){if(i)return;this.flushBufferGap(r)}}flushBufferGap(e){const r=this.media;if(!r)return;if(!ht.isBuffered(r,r.currentTime)){this.flushMainBuffer(0,e.start);return}const n=r.currentTime,s=ht.bufferInfo(r,n,0),i=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,i*.25),l=Math.max(Math.min(e.start-a,s.end-a),n+a);e.start-l>a&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,r){var n;const s=this.getLoadPosition();if(!Ve(s))return null;const a=this.lastCurrentTime>s||(n=this.media)!=null&&n.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,r,a)}getFwdBufferInfoAtPos(e,r,n,s){const i=ht.bufferInfo(e,r,s);if(i.len===0&&i.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(r,n);if(a&&(i.nextStart<=a.end||a.gap)){const l=Math.max(Math.min(i.nextStart,a.end)-r,s);return ht.bufferInfo(e,r,l)}}return i}getMaxBufferLength(e){const{config:r}=this;let n;return e?n=Math.max(8*r.maxBufferSize/e,r.maxBufferLength):n=r.maxBufferLength,Math.min(n,r.maxMaxBufferLength)}reduceMaxBufferLength(e,r){const n=this.config,s=Math.max(Math.min(e-r,n.maxBufferLength),r),i=Math.max(e-r*3,n.maxMaxBufferLength/2,s);return i>=s?(n.maxMaxBufferLength=i,this.warn(`Reduce max buffer length to ${i}s`),!0):!1}getAppendedFrag(e,r=ze.MAIN){const n=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,r):null;return n&&"fragment"in n?n.fragment:n}getNextFragment(e,r){const n=r.fragments,s=n.length;if(!s)return null;const{config:i}=this,a=n[0].start,l=i.lowLatencyMode&&!!r.partList;let d=null;if(r.live){const p=i.initialLiveManifestSize;if(s<p)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${p})`),null;if(!r.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var u;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),d=this.getInitialLiveFragment(r);const y=this.hls.startPosition,v=this.hls.liveSyncPosition,E=d?(y!==-1&&y>=a?y:v)||d.start:e;this.log(`Setting startPosition to ${E} to match start frag at live edge. mainStart: ${y} liveSyncPosition: ${v} frag.start: ${(u=d)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=E}}else e<=a&&(d=n[0]);if(!d){const p=this.loadingParts?r.partEnd:r.fragmentEnd;d=this.getFragmentAtPosition(e,p,r)}let f=this.filterReplacedPrimary(d,r);if(!f&&d){const p=d.sn-r.startSN;f=this.filterReplacedPrimary(n[p+1]||null,r)}return this.mapToInitFragWhenRequired(f)}isLoopLoading(e,r){const n=this.fragmentTracker.getState(e);return(n===en.OK||n===en.PARTIAL&&!!e.gap)&&this.nextLoadPosition>r}getNextFragmentLoopLoading(e,r,n,s,i){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,r),a&&!a.gap&&n.nextStart)){const l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,n.nextStart,s,0);if(l!==null&&n.len+l.len>=i){const d=a.sn;return this.loopSn!==d&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${d}`),this.loopSn=d),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(gN(this.config)){var e;if((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null?void 0:e.event)return!0}return!1}filterReplacedPrimary(e,r){if(!e)return e;if(gN(this.config)&&e.type!==ze.SUBTITLE){const n=this.hls.interstitialsManager,s=n==null?void 0:n.bufferingItem;if(s){const a=s.event;if(a){if(a.appendInPlace||Math.abs(e.start-s.start)>1||s.start===0)return null}else if(e.end<=s.start&&(r==null?void 0:r.live)===!1||e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}const i=n==null?void 0:n.playerQueue;if(i)for(let a=i.length;a--;){const l=i[a].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!e.initSegment.data&&!this.bitrateTest?e.initSegment:e}getNextPart(e,r,n){let s=-1,i=!1,a=!0;for(let l=0,d=e.length;l<d;l++){const u=e[l];if(a=a&&!u.independent,s>-1&&n<u.start)break;const f=u.loaded;f?s=-1:(i||(u.independent||a)&&u.fragment===r)&&(u.fragment!==r&&this.warn(`Need buffer at ${n} but next unloaded part starts at ${u.start}`),s=l),i=f}return s}loadedEndOfParts(e,r){let n;for(let s=e.length;s--;){if(n=e[s],!n.loaded)return!1;if(r>n.start)return!0}return!1}getInitialLiveFragment(e){const r=e.fragments,n=this.fragPrevious;let s=null;if(n){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${n.programDateTime}`),s=bee(r,n.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const i=n.sn+1;if(i>=e.startSN&&i<=e.endSN){const a=r[i-e.startSN];n.cc===a.cc&&(s=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=Vj(e,n.cc,n.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const i=this.hls.liveSyncPosition;i!==null&&(s=this.getFragmentAtPosition(i,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,r,n){const{config:s}=this;let{fragPrevious:i}=this,{fragments:a,endSN:l}=n;const{fragmentHint:d}=n,{maxFragLookUpTolerance:u}=s,f=n.partList,p=!!(this.loadingParts&&f!=null&&f.length&&d);p&&!this.bitrateTest&&f[f.length-1].fragment.sn===d.sn&&(a=a.concat(d),l=d.sn);let y;if(e<r){var v;const b=e<this.lastCurrentTime||e>r-u||(v=this.media)!=null&&v.paused||!this.startFragRequested?0:u;y=Xl(i,a,e,b)}else y=a[a.length-1];if(y){const E=y.sn-n.startSN,b=this.fragmentTracker.getState(y);if((b===en.OK||b===en.PARTIAL&&y.gap)&&(i=y),i&&y.sn===i.sn&&(!p||f[0].fragment.sn>y.sn||!n.live)&&y.level===i.level){const I=a[E+1];y.sn<l&&this.fragmentTracker.getState(I)!==en.OK?y=I:y=null}}return y}alignPlaylists(e,r,n){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const i=e.fragmentStart,a=!r,l=e.alignedSliding&&Ve(i);if(a||!l&&!i){ste(n,e);const d=e.fragmentStart;return this.log(`Live playlist sliding: ${d.toFixed(2)} start-sn: ${r?r.startSN:"na"}->${e.startSN} fragments: ${s}`),d}return i}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,r){let n=this.startPosition;n<r&&(n=-1);const s=this.timelineOffset;if(n===-1){const i=this.startTimeOffset!==null,a=i?this.startTimeOffset:e.startTimeOffset;a!==null&&Ve(a)?(n=r+a,a<0&&(n+=e.edge),n=Math.min(Math.max(r,n),r+e.totalduration),this.log(`Setting startPosition to ${n} for start time offset ${a} found in ${i?"multivariant":"media"} playlist`),this.startPosition=n):e.live?(n=this.hls.liveSyncPosition||r,this.log(`Setting startPosition to -1 to start at live edge ${n}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=n=0),this.lastCurrentTime=n+s}this.nextLoadPosition=n+s}getLoadPosition(){var e;const{media:r}=this;let n=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&r?n=r.currentTime:this.nextLoadPosition>=0&&(n=this.nextLoadPosition),n}handleFragLoadAborted(e,r){this.transmuxer&&e.type===this.playlistType&&Or(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${r?" part "+r.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==be.FRAG_LOADING_WAITING_RETRY)&&(this.state=be.IDLE)}onFragmentOrKeyLoadError(e,r){var n;if(r.chunkMeta&&!r.frag){const I=this.getCurrentContext(r.chunkMeta);I&&(r.frag=I.frag)}const s=r.frag;if(!s||s.type!==e||!this.levels)return;if(this.fragContextChanged(s)){var i;this.warn(`Frag load error must match current frag to retry ${s.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}const a=r.details===ue.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(s,!0);const l=r.errorAction;if(!l){this.state=be.ERROR;return}const{action:d,flags:u,retryCount:f=0,retryConfig:p}=l,y=!!p,v=y&&d===vn.RetryRequest,E=y&&!l.resolved&&u===ws.MoveAllAlternatesMatchingHost,b=(n=this.hls.latestLevelDetails)==null?void 0:n.live;if(!v&&E&&Or(s)&&!s.endList&&b&&!Hj(r))this.resetFragmentErrors(e),this.treatAsGap(s),l.resolved=!0;else if((v||E)&&f<p.maxNumRetry){var T;const I=Ov((T=r.response)==null?void 0:T.code),N=zE(p,f);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+N,this.state=be.FRAG_LOADING_WAITING_RETRY,l.resolved=!0,I){this.log("Waiting for connection (offline)"),this.retryDate=1/0,r.reason="offline";return}this.warn(`Fragment ${s.sn} of ${e} ${s.level} errored with ${r.details}, retrying loading ${f+1}/${p.maxNumRetry} in ${N}ms`)}else if(p)if(this.resetFragmentErrors(e),f<p.maxNumRetry)!a&&d!==vn.RemoveAlternatePermanently&&(l.resolved=!0);else{this.warn(`${r.details} reached or exceeded max retry (${f})`);return}else d===vn.SendAlternateToPenaltyBox?this.state=be.WAITING_LEVEL:this.state=be.ERROR;this.tickImmediate()}checkRetryDate(){const e=self.performance.now(),r=this.retryDate,n=r===1/0;(!r||e>=r||n&&!Ov(0))&&(n&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=be.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===be.PARSING||this.state===be.PARSED){const r=e.frag,n=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,n),i=s&&s.len>.5;i&&this.reduceMaxBufferLength(s.len,(r==null?void 0:r.duration)||10);const a=!i;return a&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${n} buffer`),r&&(this.fragmentTracker.removeFragment(r),this.nextLoadPosition=r.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===ze.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==be.STOPPED&&(this.state=be.IDLE)}afterBufferFlushed(e,r,n){if(!e)return;const s=ht.getBuffered(e);this.fragmentTracker.detectEvictedFragments(r,s,n),this.state===be.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==be.STOPPED&&(this.state=be.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const e=this.levelLastLoaded,r=e?e.details:null;r!=null&&r.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(r,r.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,r,n,s){const i=n.details;if(!i){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((d,u)=>{const f=e.elementaryStreams[u];if(f){const p=f.endPTS-f.startPTS;if(p<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${p})`),d||!1;const y=s?0:Jj(i,e,f.startPTS,f.endPTS,f.startDTS,f.endDTS,this);return this.hls.trigger(M.LEVEL_PTS_UPDATED,{details:i,level:n,drift:y,type:u,frag:e,start:f.startPTS,end:f.endPTS}),!0}return d},!1)){var l;const d=((l=this.transmuxer)==null?void 0:l.error)===null;if((n.fragmentError===0||d&&(n.fragmentError<2||e.endList))&&this.treatAsGap(e,n),d){const u=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(u.message),this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_PARSING_ERROR,fatal:!1,error:u,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${n.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=be.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${r?" part: "+r.index:""} of ${this.fragInfo(e,!1,r)})`),this.hls.trigger(M.FRAG_PARSED,{frag:e,part:r})}playlistLabel(){return this.playlistType===ze.MAIN?"level":"track"}fragInfo(e,r=!0,n){var s,i;return`${this.playlistLabel()} ${e.level} (${n?"part":"frag"}:[${((s=r&&!n?e.startPTS:(n||e).start)!=null?s:NaN).toFixed(3)}-${((i=r&&!n?e.endPTS:(n||e).end)!=null?i:NaN).toFixed(3)}]${n&&e.type==="main"?"INDEPENDENT="+(n.independent?"YES":"NO"):""}`}treatAsGap(e,r){r&&r.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){const r=this._state;r!==e&&(this._state=e,this.log(`${r}->${e}`))}get state(){return this._state}}function gN(t){return!!t.interstitialsController&&t.enableInterstitialPlayback!==!1}class oM{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:r}=this;let n;if(e.length)e.length===1?n=e[0]:n=ate(e,r);else return new Uint8Array(0);return this.reset(),n}reset(){this.chunks.length=0,this.dataLength=0}}function ate(t,e){const r=new Uint8Array(e);let n=0;for(let s=0;s<t.length;s++){const i=t[s];r.set(i,n),n+=i.length}return r}var w1={exports:{}},xN;function ote(){return xN||(xN=1,function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function i(d,u,f,p,y){if(typeof f!="function")throw new TypeError("The listener must be a function");var v=new s(f,p||d,y),E=r?r+u:u;return d._events[E]?d._events[E].fn?d._events[E]=[d._events[E],v]:d._events[E].push(v):(d._events[E]=v,d._eventsCount++),d}function a(d,u){--d._eventsCount===0?d._events=new n:delete d._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],f,p;if(this._eventsCount===0)return u;for(p in f=this._events)e.call(f,p)&&u.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},l.prototype.listeners=function(u){var f=r?r+u:u,p=this._events[f];if(!p)return[];if(p.fn)return[p.fn];for(var y=0,v=p.length,E=new Array(v);y<v;y++)E[y]=p[y].fn;return E},l.prototype.listenerCount=function(u){var f=r?r+u:u,p=this._events[f];return p?p.fn?1:p.length:0},l.prototype.emit=function(u,f,p,y,v,E){var b=r?r+u:u;if(!this._events[b])return!1;var T=this._events[b],I=arguments.length,N,A;if(T.fn){switch(T.once&&this.removeListener(u,T.fn,void 0,!0),I){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,f),!0;case 3:return T.fn.call(T.context,f,p),!0;case 4:return T.fn.call(T.context,f,p,y),!0;case 5:return T.fn.call(T.context,f,p,y,v),!0;case 6:return T.fn.call(T.context,f,p,y,v,E),!0}for(A=1,N=new Array(I-1);A<I;A++)N[A-1]=arguments[A];T.fn.apply(T.context,N)}else{var L=T.length,P;for(A=0;A<L;A++)switch(T[A].once&&this.removeListener(u,T[A].fn,void 0,!0),I){case 1:T[A].fn.call(T[A].context);break;case 2:T[A].fn.call(T[A].context,f);break;case 3:T[A].fn.call(T[A].context,f,p);break;case 4:T[A].fn.call(T[A].context,f,p,y);break;default:if(!N)for(P=1,N=new Array(I-1);P<I;P++)N[P-1]=arguments[P];T[A].fn.apply(T[A].context,N)}}return!0},l.prototype.on=function(u,f,p){return i(this,u,f,p,!1)},l.prototype.once=function(u,f,p){return i(this,u,f,p,!0)},l.prototype.removeListener=function(u,f,p,y){var v=r?r+u:u;if(!this._events[v])return this;if(!f)return a(this,v),this;var E=this._events[v];if(E.fn)E.fn===f&&(!y||E.once)&&(!p||E.context===p)&&a(this,v);else{for(var b=0,T=[],I=E.length;b<I;b++)(E[b].fn!==f||y&&!E[b].once||p&&E[b].context!==p)&&T.push(E[b]);T.length?this._events[v]=T.length===1?T[0]:T:a(this,v)}return this},l.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&a(this,f)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,t.exports=l}(w1)),w1.exports}var lte=ote(),QE=DJ(lte);const Hh="1.6.15",Fu={};function cte(){return typeof __HLS_WORKER_BUNDLE__=="function"}function ute(){const t=Fu[Hh];if(t)return t.clientCount++,t;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),r=self.URL.createObjectURL(e),s={worker:new self.Worker(r),objectURL:r,clientCount:1};return Fu[Hh]=s,s}function dte(t){const e=Fu[t];if(e)return e.clientCount++,e;const r=new self.URL(t,self.location.href).href,s={worker:new self.Worker(r),scriptURL:r,clientCount:1};return Fu[t]=s,s}function hte(t){const e=Fu[t||Hh];if(e&&e.clientCount--===1){const{worker:n,objectURL:s}=e;delete Fu[t||Hh],s&&self.URL.revokeObjectURL(s),n.terminate()}}function lM(t,e){return e+10<=t.length&&t[e]===51&&t[e+1]===68&&t[e+2]===73&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function ZE(t,e){return e+10<=t.length&&t[e]===73&&t[e+1]===68&&t[e+2]===51&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128}function Dg(t,e){let r=0;return r=(t[e]&127)<<21,r|=(t[e+1]&127)<<14,r|=(t[e+2]&127)<<7,r|=t[e+3]&127,r}function zh(t,e){const r=e;let n=0;for(;ZE(t,e);){n+=10;const s=Dg(t,e+6);n+=s,lM(t,e+10)&&(n+=10),e+=n}if(n>0)return t.subarray(r,r+n)}function fte(t,e,r,n){const s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],i=e[r+2],a=i>>2&15;if(a>12){const v=new Error(`invalid ADTS sampling index:${a}`);t.emit(M.ERROR,M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_PARSING_ERROR,fatal:!0,error:v,reason:v.message});return}const l=(i>>6&3)+1,d=e[r+3]>>6&3|(i&1)<<2,u="mp4a.40."+l,f=s[a];let p=a;(l===5||l===29)&&(p-=3);const y=[l<<3|(p&14)>>1,(p&1)<<7|d<<3];return Vt.log(`manifest codec:${n}, parsed codec:${u}, channels:${d}, rate:${f} (ADTS object type:${l} sampling index:${a})`),{config:y,samplerate:f,channelCount:d,codec:u,parsedCodec:u,manifestCodec:n}}function cM(t,e){return t[e]===255&&(t[e+1]&246)===240}function uM(t,e){return t[e+1]&1?7:9}function JE(t,e){return(t[e+3]&3)<<11|t[e+4]<<3|(t[e+5]&224)>>>5}function mte(t,e){return e+5<t.length}function bp(t,e){return e+1<t.length&&cM(t,e)}function pte(t,e){return mte(t,e)&&cM(t,e)&&JE(t,e)<=t.length-e}function gte(t,e){if(bp(t,e)){const r=uM(t,e);if(e+r>=t.length)return!1;const n=JE(t,e);if(n<=r)return!1;const s=e+n;return s===t.length||bp(t,s)}return!1}function dM(t,e,r,n,s){if(!t.samplerate){const i=fte(e,r,n,s);if(!i)return;zt(t,i)}}function hM(t){return 1024*9e4/t}function xte(t,e){const r=uM(t,e);if(e+r<=t.length){const n=JE(t,e)-r;if(n>0)return{headerLength:r,frameLength:n}}}function fM(t,e,r,n,s){const i=hM(t.samplerate),a=n+s*i,l=xte(e,r);let d;if(l){const{frameLength:p,headerLength:y}=l,v=y+p,E=Math.max(0,r+v-e.length);E?(d=new Uint8Array(v-y),d.set(e.subarray(r+y,e.length),0)):d=e.subarray(r+y,r+v);const b={unit:d,pts:a};return E||t.samples.push(b),{sample:b,length:v,missing:E}}const u=e.length-r;return d=new Uint8Array(u),d.set(e.subarray(r,e.length),0),{sample:{unit:d,pts:a},length:u,missing:-1}}function yte(t,e){return ZE(t,e)&&Dg(t,e+6)+10<=t.length-e}function vte(t){return t instanceof ArrayBuffer?t:t.byteOffset==0&&t.byteLength==t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer}function b1(t,e=0,r=1/0){return wte(t,e,r,Uint8Array)}function wte(t,e,r,n){const s=bte(t);let i=1;"BYTES_PER_ELEMENT"in n&&(i=n.BYTES_PER_ELEMENT);const a=Ete(t)?t.byteOffset:0,l=(a+t.byteLength)/i,d=(a+e)/i,u=Math.floor(Math.max(0,Math.min(d,l))),f=Math.floor(Math.min(u+Math.max(r,0),l));return new n(s,u,f-u)}function bte(t){return t instanceof ArrayBuffer?t:t.buffer}function Ete(t){return t&&t.buffer instanceof ArrayBuffer&&t.byteLength!==void 0&&t.byteOffset!==void 0}function Ste(t){const e={key:t.type,description:"",data:"",mimeType:null,pictureType:null},r=3;if(t.size<2)return;if(t.data[0]!==r){console.log("Ignore frame with unrecognized character encoding");return}const n=t.data.subarray(1).indexOf(0);if(n===-1)return;const s=_s(b1(t.data,1,n)),i=t.data[2+n],a=t.data.subarray(3+n).indexOf(0);if(a===-1)return;const l=_s(b1(t.data,3+n,a));let d;return s==="-->"?d=_s(b1(t.data,4+n+a)):d=vte(t.data.subarray(4+n+a)),e.mimeType=s,e.pictureType=i,e.description=l,e.data=d,e}function Tte(t){if(t.size<2)return;const e=_s(t.data,!0),r=new Uint8Array(t.data.subarray(e.length+1));return{key:t.type,info:e,data:r.buffer}}function Cte(t){if(t.size<2)return;if(t.type==="TXXX"){let r=1;const n=_s(t.data.subarray(r),!0);r+=n.length+1;const s=_s(t.data.subarray(r));return{key:t.type,info:n,data:s}}const e=_s(t.data.subarray(1));return{key:t.type,info:"",data:e}}function Ate(t){if(t.type==="WXXX"){if(t.size<2)return;let r=1;const n=_s(t.data.subarray(r),!0);r+=n.length+1;const s=_s(t.data.subarray(r));return{key:t.type,info:n,data:s}}const e=_s(t.data);return{key:t.type,info:"",data:e}}function Nte(t){return t.type==="PRIV"?Tte(t):t.type[0]==="W"?Ate(t):t.type==="APIC"?Ste(t):Cte(t)}function Ite(t){const e=String.fromCharCode(t[0],t[1],t[2],t[3]),r=Dg(t,4),n=10;return{type:e,size:r,data:t.subarray(n,n+r)}}const bm=10,Rte=10;function mM(t){let e=0;const r=[];for(;ZE(t,e);){const n=Dg(t,e+6);t[e+5]>>6&1&&(e+=bm),e+=bm;const s=e+n;for(;e+Rte<s;){const i=Ite(t.subarray(e)),a=Nte(i);a&&r.push(a),e+=i.size+bm}lM(t,e)&&(e+=bm)}return r}function pM(t){return t&&t.key==="PRIV"&&t.info==="com.apple.streaming.transportStreamTimestamp"}function _te(t){if(t.data.byteLength===8){const e=new Uint8Array(t.data),r=e[3]&1;let n=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return n/=45,r&&(n+=4772185884e-2),Math.round(n)}}function e2(t){const e=mM(t);for(let r=0;r<e.length;r++){const n=e[r];if(pM(n))return _te(n)}}let As=function(t){return t.audioId3="org.id3",t.dateRange="com.apple.quicktime.HLS",t.emsg="https://aomedia.org/emsg/ID3",t.misbklv="urn:misb:KLV:bin:1910.1",t}({});function Wi(t="",e=9e4){return{type:t,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class t2{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,r,n,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,r){return!1}appendFrame(e,r,n){}demux(e,r){this.cachedData&&(e=ri(this.cachedData,e),this.cachedData=null);let n=zh(e,0),s=n?n.length:0,i;const a=this._audioTrack,l=this._id3Track,d=n?e2(n):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&Ve(d))&&(this.basePTS=Lte(d,r,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),n&&n.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:As.audioId3,duration:Number.POSITIVE_INFINITY});s<u;){if(this.canParse(e,s)){const f=this.appendFrame(a,e,s);f?(this.frameIndex++,this.lastPTS=f.sample.pts,s+=f.length,i=s):s=u}else yte(e,s)?(n=zh(e,s),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:As.audioId3,duration:Number.POSITIVE_INFINITY}),s+=n.length,i=s):s++;if(s===u&&i!==u){const f=e.slice(i);this.cachedData?this.cachedData=ri(this.cachedData,f):this.cachedData=f}}return{audioTrack:a,videoTrack:Wi(),id3Track:l,textTrack:Wi()}}demuxSampleAes(e,r,n){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const r=this.cachedData;return r&&(this.cachedData=null,this.demux(r,0)),{audioTrack:this._audioTrack,videoTrack:Wi(),id3Track:this._id3Track,textTrack:Wi()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const Lte=(t,e,r)=>{if(Ve(t))return t*90;const n=r?r.baseTime*9e4/r.timescale:0;return e*9e4+n};let Em=null;const Pte=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],Dte=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],kte=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],jte=[0,1,1,4];function gM(t,e,r,n,s){if(r+24>e.length)return;const i=xM(e,r);if(i&&r+i.frameLength<=e.length){const a=i.samplesPerFrame*9e4/i.sampleRate,l=n+s*a,d={unit:e.subarray(r,r+i.frameLength),pts:l,dts:l};return t.config=[],t.channelCount=i.channelCount,t.samplerate=i.sampleRate,t.samples.push(d),{sample:d,length:i.frameLength,missing:0}}}function xM(t,e){const r=t[e+1]>>3&3,n=t[e+1]>>1&3,s=t[e+2]>>4&15,i=t[e+2]>>2&3;if(r!==1&&s!==0&&s!==15&&i!==3){const a=t[e+2]>>1&1,l=t[e+3]>>6,d=r===3?3-n:n===3?3:4,u=Pte[d*14+s-1]*1e3,p=Dte[(r===3?0:r===2?1:2)*3+i],y=l===3?1:2,v=kte[r][n],E=jte[n],b=v*8*E,T=Math.floor(v*u/p+a)*E;if(Em===null){const A=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Em=A?parseInt(A[1]):0}return!!Em&&Em<=87&&n===2&&u>=224e3&&l===0&&(t[e+3]=t[e+3]|128),{sampleRate:p,channelCount:y,frameLength:T,samplesPerFrame:b}}}function r2(t,e){return t[e]===255&&(t[e+1]&224)===224&&(t[e+1]&6)!==0}function yM(t,e){return e+1<t.length&&r2(t,e)}function Mte(t,e){return r2(t,e)&&4<=t.length-e}function vM(t,e){if(e+1<t.length&&r2(t,e)){const n=xM(t,e);let s=4;n!=null&&n.frameLength&&(s=n.frameLength);const i=e+s;return i===t.length||yM(t,i)}return!1}class Ote extends t2{constructor(e,r){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=r}resetInitSegment(e,r,n,s){super.resetInitSegment(e,r,n,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:r,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,r){if(!e)return!1;const n=zh(e,0);let s=(n==null?void 0:n.length)||0;if(vM(e,s))return!1;for(let i=e.length;s<i;s++)if(gte(e,s))return r.log("ADTS sync word found !"),!0;return!1}canParse(e,r){return pte(e,r)}appendFrame(e,r,n){dM(e,this.observer,r,n,e.manifestCodec);const s=fM(e,r,n,this.basePTS,this.frameIndex);if(s&&s.missing===0)return s}}const wM=(t,e)=>{let r=0,n=5;e+=n;const s=new Uint32Array(1),i=new Uint32Array(1),a=new Uint8Array(1);for(;n>0;){a[0]=t[e];const l=Math.min(n,8),d=8-l;i[0]=4278190080>>>24+d<<d,s[0]=(a[0]&i[0])>>d,r=r?r<<l|s[0]:s[0],e+=1,n-=l}return r};class Fte extends t2{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,r,n,s){super.resetInitSegment(e,r,n,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:r,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,r){return r+64<e.length}appendFrame(e,r,n){const s=bM(e,r,n,this.basePTS,this.frameIndex);if(s!==-1)return{sample:e.samples[e.samples.length-1],length:s,missing:0}}static probe(e){if(!e)return!1;const r=zh(e,0);if(!r)return!1;const n=r.length;return e[n]===11&&e[n+1]===119&&e2(r)!==void 0&&wM(e,n)<16}}function bM(t,e,r,n,s){if(r+8>e.length||e[r]!==11||e[r+1]!==119)return-1;const i=e[r+4]>>6;if(i>=3)return-1;const l=[48e3,44100,32e3][i],d=e[r+4]&63,f=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][d*3+i]*2;if(r+f>e.length)return-1;const p=e[r+6]>>5;let y=0;p===2?y+=2:(p&1&&p!==1&&(y+=2),p&4&&(y+=2));const v=(e[r+6]<<8|e[r+7])>>12-y&1,b=[2,1,2,3,3,4,4,5][p]+v,T=e[r+5]>>3,I=e[r+5]&7,N=new Uint8Array([i<<6|T<<1|I>>2,(I&3)<<6|p<<3|v<<2|d>>4,d<<4&224]),A=1536/l*9e4,L=n+s*A,P=e.subarray(r,r+f);return t.config=N,t.channelCount=b,t.samplerate=l,t.samples.push({unit:P,pts:L}),f}class Bte extends t2{resetInitSegment(e,r,n,s){super.resetInitSegment(e,r,n,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:r,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const r=zh(e,0);let n=(r==null?void 0:r.length)||0;if(r&&e[n]===11&&e[n+1]===119&&e2(r)!==void 0&&wM(e,n)<=16)return!1;for(let s=e.length;n<s;n++)if(vM(e,n))return Vt.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,r){return Mte(e,r)}appendFrame(e,r,n){if(this.basePTS!==null)return gM(e,r,n,this.basePTS,this.frameIndex)}}const Ute=/\/emsg[-/]ID3/i;class $te{constructor(e,r){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=r}resetTimeStamp(){}resetInitSegment(e,r,n,s){const i=this.videoTrack=Wi("video",1),a=this.audioTrack=Wi("audio",1),l=this.txtTrack=Wi("text",1);if(this.id3Track=Wi("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const d=Lj(e);if(d.video){const{id:u,timescale:f,codec:p,supplemental:y}=d.video;i.id=u,i.timescale=l.timescale=f,i.codec=p,i.supplemental=y}if(d.audio){const{id:u,timescale:f,codec:p}=d.audio;a.id=u,a.timescale=f,a.codec=p}l.id=Ij.text,i.sampleDuration=0,i.duration=a.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return FJ(e)}demux(e,r){this.timeOffset=r;let n=e;const s=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(n=ri(this.remainderData,e));const l=zJ(n);this.remainderData=l.remainder,s.samples=l.valid||new Uint8Array}else s.samples=n;const a=this.extractID3Track(s,r);return i.samples=jA(r,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,r=this.videoTrack,n=this.txtTrack;r.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(r,this.timeOffset);return n.samples=jA(e,r),{videoTrack:r,audioTrack:Wi(),id3Track:s,textTrack:Wi()}}extractID3Track(e,r){const n=this.id3Track;if(e.samples.length){const s=Tt(e.samples,["emsg"]);s&&s.forEach(i=>{const a=KJ(i);if(Ute.test(a.schemeIdUri)){const l=yN(a,r);let d=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;d<=.001&&(d=Number.POSITIVE_INFINITY);const u=a.payload;n.samples.push({data:u,len:u.byteLength,dts:l,pts:l,type:As.emsg,duration:d})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const l=yN(a,r);n.samples.push({data:a.payload,len:a.payload.byteLength,dts:l,pts:l,type:As.misbklv,duration:Number.POSITIVE_INFINITY})}})}return n}demuxSampleAes(e,r,n){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function yN(t,e){return Ve(t.presentationTime)?t.presentationTime/t.timeScale:e+t.presentationTimeDelta/t.timeScale}class Vte{constructor(e,r,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new WE(r,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Uo.cbc)}decryptAacSample(e,r,n){const s=e[r].unit;if(s.length<=16)return;const i=s.subarray(16,s.length-s.length%16),a=i.buffer.slice(i.byteOffset,i.byteOffset+i.length);this.decryptBuffer(a).then(l=>{const d=new Uint8Array(l);s.set(d,16),this.decrypter.isSync()||this.decryptAacSamples(e,r+1,n)}).catch(n)}decryptAacSamples(e,r,n){for(;;r++){if(r>=e.length){n();return}if(!(e[r].unit.length<32)&&(this.decryptAacSample(e,r,n),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const r=Math.floor((e.length-48)/160)*16+16,n=new Int8Array(r);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)n.set(e.subarray(i,i+16),s);return n}getAvcDecryptedUnit(e,r){const n=new Uint8Array(r);let s=0;for(let i=32;i<e.length-16;i+=160,s+=16)e.set(n.subarray(s,s+16),i);return e}decryptAvcSample(e,r,n,s,i){const a=kj(i.data),l=this.getAvcEncryptedData(a);this.decryptBuffer(l.buffer).then(d=>{i.data=this.getAvcDecryptedUnit(a,d),this.decrypter.isSync()||this.decryptAvcSamples(e,r,n+1,s)}).catch(s)}decryptAvcSamples(e,r,n,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;r++,n=0){if(r>=e.length){s();return}const i=e[r].units;for(;!(n>=i.length);n++){const a=i[n];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,r,n,s,a),!this.decrypter.isSync()))return}}}}class EM{constructor(){this.VideoSample=null}createVideoSample(e,r,n){return{key:e,frame:!1,pts:r,dts:n,units:[],length:0}}getLastNalUnit(e){var r;let n=this.VideoSample,s;if((!n||n.units.length===0)&&(n=e[e.length-1]),(r=n)!=null&&r.units){const i=n.units;s=i[i.length-1]}return s}pushAccessUnit(e,r){if(e.units.length&&e.frame){if(e.pts===void 0){const n=r.samples,s=n.length;if(s){const i=n[s-1];e.pts=i.pts,e.dts=i.dts}else{r.dropped++;return}}r.samples.push(e)}}parseNALu(e,r,n){const s=r.byteLength;let i=e.naluState||0;const a=i,l=[];let d=0,u,f,p,y=-1,v=0;for(i===-1&&(y=0,v=this.getNALuType(r,0),i=0,d=1);d<s;){if(u=r[d++],!i){i=u?0:1;continue}if(i===1){i=u?0:2;continue}if(!u)i=3;else if(u===1){if(f=d-i-1,y>=0){const E={data:r.subarray(y,f),type:v};l.push(E)}else{const E=this.getLastNalUnit(e.samples);E&&(a&&d<=4-a&&E.state&&(E.data=E.data.subarray(0,E.data.byteLength-a)),f>0&&(E.data=ri(E.data,r.subarray(0,f)),E.state=0))}d<s?(p=this.getNALuType(r,d),y=d,v=p,i=0):i=-1}else i=0}if(y>=0&&i>=0){const E={data:r.subarray(y,s),type:v,state:i};l.push(E)}if(l.length===0){const E=this.getLastNalUnit(e.samples);E&&(E.data=ri(E.data,r))}return e.naluState=i,l}}class eh{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,r=this.bytesAvailable,n=e.byteLength-r,s=new Uint8Array(4),i=Math.min(4,r);if(i===0)throw new Error("no bytes available");s.set(e.subarray(n,n+i)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=i*8,this.bytesAvailable-=i}skipBits(e){let r;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,r=e>>3,e-=r<<3,this.bytesAvailable-=r,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let r=Math.min(this.bitsAvailable,e);const n=this.word>>>32-r;if(e>32&&Vt.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=r,this.bitsAvailable>0)this.word<<=r;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return r=e-r,r>0&&this.bitsAvailable?n<<r|this.readBits(r):n}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Gte extends EM{parsePES(e,r,n,s){const i=this.parseNALu(e,n.data,s);let a=this.VideoSample,l,d=!1;n.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),i.forEach(u=>{var f,p;switch(u.type){case 1:{let b=!1;l=!0;const T=u.data;if(d&&T.length>4){const I=this.readSliceType(T);(I===2||I===4||I===7||I===9)&&(b=!0)}if(b){var y;(y=a)!=null&&y.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.frame=!0,a.key=b;break}case 5:l=!0,(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 6:{l=!0,VE(u.data,1,n.pts,r.samples);break}case 7:{var v,E;l=!0,d=!0;const b=u.data,T=this.readSPS(b);if(!e.sps||e.width!==T.width||e.height!==T.height||((v=e.pixelRatio)==null?void 0:v[0])!==T.pixelRatio[0]||((E=e.pixelRatio)==null?void 0:E[1])!==T.pixelRatio[1]){e.width=T.width,e.height=T.height,e.pixelRatio=T.pixelRatio,e.sps=[b];const I=b.subarray(1,4);let N="avc1.";for(let A=0;A<3;A++){let L=I[A].toString(16);L.length<2&&(L="0"+L),N+=L}e.codec=N}break}case 8:l=!0,e.pps=[u.data];break;case 9:l=!0,e.audFound=!0,(p=a)!=null&&p.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;case 12:l=!0;break;default:l=!1;break}a&&l&&a.units.push(u)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,r){return e[r]&31}readSliceType(e){const r=new eh(e);return r.readUByte(),r.readUEG(),r.readUEG()}skipScalingList(e,r){let n=8,s=8,i;for(let a=0;a<e;a++)s!==0&&(i=r.readEG(),s=(n+i+256)%256),n=s===0?n:s}readSPS(e){const r=new eh(e);let n=0,s=0,i=0,a=0,l,d,u;const f=r.readUByte.bind(r),p=r.readBits.bind(r),y=r.readUEG.bind(r),v=r.readBoolean.bind(r),E=r.skipBits.bind(r),b=r.skipEG.bind(r),T=r.skipUEG.bind(r),I=this.skipScalingList.bind(this);f();const N=f();if(p(5),E(3),f(),T(),N===100||N===110||N===122||N===244||N===44||N===83||N===86||N===118||N===128){const O=y();if(O===3&&E(1),T(),T(),E(1),v())for(d=O!==3?8:12,u=0;u<d;u++)v()&&(u<6?I(16,r):I(64,r))}T();const A=y();if(A===0)y();else if(A===1)for(E(1),b(),b(),l=y(),u=0;u<l;u++)b();T(),E(1);const L=y(),P=y(),k=p(1);k===0&&E(1),E(1),v()&&(n=y(),s=y(),i=y(),a=y());let D=[1,1];if(v()&&v())switch(f()){case 1:D=[1,1];break;case 2:D=[12,11];break;case 3:D=[10,11];break;case 4:D=[16,11];break;case 5:D=[40,33];break;case 6:D=[24,11];break;case 7:D=[20,11];break;case 8:D=[32,11];break;case 9:D=[80,33];break;case 10:D=[18,11];break;case 11:D=[15,11];break;case 12:D=[64,33];break;case 13:D=[160,99];break;case 14:D=[4,3];break;case 15:D=[3,2];break;case 16:D=[2,1];break;case 255:{D=[f()<<8|f(),f()<<8|f()];break}}return{width:Math.ceil((L+1)*16-n*2-s*2),height:(2-k)*(P+1)*16-(k?2:4)*(i+a),pixelRatio:D}}}class Hte extends EM{constructor(...e){super(...e),this.initVPS=null}parsePES(e,r,n,s){const i=this.parseNALu(e,n.data,s);let a=this.VideoSample,l,d=!1;n.data=null,a&&i.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),i.forEach(u=>{var f,p;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts)),a.frame=!0,l=!0;break;case 16:case 17:case 18:case 21:if(l=!0,d){var y;(y=a)!=null&&y.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:l=!0,(f=a)!=null&&f.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0,a.frame=!0;break;case 39:l=!0,VE(u.data,2,n.pts,r.samples);break;case 32:l=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=zt(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(l=!0,d=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const v=this.readSPS(u.data);e.width=v.width,e.height=v.height,e.pixelRatio=v.pixelRatio,e.codec=v.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const E in v.params)e.params[E]=v.params[E]}this.pushParameterSet(e.sps,u.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,n.pts,n.dts)),a.key=!0;break;case 34:if(l=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const v=this.readPPS(u.data);for(const E in v)e.params[E]=v[E]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:l=!0,e.audFound=!0,(p=a)!=null&&p.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,n.pts,n.dts));break;default:l=!1;break}a&&l&&a.units.push(u)}),s&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,r,n){(n&&n[0]===this.initVPS||!n&&!e.length)&&e.push(r)}getNALuType(e,r){return(e[r]&126)>>>1}ebsp2rbsp(e){const r=new Uint8Array(e.byteLength);let n=0;for(let s=0;s<e.byteLength;s++)s>=2&&e[s]===3&&e[s-1]===0&&e[s-2]===0||(r[n]=e[s],n++);return new Uint8Array(r.buffer,0,n)}pushAccessUnit(e,r){super.pushAccessUnit(e,r),this.initVPS&&(this.initVPS=null)}readVPS(e){const r=new eh(e);r.readUByte(),r.readUByte(),r.readBits(4),r.skipBits(2),r.readBits(6);const n=r.readBits(3),s=r.readBoolean();return{numTemporalLayers:n+1,temporalIdNested:s}}readSPS(e){const r=new eh(this.ebsp2rbsp(e));r.readUByte(),r.readUByte(),r.readBits(4);const n=r.readBits(3);r.readBoolean();const s=r.readBits(2),i=r.readBoolean(),a=r.readBits(5),l=r.readUByte(),d=r.readUByte(),u=r.readUByte(),f=r.readUByte(),p=r.readUByte(),y=r.readUByte(),v=r.readUByte(),E=r.readUByte(),b=r.readUByte(),T=r.readUByte(),I=r.readUByte(),N=[],A=[];for(let Ne=0;Ne<n;Ne++)N.push(r.readBoolean()),A.push(r.readBoolean());if(n>0)for(let Ne=n;Ne<8;Ne++)r.readBits(2);for(let Ne=0;Ne<n;Ne++)N[Ne]&&(r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte(),r.readUByte()),A[Ne]&&r.readUByte();r.readUEG();const L=r.readUEG();L==3&&r.skipBits(1);const P=r.readUEG(),k=r.readUEG(),D=r.readBoolean();let O=0,F=0,$=0,G=0;D&&(O+=r.readUEG(),F+=r.readUEG(),$+=r.readUEG(),G+=r.readUEG());const Y=r.readUEG(),ne=r.readUEG(),X=r.readUEG(),z=r.readBoolean();for(let Ne=z?0:n;Ne<=n;Ne++)r.skipUEG(),r.skipUEG(),r.skipUEG();if(r.skipUEG(),r.skipUEG(),r.skipUEG(),r.skipUEG(),r.skipUEG(),r.skipUEG(),r.readBoolean()&&r.readBoolean())for(let Je=0;Je<4;Je++)for(let Xe=0;Xe<(Je===3?2:6);Xe++)if(!r.readBoolean())r.readUEG();else{const Wr=Math.min(64,1<<4+(Je<<1));Je>1&&r.readEG();for(let $e=0;$e<Wr;$e++)r.readEG()}r.readBoolean(),r.readBoolean(),r.readBoolean()&&(r.readUByte(),r.skipUEG(),r.skipUEG(),r.readBoolean());const q=r.readUEG();let K=0;for(let Ne=0;Ne<q;Ne++){let Je=!1;if(Ne!==0&&(Je=r.readBoolean()),Je){Ne===q&&r.readUEG(),r.readBoolean(),r.readUEG();let Xe=0;for(let at=0;at<=K;at++){const Wr=r.readBoolean();let $e=!1;Wr||($e=r.readBoolean()),(Wr||$e)&&Xe++}K=Xe}else{const Xe=r.readUEG(),at=r.readUEG();K=Xe+at;for(let Wr=0;Wr<Xe;Wr++)r.readUEG(),r.readBoolean();for(let Wr=0;Wr<at;Wr++)r.readUEG(),r.readBoolean()}}if(r.readBoolean()){const Ne=r.readUEG();for(let Je=0;Je<Ne;Je++){for(let Xe=0;Xe<X+4;Xe++)r.readBits(1);r.readBits(1)}}let Q=0,re=1,Ee=1,ie=!0,se=1,oe=0;r.readBoolean(),r.readBoolean();let fe=!1;if(r.readBoolean()){if(r.readBoolean()){const Bn=r.readUByte(),gs=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],In=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];Bn>0&&Bn<16?(re=gs[Bn-1],Ee=In[Bn-1]):Bn===255&&(re=r.readBits(16),Ee=r.readBits(16))}if(r.readBoolean()&&r.readBoolean(),r.readBoolean()&&(r.readBits(3),r.readBoolean(),r.readBoolean()&&(r.readUByte(),r.readUByte(),r.readUByte())),r.readBoolean()&&(r.readUEG(),r.readUEG()),r.readBoolean(),r.readBoolean(),r.readBoolean(),fe=r.readBoolean(),fe&&(r.skipUEG(),r.skipUEG(),r.skipUEG(),r.skipUEG()),r.readBoolean()&&(se=r.readBits(32),oe=r.readBits(32),r.readBoolean()&&r.readUEG(),r.readBoolean())){const In=r.readBoolean(),Ua=r.readBoolean();let Ft=!1;(In||Ua)&&(Ft=r.readBoolean(),Ft&&(r.readUByte(),r.readBits(5),r.readBoolean(),r.readBits(5)),r.readBits(4),r.readBits(4),Ft&&r.readBits(4),r.readBits(5),r.readBits(5),r.readBits(5));for(let Ms=0;Ms<=n;Ms++){ie=r.readBoolean();const Os=ie||r.readBoolean();let Ur=!1;Os?r.readEG():Ur=r.readBoolean();const Li=Ur?1:r.readUEG()+1;if(In)for(let Fs=0;Fs<Li;Fs++)r.readUEG(),r.readUEG(),Ft&&(r.readUEG(),r.readUEG()),r.skipBits(1);if(Ua)for(let Fs=0;Fs<Li;Fs++)r.readUEG(),r.readUEG(),Ft&&(r.readUEG(),r.readUEG()),r.skipBits(1)}}r.readBoolean()&&(r.readBoolean(),r.readBoolean(),r.readBoolean(),Q=r.readUEG())}let _e=P,ce=k;if(D){let Ne=1,Je=1;L===1?Ne=Je=2:L==2&&(Ne=2),_e=P-Ne*F-Ne*O,ce=k-Je*G-Je*$}const Se=s?["A","B","C"][s]:"",Pe=l<<24|d<<16|u<<8|f;let Be=0;for(let Ne=0;Ne<32;Ne++)Be=(Be|(Pe>>Ne&1)<<31-Ne)>>>0;let tt=Be.toString(16);return a===1&&tt==="2"&&(tt="6"),{codecString:`hvc1.${Se}${a}.${tt}.${i?"H":"L"}${I}.B0`,params:{general_tier_flag:i,general_profile_idc:a,general_profile_space:s,general_profile_compatibility_flags:[l,d,u,f],general_constraint_indicator_flags:[p,y,v,E,b,T],general_level_idc:I,bit_depth:Y+8,bit_depth_luma_minus8:Y,bit_depth_chroma_minus8:ne,min_spatial_segmentation_idc:Q,chroma_format_idc:L,frame_rate:{fixed:ie,fps:oe/se}},width:_e,height:ce,pixelRatio:[re,Ee]}}readPPS(e){const r=new eh(this.ebsp2rbsp(e));r.readUByte(),r.readUByte(),r.skipUEG(),r.skipUEG(),r.skipBits(2),r.skipBits(3),r.skipBits(2),r.skipUEG(),r.skipUEG(),r.skipEG(),r.skipBits(2),r.readBoolean()&&r.skipUEG(),r.skipEG(),r.skipEG(),r.skipBits(4);const s=r.readBoolean(),i=r.readBoolean();let a=1;return i&&s?a=0:i?a=3:s&&(a=2),{parallelismType:a}}matchSPS(e,r){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,r).substr(3)}}const on=188;class so{constructor(e,r,n,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=r,this.typeSupported=n,this.logger=s,this.videoParser=null}static probe(e,r){const n=so.syncOffset(e);return n>0&&r.warn(`MPEG2-TS detected but first sync word found @ offset ${n}`),n!==-1}static syncOffset(e){const r=e.length;let n=Math.min(on*5,r-on)+1,s=0;for(;s<n;){let i=!1,a=-1,l=0;for(let d=s;d<r;d+=on)if(e[d]===71&&(r-d===on||e[d+on]===71)){if(l++,a===-1&&(a=d,a!==0&&(n=Math.min(a+on*99,e.length-on)+1)),i||(i=Vv(e,d)===0),i&&l>1&&(a===0&&l>2||d+on>n))return a}else{if(l)return-1;break}s++}return-1}static createTrack(e,r){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Ij[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?r:void 0}}resetInitSegment(e,r,n,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=so.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=so.createTrack("audio",s),this._id3Track=so.createTrack("id3"),this._txtTrack=so.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:r,_id3Track:n}=this;e&&(e.pesData=null),r&&(r.pesData=null),n&&(n.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,r,n=!1,s=!1){n||(this.sampleAes=null);let i;const a=this._videoTrack,l=this._audioTrack,d=this._id3Track,u=this._txtTrack;let f=a.pid,p=a.pesData,y=l.pid,v=d.pid,E=l.pesData,b=d.pesData,T=null,I=this.pmtParsed,N=this._pmtId,A=e.length;if(this.remainderData&&(e=ri(this.remainderData,e),A=e.length,this.remainderData=null),A<on&&!s)return this.remainderData=e,{audioTrack:l,videoTrack:a,id3Track:d,textTrack:u};const L=Math.max(0,so.syncOffset(e));A-=(A-L)%on,A<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,A,e.buffer.byteLength-A));let P=0;for(let D=L;D<A;D+=on)if(e[D]===71){const O=!!(e[D+1]&64),F=Vv(e,D),$=(e[D+3]&48)>>4;let G;if($>1){if(G=D+5+e[D+4],G===D+on)continue}else G=D+4;switch(F){case f:O&&(p&&(i=Ac(p,this.logger))&&(this.readyVideoParser(a.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(a,u,i,!1)),p={data:[],size:0}),p&&(p.data.push(e.subarray(G,D+on)),p.size+=D+on-G);break;case y:if(O){if(E&&(i=Ac(E,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,i);break;case"mp3":this.parseMPEGPES(l,i);break;case"ac3":this.parseAC3PES(l,i);break}E={data:[],size:0}}E&&(E.data.push(e.subarray(G,D+on)),E.size+=D+on-G);break;case v:O&&(b&&(i=Ac(b,this.logger))&&this.parseID3PES(d,i),b={data:[],size:0}),b&&(b.data.push(e.subarray(G,D+on)),b.size+=D+on-G);break;case 0:O&&(G+=e[G]+1),N=this._pmtId=zte(e,G);break;case N:{O&&(G+=e[G]+1);const Y=Wte(e,G,this.typeSupported,n,this.observer,this.logger);f=Y.videoPid,f>0&&(a.pid=f,a.segmentCodec=Y.segmentVideoCodec),y=Y.audioPid,y>0&&(l.pid=y,l.segmentCodec=Y.segmentAudioCodec),v=Y.id3Pid,v>0&&(d.pid=v),T!==null&&!I&&(this.logger.warn(`MPEG-TS PMT found at ${D} after unknown PID '${T}'. Backtracking to sync byte @${L} to parse all TS packets.`),T=null,D=L-188),I=this.pmtParsed=!0;break}case 17:case 8191:break;default:T=F;break}}else P++;P>0&&Gv(this.observer,new Error(`Found ${P} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=p,l.pesData=E,d.pesData=b;const k={audioTrack:l,videoTrack:a,id3Track:d,textTrack:u};return s&&this.extractRemainingSamples(k),k}flush(){const{remainderData:e}=this;this.remainderData=null;let r;return e?r=this.demux(e,-1,!1,!0):r={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(r),this.sampleAes?this.decrypt(r,this.sampleAes):r}extractRemainingSamples(e){const{audioTrack:r,videoTrack:n,id3Track:s,textTrack:i}=e,a=n.pesData,l=r.pesData,d=s.pesData;let u;if(a&&(u=Ac(a,this.logger))?(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(n,i,u,!0),n.pesData=null)):n.pesData=a,l&&(u=Ac(l,this.logger))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,u);break;case"mp3":this.parseMPEGPES(r,u);break;case"ac3":this.parseAC3PES(r,u);break}r.pesData=null}else l!=null&&l.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=l;d&&(u=Ac(d,this.logger))?(this.parseID3PES(s,u),s.pesData=null):s.pesData=d}demuxSampleAes(e,r,n){const s=this.demux(e,n,!0,!this.config.progressive),i=this.sampleAes=new Vte(this.observer,this.config,r);return this.decrypt(s,i)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new Gte:e==="hevc"&&(this.videoParser=new Hte))}decrypt(e,r){return new Promise(n=>{const{audioTrack:s,videoTrack:i}=e;s.samples&&s.segmentCodec==="aac"?r.decryptAacSamples(s.samples,0,()=>{i.samples?r.decryptAvcSamples(i.samples,0,0,()=>{n(e)}):n(e)}):i.samples&&r.decryptAvcSamples(i.samples,0,0,()=>{n(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,r){let n=0;const s=this.aacOverFlow;let i=r.data;if(s){this.aacOverFlow=null;const p=s.missing,y=s.sample.unit.byteLength;if(p===-1)i=ri(s.sample.unit,i);else{const v=y-p;s.sample.unit.set(i.subarray(0,p),v),e.samples.push(s.sample),n=s.missing}}let a,l;for(a=n,l=i.length;a<l-1&&!bp(i,a);a++);if(a!==n){let p;const y=a<l-1;if(y?p=`AAC PES did not start with ADTS header,offset:${a}`:p="No ADTS header found in AAC PES",Gv(this.observer,new Error(p),y,this.logger),!y)return}dM(e,this.observer,i,a,this.audioCodec);let d;if(r.pts!==void 0)d=r.pts;else if(s){const p=hM(e.samplerate);d=s.sample.pts+p}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,f;for(;a<l;)if(f=fM(e,i,a,d,u),a+=f.length,f.missing){this.aacOverFlow=f;break}else for(u++;a<l-1&&!bp(i,a);a++);}parseMPEGPES(e,r){const n=r.data,s=n.length;let i=0,a=0;const l=r.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<s;)if(yM(n,a)){const d=gM(e,n,a,l,i);if(d)a+=d.length,i++;else break}else a++}parseAC3PES(e,r){{const n=r.data,s=r.pts;if(s===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const i=n.length;let a=0,l=0,d;for(;l<i&&(d=bM(e,n,l,s,a++))>0;)l+=d}}parseID3PES(e,r){if(r.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const n=zt({},r,{type:this._videoTrack?As.emsg:As.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(n)}}function Vv(t,e){return((t[e+1]&31)<<8)+t[e+2]}function zte(t,e){return(t[e+10]&31)<<8|t[e+11]}function Wte(t,e,r,n,s,i){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},l=(t[e+1]&15)<<8|t[e+2],d=e+3+l-4,u=(t[e+10]&15)<<8|t[e+11];for(e+=12+u;e<d;){const f=Vv(t,e),p=(t[e+3]&15)<<8|t[e+4];switch(t[e]){case 207:if(!n){E1("ADTS AAC",i);break}case 15:a.audioPid===-1&&(a.audioPid=f);break;case 21:a.id3Pid===-1&&(a.id3Pid=f);break;case 219:if(!n){E1("H.264",i);break}case 27:a.videoPid===-1&&(a.videoPid=f);break;case 3:case 4:!r.mpeg&&!r.mp3?i.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=f,a.segmentAudioCodec="mp3");break;case 193:if(!n){E1("AC-3",i);break}case 129:r.ac3?a.audioPid===-1&&(a.audioPid=f,a.segmentAudioCodec="ac3"):i.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&p>0){let y=e+5,v=p;for(;v>2;){switch(t[y]){case 106:r.ac3!==!0?i.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=f,a.segmentAudioCodec="ac3");break}const b=t[y+1]+2;y+=b,v-=b}}break;case 194:case 135:return Gv(s,new Error("Unsupported EC-3 in M2TS found"),void 0,i),a;case 36:a.videoPid===-1&&(a.videoPid=f,a.segmentVideoCodec="hevc",i.log("HEVC in M2TS found"));break}e+=p+5}return a}function Gv(t,e,r,n){n.warn(`parsing error: ${e.message}`),t.emit(M.ERROR,M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:e,reason:e.message})}function E1(t,e){e.log(`${t} with AES-128-CBC encryption found in unencrypted stream`)}function Ac(t,e){let r=0,n,s,i,a,l;const d=t.data;if(!t||t.size===0)return null;for(;d[0].length<19&&d.length>1;)d[0]=ri(d[0],d[1]),d.splice(1,1);if(n=d[0],(n[0]<<16)+(n[1]<<8)+n[2]===1){if(s=(n[4]<<8)+n[5],s&&s>t.size-6)return null;const f=n[7];f&192&&(a=(n[9]&14)*536870912+(n[10]&255)*4194304+(n[11]&254)*16384+(n[12]&255)*128+(n[13]&254)/2,f&64?(l=(n[14]&14)*536870912+(n[15]&255)*4194304+(n[16]&254)*16384+(n[17]&255)*128+(n[18]&254)/2,a-l>60*9e4&&(e.warn(`${Math.round((a-l)/9e4)}s delta between PTS and DTS, align them`),a=l)):l=a),i=n[8];let p=i+9;if(t.size<=p)return null;t.size-=p;const y=new Uint8Array(t.size);for(let v=0,E=d.length;v<E;v++){n=d[v];let b=n.byteLength;if(p)if(p>b){p-=b;continue}else n=n.subarray(p),b-=p,p=0;y.set(n,r),r+=b}return s&&(s-=i+3),{data:y,pts:a,dts:l,len:s}}return null}class Kte{static getSilentFrame(e,r){switch(e){case"mp4a.40.2":if(r===1)return new Uint8Array([0,200,0,128,35,128]);if(r===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(r===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(r===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(r===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(r===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(r===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(r===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(r===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Xa=Math.pow(2,32)-1;class le{static init(){le.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in le.types)le.types.hasOwnProperty(e)&&(le.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);le.HDLR_TYPES={video:r,audio:n};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),i=new Uint8Array([0,0,0,0,0,0,0,0]);le.STTS=le.STSC=le.STCO=i,le.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),le.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),le.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),le.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);le.FTYP=le.box(le.types.ftyp,a,d,a,l),le.DINF=le.box(le.types.dinf,le.box(le.types.dref,s))}static box(e,...r){let n=8,s=r.length;const i=s;for(;s--;)n+=r[s].byteLength;const a=new Uint8Array(n);for(a[0]=n>>24&255,a[1]=n>>16&255,a[2]=n>>8&255,a[3]=n&255,a.set(e,4),s=0,n=8;s<i;s++)a.set(r[s],n),n+=r[s].byteLength;return a}static hdlr(e){return le.box(le.types.hdlr,le.HDLR_TYPES[e])}static mdat(e){return le.box(le.types.mdat,e)}static mdhd(e,r){r*=e;const n=Math.floor(r/(Xa+1)),s=Math.floor(r%(Xa+1));return le.box(le.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,s>>24,s>>16&255,s>>8&255,s&255,85,196,0,0]))}static mdia(e){return le.box(le.types.mdia,le.mdhd(e.timescale||0,e.duration||0),le.hdlr(e.type),le.minf(e))}static mfhd(e){return le.box(le.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?le.box(le.types.minf,le.box(le.types.smhd,le.SMHD),le.DINF,le.stbl(e)):le.box(le.types.minf,le.box(le.types.vmhd,le.VMHD),le.DINF,le.stbl(e))}static moof(e,r,n){return le.box(le.types.moof,le.mfhd(e),le.traf(n,r))}static moov(e){let r=e.length;const n=[];for(;r--;)n[r]=le.trak(e[r]);return le.box.apply(null,[le.types.moov,le.mvhd(e[0].timescale||0,e[0].duration||0)].concat(n).concat(le.mvex(e)))}static mvex(e){let r=e.length;const n=[];for(;r--;)n[r]=le.trex(e[r]);return le.box.apply(null,[le.types.mvex,...n])}static mvhd(e,r){r*=e;const n=Math.floor(r/(Xa+1)),s=Math.floor(r%(Xa+1)),i=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24,n>>16&255,n>>8&255,n&255,s>>24,s>>16&255,s>>8&255,s&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return le.box(le.types.mvhd,i)}static sdtp(e){const r=e.samples||[],n=new Uint8Array(4+r.length);let s,i;for(s=0;s<r.length;s++)i=r[s].flags,n[s+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return le.box(le.types.sdtp,n)}static stbl(e){return le.box(le.types.stbl,le.stsd(e),le.box(le.types.stts,le.STTS),le.box(le.types.stsc,le.STSC),le.box(le.types.stsz,le.STSZ),le.box(le.types.stco,le.STCO))}static avc1(e){let r=[],n=[],s,i,a;for(s=0;s<e.sps.length;s++)i=e.sps[s],a=i.byteLength,r.push(a>>>8&255),r.push(a&255),r=r.concat(Array.prototype.slice.call(i));for(s=0;s<e.pps.length;s++)i=e.pps[s],a=i.byteLength,n.push(a>>>8&255),n.push(a&255),n=n.concat(Array.prototype.slice.call(i));const l=le.box(le.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|e.sps.length].concat(r).concat([e.pps.length]).concat(n))),d=e.width,u=e.height,f=e.pixelRatio[0],p=e.pixelRatio[1];return le.box(le.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,le.box(le.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),le.box(le.types.pasp,new Uint8Array([f>>24,f>>16&255,f>>8&255,f&255,p>>24,p>>16&255,p>>8&255,p&255])))}static esds(e){const r=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...r,6,1,2])}static audioStsd(e){const r=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,r>>8&255,r&255,0,0])}static mp4a(e){return le.box(le.types.mp4a,le.audioStsd(e),le.box(le.types.esds,le.esds(e)))}static mp3(e){return le.box(le.types[".mp3"],le.audioStsd(e))}static ac3(e){return le.box(le.types["ac-3"],le.audioStsd(e),le.box(le.types.dac3,e.config))}static stsd(e){const{segmentCodec:r}=e;if(e.type==="audio"){if(r==="aac")return le.box(le.types.stsd,le.STSD,le.mp4a(e));if(r==="ac3"&&e.config)return le.box(le.types.stsd,le.STSD,le.ac3(e));if(r==="mp3"&&e.codec==="mp3")return le.box(le.types.stsd,le.STSD,le.mp3(e))}else if(e.pps&&e.sps){if(r==="avc")return le.box(le.types.stsd,le.STSD,le.avc1(e));if(r==="hevc"&&e.vps)return le.box(le.types.stsd,le.STSD,le.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${r}/${e.codec})`)}static tkhd(e){const r=e.id,n=(e.duration||0)*(e.timescale||0),s=e.width||0,i=e.height||0,a=Math.floor(n/(Xa+1)),l=Math.floor(n%(Xa+1));return le.box(le.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,r&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,l>>24,l>>16&255,l>>8&255,l&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,s&255,0,0,i>>8&255,i&255,0,0]))}static traf(e,r){const n=le.sdtp(e),s=e.id,i=Math.floor(r/(Xa+1)),a=Math.floor(r%(Xa+1));return le.box(le.types.traf,le.box(le.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,s&255])),le.box(le.types.tfdt,new Uint8Array([1,0,0,0,i>>24,i>>16&255,i>>8&255,i&255,a>>24,a>>16&255,a>>8&255,a&255])),le.trun(e,n.length+16+20+8+16+8+8),n)}static trak(e){return e.duration=e.duration||4294967295,le.box(le.types.trak,le.tkhd(e),le.mdia(e))}static trex(e){const r=e.id;return le.box(le.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,r){const n=e.samples||[],s=n.length,i=12+16*s,a=new Uint8Array(i);let l,d,u,f,p,y;for(r+=8+i,a.set([e.type==="video"?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,s&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255],0),l=0;l<s;l++)d=n[l],u=d.duration,f=d.size,p=d.flags,y=d.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,p.isLeading<<2|p.dependsOn,p.isDependedOn<<6|p.hasRedundancy<<4|p.paddingValue<<1|p.isNonSync,p.degradPrio&61440,p.degradPrio&15,y>>>24&255,y>>>16&255,y>>>8&255,y&255],12+16*l);return le.box(le.types.trun,a)}static initSegment(e){le.types||le.init();const r=le.moov(e);return ri(le.FTYP,r)}static hvc1(e){const r=e.params,n=[e.vps,e.sps,e.pps],s=4,i=new Uint8Array([1,r.general_profile_space<<6|(r.general_tier_flag?32:0)|r.general_profile_idc,r.general_profile_compatibility_flags[0],r.general_profile_compatibility_flags[1],r.general_profile_compatibility_flags[2],r.general_profile_compatibility_flags[3],r.general_constraint_indicator_flags[0],r.general_constraint_indicator_flags[1],r.general_constraint_indicator_flags[2],r.general_constraint_indicator_flags[3],r.general_constraint_indicator_flags[4],r.general_constraint_indicator_flags[5],r.general_level_idc,240|r.min_spatial_segmentation_idc>>8,255&r.min_spatial_segmentation_idc,252|r.parallelismType,252|r.chroma_format_idc,248|r.bit_depth_luma_minus8,248|r.bit_depth_chroma_minus8,0,parseInt(r.frame_rate.fps),s-1|r.temporal_id_nested<<2|r.num_temporal_layers<<3|(r.frame_rate.fixed?64:0),n.length]);let a=i.length;for(let E=0;E<n.length;E+=1){a+=3;for(let b=0;b<n[E].length;b+=1)a+=2+n[E][b].length}const l=new Uint8Array(a);l.set(i,0),a=i.length;const d=n.length-1;for(let E=0;E<n.length;E+=1){l.set(new Uint8Array([32+E|(E===d?128:0),0,n[E].length]),a),a+=3;for(let b=0;b<n[E].length;b+=1)l.set(new Uint8Array([n[E][b].length>>8,n[E][b].length&255]),a),a+=2,l.set(n[E][b],a),a+=n[E][b].length}const u=le.box(le.types.hvcC,l),f=e.width,p=e.height,y=e.pixelRatio[0],v=e.pixelRatio[1];return le.box(le.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>8&255,f&255,p>>8&255,p&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,le.box(le.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),le.box(le.types.pasp,new Uint8Array([y>>24,y>>16&255,y>>8&255,y&255,v>>24,v>>16&255,v>>8&255,v&255])))}}le.types=void 0;le.HDLR_TYPES=void 0;le.STTS=void 0;le.STSC=void 0;le.STCO=void 0;le.STSZ=void 0;le.VMHD=void 0;le.SMHD=void 0;le.STSD=void 0;le.FTYP=void 0;le.DINF=void 0;const SM=9e4;function n2(t,e,r=1,n=!1){const s=t*e*r;return n?Math.round(s):s}function Yte(t,e,r=1,n=!1){return n2(t,e,1/r,n)}function _d(t,e=!1){return n2(t,1e3,1/SM,e)}function qte(t,e=1){return n2(t,SM,1/e)}function vN(t){const{baseTime:e,timescale:r,trackId:n}=t;return`${e/r} (${e}/${r}) trackId: ${n}`}const Xte=10*1e3,Qte=1024,Zte=1152,Jte=1536;let Nc=null,S1=null;function wN(t,e,r,n){return{duration:e,size:r,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:t?2:1,isNonSync:t?0:1}}}class o0 extends ii{constructor(e,r,n,s){if(super("mp4-remuxer",s),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=r,this.typeSupported=n,this.ISGenerated=!1,Nc===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Nc=a?parseInt(a[1]):0}if(S1===null){const i=navigator.userAgent.match(/Safari\/(\d+)/i);S1=i?parseInt(i[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){const r=this._initPTS;(!r||!e||e.trackId!==r.trackId||e.baseTime!==r.baseTime||e.timescale!==r.timescale)&&this.log(`Reset initPTS: ${r&&vN(r)} > ${e&&vN(e)}`),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let r=!1;const n=e[0].pts,s=e.reduce((i,a)=>{let l=a.pts,d=l-i;return d<-4294967296&&(r=!0,l=Es(l,n),d=l-i),d>0?i:l},n);return r&&this.debug("PTS rollover detected"),s}remux(e,r,n,s,i,a,l,d){let u,f,p,y,v,E,b=i,T=i;const I=e.pid>-1,N=r.pid>-1,A=r.samples.length,L=e.samples.length>0,P=l&&A>0||A>1;if((!I||L)&&(!N||P)||this.ISGenerated||l){if(this.ISGenerated){var D,O,F,$;const X=this.videoTrackConfig;(X&&(r.width!==X.width||r.height!==X.height||((D=r.pixelRatio)==null?void 0:D[0])!==((O=X.pixelRatio)==null?void 0:O[0])||((F=r.pixelRatio)==null?void 0:F[1])!==(($=X.pixelRatio)==null?void 0:$[1]))||!X&&P||this.nextAudioTs===null&&L)&&this.resetInitSegment()}this.ISGenerated||(p=this.generateIS(e,r,i,a));const G=this.isVideoContiguous;let Y=-1,ne;if(P&&(Y=ere(r.samples),!G&&this.config.forceKeyFrameOnDiscontinuity))if(E=!0,Y>0){this.warn(`Dropped ${Y} out of ${A} video samples due to a missing keyframe`);const X=this.getVideoStartPts(r.samples);r.samples=r.samples.slice(Y),r.dropped+=Y,T+=(r.samples[0].pts-X)/r.inputTimeScale,ne=T}else Y===-1&&(this.warn(`No keyframe found out of ${A} video samples`),E=!1);if(this.ISGenerated){if(L&&P){const X=this.getVideoStartPts(r.samples),Z=(Es(e.samples[0].pts,X)-X)/r.inputTimeScale;b+=Math.max(0,Z),T+=Math.max(0,-Z)}if(L){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),p=this.generateIS(e,r,i,a)),f=this.remuxAudio(e,b,this.isAudioContiguous,a,N||P||d===ze.AUDIO?T:void 0),P){const X=f?f.endPTS-f.startPTS:0;r.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),p=this.generateIS(e,r,i,a)),u=this.remuxVideo(r,T,G,X)}}else P&&(u=this.remuxVideo(r,T,G,0));u&&(u.firstKeyFrame=Y,u.independent=Y!==-1,u.firstKeyFramePTS=ne)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(n.samples.length&&(v=TM(n,i,this._initPTS,this._initDTS)),s.samples.length&&(y=CM(s,i,this._initPTS))),{audio:f,video:u,initSegment:p,independent:E,text:y,id3:v}}computeInitPts(e,r,n,s){const i=Math.round(n*r);let a=Es(e,i);if(a<i+r)for(this.log(`Adjusting PTS for rollover in timeline near ${(i-a)/r} ${s}`);a<i+r;)a+=8589934592;return a-i}generateIS(e,r,n,s){const i=e.samples,a=r.samples,l=this.typeSupported,d={},u=this._initPTS;let f=!u||s,p="audio/mp4",y,v,E,b=-1;if(f&&(y=v=1/0),e.config&&i.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":l.mpeg?(p="audio/mpeg",e.codec=""):l.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}d.audio={id:"audio",container:p,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&l.mpeg?new Uint8Array(0):le.initSegment([e]),metadata:{channelCount:e.channelCount}},f&&(b=e.id,E=e.inputTimeScale,!u||E!==u.timescale?y=v=this.computeInitPts(i[0].pts,E,n,"audio"):f=!1)}if(r.sps&&r.pps&&a.length){if(r.timescale=r.inputTimeScale,d.video={id:"main",container:"video/mp4",codec:r.codec,initSegment:le.initSegment([r]),metadata:{width:r.width,height:r.height}},f)if(b=r.id,E=r.inputTimeScale,!u||E!==u.timescale){const T=this.getVideoStartPts(a),I=Es(a[0].dts,T),N=this.computeInitPts(I,E,n,"video"),A=this.computeInitPts(T,E,n,"video");v=Math.min(v,N),y=Math.min(y,A)}else f=!1;this.videoTrackConfig={width:r.width,height:r.height,pixelRatio:r.pixelRatio}}if(Object.keys(d).length)return this.ISGenerated=!0,f?(u&&this.warn(`Timestamps at playlist time: ${s?"":"~"}${n} ${y/E} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${n} offset: ${y/E} (${y}/${E}) trackId: ${b}`),this._initPTS={baseTime:y,timescale:E,trackId:b},this._initDTS={baseTime:v,timescale:E,trackId:b}):y=E=void 0,{tracks:d,initPTS:y,timescale:E,trackId:b}}remuxVideo(e,r,n,s){const i=e.inputTimeScale,a=e.samples,l=[],d=a.length,u=this._initPTS,f=u.baseTime*i/u.timescale;let p=this.nextVideoTs,y=8,v=this.videoSampleDuration,E,b,T=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,N=!1;if(!n||p===null){const Q=f+r*i,re=a[0].pts-Es(a[0].dts,a[0].pts);Nc&&p!==null&&Math.abs(Q-re-(p+f))<15e3?n=!0:p=Q-re-f}const A=p+f;for(let Q=0;Q<d;Q++){const re=a[Q];re.pts=Es(re.pts,A),re.dts=Es(re.dts,A),re.dts<a[Q>0?Q-1:Q].dts&&(N=!0)}N&&a.sort(function(Q,re){const Ee=Q.dts-re.dts,ie=Q.pts-re.pts;return Ee||ie}),E=a[0].dts,b=a[a.length-1].dts;const L=b-E,P=L?Math.round(L/(d-1)):v||e.inputTimeScale/30;if(n){const Q=E-A,re=Q>P,Ee=Q<-1;if((re||Ee)&&(re?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${_d(Q,!0)} ms (${Q}dts) hole between fragments detected at ${r.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${_d(-Q,!0)} ms (${Q}dts) overlapping between fragments detected at ${r.toFixed(3)}`),!Ee||A>=a[0].pts||Nc)){E=A;const ie=a[0].pts-Q;if(re)a[0].dts=E,a[0].pts=ie;else{let se=!0;for(let oe=0;oe<a.length&&!(a[oe].dts>ie&&se);oe++){const fe=a[oe].pts;if(a[oe].dts-=Q,a[oe].pts-=Q,oe<a.length-1){const Le=a[oe+1].pts,_e=a[oe].pts,ce=Le<=_e,Se=Le<=fe;se=ce==Se}}}this.log(`Video: Initial PTS/DTS adjusted: ${_d(ie,!0)}/${_d(E,!0)}, delta: ${_d(Q,!0)} ms`)}}E=Math.max(0,E);let k=0,D=0,O=E;for(let Q=0;Q<d;Q++){const re=a[Q],Ee=re.units,ie=Ee.length;let se=0;for(let oe=0;oe<ie;oe++)se+=Ee[oe].data.length;D+=se,k+=ie,re.length=se,re.dts<O?(re.dts=O,O+=P/4|0||1):O=re.dts,T=Math.min(re.pts,T),I=Math.max(re.pts,I)}b=a[d-1].dts;const F=D+4*k+8;let $;try{$=new Uint8Array(F)}catch(Q){this.observer.emit(M.ERROR,M.ERROR,{type:Qe.MUX_ERROR,details:ue.REMUX_ALLOC_ERROR,fatal:!1,error:Q,bytes:F,reason:`fail allocating video mdat ${F}`});return}const G=new DataView($.buffer);G.setUint32(0,F),$.set(le.types.mdat,4);let Y=!1,ne=Number.POSITIVE_INFINITY,X=Number.POSITIVE_INFINITY,z=Number.NEGATIVE_INFINITY,Z=Number.NEGATIVE_INFINITY;for(let Q=0;Q<d;Q++){const re=a[Q],Ee=re.units;let ie=0;for(let fe=0,Le=Ee.length;fe<Le;fe++){const _e=Ee[fe],ce=_e.data,Se=_e.data.byteLength;G.setUint32(y,Se),y+=4,$.set(ce,y),y+=Se,ie+=4+Se}let se;if(Q<d-1)v=a[Q+1].dts-re.dts,se=a[Q+1].pts-re.pts;else{const fe=this.config,Le=Q>0?re.dts-a[Q-1].dts:P;if(se=Q>0?re.pts-a[Q-1].pts:P,fe.stretchShortVideoTrack&&this.nextAudioTs!==null){const _e=Math.floor(fe.maxBufferHole*i),ce=(s?T+s*i:this.nextAudioTs+f)-re.pts;ce>_e?(v=ce-Le,v<0?v=Le:Y=!0,this.log(`It is approximately ${ce/90} ms to the next segment; using duration ${v/90} ms for the last video frame.`)):v=Le}else v=Le}const oe=Math.round(re.pts-re.dts);ne=Math.min(ne,v),z=Math.max(z,v),X=Math.min(X,se),Z=Math.max(Z,se),l.push(wN(re.key,v,ie,oe))}if(l.length){if(Nc){if(Nc<70){const Q=l[0].flags;Q.dependsOn=2,Q.isNonSync=0}}else if(S1&&Z-X<z-ne&&P/z<.025&&l[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let Q=E;for(let re=0,Ee=l.length;re<Ee;re++){const ie=Q+l[re].duration,se=Q+l[re].cts;if(re<Ee-1){const oe=ie+l[re+1].cts;l[re].duration=oe-se}else l[re].duration=re?l[re-1].duration:P;l[re].cts=0,Q=ie}}}v=Y||!v?P:v;const ee=b+v;this.nextVideoTs=p=ee-f,this.videoSampleDuration=v,this.isVideoContiguous=!0;const ae={data1:le.moof(e.sequenceNumber++,E,zt(e,{samples:l})),data2:$,startPTS:(T-f)/i,endPTS:(I+v-f)/i,startDTS:(E-f)/i,endDTS:p/i,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,ae}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return Zte;case"ac3":return Jte;default:return Qte}}remuxAudio(e,r,n,s,i){const a=e.inputTimeScale,l=e.samplerate?e.samplerate:a,d=a/l,u=this.getSamplesPerFrame(e),f=u*d,p=this._initPTS,y=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,v=[],E=i!==void 0;let b=e.samples,T=y?0:8,I=this.nextAudioTs||-1;const N=p.baseTime*a/p.timescale,A=N+r*a;if(this.isAudioContiguous=n=n||b.length&&I>0&&(s&&Math.abs(A-(I+N))<9e3||Math.abs(Es(b[0].pts,A)-(I+N))<20*f),b.forEach(function(Z){Z.pts=Es(Z.pts,A)}),!n||I<0){const Z=b.length;if(b=b.filter(ee=>ee.pts>=0),Z!==b.length&&this.warn(`Removed ${b.length-Z} of ${Z} samples (initPTS ${N} / ${a})`),!b.length)return;i===0?I=0:s&&!E?I=Math.max(0,A-N):I=b[0].pts-N}if(e.segmentCodec==="aac"){const Z=this.config.maxAudioFramesDrift;for(let ee=0,q=I+N;ee<b.length;ee++){const K=b[ee],ae=K.pts,Q=ae-q,re=Math.abs(1e3*Q/a);if(Q<=-Z*f&&E)ee===0&&(this.warn(`Audio frame @ ${(ae/a).toFixed(3)}s overlaps marker by ${Math.round(1e3*Q/a)} ms.`),this.nextAudioTs=I=ae-N,q=ae);else if(Q>=Z*f&&re<Xte&&E){let Ee=Math.round(Q/f);for(q=ae-Ee*f;q<0&&Ee&&f;)Ee--,q+=f;ee===0&&(this.nextAudioTs=I=q-N),this.warn(`Injecting ${Ee} audio frames @ ${((q-N)/a).toFixed(3)}s due to ${Math.round(1e3*Q/a)} ms gap.`);for(let ie=0;ie<Ee;ie++){let se=Kte.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);se||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),se=K.unit.subarray()),b.splice(ee,0,{unit:se,pts:q}),q+=f,ee++}}K.pts=q,q+=f}}let L=null,P=null,k,D=0,O=b.length;for(;O--;)D+=b[O].unit.byteLength;for(let Z=0,ee=b.length;Z<ee;Z++){const q=b[Z],K=q.unit;let ae=q.pts;if(P!==null){const re=v[Z-1];re.duration=Math.round((ae-P)/d)}else if(n&&e.segmentCodec==="aac"&&(ae=I+N),L=ae,D>0){D+=T;try{k=new Uint8Array(D)}catch(re){this.observer.emit(M.ERROR,M.ERROR,{type:Qe.MUX_ERROR,details:ue.REMUX_ALLOC_ERROR,fatal:!1,error:re,bytes:D,reason:`fail allocating audio mdat ${D}`});return}y||(new DataView(k.buffer).setUint32(0,D),k.set(le.types.mdat,4))}else return;k.set(K,T);const Q=K.byteLength;T+=Q,v.push(wN(!0,u,Q,0)),P=ae}const F=v.length;if(!F)return;const $=v[v.length-1];I=P-N,this.nextAudioTs=I+d*$.duration;const G=y?new Uint8Array(0):le.moof(e.sequenceNumber++,L/d,zt({},e,{samples:v}));e.samples=[];const Y=(L-N)/a,ne=this.nextAudioTs/a,z={data1:G,data2:k,startPTS:Y,endPTS:ne,startDTS:Y,endDTS:ne,type:"audio",hasAudio:!0,hasVideo:!1,nb:F};return this.isAudioContiguous=!0,z}}function Es(t,e){let r;if(e===null)return t;for(e<t?r=-8589934592:r=8589934592;Math.abs(t-e)>4294967296;)t+=r;return t}function ere(t){for(let e=0;e<t.length;e++)if(t[e].key)return e;return-1}function TM(t,e,r,n){const s=t.samples.length;if(!s)return;const i=t.inputTimeScale;for(let l=0;l<s;l++){const d=t.samples[l];d.pts=Es(d.pts-r.baseTime*i/r.timescale,e*i)/i,d.dts=Es(d.dts-n.baseTime*i/n.timescale,e*i)/i}const a=t.samples;return t.samples=[],{samples:a}}function CM(t,e,r){const n=t.samples.length;if(!n)return;const s=t.inputTimeScale;for(let a=0;a<n;a++){const l=t.samples[a];l.pts=Es(l.pts-r.baseTime*s/r.timescale,e*s)/s}t.samples.sort((a,l)=>a.pts-l.pts);const i=t.samples;return t.samples=[],{samples:i}}class tre extends ii{constructor(e,r,n,s){super("passthrough-remuxer",s),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;const r=this.initPTS;r&&e&&r.baseTime===e.baseTime&&r.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,r,n,s){this.audioCodec=r,this.videoCodec=n,this.generateInitSegment(e,s),this.emitInitSegment=!0}generateInitSegment(e,r){let{audioCodec:n,videoCodec:s}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const{audio:i,video:a}=this.initData=Lj(e);if(r)VJ(e,r);else{const d=i||a;d!=null&&d.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${d.codec}")!`)}i&&(n=bN(i,Yt.AUDIO,this)),a&&(s=bN(a,Yt.VIDEO,this));const l={};i&&a?l.audiovideo={container:"video/mp4",codec:n+","+s,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:i?l.audio={container:"audio/mp4",codec:n,encrypted:i.encrypted,initSegment:e,id:"audio"}:a?l.video={container:"video/mp4",codec:s,supplemental:a.supplemental,encrypted:a.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,r,n,s,i,a){var l,d;let{initPTS:u,lastEndTime:f}=this;const p={audio:void 0,video:void 0,text:s,id3:n,initSegment:void 0};Ve(f)||(f=this.lastEndTime=i||0);const y=r.samples;if(!y.length)return p;const v={initPTS:void 0,timescale:void 0,trackId:void 0};let E=this.initData;if((l=E)!=null&&l.length||(this.generateInitSegment(y),E=this.initData),!((d=E)!=null&&d.length))return this.warn("Failed to generate initSegment."),p;this.emitInitSegment&&(v.tracks=this.initTracks,this.emitInitSegment=!1);const b=HJ(y,E,this),T=E.audio?b[E.audio.id]:null,I=E.video?b[E.video.id]:null,N=Sm(I,1/0),A=Sm(T,1/0),L=Sm(I,0,!0),P=Sm(T,0,!0);let k=i,D=0;const O=T&&(!I||!u&&A<N||u&&u.trackId===E.audio.id),F=O?T:I;if(F){const q=F.timescale,K=F.start-i*q,ae=O?E.audio.id:E.video.id;k=F.start/q,D=O?P-A:L-N,(a||!u)&&(rre(u,k,i,D)||q!==u.timescale)&&(u&&this.warn(`Timestamps at playlist time: ${a?"":"~"}${i} ${K/q} != initPTS: ${u.baseTime/u.timescale} (${u.baseTime}/${u.timescale}) trackId: ${u.trackId}`),this.log(`Found initPTS at playlist time: ${i} offset: ${k-i} (${K}/${q}) trackId: ${ae}`),u=null,v.initPTS=K,v.timescale=q,v.trackId=ae)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${i}`);u?(v.initPTS=u.baseTime,v.timescale=u.timescale,v.trackId=u.trackId):((!v.timescale||v.trackId===void 0||v.initPTS===void 0)&&(this.warn("Could not set initPTS"),v.initPTS=k,v.timescale=1,v.trackId=-1),this.initPTS=u={baseTime:v.initPTS,timescale:v.timescale,trackId:v.trackId});const $=k-u.baseTime/u.timescale,G=$+D;D>0?this.lastEndTime=G:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const Y=!!E.audio,ne=!!E.video;let X="";Y&&(X+="audio"),ne&&(X+="video");const z=(E.audio?E.audio.encrypted:!1)||(E.video?E.video.encrypted:!1),Z={data1:y,startPTS:$,startDTS:$,endPTS:G,endDTS:G,type:X,hasAudio:Y,hasVideo:ne,nb:1,dropped:0,encrypted:z};p.audio=Y&&!ne?Z:void 0,p.video=ne?Z:void 0;const ee=I==null?void 0:I.sampleCount;if(ee){const q=I.keyFrameIndex,K=q!==-1;Z.nb=ee,Z.dropped=q===0||this.isVideoContiguous?0:K?q:ee,Z.independent=K,Z.firstKeyFrame=q,K&&I.keyFrameStart&&(Z.firstKeyFramePTS=(I.keyFrameStart-u.baseTime)/u.timescale),this.isVideoContiguous||(p.independent=K),this.isVideoContiguous||(this.isVideoContiguous=K),Z.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${q}/${ee} dropped: ${Z.dropped} start: ${Z.firstKeyFramePTS||"NA"}`)}return p.initSegment=v,p.id3=TM(n,i,u,u),s.samples.length&&(p.text=CM(s,i,u)),p}}function Sm(t,e,r=!1){return(t==null?void 0:t.start)!==void 0?(t.start+(r?t.duration:0))/t.timescale:e}function rre(t,e,r,n){if(t===null)return!0;const s=Math.max(n,1),i=e-t.baseTime/t.timescale;return Math.abs(i-r)>s}function bN(t,e,r){const n=t.codec;return n&&n.length>4?n:e===Yt.AUDIO?n==="ec-3"||n==="ac-3"||n==="alac"?n:n==="fLaC"||n==="Opus"?fp(n,!1):(r.warn(`Unhandled audio codec "${n}" in mp4 MAP`),n||"mp4a"):(r.warn(`Unhandled video codec "${n}" in mp4 MAP`),n||"avc1")}let wa;try{wa=self.performance.now.bind(self.performance)}catch{wa=Date.now}const l0=[{demux:$te,remux:tre},{demux:so,remux:o0},{demux:Ote,remux:o0},{demux:Bte,remux:o0}];l0.splice(2,0,{demux:Fte,remux:o0});class EN{constructor(e,r,n,s,i,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=r,this.config=n,this.id=i,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,r,n,s){const i=n.transmuxing;i.executeStart=wa();let a=new Uint8Array(e);const{currentTransmuxState:l,transmuxConfig:d}=this;s&&(this.currentTransmuxState=s);const{contiguous:u,discontinuity:f,trackSwitch:p,accurateTimeOffset:y,timeOffset:v,initSegmentChange:E}=s||l,{audioCodec:b,videoCodec:T,defaultInitPts:I,duration:N,initSegmentData:A}=d,L=nre(a,r);if(L&&cu(L.method)){const O=this.getDecrypter(),F=YE(L.method);if(O.isSync()){let $=O.softwareDecrypt(a,L.key.buffer,L.iv.buffer,F);if(n.part>-1){const Y=O.flush();$=Y&&Y.buffer}if(!$)return i.executeEnd=wa(),T1(n);a=new Uint8Array($)}else return this.asyncResult=!0,this.decryptionPromise=O.webCryptoDecrypt(a,L.key.buffer,L.iv.buffer,F).then($=>{const G=this.push($,null,n);return this.decryptionPromise=null,G}),this.decryptionPromise}const P=this.needsProbing(f,p);if(P){const O=this.configureTransmuxer(a);if(O)return this.logger.warn(`[transmuxer] ${O.message}`),this.observer.emit(M.ERROR,M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_PARSING_ERROR,fatal:!1,error:O,reason:O.message}),i.executeEnd=wa(),T1(n)}(f||p||E||P)&&this.resetInitSegment(A,b,T,N,r),(f||E||P)&&this.resetInitialTimestamp(I),u||this.resetContiguity();const k=this.transmux(a,L,v,y,n);this.asyncResult=Wh(k);const D=this.currentTransmuxState;return D.contiguous=!0,D.discontinuity=!1,D.trackSwitch=!1,i.executeEnd=wa(),k}flush(e){const r=e.transmuxing;r.executeStart=wa();const{decrypter:n,currentTransmuxState:s,decryptionPromise:i}=this;if(i)return this.asyncResult=!0,i.then(()=>this.flush(e));const a=[],{timeOffset:l}=s;if(n){const p=n.flush();p&&a.push(this.push(p.buffer,null,e))}const{demuxer:d,remuxer:u}=this;if(!d||!u){r.executeEnd=wa();const p=[T1(e)];return this.asyncResult?Promise.resolve(p):p}const f=d.flush(l);return Wh(f)?(this.asyncResult=!0,f.then(p=>(this.flushRemux(a,p,e),a))):(this.flushRemux(a,f,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,r,n){const{audioTrack:s,videoTrack:i,id3Track:a,textTrack:l}=r,{accurateTimeOffset:d,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${n.sn}${n.part>-1?" part: "+n.part:""} of ${this.id===ze.MAIN?"level":"track"} ${n.level}`);const f=this.remuxer.remux(s,i,a,l,u,d,!0,this.id);e.push({remuxResult:f,chunkMeta:n}),n.transmuxing.executeEnd=wa()}resetInitialTimestamp(e){const{demuxer:r,remuxer:n}=this;!r||!n||(r.resetTimeStamp(e),n.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:r}=this;!e||!r||(e.resetContiguity(),r.resetNextTimestamp())}resetInitSegment(e,r,n,s,i){const{demuxer:a,remuxer:l}=this;!a||!l||(a.resetInitSegment(e,r,n,s),l.resetInitSegment(e,r,n,i))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,r,n,s,i){let a;return r&&r.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,r,n,s,i):a=this.transmuxUnencrypted(e,n,s,i),a}transmuxUnencrypted(e,r,n,s){const{audioTrack:i,videoTrack:a,id3Track:l,textTrack:d}=this.demuxer.demux(e,r,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(i,a,l,d,r,n,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,r,n,s,i){return this.demuxer.demuxSampleAes(e,r,n).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,n,s,!1,this.id),chunkMeta:i}))}configureTransmuxer(e){const{config:r,observer:n,typeSupported:s}=this;let i;for(let p=0,y=l0.length;p<y;p++){var a;if((a=l0[p].demux)!=null&&a.probe(e,this.logger)){i=l0[p];break}}if(!i)return new Error("Failed to find demuxer by probing fragment data");const l=this.demuxer,d=this.remuxer,u=i.remux,f=i.demux;(!d||!(d instanceof u))&&(this.remuxer=new u(n,r,s,this.logger)),(!l||!(l instanceof f))&&(this.demuxer=new f(n,r,s,this.logger),this.probe=f.probe)}needsProbing(e,r){return!this.demuxer||!this.remuxer||e||r}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new WE(this.config)),e}}function nre(t,e){let r=null;return t.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(r=e),r}const T1=t=>({remuxResult:{},chunkMeta:t});function Wh(t){return"then"in t&&t.then instanceof Function}class sre{constructor(e,r,n,s,i){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=r,this.initSegmentData=n,this.duration=s,this.defaultInitPts=i||null}}class ire{constructor(e,r,n,s,i,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=r,this.accurateTimeOffset=n,this.trackSwitch=s,this.timeOffset=i,this.initSegmentChange=a}}let SN=0;class AM{constructor(e,r,n,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=SN++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=d=>{const u=d.data,f=this.hls;if(!(!f||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var p;const y=(p=this.workerContext)==null?void 0:p.objectURL;y&&self.URL.revokeObjectURL(y);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{f.logger[u.data.logType]&&f.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,f.trigger(u.event,u.data);break}}},this.onWorkerError=d=>{if(!this.hls)return;const u=new Error(`${d.message}  (${d.filename}:${d.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const i=e.config;this.hls=e,this.id=r,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=n,this.onFlush=s;const a=(d,u)=>{u=u||{},u.frag=this.frag||void 0,d===M.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(d,u)};this.observer=new QE,this.observer.on(M.FRAG_DECRYPTED,a),this.observer.on(M.ERROR,a);const l=FA(i.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const d=this.hls.logger;if(i.workerPath||cte()){try{i.workerPath?(d.log(`loading Web Worker ${i.workerPath} for "${r}"`),this.workerContext=dte(i.workerPath)):(d.log(`injecting Web Worker for "${r}"`),this.workerContext=ute());const{worker:f}=this.workerContext;f.addEventListener("message",this.onWorkerMessage),f.addEventListener("error",this.onWorkerError),f.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:r,config:qt(i)})}catch(f){d.warn(`Error setting up "${r}" Web Worker, fallback to inline`,f),this.terminateWorker(),this.error=null,this.transmuxer=new EN(this.observer,l,i,"",r,e.logger)}return}}this.transmuxer=new EN(this.observer,l,i,"",r,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=SN++;const r=this.hls.config,n=FA(r.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:n,id:this.id,config:qt(r)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),hte(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const r=this.transmuxer;r&&(r.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,r,n,s,i,a,l,d,u,f){var p,y;u.transmuxing.start=self.performance.now();const{instanceNo:v,transmuxer:E}=this,b=a?a.start:i.start,T=i.decryptdata,I=this.frag,N=!(I&&i.cc===I.cc),A=!(I&&u.level===I.level),L=I?u.sn-I.sn:-1,P=this.part?u.part-this.part.index:-1,k=L===0&&u.id>1&&u.id===(I==null?void 0:I.stats.chunkCount),D=!A&&(L===1||L===0&&(P===1||k&&P<=0)),O=self.performance.now();(A||L||i.stats.parsing.start===0)&&(i.stats.parsing.start=O),a&&(P||!D)&&(a.stats.parsing.start=O);const F=!(I&&((p=i.initSegment)==null?void 0:p.url)===((y=I.initSegment)==null?void 0:y.url)),$=new ire(N,D,d,A,b,F);if(!D||N||F){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${i.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===ze.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${N}
        trackSwitch: ${A}
        contiguous: ${D}
        accurateTimeOffset: ${d}
        timeOffset: ${b}
        initSegmentChange: ${F}`);const G=new sre(n,s,r,l,f);this.configureTransmuxer(G)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:v,cmd:"demux",data:e,decryptdata:T,chunkMeta:u,state:$},e instanceof ArrayBuffer?[e]:[]);else if(E){const G=E.push(e,T,u,$);Wh(G)?G.then(Y=>{this.handleTransmuxComplete(Y)}).catch(Y=>{this.transmuxerError(Y,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(G)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:r,transmuxer:n}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:r,cmd:"flush",chunkMeta:e});else if(n){const s=n.flush(e);Wh(s)?s.then(i=>{this.handleFlushResult(i,e)}).catch(i=>{this.transmuxerError(i,e,"transmuxer-interface flush error")}):this.handleFlushResult(s,e)}}transmuxerError(e,r,n){this.hls&&(this.error=e,this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_PARSING_ERROR,chunkMeta:r,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:n}))}handleFlushResult(e,r){e.forEach(n=>{this.handleTransmuxComplete(n)}),this.onFlush(r)}configureTransmuxer(e){const{instanceNo:r,transmuxer:n}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:r,cmd:"configure",config:e}):n&&n.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const TN=100;class are extends XE{constructor(e,r,n){super(e,r,n,"audio-stream-controller",ze.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(M.BUFFER_RESET,this.onBufferReset,this),e.on(M.BUFFER_CREATED,this.onBufferCreated,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(M.FRAG_LOADING,this.onFragLoading,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(M.BUFFER_RESET,this.onBufferReset,this),e.off(M.BUFFER_CREATED,this.onBufferCreated,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(M.FRAG_LOADING,this.onFragLoading,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:r,id:n,initPTS:s,timescale:i,trackId:a}){if(n===ze.MAIN){const l=r.cc,d=this.fragCurrent;if(this.initPTS[l]={baseTime:s,timescale:i,trackId:a},this.log(`InitPTS for cc: ${l} found from main: ${s/i} (${s}/${i}) trackId: ${a}`),this.mainAnchor=r,this.state===be.WAITING_INIT_PTS){const u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==l)&&this.syncWithAnchor(r,u==null?void 0:u.frag)}else!this.hls.hasEnoughToStart&&d&&d.cc!==l?(d.abortRequests(),this.syncWithAnchor(r,d)):this.state===be.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,r){var n;const s=((n=this.mainFragLoading)==null?void 0:n.frag)||null;if(r&&(s==null?void 0:s.cc)===r.cc)return;const i=(s||e).cc,a=this.getLevelDetails(),l=this.getLoadPosition(),d=Vj(a,i,l);d&&(this.log(`Syncing with main frag at ${d.start} cc ${d.cc}`),this.startFragRequested=!1,this.nextLoadPosition=d.start,this.resetLoadingState(),this.state===be.IDLE&&this.doTickIdle())}startLoad(e,r){if(!this.levels){this.startPosition=e,this.state=be.STOPPED;return}const n=this.lastCurrentTime;this.stopLoad(),this.setInterval(TN),n>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n,this.state=be.IDLE):this.state=be.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=r?-1:e,this.tick()}doTick(){switch(this.state){case be.IDLE:this.doTickIdle();break;case be.WAITING_TRACK:{const{levels:e,trackId:r}=this,n=e==null?void 0:e[r],s=n==null?void 0:n.details;if(s&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(s))break;this.state=be.WAITING_INIT_PTS}break}case be.FRAG_LOADING_WAITING_RETRY:{this.checkRetryDate();break}case be.WAITING_INIT_PTS:{const e=this.waitingData;if(e){const{frag:r,part:n,cache:s,complete:i}=e,a=this.mainAnchor;if(this.initPTS[r.cc]!==void 0){this.waitingData=null,this.state=be.FRAG_LOADING;const l=s.flush().buffer,d={frag:r,part:n,payload:l,networkDetails:null};this._handleFragmentLoadProgress(d),i&&super._handleFragmentLoadComplete(d)}else a&&a.cc!==e.frag.cc&&this.syncWithAnchor(a,e.frag)}else this.state=be.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:r,levels:n,media:s,trackId:i}=this,a=r.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(n!=null&&n[i]))return;const l=n[i],d=l.details;if(!d||this.waitForLive(l)||this.waitForCdnTuneIn(d)){this.state=be.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,Yt.AUDIO,ze.AUDIO));const f=this.getFwdBufferInfo(u,ze.AUDIO);if(f===null)return;if(!this.switchingTrack&&this._streamEnded(f,d)){r.trigger(M.BUFFER_EOS,{type:"audio"}),this.state=be.ENDED;return}const p=f.len,y=r.maxBufferLength,v=d.fragments,E=v[0].start,b=this.getLoadPosition(),T=this.flushing?b:f.end;if(this.switchingTrack&&s){const A=b;d.PTSKnown&&A<E&&(f.end>E||f.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=E+.05)}if(p>=y&&!this.switchingTrack&&T<v[v.length-1].start)return;let I=this.getNextFragment(T,d);if(I&&this.isLoopLoading(I,T)&&(I=this.getNextFragmentLoopLoading(I,d,f,ze.MAIN,y)),!I){this.bufferFlushed=!0;return}let N=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&N&&Or(I)&&!I.endList&&(!d.live||!this.loadingParts&&T<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(N)===en.OK&&(this.mainFragLoading=N=null),N&&Or(N))){if(I.start>N.end){const L=this.fragmentTracker.getFragAtPos(T,ze.MAIN);L&&L.end>N.end&&(N=L,this.mainFragLoading={frag:L,targetBufferTime:null})}if(I.start>N.end)return}this.loadFragment(I,l,T)}onMediaDetaching(e,r){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,r)}onAudioTracksUpdated(e,{audioTracks:r}){this.resetTransmuxer(),this.levels=r.map(n=>new Gh(n))}onAudioTrackSwitching(e,r){const n=!!r.url;this.trackId=r.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),n?(this.switchingTrack=r,this.flushAudioIfNeeded(r),this.state!==be.STOPPED&&(this.setInterval(TN),this.state=be.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=r,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,r){this.mainDetails=r.details;const n=this.cachedTrackLoadedData;n&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(M.AUDIO_TRACK_LOADED,n))}onAudioTrackLoaded(e,r){var n;const{levels:s}=this,{details:i,id:a,groupId:l,track:d}=r;if(!s){this.warn(`Audio tracks reset while loading track ${a} "${d.name}" of "${l}"`);return}const u=this.mainDetails;if(!u||i.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=r,this.state!==be.STOPPED&&(this.state=be.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${d.name}" of "${l}" loaded [${i.startSN},${i.endSN}]${i.lastPartSn?`[part-${i.lastPartSn}-${i.lastPartIndex}]`:""},duration:${i.totalduration}`);const f=s[a];let p=0;if(i.live||(n=f.details)!=null&&n.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;if(f.details){var y;p=this.alignPlaylists(i,f.details,(y=this.levelLastLoaded)==null?void 0:y.details)}i.alignedSliding||(aM(i,u),i.alignedSliding||wp(i,u),p=i.fragmentStart)}f.details=i,this.levelLastLoaded=f,this.startFragRequested||this.setStartPosition(u,p),this.hls.trigger(M.AUDIO_TRACK_UPDATED,{details:i,id:a,groupId:r.groupId}),this.state===be.WAITING_TRACK&&!this.waitForCdnTuneIn(i)&&(this.state=be.IDLE),this.tick()}_handleFragmentLoadProgress(e){var r;const n=e.frag,{part:s,payload:i}=e,{config:a,trackId:l,levels:d}=this;if(!d){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const u=d[l];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const f=u.details;if(!f){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(n.start);return}const p=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let y=this.transmuxer;y||(y=this.transmuxer=new AM(this.hls,ze.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const v=this.initPTS[n.cc],E=(r=n.initSegment)==null?void 0:r.data;if(v!==void 0){const T=s?s.index:-1,I=T!==-1,N=new KE(n.level,n.sn,n.stats.chunkCount,i.byteLength,T,I);y.push(i,E,p,"",n,s,f.totalduration,!1,N,v)}else{this.log(`Unknown video PTS for cc ${n.cc}, waiting for video PTS before demuxing audio frag ${n.sn} of [${f.startSN} ,${f.endSN}],track ${l}`);const{cache:b}=this.waitingData=this.waitingData||{frag:n,part:s,cache:new oM,complete:!1};b.push(new Uint8Array(i)),this.state!==be.STOPPED&&(this.state=be.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,r){this.bufferFlushed=this.flushing=!1;const n=r.tracks.audio;n&&(this.mediaBuffer=n.buffer||null)}onFragLoading(e,r){!this.audioOnly&&r.frag.type===ze.MAIN&&Or(r.frag)&&(this.mainFragLoading=r,this.state===be.IDLE&&this.tick())}onFragBuffered(e,r){const{frag:n,part:s}=r;if(n.type!==ze.AUDIO){!this.audioOnly&&n.type===ze.MAIN&&!n.elementaryStreams.video&&!n.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${s?" p: "+s.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Or(n)){this.fragPrevious=n;const i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger(M.AUDIO_TRACK_SWITCHED,$t({},i)))}this.fragBufferedComplete(n,s),this.media&&this.tick()}onError(e,r){var n;if(r.fatal){this.state=be.ERROR;return}switch(r.details){case ue.FRAG_GAP:case ue.FRAG_PARSING_ERROR:case ue.FRAG_DECRYPT_ERROR:case ue.FRAG_LOAD_ERROR:case ue.FRAG_LOAD_TIMEOUT:case ue.KEY_LOAD_ERROR:case ue.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ze.AUDIO,r);break;case ue.AUDIO_TRACK_LOAD_ERROR:case ue.AUDIO_TRACK_LOAD_TIMEOUT:case ue.LEVEL_PARSING_ERROR:!r.levelRetry&&this.state===be.WAITING_TRACK&&((n=r.context)==null?void 0:n.type)===Ct.AUDIO_TRACK&&(this.state=be.IDLE);break;case ue.BUFFER_ADD_CODEC_ERROR:case ue.BUFFER_APPEND_ERROR:if(r.parent!=="audio")return;this.reduceLengthAndFlushBuffer(r)||this.resetLoadingState();break;case ue.BUFFER_FULL_ERROR:if(r.parent!=="audio")return;this.reduceLengthAndFlushBuffer(r)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case ue.INTERNAL_EXCEPTION:this.recoverWorkerError(r);break}}onBufferFlushing(e,{type:r}){r!==Yt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:r}){if(r!==Yt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===be.ENDED&&(this.state=be.IDLE);const n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,r,ze.AUDIO),this.tick())}}_handleTransmuxComplete(e){var r;const n="audio",{hls:s}=this,{remuxResult:i,chunkMeta:a}=e,l=this.getCurrentContext(a);if(!l){this.resetWhenMissingContext(a);return}const{frag:d,part:u,level:f}=l,{details:p}=f,{audio:y,text:v,id3:E,initSegment:b}=i;if(this.fragContextChanged(d)||!p){this.fragmentTracker.removeFragment(d);return}if(this.state=be.PARSING,this.switchingTrack&&y&&this.completeAudioSwitch(this.switchingTrack),b!=null&&b.tracks){const T=d.initSegment||d;if(this.unhandledEncryptionError(b,d))return;this._bufferInitSegment(f,b.tracks,T,a),s.trigger(M.FRAG_PARSING_INIT_SEGMENT,{frag:T,id:n,tracks:b.tracks})}if(y){const{startPTS:T,endPTS:I,startDTS:N,endDTS:A}=y;u&&(u.elementaryStreams[Yt.AUDIO]={startPTS:T,endPTS:I,startDTS:N,endDTS:A}),d.setElementaryStreamInfo(Yt.AUDIO,T,I,N,A),this.bufferFragmentData(y,d,u,a)}if(E!=null&&(r=E.samples)!=null&&r.length){const T=zt({id:n,frag:d,details:p},E);s.trigger(M.FRAG_PARSING_METADATA,T)}if(v){const T=zt({id:n,frag:d,details:p},v);s.trigger(M.FRAG_PARSING_USERDATA,T)}}_bufferInitSegment(e,r,n,s){if(this.state!==be.PARSING||(r.video&&delete r.video,r.audiovideo&&delete r.audiovideo,!r.audio))return;const i=r.audio;i.id=ze.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${i.container}, codecs[level/parsed]=[${a}/${i.codec}]`),a&&a.split(",").length===1&&(i.levelCodec=a),this.hls.trigger(M.BUFFER_CODECS,r);const l=i.initSegment;if(l!=null&&l.byteLength){const d={type:"audio",frag:n,part:null,chunkMeta:s,parent:n.type,data:l};this.hls.trigger(M.BUFFER_APPENDING,d)}this.tickImmediate()}loadFragment(e,r,n){const s=this.fragmentTracker.getState(e);if(this.switchingTrack||s===en.NOT_LOADED||s===en.PARTIAL){var i;if(!Or(e))this._loadInitSegment(e,r);else if((i=r.details)!=null&&i.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=be.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==r.details.fragmentStart&&wp(r.details,a)}else super.loadFragment(e,r,n)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:r,lang:n,assocLang:s,characteristics:i,audioCodec:a,channels:l}=this.bufferedTrack;Dl({name:r,lang:n,assocLang:s,characteristics:i,audioCodec:a,channels:l},e,dl)||(pp(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:r}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,r.trigger(M.AUDIO_TRACK_SWITCHED,$t({},e))}}class s2 extends ii{constructor(e,r){super(r,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,r,n){const s=r==null?void 0:r.renditionReports;if(s){let i=-1;for(let a=0;a<s.length;a++){const l=s[a];let d;try{d=new self.URL(l.URI,r.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),d=l.URI||""}if(d===e){i=a;break}else d===e.substring(0,d.length)&&(i=a)}if(i!==-1){const a=s[i],l=parseInt(a["LAST-MSN"])||r.lastPartSn;let d=parseInt(a["LAST-PART"])||r.lastPartIndex;if(this.hls.config.lowLatencyMode){const f=Math.min(r.age-r.partTarget,r.targetduration);d>=0&&f>r.partTarget&&(d+=1)}const u=n&&BA(n);return new UA(l,d>=0?d:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,r){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,r){if(r)try{return r.addDirectives(e)}catch(n){this.warn(`Could not construct new URL with HLS Delivery Directives: ${n}`)}return e}playlistLoaded(e,r,n){const{details:s,stats:i}=r,a=self.performance.now(),l=i.loading.first?Math.max(0,a-i.loading.first):0;s.advancedDateTime=Date.now()-l;const d=this.hls.config.timelineOffset;if(d!==s.appliedTimelineOffset){const f=Math.max(d||0,0);s.appliedTimelineOffset=f,s.fragments.forEach(p=>{p.setStart(p.playlistOffset+f)})}if(s.live||n!=null&&n.live){const f="levelInfo"in r?r.levelInfo:r.track;if(s.reloaded(n),n&&s.fragments.length>0){Zee(n,s,this);const N=s.playlistParsingError;if(N){this.warn(N);const A=this.hls;if(!A.config.ignorePlaylistParsingErrors){var u;const{networkDetails:L}=r;A.trigger(M.ERROR,{type:Qe.NETWORK_ERROR,details:ue.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:N,reason:N.message,level:r.level||void 0,parent:(u=s.fragments[0])==null?void 0:u.type,networkDetails:L,stats:i});return}s.playlistParsingError=null}}s.requestScheduled===-1&&(s.requestScheduled=i.loading.start);const p=this.hls.mainForwardBufferInfo,y=p?p.end-p.len:0,v=(s.edge-y)*1e3,E=tM(s,v);if(s.requestScheduled+E<a?s.requestScheduled=a:s.requestScheduled+=E,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let b,T,I;if(s.canBlockReload&&s.endSN&&s.advanced){const N=this.hls.config.lowLatencyMode,A=s.lastPartSn,L=s.endSN,P=s.lastPartIndex,k=P!==-1,D=A===L;k?D?(T=L+1,I=N?0:P):(T=A,I=N?P+1:s.maxPartIndex):T=L+1;const O=s.age,F=O+s.ageHeader;let $=Math.min(F-s.partTarget,s.targetduration*1.5);if($>0){if(F>s.targetduration*3)this.log(`Playlist last advanced ${O.toFixed(2)}s ago. Omitting segment and part directives.`),T=void 0,I=void 0;else if(n!=null&&n.tuneInGoal&&F-s.partTarget>n.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${n.tuneInGoal} to: ${$} with playlist age: ${s.age}`),$=0;else{const G=Math.floor($/s.targetduration);if(T+=G,I!==void 0){const Y=Math.round($%s.targetduration/s.partTarget);I+=Y}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${O.toFixed(2)}s goal: ${$} skip sn ${G} to part ${I}`)}s.tuneInGoal=$}if(b=this.getDeliveryDirectives(s,r.deliveryDirectives,T,I),N||!D){s.requestScheduled=a,this.loadingPlaylist(f,b);return}}else(s.canBlockReload||s.canSkipUntil)&&(b=this.getDeliveryDirectives(s,r.deliveryDirectives,T,I));b&&T!==void 0&&s.canBlockReload&&(s.requestScheduled=i.loading.first+Math.max(E-l*2,E/2)),this.scheduleLoading(f,b,s)}else this.clearTimer()}scheduleLoading(e,r,n){const s=n||e.details;if(!s){this.loadingPlaylist(e,r);return}const i=self.performance.now(),a=s.requestScheduled;if(i>=a){this.loadingPlaylist(e,r);return}const l=a-i;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,r),l)}getDeliveryDirectives(e,r,n,s){let i=BA(e);return r!=null&&r.skip&&e.deltaUpdateFailed&&(n=r.msn,s=r.part,i=i0.No),new UA(n,s,i)}checkRetry(e){const r=e.details,n=gp(e),s=e.errorAction,{action:i,retryCount:a=0,retryConfig:l}=s||{},d=!!s&&!!l&&(i===vn.RetryRequest||!s.resolved&&i===vn.SendAlternateToPenaltyBox);if(d){var u;if(a>=l.maxNumRetry)return!1;if(n&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${l.maxNumRetry} after "${r}" without delivery-directives`),this.loadPlaylist();else{const f=zE(l,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),f),this.warn(`Retrying playlist loading ${a+1}/${l.maxNumRetry} after "${r}" in ${f}ms`)}e.levelRetry=!0,s.resolved=!0}return d}}function NM(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Kh(t[r].attrs,e[r].attrs))return!1;return!0}function Kh(t,e,r){const n=t["STABLE-RENDITION-ID"];return n&&!r?n===e["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(s=>t[s]!==e[s])}function Hv(t,e){return e.label.toLowerCase()===t.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(t.lang||"").toLowerCase())}class ore extends s2{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVEL_LOADING,this.onLevelLoading,this),e.off(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(M.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(M.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,r){this.tracks=r.audioTracks||[]}onAudioTrackLoaded(e,r){const{id:n,groupId:s,details:i}=r,a=this.tracksInGroup[n];if(!a||a.groupId!==s){this.warn(`Audio track with id:${n} and group:${s} not found in active group ${a==null?void 0:a.groupId}`);return}const l=a.details;a.details=r.details,this.log(`Audio track ${n} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,r,l)}onLevelLoading(e,r){this.switchLevel(r.level)}onLevelSwitching(e,r){this.switchLevel(r.level)}switchLevel(e){const r=this.hls.levels[e];if(!r)return;const n=r.audioGroups||null,s=this.groupIds;let i=this.currentTrack;if(!n||(s==null?void 0:s.length)!==(n==null?void 0:n.length)||n!=null&&n.some(l=>(s==null?void 0:s.indexOf(l))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const l=this.tracks.filter(y=>!n||n.indexOf(y.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(y=>y.default)&&(this.selectDefaultTrack=!1),l.forEach((y,v)=>{y.id=v});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=l;const d=this.hls.config.audioPreference;if(!i&&d){const y=Qi(d,l,dl);if(y>-1)i=l[y];else{const v=Qi(d,this.tracks);i=this.tracks[v]}}let u=this.findTrackId(i);u===-1&&i&&(u=this.findTrackId(null));const f={audioTracks:l};this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${n==null?void 0:n.join(",")}`),this.hls.trigger(M.AUDIO_TRACKS_UPDATED,f);const p=this.trackId;if(u!==-1&&p===-1)this.setAudioTrack(u);else if(l.length&&p===-1){var a;const y=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${l.length}`);this.warn(y.message),this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:y})}}}onError(e,r){r.fatal||!r.context||r.context.type===Ct.AUDIO_TRACK&&r.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(r.context.groupId)!==-1)&&this.checkRetry(r)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const r=this.hls;if(r.config.audioPreference=e,e){const n=this.allAudioTracks;if(this.selectDefaultTrack=!1,n.length){const s=this.currentTrack;if(s&&Dl(e,s,dl))return s;const i=Qi(e,this.tracksInGroup,dl);if(i>-1){const a=this.tracksInGroup[i];return this.setAudioTrack(i),a}else if(s){let a=r.loadLevel;a===-1&&(a=r.firstAutoLevel);const l=vee(e,r.levels,n,a,dl);if(l===-1)return null;r.nextLoadLevel=l}if(e.channels||e.audioCodec){const a=Qi(e,n);if(a>-1)return n[a]}}}return null}setAudioTrack(e){const r=this.tracksInGroup;if(e<0||e>=r.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,s=r[e],i=s.details&&!s.details.live;if(e===this.trackId&&s===n&&i||(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(M.AUDIO_TRACK_SWITCHING,$t({},s)),i))return;const a=this.switchParams(s.url,n==null?void 0:n.details,s.details);this.loadPlaylist(a)}findTrackId(e){const r=this.tracksInGroup;for(let n=0;n<r.length;n++){const s=r[n];if(!(this.selectDefaultTrack&&!s.default)&&(!e||Dl(e,s,dl)))return n}if(e){const{name:n,lang:s,assocLang:i,characteristics:a,audioCodec:l,channels:d}=e;for(let u=0;u<r.length;u++){const f=r[u];if(Dl({name:n,lang:s,assocLang:i,characteristics:a,audioCodec:l,channels:d},f,dl))return u}for(let u=0;u<r.length;u++){const f=r[u];if(Kh(e.attrs,f.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<r.length;u++){const f=r[u];if(Kh(e.attrs,f.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const r=this.currentTrack;this.shouldLoadPlaylist(r)&&pp(r.url,this.hls)&&this.scheduleLoading(r,e)}loadingPlaylist(e,r){super.loadingPlaylist(e,r);const n=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,r),a=e.details,l=a==null?void 0:a.age;this.log(`Loading audio-track ${n} "${e.name}" lang:${e.lang} group:${s}${(r==null?void 0:r.msn)!==void 0?" at sn "+r.msn+" part "+r.part:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(M.AUDIO_TRACK_LOADING,{url:i,id:n,groupId:s,deliveryDirectives:r||null,track:e})}}class lre{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,r,n){if(this.queues===null||this.tracks===null)return;const s=this.queues[r];s.push(e),s.length===1&&!n&&this.executeNext(r)}appendBlocker(e){return new Promise(r=>{const n={label:"async-blocker",execute:r,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(n,e)})}prependBlocker(e){return new Promise(r=>{if(this.queues){const n={label:"async-blocker-prepend",execute:r,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(n)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var r;const n=(r=e[0])==null?void 0:r.label;(n==="async-blocker"||n==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const r=this.queues[e];if(r.length){const s=r[0];try{s.execute()}catch(i){var n;if(s.onError(i),this.queues===null||this.tracks===null)return;const a=(n=this.tracks[e])==null?void 0:n.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var r;return((r=this.queues)==null?void 0:r[e][0])||null}toString(){const{queues:e,tracks:r}=this;return e===null||r===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var r,n;return(r=this.queues)!=null&&r[e]||(n=this.tracks)!=null&&n[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var r;const n=(r=this.tracks)==null?void 0:r[e],s=n==null?void 0:n.buffer;return s?`SourceBuffer${s.updating?" updating":""}${n.ended?" ended":""}${n.ending?" ending":""}`:"none"}listOps(e){var r;return((r=this.queues)==null?void 0:r[e].map(n=>n.label).join(", "))||""}}const CN=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,IM="HlsJsTrackRemovedError";class cre extends Error{constructor(e){super(e),this.name=IM}}class ure extends ii{constructor(e,r){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=n=>{var s;this.hls&&((s=this.mediaSource)==null?void 0:s.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=n=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=n=>{const{media:s,mediaSource:i}=this;n&&this.log("Media source opened"),!(!s||!i)&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(M.MEDIA_ATTACHED,{media:s,mediaSource:i}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:n,_objectUrl:s}=this;n!==s&&this.error(`Media element src was set while attaching MediaSource (${s} > ${n})`)},this.hls=e,this.fragmentTracker=r,this.appendSource=PJ(Bo(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.BUFFER_RESET,this.onBufferReset,this),e.on(M.BUFFER_APPENDING,this.onBufferAppending,this),e.on(M.BUFFER_CODECS,this.onBufferCodecs,this),e.on(M.BUFFER_EOS,this.onBufferEos,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.FRAG_PARSED,this.onFragParsed,this),e.on(M.FRAG_CHANGED,this.onFragChanged,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.BUFFER_RESET,this.onBufferReset,this),e.off(M.BUFFER_APPENDING,this.onBufferAppending,this),e.off(M.BUFFER_CODECS,this.onBufferCodecs,this),e.off(M.BUFFER_EOS,this.onBufferEos,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.FRAG_PARSED,this.onFragParsed,this),e.off(M.FRAG_CHANGED,this.onFragChanged,this),e.off(M.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:r}=this;if(!e)return null;const n={};if(this.operationQueue){const i=this.isUpdating();i||this.operationQueue.removeBlockers();const a=this.isQueued();(i||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${i?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===r?zt(n,s.tracks):this.sourceBuffers.forEach(i=>{const[a]=i;a&&(n[a]=zt({},this.tracks[a]),this.removeBuffer(a)),i[0]=i[1]=null}),{media:e,mediaSource:r,tracks:n}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,r){var n;let s=2;(r.audio&&!r.video||!r.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),(n=this.transferData)!=null&&n.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,r){const n=this.media=r.media;this.transferData=this.overrides=void 0;const s=Bo(this.appendSource);if(s){const i=!!r.mediaSource;(i||r.overrides)&&(this.transferData=r,this.overrides=r.overrides);const a=this.mediaSource=r.mediaSource||new s;if(this.assignMediaSource(a),i)this._objectUrl=n.src,this.attachTransferred();else{const l=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{n.removeAttribute("src");const d=self.ManagedMediaSource;n.disableRemotePlayback=n.disableRemotePlayback||d&&a instanceof d,AN(n),dre(n,l),n.load()}catch{n.src=l}else n.src=l}n.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var r,n;this.log(`${((r=this.transferData)==null?void 0:r.mediaSource)===e?"transferred":"created"} media source: ${(n=e.constructor)==null?void 0:n.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,r=this.transferData;if(!r||!e)return;const n=this.tracks,s=r.tracks,i=s?Object.keys(s):null,a=i?i.length:0,l=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(s&&i&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${qt(n,(d,u)=>d==="initSegment"?void 0:u)};
transfer tracks: ${qt(s,(d,u)=>d==="initSegment"?void 0:u)}}`),!Tj(s,n)){r.mediaSource=null,r.tracks=void 0;const d=e.currentTime,u=this.details,f=Math.max(d,(u==null?void 0:u.fragments[0].start)||0);if(f-d>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${d} -> ${f}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(n)}") start time: ${f} currentTime: ${d}`),this.onMediaDetaching(M.MEDIA_DETACHING,{}),this.onMediaAttaching(M.MEDIA_ATTACHING,r),e.currentTime=f;return}this.transferData=void 0,i.forEach(d=>{const u=d,f=s[u];if(f){const p=f.buffer;if(p){const y=this.fragmentTracker,v=f.id;if(y.hasFragments(v)||y.hasParts(v)){const T=ht.getBuffered(p);y.detectEvictedFragments(u,T,v,null,!0)}const E=C1(u),b=[u,p];this.sourceBuffers[E]=b,p.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,f)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;const r=(e=this.mediaSource)==null?void 0:e.readyState;return r==="open"||r==="ended"}onMediaDetaching(e,r){const n=!!r.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:i,_objectUrl:a}=this;if(i){if(this.log(`media source ${n?"transferring":"detaching"}`),n)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const l=i.readyState==="open";try{const d=i.sourceBuffers;for(let u=d.length;u--;)l&&d[u].abort(),i.removeSourceBuffer(d[u]);l&&i.endOfStream()}catch(d){this.warn(`onMediaDetaching: ${d.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(i.removeEventListener("startstreaming",this._onStartStreaming),i.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),n||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(s.removeAttribute("src"),this.appendSource&&AN(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(M.MEDIA_DETACHED,r)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var r;const n=(r=this.tracks[e])==null?void 0:r.buffer;if(this.removeBuffer(e),n)try{var s;(s=this.mediaSource)!=null&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(n)}catch(i){this.warn(`onBufferReset ${e}`,i)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[C1(e)]=[null,null];const r=this.tracks[e];r&&(r.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new lre(this.tracks)}onBufferCodecs(e,r){var n;const s=this.tracks,i=Object.keys(r);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in r&&(s.audio||s.video)||s.audiovideo&&("audio"in r||"video"in r),l=!a&&this.sourceBufferCount&&this.media&&i.some(d=>!s[d]);if(a||l){this.warn(`Unsupported transition between "${Object.keys(s)}" and "${i}" SourceBuffers`);return}i.forEach(d=>{var u,f;const p=r[d],{id:y,codec:v,levelCodec:E,container:b,metadata:T,supplemental:I}=p;let N=s[d];const A=(u=this.transferData)==null||(u=u.tracks)==null?void 0:u[d],L=A!=null&&A.buffer?A:N,P=(L==null?void 0:L.pendingCodec)||(L==null?void 0:L.codec),k=L==null?void 0:L.levelCodec;N||(N=s[d]={buffer:void 0,listeners:[],codec:v,supplemental:I,container:b,levelCodec:E,metadata:T,id:y});const D=s0(P,k),O=D==null?void 0:D.replace(CN,"$1");let F=s0(v,E);const $=(f=F)==null?void 0:f.replace(CN,"$1");F&&D&&O!==$&&(d.slice(0,5)==="audio"&&(F=fp(F,this.appendSource)),this.log(`switching codec ${P} to ${F}`),F!==(N.pendingCodec||N.codec)&&(N.pendingCodec=F),N.container=b,this.appendChangeType(d,b,F))}),(this.tracksReady||this.sourceBufferCount)&&(r.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!r.video&&((n=r.audio)==null?void 0:n.id)==="main"&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,r)=>{const n=this.tracks[r];return e[r]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},e},{})}appendChangeType(e,r,n){const s=`${r};codecs=${n}`,i={label:`change-type=${s}`,execute:()=>{const a=this.tracks[e];if(a){const l=a.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),l.changeType(s),a.codec=n,a.container=r)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(i,e,this.isPending(this.tracks[e]))}blockAudio(e){var r;const n=e.start,s=n+e.duration*.05;if(((r=this.fragmentTracker.getAppendedFrag(n,ze.MAIN))==null?void 0:r.gap)===!0)return;const a={label:"block-audio",execute:()=>{var l;const d=this.tracks.video;(this.lastVideoAppendEnd>s||d!=null&&d.buffer&&ht.isBuffered(d.buffer,s)||((l=this.fragmentTracker.getAppendedFrag(s,ze.MAIN))==null?void 0:l.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:l=>{this.warn("Error executing block-audio operation",l)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:r}=this;e&&r&&(this.blockedAudioAppend=null,r.unblockAudio(e.op))}onBufferAppending(e,r){const{tracks:n}=this,{data:s,type:i,parent:a,frag:l,part:d,chunkMeta:u,offset:f}=r,p=u.buffering[i],{sn:y,cc:v}=l,E=self.performance.now();p.start=E;const b=l.stats.buffering,T=d?d.stats.buffering:null;b.start===0&&(b.start=E),T&&T.start===0&&(T.start=E);const I=n.audio;let N=!1;i==="audio"&&(I==null?void 0:I.container)==="audio/mpeg"&&(N=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const A=n.video,L=A==null?void 0:A.buffer;if(L&&y!=="initSegment"){const D=d||l,O=this.blockedAudioAppend;if(i==="audio"&&a!=="main"&&!this.blockedAudioAppend&&!(A.ending||A.ended)){const $=D.start+D.duration*.05,G=L.buffered,Y=this.currentOp("video");!G.length&&!Y?this.blockAudio(D):!Y&&!ht.isBuffered(L,$)&&this.lastVideoAppendEnd<$&&this.blockAudio(D)}else if(i==="video"){const F=D.end;if(O){const $=O.frag.start;(F>$||F<this.lastVideoAppendEnd||ht.isBuffered(L,$))&&this.unblockAudio()}this.lastVideoAppendEnd=F}}const P=(d||l).start,k={label:`append-${i}`,execute:()=>{var D;p.executeStart=self.performance.now();const O=(D=this.tracks[i])==null?void 0:D.buffer;O&&(N?this.updateTimestampOffset(O,P,.1,i,y,v):f!==void 0&&Ve(f)&&this.updateTimestampOffset(O,f,1e-6,i,y,v)),this.appendExecutor(s,i)},onStart:()=>{},onComplete:()=>{const D=self.performance.now();p.executeEnd=p.end=D,b.first===0&&(b.first=D),T&&T.first===0&&(T.first=D);const O={};this.sourceBuffers.forEach(([F,$])=>{F&&(O[F]=ht.getBuffered($))}),this.appendErrors[i]=0,i==="audio"||i==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(M.BUFFER_APPENDED,{type:i,frag:l,part:d,chunkMeta:u,parent:l.type,timeRanges:O})},onError:D=>{var O;const F={type:Qe.MEDIA_ERROR,parent:l.type,details:ue.BUFFER_APPEND_ERROR,sourceBufferName:i,frag:l,part:d,chunkMeta:u,error:D,err:D,fatal:!1},$=(O=this.media)==null?void 0:O.error;if(D.code===DOMException.QUOTA_EXCEEDED_ERR||D.name=="QuotaExceededError"||"quota"in D)F.details=ue.BUFFER_FULL_ERROR;else if(D.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!$)F.errorAction=lu(!0);else if(D.name===IM&&this.sourceBufferCount===0)F.errorAction=lu(!0);else{const G=++this.appendErrors[i];this.warn(`Failed ${G}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${i}" sourceBuffer (${$||"no media error"})`),(G>=this.hls.config.appendErrorMaxRetry||$)&&(F.fatal=!0)}this.hls.trigger(M.ERROR,F)}};this.log(`queuing "${i}" append sn: ${y}${d?" p: "+d.index:""} of ${l.type===ze.MAIN?"level":"track"} ${l.level} cc: ${v}`),this.append(k,i,this.isPending(this.tracks[i]))}getFlushOp(e,r,n){return this.log(`queuing "${e}" remove ${r}-${n}`),{label:"remove",execute:()=>{this.removeExecutor(e,r,n)},onStart:()=>{},onComplete:()=>{this.hls.trigger(M.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${r}-${n} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,r){const{type:n,startOffset:s,endOffset:i}=r;n?this.append(this.getFlushOp(n,s,i),n):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,s,i),a)})}onFragParsed(e,r){const{frag:n,part:s}=r,i=[],a=s?s.elementaryStreams:n.elementaryStreams;a[Yt.AUDIOVIDEO]?i.push("audiovideo"):(a[Yt.AUDIO]&&i.push("audio"),a[Yt.VIDEO]&&i.push("video"));const l=()=>{const d=self.performance.now();n.stats.buffering.end=d,s&&(s.stats.buffering.end=d);const u=s?s.stats:n.stats;this.hls.trigger(M.FRAG_BUFFERED,{frag:n,part:s,stats:u,id:n.type})};i.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${n.type} level: ${n.level} sn: ${n.sn}`),this.blockBuffers(l,i).catch(d=>{this.warn(`Fragment buffered callback ${d}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,r){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){const r=this.tracks[e];if(r)return!r.ended||r.ending}return!1})}onBufferEos(e,r){var n;this.sourceBuffers.forEach(([a])=>{if(a){const l=this.tracks[a];(!r.type||r.type===a)&&(l.ending=!0,l.ended||(l.ended=!0,this.log(`${a} buffer reached EOS`)))}});const s=((n=this.overrides)==null?void 0:n.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var l;return a&&!((l=this.tracks[a])!=null&&l.ended)})?s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(M.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(M.BUFFERED_TO_END,void 0)):r.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const r=this.tracks[e];r&&(r.ending=!1)}})}onLevelUpdated(e,{details:r}){r.fragments.length&&(this.details=r,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{const e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,r){if(r.details===ue.BUFFER_APPEND_ERROR&&r.frag){var n;const s=(n=r.errorAction)==null?void 0:n.nextAutoLevel;Ve(s)&&s!==r.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:r,media:n}=this;if(!n||r===null||!this.sourceBufferCount)return;const s=e.config,i=n.currentTime,a=r.levelTargetDuration,l=r.live&&s.liveBackBufferLength!==null?s.liveBackBufferLength:s.backBufferLength;if(Ve(l)&&l>=0){const u=Math.max(l,a),f=Math.floor(i/a)*a-u;this.flushBackBuffer(i,a,f)}const d=s.frontBufferFlushThreshold;if(Ve(d)&&d>0){const u=Math.max(s.maxBufferLength,d),f=Math.max(u,a),p=Math.floor(i/a)*a+f;this.flushFrontBuffer(i,a,p)}}flushBackBuffer(e,r,n){this.sourceBuffers.forEach(([s,i])=>{if(i){const l=ht.getBuffered(i);if(l.length>0&&n>l.start(0)){var a;this.hls.trigger(M.BACK_BUFFER_REACHED,{bufferEnd:n});const d=this.tracks[s];if((a=this.details)!=null&&a.live)this.hls.trigger(M.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n});else if(d!=null&&d.ended){this.log(`Cannot flush ${s} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(M.BUFFER_FLUSHING,{startOffset:0,endOffset:n,type:s})}}})}flushFrontBuffer(e,r,n){this.sourceBuffers.forEach(([s,i])=>{if(i){const a=ht.getBuffered(i),l=a.length;if(l<2)return;const d=a.start(l-1),u=a.end(l-1);if(n>d||e>=d&&e<=u)return;this.hls.trigger(M.BUFFER_FLUSHING,{startOffset:d,endOffset:1/0,type:s})}})}getDurationAndRange(){var e;const{details:r,mediaSource:n}=this;if(!r||!this.media||(n==null?void 0:n.readyState)!=="open")return null;const s=r.edge;if(r.live&&this.hls.config.liveDurationInfinity){if(r.fragments.length&&n.setLiveSeekableRange){const u=Math.max(0,r.fragmentStart),f=Math.max(u,s);return{duration:1/0,start:u,end:f}}return{duration:1/0}}const i=(e=this.overrides)==null?void 0:e.duration;if(i)return Ve(i)?{duration:i}:null;const a=this.media.duration,l=Ve(n.duration)?n.duration:0;return s>l&&s>a||!Ve(a)?{duration:s}:null}updateMediaSource({duration:e,start:r,end:n}){const s=this.mediaSource;!this.media||!s||s.readyState!=="open"||(s.duration!==e&&(Ve(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),r!==void 0&&n!==void 0&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${r}-${n}.`),s.setLiveSeekableRange(r,n)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:r,tracks:n}=this;if(this.log(`checkPendingTracks (pending: ${r} codec events expected: ${e}) ${qt(n)}`),this.tracksReady){var s;const i=(s=this.transferData)==null?void 0:s.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([r,n])=>{if(r){const s=this.tracks[r];e[r]={buffer:n,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(M.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([r])=>{this.executeNext(r)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:r,mediaSource:n}=this;if(!n)throw new Error("createSourceBuffers called when mediaSource was null");for(const i in e){const a=i,l=e[a];if(this.isPending(l)){const d=this.getTrackCodec(l,a),u=`${l.container};codecs=${d}`;l.codec=d,this.log(`creating sourceBuffer(${u})${this.currentOp(a)?" Queued":""} ${qt(l)}`);try{const f=n.addSourceBuffer(u),p=C1(a),y=[a,f];r[p]=y,l.buffer=f}catch(f){var s;this.error(`error while trying to add sourceBuffer: ${f.message}`),this.shiftAndExecuteNext(a),(s=this.operationQueue)==null||s.removeBlockers(),delete this.tracks[a],this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:f,sourceBufferName:a,mimeType:u,parent:l.id});return}this.trackSourceBuffer(a,l)}}this.bufferCreated()}getTrackCodec(e,r){const n=e.supplemental;let s=e.codec;n&&(r==="video"||r==="audiovideo")&&$h(n,"video")&&(s=eee(s,n));const i=s0(s,e.levelCodec);return i?r.slice(0,5)==="audio"?fp(i,this.appendSource):i:""}trackSourceBuffer(e,r){const n=r.buffer;if(!n)return;const s=this.getTrackCodec(r,e);this.tracks[e]={buffer:n,codec:s,container:r.container,levelCodec:r.levelCodec,supplemental:r.supplemental,metadata:r.metadata,id:r.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(i,a)=>{const l=a.removedRanges;l!=null&&l.length&&this.hls.trigger(M.BUFFER_FLUSHED,{type:i})})}get mediaSrc(){var e,r;const n=((e=this.media)==null||(r=e.querySelector)==null?void 0:r.call(e,"source"))||this.media;return n==null?void 0:n.src}onSBUpdateStart(e){const r=this.currentOp(e);r&&r.onStart()}onSBUpdateEnd(e){var r;if(((r=this.mediaSource)==null?void 0:r.readyState)==="closed"){this.resetBuffer(e);return}const n=this.currentOp(e);n&&(n.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,r){var n;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(n=this.mediaSource)==null?void 0:n.readyState}`);this.error(`${s}`,r),this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const i=this.currentOp(e);i&&i.onError(s)}updateTimestampOffset(e,r,n,s,i,a){const l=r-e.timestampOffset;Math.abs(l)>=n&&(this.log(`Updating ${s} SourceBuffer timestampOffset to ${r} (sn: ${i} cc: ${a})`),e.timestampOffset=r)}removeExecutor(e,r,n){const{media:s,mediaSource:i}=this,a=this.tracks[e],l=a==null?void 0:a.buffer;if(!s||!i||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const d=Ve(s.duration)?s.duration:1/0,u=Ve(i.duration)?i.duration:1/0,f=Math.max(0,r),p=Math.min(n,d,u);p>f&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${f},${p}] from the ${e} SourceBuffer`),l.remove(f,p)):this.shiftAndExecuteNext(e)}appendExecutor(e,r){const n=this.tracks[r],s=n==null?void 0:n.buffer;if(!s)throw new cre(`Attempting to append to the ${r} SourceBuffer, but it does not exist`);n.ending=!1,n.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(r=>{this.warn(`SourceBuffer blocked callback ${r}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(r){this.warn(`Callback run without blocking ${this.operationQueue} ${r}`)}}isUpdating(){return this.sourceBuffers.some(([e,r])=>e&&r.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,r=this.sourceBufferTypes){if(!r.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:n}=this,s=r.map(a=>this.appendBlocker(a));return r.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(a=>{n===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(r=>{var n;const s=(n=this.tracks[r])==null?void 0:n.buffer;!s||s.updating||this.shiftAndExecuteNext(r)})}append(e,r,n){this.operationQueue&&this.operationQueue.append(e,r,n)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,r)=>e+(this.isPending(this.tracks[r])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[r])=>e+(r?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,r,n){const s=this.tracks[e];if(!s)return;const i=s.buffer;if(!i)return;const a=n.bind(this,e);s.listeners.push({event:r,listener:a}),i.addEventListener(r,a)}removeBufferListeners(e){const r=this.tracks[e];if(!r)return;const n=r.buffer;n&&(r.listeners.forEach(s=>{n.removeEventListener(s.event,s.listener)}),r.listeners.length=0)}}function AN(t){const e=t.querySelectorAll("source");[].slice.call(e).forEach(r=>{t.removeChild(r)})}function dre(t,e){const r=self.document.createElement("source");r.type="video/mp4",r.src=e,t.appendChild(r)}function C1(t){return t==="audio"?1:0}class i2{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(M.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.BUFFER_CODECS,this.onBufferCodecs,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(M.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.BUFFER_CODECS,this.onBufferCodecs,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,r){const n=this.hls.levels[r.droppedLevel];this.isLevelAllowed(n)&&this.restrictedLevels.push({bitrate:n.bitrate,height:n.height,width:n.width})}onMediaAttaching(e,r){this.media=r.media instanceof HTMLVideoElement?r.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,r){const n=this.hls;this.restrictedLevels=[],this.firstLevel=r.firstLevel,n.config.capLevelToPlayerSize&&r.video&&this.startCapping()}onLevelsUpdated(e,r){this.timer&&Ve(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,r){this.hls.config.capLevelToPlayerSize&&r.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const r=this.hls,n=this.getMaxLevel(e.length-1);n!==this.autoLevelCapping&&r.logger.log(`Setting autoLevelCapping to ${n}: ${e[n].height}p@${e[n].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),r.autoLevelCapping=n,r.autoLevelEnabled&&r.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=r.autoLevelCapping}}}getMaxLevel(e){const r=this.hls.levels;if(!r.length)return-1;const n=r.filter((s,i)=>this.isLevelAllowed(s)&&i<=e);return this.clientRect=null,i2.getMaxLevelByMediaSize(n,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,r={width:0,height:0};if(e){const n=e.getBoundingClientRect();r.width=n.width,r.height=n.height,!r.width&&!r.height&&(r.width=n.right-n.left||e.width||0,r.height=n.bottom-n.top||e.height||0)}return this.clientRect=r,r}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(n=>e.bitrate===n.bitrate&&e.width===n.width&&e.height===n.height)}static getMaxLevelByMediaSize(e,r,n){if(!(e!=null&&e.length))return-1;const s=(l,d)=>d?l.width!==d.width||l.height!==d.height:!0;let i=e.length-1;const a=Math.max(r,n);for(let l=0;l<e.length;l+=1){const d=e[l];if((d.width>=a||d.height>=a)&&s(d,e[l+1])){i=l;break}}return i}}const hre={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},rs=hre,fre={HLS:"h"},mre=fre;class aa{constructor(e,r){Array.isArray(e)&&(e=e.map(n=>n instanceof aa?n:new aa(n))),this.value=e,this.params=r}}const pre="Dict";function gre(t){return Array.isArray(t)?JSON.stringify(t):t instanceof Map?"Map{}":t instanceof Set?"Set{}":typeof t=="object"?JSON.stringify(t):String(t)}function xre(t,e,r,n){return new Error(`failed to ${t} "${gre(e)}" as ${r}`,{cause:n})}function oa(t,e,r){return xre("serialize",t,e,r)}class RM{constructor(e){this.description=e}}const NN="Bare Item",yre="Boolean";function vre(t){if(typeof t!="boolean")throw oa(t,yre);return t?"?1":"?0"}function wre(t){return btoa(String.fromCharCode(...t))}const bre="Byte Sequence";function Ere(t){if(ArrayBuffer.isView(t)===!1)throw oa(t,bre);return`:${wre(t)}:`}const Sre="Integer";function Tre(t){return t<-999999999999999||999999999999999<t}function _M(t){if(Tre(t))throw oa(t,Sre);return t.toString()}function Cre(t){return`@${_M(t.getTime()/1e3)}`}function LM(t,e){if(t<0)return-LM(-t,e);const r=Math.pow(10,e);if(Math.abs(t*r%1-.5)<Number.EPSILON){const s=Math.floor(t*r);return(s%2===0?s:s+1)/r}else return Math.round(t*r)/r}const Are="Decimal";function Nre(t){const e=LM(t,3);if(Math.floor(Math.abs(e)).toString().length>12)throw oa(t,Are);const r=e.toString();return r.includes(".")?r:`${r}.0`}const Ire="String",Rre=/[\x00-\x1f\x7f]+/;function _re(t){if(Rre.test(t))throw oa(t,Ire);return`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function Lre(t){return t.description||t.toString().slice(7,-1)}const Pre="Token";function IN(t){const e=Lre(t);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw oa(e,Pre);return e}function zv(t){switch(typeof t){case"number":if(!Ve(t))throw oa(t,NN);return Number.isInteger(t)?_M(t):Nre(t);case"string":return _re(t);case"symbol":return IN(t);case"boolean":return vre(t);case"object":if(t instanceof Date)return Cre(t);if(t instanceof Uint8Array)return Ere(t);if(t instanceof RM)return IN(t);default:throw oa(t,NN)}}const Dre="Key";function Wv(t){if(/^[a-z*][a-z0-9\-_.*]*$/.test(t)===!1)throw oa(t,Dre);return t}function a2(t){return t==null?"":Object.entries(t).map(([e,r])=>r===!0?`;${Wv(e)}`:`;${Wv(e)}=${zv(r)}`).join("")}function PM(t){return t instanceof aa?`${zv(t.value)}${a2(t.params)}`:zv(t)}function kre(t){return`(${t.value.map(PM).join(" ")})${a2(t.params)}`}function jre(t,e={whitespace:!0}){if(typeof t!="object"||t==null)throw oa(t,pre);const r=t instanceof Map?t.entries():Object.entries(t),n=e!=null&&e.whitespace?" ":"";return Array.from(r).map(([s,i])=>{i instanceof aa||(i=new aa(i));let a=Wv(s);return i.value===!0?a+=a2(i.params):(a+="=",Array.isArray(i.value)?a+=kre(i):a+=PM(i)),a}).join(`,${n}`)}function DM(t,e){return jre(t,e)}const Ui="CMCD-Object",Sr="CMCD-Request",al="CMCD-Session",Qa="CMCD-Status",Mre={br:Ui,ab:Ui,d:Ui,ot:Ui,tb:Ui,tpb:Ui,lb:Ui,tab:Ui,lab:Ui,url:Ui,pb:Sr,bl:Sr,tbl:Sr,dl:Sr,ltc:Sr,mtp:Sr,nor:Sr,nrr:Sr,rc:Sr,sn:Sr,sta:Sr,su:Sr,ttfb:Sr,ttfbb:Sr,ttlb:Sr,cmsdd:Sr,cmsds:Sr,smrt:Sr,df:Sr,cs:Sr,ts:Sr,cid:al,pr:al,sf:al,sid:al,st:al,v:al,msd:al,bs:Qa,bsd:Qa,cdn:Qa,rtp:Qa,bg:Qa,pt:Qa,ec:Qa,e:Qa},Ore={REQUEST:Sr};function Fre(t){return Object.keys(t).reduce((e,r)=>{var n;return(n=t[r])===null||n===void 0||n.forEach(s=>e[s]=r),e},{})}function Bre(t,e){const r={};if(!t)return r;const n=Object.keys(t),s=e?Fre(e):{};return n.reduce((i,a)=>{var l;const d=Mre[a]||s[a]||Ore.REQUEST,u=(l=i[d])!==null&&l!==void 0?l:i[d]={};return u[a]=t[a],i},r)}function Ure(t){return["ot","sf","st","e","sta"].includes(t)}function $re(t){return typeof t=="number"?Ve(t):t!=null&&t!==""&&t!==!1}const kM="event";function Vre(t,e){const r=new URL(t),n=new URL(e);if(r.origin!==n.origin)return t;const s=r.pathname.split("/").slice(1),i=n.pathname.split("/").slice(1,-1);for(;s[0]===i[0];)s.shift(),i.shift();for(;i.length;)i.shift(),s.unshift("..");return s.join("/")+r.search+r.hash}const c0=t=>Math.round(t),Kv=(t,e)=>Array.isArray(t)?t.map(r=>Kv(r,e)):t instanceof aa&&typeof t.value=="string"?new aa(Kv(t.value,e),t.params):(e.baseUrl&&(t=Vre(t,e.baseUrl)),e.version===1?encodeURIComponent(t):t),Tm=t=>c0(t/100)*100,Gre=(t,e)=>{let r=t;return e.version>=2&&(t instanceof aa&&typeof t.value=="string"?r=new aa([t]):typeof t=="string"&&(r=[t])),Kv(r,e)},Hre={br:c0,d:c0,bl:Tm,dl:Tm,mtp:Tm,nor:Gre,rtp:Tm,tb:c0},jM="request",MM="response",o2=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],zre=["e"],Wre=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function kg(t){return Wre.test(t)}function Kre(t){return o2.includes(t)||zre.includes(t)||kg(t)}const OM=["d","dl","nor","ot","rtp","su"];function Yre(t){return o2.includes(t)||OM.includes(t)||kg(t)}const qre=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"];function Xre(t){return o2.includes(t)||OM.includes(t)||qre.includes(t)||kg(t)}const Qre=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Zre(t){return Qre.includes(t)||kg(t)}const Jre={[MM]:Xre,[kM]:Kre,[jM]:Yre};function FM(t,e={}){const r={};if(t==null||typeof t!="object")return r;const n=e.version||t.v||1,s=e.reportingMode||jM,i=n===1?Zre:Jre[s];let a=Object.keys(t).filter(i);const l=e.filter;typeof l=="function"&&(a=a.filter(l));const d=s===MM||s===kM;d&&!a.includes("ts")&&a.push("ts"),n>1&&!a.includes("v")&&a.push("v");const u=zt({},Hre,e.formatters),f={version:n,reportingMode:s,baseUrl:e.baseUrl};return a.sort().forEach(p=>{let y=t[p];const v=u[p];if(typeof v=="function"&&(y=v(y,f)),p==="v"){if(n===1)return;y=n}p=="pr"&&y===1||(d&&p==="ts"&&!Ve(y)&&(y=Date.now()),$re(y)&&(Ure(p)&&typeof y=="string"&&(y=new RM(y)),r[p]=y))}),r}function ene(t,e={}){const r={};if(!t)return r;const n=FM(t,e),s=Bre(n,e==null?void 0:e.customHeaderMap);return Object.entries(s).reduce((i,[a,l])=>{const d=DM(l,{whitespace:!1});return d&&(i[a]=d),i},r)}function tne(t,e,r){return zt(t,ene(e,r))}const rne="CMCD";function nne(t,e={}){return t?DM(FM(t,e),{whitespace:!1}):""}function sne(t,e={}){if(!t)return"";const r=nne(t,e);return encodeURIComponent(r)}function ine(t,e={}){if(!t)return"";const r=sne(t,e);return`${rne}=${r}`}const RN=/CMCD=[^&#]+/;function ane(t,e,r){const n=ine(e,r);if(!n)return t;if(RN.test(t))return t.replace(RN,n);const s=t.includes("?")?"&":"?";return`${t}${s}${n}`}class one{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=s=>{try{this.apply(s,{ot:rs.MANIFEST,su:!this.initialized})}catch(i){this.hls.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=s=>{try{const{frag:i,part:a}=s,l=this.hls.levels[i.level],d=this.getObjectType(i),u={d:(a||i).duration*1e3,ot:d};(d===rs.VIDEO||d===rs.AUDIO||d==rs.MUXED)&&(u.br=l.bitrate/1e3,u.tb=this.getTopBandwidth(d)/1e3,u.bl=this.getBufferLength(d));const f=a?this.getNextPart(a):this.getNextFrag(i);f!=null&&f.url&&f.url!==i.url&&(u.nor=f.url),this.apply(s,u)}catch(i){this.hls.logger.warn("Could not generate segment CMCD data.",i)}},this.hls=e;const r=this.config=e.config,{cmcd:n}=r;n!=null&&(r.pLoader=this.createPlaylistLoader(),r.fLoader=this.createFragmentLoader(),this.sid=n.sessionId||e.sessionId,this.cid=n.contentId,this.useHeaders=n.useHeaders===!0,this.includeKeys=n.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHED,this.onMediaDetached,this),e.on(M.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHED,this.onMediaDetached,this),e.off(M.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,r){this.media=r.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,r){var n,s;this.audioBuffer=(n=r.tracks.audio)==null?void 0:n.buffer,this.videoBuffer=(s=r.tracks.video)==null?void 0:s.buffer}createData(){var e;return{v:1,sf:mre.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,r={}){zt(r,this.createData());const n=r.ot===rs.INIT||r.ot===rs.VIDEO||r.ot===rs.MUXED;this.starved&&n&&(r.bs=!0,r.su=!0,this.starved=!1),r.su==null&&(r.su=this.buffering);const{includeKeys:s}=this;s&&(r=Object.keys(r).reduce((a,l)=>(s.includes(l)&&(a[l]=r[l]),a),{}));const i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),tne(e.headers,r,i)):e.url=ane(e.url,r,i)}getNextFrag(e){var r;const n=(r=this.hls.levels[e.level])==null?void 0:r.details;if(n){const s=e.sn-n.startSN;return n.fragments[s+1]}}getNextPart(e){var r;const{index:n,fragment:s}=e,i=(r=this.hls.levels[s.level])==null||(r=r.details)==null?void 0:r.partList;if(i){const{sn:a}=s;for(let l=i.length-1;l>=0;l--){const d=i[l];if(d.index===n&&d.fragment.sn===a)return i[l+1]}}}getObjectType(e){const{type:r}=e;if(r==="subtitle")return rs.TIMED_TEXT;if(e.sn==="initSegment")return rs.INIT;if(r==="audio")return rs.AUDIO;if(r==="main")return this.hls.audioTracks.length?rs.VIDEO:rs.MUXED}getTopBandwidth(e){let r=0,n;const s=this.hls;if(e===rs.AUDIO)n=s.audioTracks;else{const i=s.maxAutoLevel,a=i>-1?i+1:s.levels.length;n=s.levels.slice(0,a)}return n.forEach(i=>{i.bitrate>r&&(r=i.bitrate)}),r>0?r:NaN}getBufferLength(e){const r=this.media,n=e===rs.AUDIO?this.audioBuffer:this.videoBuffer;return!n||!r?NaN:ht.bufferInfo(n,r.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,r=this.applyPlaylistData,n=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new n(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,l){r(i),this.loader.load(i,a,l)}}}createFragmentLoader(){const{fLoader:e}=this.config,r=this.applyFragmentData,n=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new n(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,l){r(i),this.loader.load(i,a,l)}}}}const lne=3e5;class cne extends ii{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,r)=>(e.indexOf(r.pathwayId)===-1&&e.push(r.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const r=this.levels;r&&(this.levels=r.filter(n=>n!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,r){const{contentSteering:n}=r;n!==null&&(this.pathwayId=n.pathwayId,this.uri=n.uri,this.started&&this.startLoad())}onManifestParsed(e,r){this.audioTracks=r.audioTracks,this.subtitleTracks=r.subtitleTracks}onError(e,r){const{errorAction:n}=r;if((n==null?void 0:n.action)===vn.SendAlternateToPenaltyBox&&n.flags===ws.MoveAllAlternatesMatchingHost){const s=this.levels;let i=this._pathwayPriority,a=this.pathwayId;if(r.context){const{groupId:l,pathwayId:d,type:u}=r.context;l&&s?a=this.getPathwayForGroupId(l,u,a):d&&(a=d)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!i&&s&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),n.resolved=this.pathwayId!==a),r.details===ue.BUFFER_APPEND_ERROR&&!r.fatal?n.resolved=!0:n.resolved||this.warn(`Could not resolve ${r.details} ("${r.error.message}") with content-steering for Pathway: ${a} levels: ${s&&s.length} priorities: ${qt(i)} penalized: ${qt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let r=this.getLevelsForPathway(this.pathwayId);if(r.length===0){const n=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${n}"`),r=this.getLevelsForPathway(n),this.pathwayId=n}return r.length!==e.length&&this.log(`Found ${r.length}/${e.length} levels in Pathway "${this.pathwayId}"`),r}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(r=>e===r.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let r;const n=this.penalizedPathways,s=performance.now();Object.keys(n).forEach(i=>{s-n[i]>lne&&delete n[i]});for(let i=0;i<e.length;i++){const a=e[i];if(a in n)continue;if(a===this.pathwayId)return;const l=this.hls.nextLoadLevel,d=this.hls.levels[l];if(r=this.getLevelsForPathway(a),r.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,sM(r),this.hls.trigger(M.LEVELS_UPDATED,{levels:r});const u=this.hls.levels[l];d&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==d.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==d.bitrate&&this.log(`Unstable Pathways change from bitrate ${d.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,r,n){const s=this.getLevelsForPathway(n).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(r===Ct.AUDIO_TRACK&&s[i].hasAudioGroup(e)||r===Ct.SUBTITLE_TRACK&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return n}clonePathways(e){const r=this.levels;if(!r)return;const n={},s={};e.forEach(i=>{const{ID:a,"BASE-ID":l,"URI-REPLACEMENT":d}=i;if(r.some(f=>f.pathwayId===a))return;const u=this.getLevelsForPathway(l).map(f=>{const p=new dr(f.attrs);p["PATHWAY-ID"]=a;const y=p.AUDIO&&`${p.AUDIO}_clone_${a}`,v=p.SUBTITLES&&`${p.SUBTITLES}_clone_${a}`;y&&(n[p.AUDIO]=y,p.AUDIO=y),v&&(s[p.SUBTITLES]=v,p.SUBTITLES=v);const E=BM(f.uri,p["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",d),b=new Gh({attrs:p,audioCodec:f.audioCodec,bitrate:f.bitrate,height:f.height,name:f.name,url:E,videoCodec:f.videoCodec,width:f.width});if(f.audioGroups)for(let T=1;T<f.audioGroups.length;T++)b.addGroupId("audio",`${f.audioGroups[T]}_clone_${a}`);if(f.subtitleGroups)for(let T=1;T<f.subtitleGroups.length;T++)b.addGroupId("text",`${f.subtitleGroups[T]}_clone_${a}`);return b});r.push(...u),_N(this.audioTracks,n,d,a),_N(this.subtitleTracks,s,d,a)})}loadSteeringManifest(e){const r=this.hls.config,n=r.loader;this.loader&&this.loader.destroy(),this.loader=new n(r);let s;try{s=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(s.protocol!=="data:"){const f=(this.hls.bandwidthEstimate||r.abrEwmaDefaultEstimate)|0;s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+f)}const i={responseType:"json",url:s.href},a=r.steeringManifestLoadPolicy.default,l=a.errorRetry||a.timeoutRetry||{},d={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},u={onSuccess:(f,p,y,v)=>{this.log(`Loaded steering manifest: "${s}"`);const E=f.data;if((E==null?void 0:E.VERSION)!==1){this.log(`Steering VERSION ${E.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=E.TTL;const{"RELOAD-URI":b,"PATHWAY-CLONES":T,"PATHWAY-PRIORITY":I}=E;if(b)try{this.uri=new self.URL(b,s).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${b}`);return}this.scheduleRefresh(this.uri||y.url),T&&this.clonePathways(T);const N={steeringManifest:E,url:s.toString()};this.hls.trigger(M.STEERING_MANIFEST_LOADED,N),I&&this.updatePathwayPriority(I)},onError:(f,p,y,v)=>{if(this.log(`Error loading steering manifest: ${f.code} ${f.text} (${p.url})`),this.stopLoad(),f.code===410){this.enabled=!1,this.log(`Steering manifest ${p.url} no longer available`);return}let E=this.timeToLoad*1e3;if(f.code===429){const b=this.loader;if(typeof(b==null?void 0:b.getResponseHeader)=="function"){const T=b.getResponseHeader("Retry-After");T&&(E=parseFloat(T)*1e3)}this.log(`Steering manifest ${p.url} rate limited`);return}this.scheduleRefresh(this.uri||p.url,E)},onTimeout:(f,p,y)=>{this.log(`Timeout loading steering manifest (${p.url})`),this.scheduleRefresh(this.uri||p.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(i,d,u)}scheduleRefresh(e,r=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var n;const s=(n=this.hls)==null?void 0:n.media;if(s&&!s.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},r)}}function _N(t,e,r,n){t&&Object.keys(e).forEach(s=>{const i=t.filter(a=>a.groupId===s).map(a=>{const l=zt({},a);return l.details=void 0,l.attrs=new dr(l.attrs),l.url=l.attrs.URI=BM(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),l.groupId=l.attrs["GROUP-ID"]=e[s],l.attrs["PATHWAY-ID"]=n,l});t.push(...i)})}function BM(t,e,r,n){const{HOST:s,PARAMS:i,[r]:a}=n;let l;e&&(l=a==null?void 0:a[e],l&&(t=l));const d=new self.URL(t);return s&&!l&&(d.host=s),i&&Object.keys(i).sort().forEach(u=>{u&&d.searchParams.set(u,i[u])}),d.href}class uu extends ii{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.mediaResolved=void 0,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=uu.CDMCleanupPromise?[uu.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=r=>{const{initDataType:n,initData:s}=r,i=`"${r.type}" event: init data type: "${n}"`;if(this.debug(i),s!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=Fd(this.config));const l=a.map(x1).filter(d=>!!d);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(a=>{const l=a0(a);if(n!=="sinf"||l!==mr.FAIRPLAY){this.log(`Ignoring "${r.type}" event with init data type: "${n}" for selected key-system ${l}`);return}let d;try{const v=Zr(new Uint8Array(s)),E=qE(JSON.parse(v).sinf),b=Dj(E);if(!b)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");d=new Uint8Array(b.subarray(8,24))}catch(v){this.warn(`${i} Failed to parse sinf: ${v}`);return}const u=wn(d),{keyIdToKeySessionPromise:f,mediaKeySessions:p}=this;let y=f[u];for(let v=0;v<p.length;v++){const E=p[v],b=E.decryptdata;if(!b.keyId)continue;const T=wn(b.keyId);if(yp(d,b.keyId)||b.uri.replace(/-/g,"").indexOf(u)!==-1){if(y=f[T],!y)continue;if(b.pssh)break;delete f[T],b.pssh=new Uint8Array(s),b.keyId=d,y=f[u]=y.then(()=>this.generateRequestWithPreferredKeySession(E,n,s,"encrypted-event-key-match")),y.catch(I=>this.handleError(I));break}}y||this.handleError(new Error(`Key ID ${u} not encountered in playlist. Key-system sessions ${p.length}.`))}).catch(a=>this.handleError(a))}},this.onWaitingForKey=r=>{this.log(`"${r.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(M.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(M.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(M.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(M.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(M.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(M.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:r,widevineLicenseUrl:n}=this.config,s=r==null?void 0:r[e];if(s)return s.licenseUrl;if(e===mr.WIDEVINE&&n)return n}getLicenseServerUrlOrThrow(e){const r=this.getLicenseServerUrl(e);if(r===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return r}getServerCertificateUrl(e){const{drmSystems:r}=this.config,n=r==null?void 0:r[e];if(n)return n.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const r=this.hls.levels,n=(a,l,d)=>!!a&&d.indexOf(a)===l,s=r.map(a=>a.audioCodec).filter(n),i=r.map(a=>a.videoCodec).filter(n);return s.length+i.length===0&&i.push("avc1.42e01e"),new Promise((a,l)=>{const d=u=>{const f=u.shift();this.getMediaKeysPromise(f,s,i).then(p=>a({keySystem:f,mediaKeys:p})).catch(p=>{u.length?d(u):p instanceof ys?l(p):l(new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_NO_ACCESS,error:p,fatal:!0},p.message))})};d(e)})}requestMediaKeySystemAccess(e,r){const{requestMediaKeySystemAccessFunc:n}=this.config;if(typeof n!="function"){let s=`Configured requestMediaKeySystemAccess is not a function ${n}`;return Xj===null&&self.location.protocol==="http:"&&(s=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(s))}return n(e,r)}getMediaKeysPromise(e,r,n){var s;const i=Gee(e,r,n,this.config.drmSystemOptions||{});let a=this.keySystemAccessPromises[e],l=(s=a)==null?void 0:s.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${qt(i)}`),l=this.requestMediaKeySystemAccess(e,i);const d=a=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(u=>{this.log(`Failed to obtain access to key-system "${e}": ${u}`)}),l.then(u=>{this.log(`Access for key-system "${u.keySystem}" obtained`);const f=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);const p=d.mediaKeys=u.createMediaKeys().then(y=>(this.log(`Media-keys created for "${e}"`),d.hasMediaKeys=!0,f.then(v=>v?this.setMediaKeysServerCertificate(y,e,v):y)));return p.catch(y=>{this.error(`Failed to create media-keys for "${e}"}: ${y}`)}),p})}return l.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:r,mediaKeys:n}){this.log(`Creating key-system session "${r}" keyId: ${wn(e.keyId||[])} keyUri: ${e.uri}`);const s=n.createSession(),i={decryptdata:e,keySystem:r,mediaKeys:n,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i}renewKeySession(e){const r=e.decryptdata;if(r.pssh){const n=this.createMediaKeySessionContext(e),s=Cm(r),i="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(n,i,r.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}updateKeySession(e,r){const n=e.mediaKeysSession;return this.log(`Updating key-session "${n.sessionId}" for keyId ${wn(e.decryptdata.keyId||[])}
      } (data length: ${r.byteLength})`),n.update(r)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>x1(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:r,mediaKeys:n})=>this.attemptSetMediaKeys(r,n))}selectKeySystem(e){return new Promise((r,n)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:s})=>{const i=x1(s);i?r(i):n(new Error(`Unable to find format for key-system "${s}"`))}).catch(n)})}selectKeySystemFormat(e){const r=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)),this.keyFormatPromise}getKeyFormatPromise(e){const r=Fd(this.config),n=e.map(a0).filter(s=>!!s&&r.indexOf(s)!==-1);return this.selectKeySystem(n)}getKeyStatus(e){const{mediaKeySessions:r}=this;for(let n=0;n<r.length;n++){const s=une(e,r[n]);if(s)return s}}loadKey(e){const r=e.keyInfo.decryptdata,n=Cm(r),s=this.bannedKeyIds[n];if(s||this.getKeyStatus(r)==="internal-error"){const l=LN(s||"internal-error",r);return this.handleError(l,e.frag),Promise.reject(l)}const i=`(keyId: ${n} format: "${r.keyFormat}" method: ${r.method} uri: ${r.uri})`;this.log(`Starting session for key ${i}`);const a=this.keyIdToKeySessionPromise[n];if(!a){const l=this.getKeySystemForKeyPromise(r).then(({keySystem:d,mediaKeys:u})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${i}`),this.attemptSetMediaKeys(d,u).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:d,mediaKeys:u,decryptdata:r}))))).then(d=>{const u="cenc",f=r.pssh?r.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(d,u,f,"playlist-key")});return l.catch(d=>this.handleError(d,e.frag)),this.keyIdToKeySessionPromise[n]=l,l}return a.catch(l=>{if(l instanceof ys){const d=$t({},l.data);this.getKeyStatus(r)==="internal-error"&&(d.decryptdata=r);const u=new ys(d,l.message);this.handleError(u,e.frag)}}),a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e,r){if(this.hls)if(e instanceof ys){r&&(e.data.frag=r);const n=e.data.decryptdata;this.error(`${e.message}${n?` (${wn(n.keyId||[])})`:""}`),this.hls.trigger(M.ERROR,e.data)}else this.error(e.message),this.hls.trigger(M.ERROR,{type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}getKeySystemForKeyPromise(e){const r=Cm(e),n=this.keyIdToKeySessionPromise[r];if(!n){const s=a0(e.keyFormat),i=s?[s]:Fd(this.config);return this.attemptKeySystemAccess(i)}return n}getKeySystemSelectionPromise(e){if(e.length||(e=Fd(this.config)),e.length===0)throw new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${qt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,r){if(this.mediaResolved=void 0,this.mediaKeys===r)return Promise.resolve();const n=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(n).then(()=>this.media?this.media.setMediaKeys(r):new Promise((i,a)=>{this.mediaResolved=()=>{if(this.mediaResolved=void 0,!this.media)return a(new Error("Attempted to set mediaKeys without media element attached"));this.mediaKeys=r,this.media.setMediaKeys(r).then(i).catch(a)}}));return this.mediaKeys=r,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),n.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(i=>n.indexOf(i)===-1)})}generateRequestWithPreferredKeySession(e,r,n,s){var i;const a=(i=this.config.drmSystems)==null||(i=i[e.keySystem])==null?void 0:i.generateRequest;if(a)try{const E=a.call(this.hls,r,n,e);if(!E)throw new Error("Invalid response from configured generateRequest filter");r=E.initDataType,n=E.initData?E.initData:null,e.decryptdata.pssh=n?new Uint8Array(n):null}catch(E){if(this.warn(E.message),this.hls&&this.hls.config.debug)throw E}if(n===null)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const l=Cm(e.decryptdata),d=e.decryptdata.uri;this.log(`Generating key-session request for "${s}" keyId: ${l} URI: ${d} (init data type: ${r} length: ${n.byteLength})`);const u=new QE,f=e._onmessage=E=>{const b=e.mediaKeysSession;if(!b){u.emit("error",new Error("invalid state"));return}const{messageType:T,message:I}=E;this.log(`"${T}" message event for session "${b.sessionId}" message size: ${I.byteLength}`),T==="license-request"||T==="license-renewal"?this.renewLicense(e,I).catch(N=>{u.eventNames().length?u.emit("error",N):this.handleError(N)}):T==="license-release"?e.keySystem===mr.FAIRPLAY&&this.updateKeySession(e,Bv("acknowledged")).then(()=>this.removeSession(e)).catch(N=>this.handleError(N)):this.warn(`unhandled media key message type "${T}"`)},p=(E,b)=>{b.keyStatus=E;let T;E.startsWith("usable")?u.emit("resolved"):E==="internal-error"||E==="output-restricted"||E==="output-downscaled"?T=LN(E,b.decryptdata):E==="expired"?T=new Error(`key expired (keyId: ${l})`):E==="released"?T=new Error("key released"):E==="status-pending"||this.warn(`unhandled key status change "${E}" (keyId: ${l})`),T&&(u.eventNames().length?u.emit("error",T):this.handleError(T))},y=e._onkeystatuseschange=E=>{if(!e.mediaKeysSession){u.emit("error",new Error("invalid state"));return}const T=this.getKeyStatuses(e);if(!Object.keys(T).some(L=>T[L]!=="status-pending"))return;if(T[l]==="expired"){this.log(`Expired key ${qt(T)} in key-session "${e.mediaKeysSession.sessionId}"`),this.renewKeySession(e);return}let N=T[l];if(N)p(N,e);else{var A;e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(A=e.keyStatusTimeouts)[l]||(A[l]=self.setTimeout(()=>{if(!e.mediaKeysSession||!this.mediaKeys)return;const P=this.getKeyStatus(e.decryptdata);if(P&&P!=="status-pending")return this.log(`No status for keyId ${l} in key-session "${e.mediaKeysSession.sessionId}". Using session key-status ${P} from other session.`),p(P,e);this.log(`key status for ${l} in key-session "${e.mediaKeysSession.sessionId}" timed out after 1000ms`),N="internal-error",p(N,e)},1e3)),this.log(`No status for keyId ${l} (${qt(T)}).`)}};Wn(e.mediaKeysSession,"message",f),Wn(e.mediaKeysSession,"keystatuseschange",y);const v=new Promise((E,b)=>{u.on("error",b),u.on("resolved",E)});return e.mediaKeysSession.generateRequest(r,n).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l} URI: ${d}`)}).catch(E=>{throw new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_NO_SESSION,error:E,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${E}`)}).then(()=>v).catch(E=>(u.removeAllListeners(),this.removeSession(e).then(()=>{throw E}))).then(()=>(u.removeAllListeners(),e))}getKeyStatuses(e){const r={};return e.mediaKeysSession.keyStatuses.forEach((n,s)=>{if(typeof s=="string"&&typeof n=="object"){const l=s;s=n,n=l}const i="buffer"in s?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):new Uint8Array(s);if(e.keySystem===mr.PLAYREADY&&i.length===16){const l=wn(i);r[l]=n,Yj(i)}const a=wn(i);n==="internal-error"&&(this.bannedKeyIds[a]=n),this.log(`key status change "${n}" for keyStatuses keyId: ${a} key-session "${e.mediaKeysSession.sessionId}"`),r[a]=n}),r}fetchServerCertificate(e){const r=this.config,n=r.loader,s=new n(r),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,l)=>{const d={responseType:"arraybuffer",url:i},u=r.certLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,v,E,b)=>{a(y.data)},onError:(y,v,E,b)=>{l(new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:$t({url:d.url,data:void 0},y)},`"${e}" certificate request failed (${i}). Status: ${y.code} (${y.text})`))},onTimeout:(y,v,E)=>{l(new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:E,response:{url:d.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(y,v,E)=>{l(new Error("aborted"))}};s.load(d,f,p)})):Promise.resolve()}setMediaKeysServerCertificate(e,r,n){return new Promise((s,i)=>{e.setServerCertificate(n).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${n.byteLength}) on "${r}"`),s(e)}).catch(a=>{i(new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,r){return this.requestLicense(e,new Uint8Array(r)).then(n=>this.updateKeySession(e,new Uint8Array(n)).catch(s=>{throw new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:s,fatal:!1},s.message)}))}unpackPlayReadyKeyMessage(e,r){const n=String.fromCharCode.apply(null,new Uint16Array(r.buffer));if(!n.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),r;const s=new DOMParser().parseFromString(n,"application/xml"),i=s.querySelectorAll("HttpHeader");if(i.length>0){let f;for(let p=0,y=i.length;p<y;p++){var a,l;f=i[p];const v=(a=f.querySelector("name"))==null?void 0:a.textContent,E=(l=f.querySelector("value"))==null?void 0:l.textContent;v&&E&&e.setRequestHeader(v,E)}}const d=s.querySelector("Challenge"),u=d==null?void 0:d.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Bv(atob(u))}setupLicenseXHR(e,r,n,s){const i=this.config.licenseXhrSetup;return i?Promise.resolve().then(()=>{if(!n.decryptdata)throw new Error("Key removed");return i.call(this.hls,e,r,n,s)}).catch(a=>{if(!n.decryptdata)throw a;return e.open("POST",r,!0),i.call(this.hls,e,r,n,s)}).then(a=>(e.readyState||e.open("POST",r,!0),{xhr:e,licenseChallenge:a||s})):(e.open("POST",r,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,r){const n=this.config.keyLoadPolicy.default;return new Promise((s,i)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return i(new Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let d=l.response;this.log(`License received ${d instanceof ArrayBuffer?d.byteLength:d}`);const u=this.config.licenseResponseCallback;if(u)try{d=u.call(this.hls,l,a,e)}catch(f){this.error(f)}s(d)}else{const d=n.errorRetry,u=d?d.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||l.status>=400&&l.status<500)i(new ys({type:Qe.KEY_SYSTEM_ERROR,details:ue.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:a,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${a}). Status: ${l.status} (${l.statusText})`));else{const f=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${f} attempts left`),this.requestLicense(e,r).then(s,i)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,a,e,r).then(({xhr:d,licenseChallenge:u})=>{e.keySystem==mr.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(d,u)),d.send(u)}).catch(i)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,r){if(!this.config.emeEnabled)return;const n=r.media;this.media=n,Wn(n,"encrypted",this.onMediaEncrypted),Wn(n,"waitingforkey",this.onWaitingForKey);const s=this.mediaResolved;s?s():this.mediaKeys=n.mediaKeys}onMediaDetached(){const e=this.media;e&&(ls(e,"encrypted",this.onMediaEncrypted),ls(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={};const r=this.mediaResolved;if(r&&r(),!this.mediaKeys&&!this.mediaKeySessions.length)return;const n=this.media,s=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,Ao.clearKeyUriToKeyIdMap();const i=s.length;uu.CDMCleanupPromise=Promise.all(s.map(a=>this.removeSession(a)).concat((n==null||(e=n.setMediaKeys(null))==null?void 0:e.catch(a=>{this.log(`Could not clear media keys: ${a}`),this.hls&&this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${a}`)})}))||Promise.resolve())).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`),this.hls&&this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this._clear()}onManifestLoaded(e,{sessionKeys:r}){if(!(!r||!this.config.emeEnabled)&&!this.keyFormatPromise){const n=r.reduce((s,i)=>(s.indexOf(i.keyFormat)===-1&&s.push(i.keyFormat),s),[]);this.log(`Selecting key-system from session-keys ${n.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(n)}}removeSession(e){const{mediaKeysSession:r,licenseXhr:n,decryptdata:s}=e;if(r){this.log(`Remove licenses and keys and close session "${r.sessionId}" keyId: ${wn((s==null?void 0:s.keyId)||[])}`),e._onmessage&&(r.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(r.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const i=this.mediaKeySessions.indexOf(e);i>-1&&this.mediaKeySessions.splice(i,1);const{keyStatusTimeouts:a}=e;a&&Object.keys(a).forEach(u=>self.clearTimeout(a[u]));const{drmSystemOptions:l}=this.config;return(zee(l)?new Promise((u,f)=>{self.setTimeout(()=>f(new Error("MediaKeySession.remove() timeout")),8e3),r.remove().then(u).catch(f)}):Promise.resolve()).catch(u=>{this.log(`Could not remove session: ${u}`),this.hls&&this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${u}`)})}).then(()=>r.close()).catch(u=>{this.log(`Could not close session: ${u}`),this.hls&&this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${u}`)})})}return Promise.resolve()}}uu.CDMCleanupPromise=void 0;function Cm(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return wn(t.keyId)}function une(t,e){if(t.keyId&&e.mediaKeysSession.keyStatuses.has(t.keyId))return e.mediaKeysSession.keyStatuses.get(t.keyId);if(t.matches(e.decryptdata))return e.keyStatus}class ys extends Error{constructor(e,r){super(r),this.data=void 0,e.error||(e.error=new Error(r)),this.data=e,e.err=e.error}}function LN(t,e){const r=t==="output-restricted",n=r?ue.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:ue.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new ys({type:Qe.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:e},r?"HDCP level output restricted":`key status changed to "${t}"`)}class dne{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(M.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(M.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,r){const n=this.hls.config;if(n.capLevelOnFPSDrop){const s=r.media instanceof self.HTMLVideoElement?r.media:null;this.media=s,s&&typeof s.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),n.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,r,n){const s=performance.now();if(r){if(this.lastTime){const i=s-this.lastTime,a=n-this.lastDroppedFrames,l=r-this.lastDecodedFrames,d=1e3*a/i,u=this.hls;if(u.trigger(M.FPS_DROP,{currentDropped:a,currentDecoded:l,totalDroppedFrames:n}),d>0&&a>u.config.fpsDroppedMonitoringThreshold*l){let f=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=f)&&(f=f-1,u.trigger(M.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel}),u.autoLevelCapping=f,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=n,this.lastDecodedFrames=r}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const r=e.getVideoPlaybackQuality();this.checkFPS(e,r.totalVideoFrames,r.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function UM(t,e){let r;try{r=new Event("addtrack")}catch{r=document.createEvent("Event"),r.initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function $M(t,e){const r=t.mode;if(r==="disabled"&&(t.mode="hidden"),t.cues&&!t.cues.getCueById(e.id))try{if(t.addCue(e),!t.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(n){Vt.debug(`[texttrack-utils]: ${n}`);try{const s=new self.TextTrackCue(e.startTime,e.endTime,e.text);s.id=e.id,t.addCue(s)}catch(s){Vt.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${s}`)}}r==="disabled"&&(t.mode=r)}function qc(t,e){const r=t.mode;if(r==="disabled"&&(t.mode="hidden"),t.cues)for(let n=t.cues.length;n--;)e&&t.cues[n].removeEventListener("enter",e),t.removeCue(t.cues[n]);r==="disabled"&&(t.mode=r)}function Yv(t,e,r,n){const s=t.mode;if(s==="disabled"&&(t.mode="hidden"),t.cues&&t.cues.length>0){const i=fne(t.cues,e,r);for(let a=0;a<i.length;a++)(!n||n(i[a]))&&t.removeCue(i[a])}s==="disabled"&&(t.mode=s)}function hne(t,e){if(e<=t[0].startTime)return 0;const r=t.length-1;if(e>t[r].endTime)return-1;let n=0,s=r,i;for(;n<=s;)if(i=Math.floor((s+n)/2),e<t[i].startTime)s=i-1;else if(e>t[i].startTime&&n<r)n=i+1;else return i;return t[n].startTime-e<e-t[s].startTime?n:s}function fne(t,e,r){const n=[],s=hne(t,e);if(s>-1)for(let i=s,a=t.length;i<a;i++){const l=t[i];if(l.startTime>=e&&l.endTime<=r)n.push(l);else if(l.startTime>r)return n}return n}function u0(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];(n.kind==="subtitles"||n.kind==="captions")&&n.label&&e.push(t[r])}return e}class mne extends s2{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let r=null;const n=u0(this.media.textTracks);for(let i=0;i<n.length;i++)if(n[i].mode==="hidden")r=n[i];else if(n[i].mode==="showing"){r=n[i];break}const s=this.findTrackForTextTrack(r);this.subtitleTrack!==s&&this.setSubtitleTrack(s)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(M.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVEL_LOADING,this.onLevelLoading,this),e.off(M.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(M.ERROR,this.onError,this)}onMediaAttached(e,r){this.media=r.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,r){const n=this.media;if(!n)return;const s=!!r.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||n.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;u0(n.textTracks).forEach(a=>{qc(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,r){this.tracks=r.subtitleTracks}onSubtitleTrackLoaded(e,r){const{id:n,groupId:s,details:i}=r,a=this.tracksInGroup[n];if(!a||a.groupId!==s){this.warn(`Subtitle track with id:${n} and group:${s} not found in active group ${a==null?void 0:a.groupId}`);return}const l=a.details;a.details=r.details,this.log(`Subtitle track ${n} "${a.name}" lang:${a.lang} group:${s} loaded [${i.startSN}-${i.endSN}]`),n===this.trackId&&this.playlistLoaded(n,r,l)}onLevelLoading(e,r){this.switchLevel(r.level)}onLevelSwitching(e,r){this.switchLevel(r.level)}switchLevel(e){const r=this.hls.levels[e];if(!r)return;const n=r.subtitleGroups||null,s=this.groupIds;let i=this.currentTrack;if(!n||(s==null?void 0:s.length)!==(n==null?void 0:n.length)||n!=null&&n.some(a=>(s==null?void 0:s.indexOf(a))===-1)){this.groupIds=n,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(f=>!n||n.indexOf(f.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(f=>f.default)&&(this.selectDefaultTrack=!1),a.forEach((f,p)=>{f.id=p});else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const l=this.hls.config.subtitlePreference;if(!i&&l){this.selectDefaultTrack=!1;const f=Qi(l,a);if(f>-1)i=a[f];else{const p=Qi(l,this.tracks);i=this.tracks[p]}}let d=this.findTrackId(i);d===-1&&i&&(d=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${n==null?void 0:n.join(",")}" group-id`),this.hls.trigger(M.SUBTITLE_TRACKS_UPDATED,u),d!==-1&&this.trackId===-1&&this.setSubtitleTrack(d)}}findTrackId(e){const r=this.tracksInGroup,n=this.selectDefaultTrack;for(let s=0;s<r.length;s++){const i=r[s];if(!(n&&!i.default||!n&&!e)&&(!e||Dl(i,e)))return s}if(e){for(let s=0;s<r.length;s++){const i=r[s];if(Kh(e.attrs,i.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return s}for(let s=0;s<r.length;s++){const i=r[s];if(Kh(e.attrs,i.attrs,["LANGUAGE"]))return s}}return-1}findTrackForTextTrack(e){if(e){const r=this.tracksInGroup;for(let n=0;n<r.length;n++){const s=r[n];if(Hv(s,e))return n}}return-1}onError(e,r){r.fatal||!r.context||r.context.type===Ct.SUBTITLE_TRACK&&r.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(r.context.groupId)!==-1)&&this.checkRetry(r)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const r=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,r.length){const n=this.currentTrack;if(n&&Dl(e,n))return n;const s=Qi(e,this.tracksInGroup);if(s>-1){const i=this.tracksInGroup[s];return this.setSubtitleTrack(s),i}else{if(n)return null;{const i=Qi(e,r);if(i>-1)return r[i]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,r){super.loadingPlaylist(e,r);const n=e.id,s=e.groupId,i=this.getUrlWithDirectives(e.url,r),a=e.details,l=a==null?void 0:a.age;this.log(`Loading subtitle ${n} "${e.name}" lang:${e.lang} group:${s}${(r==null?void 0:r.msn)!==void 0?" at sn "+r.msn+" part "+r.part:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(M.SUBTITLE_TRACK_LOADING,{url:i,id:n,groupId:s,deliveryDirectives:r||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const r=u0(e.textTracks),n=this.currentTrack;let s;if(n&&(s=r.filter(i=>Hv(n,i))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${n.name}" and language "${n.lang}"`)),[].slice.call(r).forEach(i=>{i.mode!=="disabled"&&i!==s&&(i.mode="disabled")}),s){const i=this.subtitleDisplay?"showing":"hidden";s.mode!==i&&(s.mode=i)}}setSubtitleTrack(e){const r=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=r.length||!Ve(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const n=this.currentTrack,s=r[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s){this.hls.trigger(M.SUBTITLE_TRACK_SWITCH,{id:e});return}const i=!!s.details&&!s.details.live;if(e===this.trackId&&s===n&&i)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:a,groupId:l="",name:d,type:u,url:f}=s;this.hls.trigger(M.SUBTITLE_TRACK_SWITCH,{id:a,groupId:l,name:d,type:u,url:f});const p=this.switchParams(s.url,n==null?void 0:n.details,s.details);this.loadPlaylist(p)}}function pne(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),r=e.toString();return URL.revokeObjectURL(e),r.slice(r.lastIndexOf("/")+1)}catch{let r=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const i=(r+Math.random()*16)%16|0;return r=Math.floor(r/16),(s=="x"?i:i&3|8).toString(16)})}}}function th(t){let e=5381,r=t.length;for(;r;)e=e*33^t.charCodeAt(--r);return(e>>>0).toString()}const du=.025;let Ep=function(t){return t[t.Point=0]="Point",t[t.Range=1]="Range",t}({});function gne(t,e,r){return`${t.identifier}-${r+1}-${th(e)}`}class xne{constructor(e,r){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=r,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var r;if(e>0&&e>=this.assetList.length)return!0;const n=this.playoutLimit;return e<=0||isNaN(n)?!1:n===0?!0:(((r=this.assetList[e])==null?void 0:r.startOffset)||0)>n}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const r=this.dateRange.tagAnchor;if(r)return A1(e,r)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const r=this.dateRange.startTime,n=A1(r,e);return r-n<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,r=Ve(e)?e:this.duration;return this.cumulativeDuration+r}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const r=this.resumeAnchor;if(r)return A1(e,r)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<du))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let r;return this._duration!==null?r=this._duration:this.dateRange.duration?r=this.dateRange.duration:r=this.dateRange.plannedDuration||0,!isNaN(e)&&e<r&&(r=e),r}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?Ep.Range:Ep.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return yne(this)}}function A1(t,e){return t-e.start<e.duration/2&&!(Math.abs(t-(e.start+e.duration))<du)?e.start:e.start+e.duration}function VM(t,e,r){const n=new self.URL(t,r);return n.protocol!=="data:"&&n.searchParams.set("_HLS_primary_id",e),n}function N1(t,e){for(;(r=t.assetList[++e])!=null&&r.error;)var r;return e}function yne(t){return`["${t.identifier}" ${t.cue.pre?"<pre>":t.cue.post?"<post>":""}${t.timelineStart.toFixed(2)}-${t.resumeTime.toFixed(2)}]`}function Rc(t){const e=t.timelineStart,r=t.duration||0;return`["${t.identifier}" ${e.toFixed(2)}-${(e+r).toFixed(2)}]`}class vne{constructor(e,r,n,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(M.PLAYOUT_LIMIT_REACHED,{})};const i=this.hls=new e(r);this.interstitial=n,this.assetItem=s;const a=()=>{this.hasDetails=!0};i.once(M.LEVEL_LOADED,a),i.once(M.AUDIO_TRACK_LOADED,a),i.once(M.SUBTITLE_TRACK_LOADED,a),i.on(M.MEDIA_ATTACHING,(l,{media:d})=>{this.removeMediaListeners(),this.mediaAttached=d,this.interstitial.playoutLimit&&(d.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&i.on(M.BUFFER_APPENDED,()=>{const f=this.bufferedEnd;this.reachedPlayout(f)&&(this._bufferedEosTime=f,i.trigger(M.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){const e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let r=this.assetItem.uri;try{r=VM(r,e.config.primarySessionId||"").href}catch{}e.loadSource(r)}}bufferedInPlaceToEnd(e){var r;if(!this.appendInPlace)return!1;if((r=this.hls)!=null&&r.bufferedToEnd)return!0;if(!e)return!1;const n=Math.min(this._bufferedEosTime||1/0,this.duration),s=this.timelineOffset,i=ht.bufferInfo(e,s,0);return this.getAssetTime(i.end)>=n-.02}reachedPlayout(e){const n=this.interstitial.playoutLimit;return this.startOffset+e>=n}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const r=ht.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(r.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;if(!e)return 0;const r=this.interstitial.playoutLimit;if(r){const n=r-this.startOffset;if(n>0&&n<e)return n}return e}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const r=this.timelineOffset;if(e!==r){const n=e-r;if(Math.abs(n)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const r=this.timelineOffset,n=this.duration;return Math.min(Math.max(0,e-r),n)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var r;this.loadSource(),(r=this.hls)==null||r.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){const e=this.hls;if(e&&this.hasDetails){e.stopLoad();const r=n=>delete n.details;e.levels.forEach(r),e.allAudioTracks.forEach(r),e.allSubtitleTracks.forEach(r),this.hasDetails=!1}}on(e,r,n){var s;(s=this.hls)==null||s.on(e,r)}once(e,r,n){var s;(s=this.hls)==null||s.once(e,r)}off(e,r,n){var s;(s=this.hls)==null||s.off(e,r)}toString(){var e;return`HlsAssetPlayer: ${Rc(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const PN=.033;class wne extends ii{constructor(e,r){super("interstitials-sched",r),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,r){return this.events?this.events.reduce((n,s)=>e<=s.startOffset&&r>s.startOffset?(delete s.error,n+1):n,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,r){if(e.event)return this.findEventIndex(e.event.identifier);let n=-1;e.nextEvent?n=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(n=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[n]||(r===void 0&&(r=e.start),n=this.findItemIndexAtTime(r));n>=0&&(i=s[n])!=null&&i.event;){var i;n--}return n}findItemIndexAtTime(e,r){const n=this.items;if(n)for(let s=0;s<n.length;s++){let i=n[s];if(r&&r!=="primary"&&(i=i[r]),e===i.start||e>i.start&&e<i.end)return s}return-1}findJumpRestrictedIndex(e,r){const n=this.items;if(n)for(let s=e;s<=r&&n[s];s++){const i=n[s].event;if(i!=null&&i.restrictions.jump&&!i.appendInPlace)return s}return-1}findEventIndex(e){const r=this.items;if(r)for(let s=r.length;s--;){var n;if(((n=r[s].event)==null?void 0:n.identifier)===e)return s}return-1}findAssetIndex(e,r){const n=e.assetList,s=n.length;if(s>1)for(let i=0;i<s;i++){const a=n[i];if(!a.error){const l=a.timelineStart;if(r===l||r>l&&(r<l+(a.duration||0)||i===s-1))return i}}return 0}get assetIdAtEnd(){var e;const r=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(r){const n=r.assetList,s=n[n.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,r){const n=e.main.details,{dateRanges:s}=n,i=this.events,a=this.parseDateRanges(s,{url:n.url},r),l=Object.keys(s),d=i?i.filter(u=>!l.includes(u.identifier)):[];a.length&&a.sort((u,f)=>{const p=u.cue.pre,y=u.cue.post,v=f.cue.pre,E=f.cue.post;if(p&&!v)return-1;if(v&&!p||y&&!E)return 1;if(E&&!y)return-1;if(!p&&!v&&!y&&!E){const b=u.startTime,T=f.startTime;if(b!==T)return b-T}return u.dateRange.tagOrder-f.dateRange.tagOrder}),this.events=a,d.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,d)}updateSchedule(e,r=[],n=!1){const s=this.events||[];if(s.length||r.length||this.length<2){const i=this.items,a=this.parseSchedule(s,e);(n||r.length||(i==null?void 0:i.length)!==a.length||a.some((d,u)=>Math.abs(d.playout.start-i[u].playout.start)>.005||Math.abs(d.playout.end-i[u].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(r,i))}}parseDateRanges(e,r,n){const s=[],i=Object.keys(e);for(let a=0;a<i.length;a++){const l=i[a],d=e[l];if(d.isInterstitial){let u=this.eventMap[l];u?u.setDateRange(d):(u=new xne(d,r),this.eventMap[l]=u,n===!1&&(u.appendInPlace=n)),s.push(u)}}return s}parseSchedule(e,r){const n=[],s=r.main.details,i=s.live?1/0:s.edge;let a=0;if(e=e.filter(d=>!d.error&&!(d.cue.once&&d.hasPlayed)),e.length){this.resolveOffsets(e,r);let d=0,u=0;if(e.forEach((f,p)=>{const y=f.cue.pre,v=f.cue.post,E=e[p-1]||null,b=f.appendInPlace,T=v?i:f.startOffset,I=f.duration,N=f.timelineOccupancy===Ep.Range?I:0,A=f.resumptionOffset,L=(E==null?void 0:E.startTime)===T,P=T+f.cumulativeDuration;let k=b?P+I:T+A;if(y||!v&&T<=0){const O=u;u+=N,f.timelineStart=P;const F=a;a+=I,n.push({event:f,start:P,end:k,playout:{start:F,end:a},integrated:{start:O,end:u}})}else if(T<=i){if(!L){const $=T-d;if($>PN){const G=d,Y=u;u+=$;const ne=a;a+=$;const X={previousEvent:e[p-1]||null,nextEvent:f,start:G,end:G+$,playout:{start:ne,end:a},integrated:{start:Y,end:u}};n.push(X)}else $>0&&E&&(E.cumulativeDuration+=$,n[n.length-1].end=T)}v&&(k=P),f.timelineStart=P;const O=u;u+=N;const F=a;a+=I,n.push({event:f,start:P,end:k,playout:{start:F,end:a},integrated:{start:O,end:u}})}else return;const D=f.resumeTime;v||D>i?d=i:d=D}),d<i){var l;const f=d,p=u,y=i-d;u+=y;const v=a;a+=y,n.push({previousEvent:((l=n[n.length-1])==null?void 0:l.event)||null,nextEvent:null,start:d,end:f+y,playout:{start:v,end:a},integrated:{start:p,end:u}})}this.setDurations(i,a,u)}else n.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return n}setDurations(e,r,n){this.durations={primary:e,playout:r,integrated:n}}resolveOffsets(e,r){const n=r.main.details,s=n.live?1/0:n.edge;let i=0,a=-1;e.forEach((l,d)=>{const u=l.cue.pre,f=l.cue.post,p=u?0:f?s:l.startTime;this.updateAssetDurations(l),a===p?l.cumulativeDuration=i:(i=0,a=p),!f&&l.snapOptions.in&&(l.resumeAnchor=Xl(null,n.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),l.appendInPlace&&!l.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(l,r)||(l.appendInPlace=!1)),!l.appendInPlace&&d+1<e.length&&e[d+1].startTime-e[d].resumeTime<PN&&(e[d+1].appendInPlace=!1,e[d+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));const v=Ve(l.resumeOffset)?l.resumeOffset:l.duration;i+=v})}primaryCanResumeInPlaceAt(e,r){const n=e.resumeTime,s=e.startTime+e.resumptionOffset;return Math.abs(n-s)>du?(this.log(`"${e.identifier}" resumption ${n} not aligned with estimated timeline end ${s}`),!1):!Object.keys(r).some(a=>{const l=r[a].details,d=l.edge;if(n>=d)return this.log(`"${e.identifier}" resumption ${n} past ${a} playlist end ${d}`),!1;const u=Xl(null,l.fragments,n);if(!u)return this.log(`"${e.identifier}" resumption ${n} does not align with any fragments in ${a} playlist (${l.fragStart}-${l.fragmentEnd})`),!0;const f=a==="audio"?.175:0;return Math.abs(u.start-n)<du+f||Math.abs(u.end-n)<du+f?!1:(this.log(`"${e.identifier}" resumption ${n} not aligned with ${a} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const r=e.timelineStart;let n=0,s=!1,i=!1;for(let a=0;a<e.assetList.length;a++){const l=e.assetList[a],d=r+n;l.startOffset=n,l.timelineStart=d,s||(s=l.duration===null),i||(i=!!l.error);const u=l.error?0:l.duration||0;n+=u}s&&!i?e.duration=Math.max(n,e.duration):e.duration=n}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function hi(t){return`[${t.event?'"'+t.event.identifier+'"':"primary"}: ${t.start.toFixed(2)}-${t.end.toFixed(2)}]`}class bne{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,r){const n=e.assetListUrl;let s;try{s=VM(n,this.hls.sessionId,e.baseUrl)}catch(y){const v=this.assignAssetListError(e,ue.ASSET_LIST_LOAD_ERROR,y,n);this.hls.trigger(M.ERROR,v);return}r&&s.protocol!=="data:"&&s.searchParams.set("_HLS_start_offset",""+r);const i=this.hls.config,a=i.loader,l=new a(i),d={responseType:"json",url:s.href},u=i.interstitialAssetListLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,v,E,b)=>{const T=y.data,I=T==null?void 0:T.ASSETS;if(!Array.isArray(I)){const N=this.assignAssetListError(e,ue.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),E.url,v,b);this.hls.trigger(M.ERROR,N);return}e.assetListResponse=T,this.hls.trigger(M.ASSET_LIST_LOADED,{event:e,assetListResponse:T,networkDetails:b})},onError:(y,v,E,b)=>{const T=this.assignAssetListError(e,ue.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${y.code} ${y.text} (${v.url})`),v.url,b,E);this.hls.trigger(M.ERROR,T)},onTimeout:(y,v,E)=>{const b=this.assignAssetListError(e,ue.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${v.url})`),v.url,y,E);this.hls.trigger(M.ERROR,b)}};return l.load(d,f,p),this.hls.trigger(M.ASSET_LIST_LOADING,{event:e}),l}assignAssetListError(e,r,n,s,i,a){return e.error=n,{type:Qe.NETWORK_ERROR,details:r,fatal:!1,interstitial:e,url:s,error:n,networkDetails:a,stats:i}}}function DN(t){var e;t==null||(e=t.play())==null||e.catch(()=>{})}function Am(t,e){return`[${t}] Advancing timeline position to ${e}`}class Ene extends ii{constructor(e,r){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled||!this.schedule)return;const s=n-this.timelinePos;if(Math.abs(s)<1/7056e5)return;const a=s<=-.01;this.timelinePos=n,this.bufferedPos=n;const l=this.playingItem;if(!l){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(n,n-s)&&this.updateSchedule(!0),this.checkBuffer(),a&&n<l.start||n>=l.end){var d;const v=this.findItemIndex(l);let E=this.schedule.findItemIndexAtTime(n);if(E===-1&&(E=v+(a?-1:1),this.log(`seeked ${a?"back ":""}to position not covered by schedule ${n} (resolving from ${v} to ${E})`)),!this.isInterstitial(l)&&(d=this.media)!=null&&d.paused&&(this.shouldPlay=!1),!a&&E>v){const b=this.schedule.findJumpRestrictedIndex(v+1,E);if(b>v){this.setSchedulePosition(b);return}}this.setSchedulePosition(E);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(l)){const v=l.event.assetList[0];v&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(n,v))}return}const f=u.timelineStart,p=u.duration||0;if(a&&n<f||n>=f+p){var y;(y=l.event)!=null&&y.appendInPlace&&(this.clearAssetPlayers(l.event,l),this.flushFrontBuffer(n)),this.setScheduleToAssetAtTime(n,u)}},this.onTimeupdate=()=>{const n=this.currentTime;if(n===void 0||this.playbackDisabled)return;if(n>this.timelinePos)this.timelinePos=n,n>this.bufferedPos&&this.checkBuffer();else return;const s=this.playingItem;if(!s||this.playingLastItem)return;if(n>=s.end){this.timelinePos=s.end;const l=this.findItemIndex(s);this.setSchedulePosition(l+1)}const i=this.playingAsset;if(!i)return;const a=i.timelineStart+(i.duration||0);n>=a&&this.setScheduleToAssetAtTime(n,i)},this.onScheduleUpdate=(n,s)=>{const i=this.schedule;if(!i)return;const a=this.playingItem,l=i.events||[],d=i.items||[],u=i.durations,f=n.map(b=>b.identifier),p=!!(l.length||f.length);(p||s)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${d.map(b=>hi(b))} pos: ${this.timelinePos}`),f.length&&this.log(`Removed events ${f}`);let y=null,v=null;a&&(y=this.updateItem(a,this.timelinePos),this.itemsMatch(a,y)?this.playingItem=y:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const E=this.bufferingItem;if(E&&(v=this.updateItem(E,this.bufferedPos),this.itemsMatch(E,v)?this.bufferingItem=v:E.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(E.event,null))),n.forEach(b=>{b.assetList.forEach(T=>{this.clearAssetPlayer(T.identifier,null)})}),this.playerQueue.forEach(b=>{if(b.interstitial.appendInPlace){const T=b.assetItem.timelineStart,I=b.timelineOffset-T;if(I)try{b.timelineOffset=T}catch(N){Math.abs(I)>du&&this.warn(`${N} ("${b.assetId}" ${b.timelineOffset}->${T})`)}}}),p||s){if(this.hls.trigger(M.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:d.slice(0),durations:u,removedIds:f}),this.isInterstitial(a)&&f.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}a&&this.trimInPlace(y,a),E&&v!==y&&this.trimInPlace(v,E),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=r,this.assetListLoader=new bne(e),this.schedule=new wne(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e&&(e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(M.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(M.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(M.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(M.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(M.BUFFER_APPENDED,this.onBufferAppended,this),e.on(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(M.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(M.MEDIA_ENDED,this.onMediaEnded,this),e.on(M.ERROR,this.onError,this),e.on(M.DESTROYING,this.onDestroying,this))}unregisterListeners(){const e=this.hls;e&&(e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(M.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(M.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(M.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(M.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(M.BUFFER_CODECS,this.onBufferCodecs,this),e.off(M.BUFFER_APPENDED,this.onBufferAppended,this),e.off(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(M.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(M.MEDIA_ENDED,this.onMediaEnded,this),e.off(M.ERROR,this.onError,this),e.off(M.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){ls(e,"play",this.onPlay),ls(e,"pause",this.onPause),ls(e,"seeking",this.onSeeking),ls(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,r){const n=this.media=r.media;Wn(n,"seeking",this.onSeeking),Wn(n,"timeupdate",this.onTimeupdate),Wn(n,"play",this.onPlay),Wn(n,"pause",this.onPause)}onMediaAttached(e,r){const n=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,n===null)this.checkStart();else if(!s){this.clearScheduleState();const i=this.findItemIndex(n);this.setSchedulePosition(i)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,r){const n=!!r.transferMedia,s=this.media;if(this.media=null,!n&&(s&&this.removeMediaListeners(s),this.detachedData)){const i=this.getBufferingPlayer();i&&(this.log(`Removing schedule state for detachedData and ${i}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;const e=this,r=()=>e.bufferingItem||e.waitingItem,n=p=>p&&e.getAssetPlayer(p.identifier),s=(p,y,v,E,b)=>{if(p){let T=p[y].start;const I=p.event;if(I){if(y==="playout"||I.timelineOccupancy!==Ep.Point){const N=n(v);(N==null?void 0:N.interstitial)===I&&(T+=N.assetItem.startOffset+N[b])}}else{const N=E==="bufferedPos"?a():e[E];T+=N-p.start}return T}return 0},i=(p,y)=>{var v;if(p!==0&&y!=="primary"&&(v=e.schedule)!=null&&v.length){var E;const b=e.schedule.findItemIndexAtTime(p),T=(E=e.schedule.items)==null?void 0:E[b];if(T){const I=T[y].start-T.start;return p+I}}return p},a=()=>{const p=e.bufferedPos;return p===Number.MAX_VALUE?l("primary"):Math.max(p,0)},l=p=>{var y,v;return(y=e.primaryDetails)!=null&&y.live?e.primaryDetails.edge:((v=e.schedule)==null?void 0:v.durations[p])||0},d=(p,y)=>{var v,E;const b=e.effectivePlayingItem;if(b!=null&&(v=b.event)!=null&&v.restrictions.skip||!e.schedule)return;e.log(`seek to ${p} "${y}"`);const T=e.effectivePlayingItem,I=e.schedule.findItemIndexAtTime(p,y),N=(E=e.schedule.items)==null?void 0:E[I],A=e.getBufferingPlayer(),L=A==null?void 0:A.interstitial,P=L==null?void 0:L.appendInPlace,k=T&&e.itemsMatch(T,N);if(T&&(P||k)){const D=n(e.playingAsset),O=(D==null?void 0:D.media)||e.primaryMedia;if(O){const F=y==="primary"?O.currentTime:s(T,y,e.playingAsset,"timelinePos","currentTime"),$=p-F,G=(P?F:O.currentTime)+$;if(G>=0&&(!D||P||G<=D.duration)){O.currentTime=G;return}}}if(N){let D=p;if(y!=="primary"){const F=N[y].start,$=p-F;D=N.start+$}const O=!e.isInterstitial(N);if((!e.isInterstitial(T)||T.event.appendInPlace)&&(O||N.event.appendInPlace)){const F=e.media||(P?A==null?void 0:A.media:null);F&&(F.currentTime=D)}else if(T){const F=e.findItemIndex(T);if(I>F){const G=e.schedule.findJumpRestrictedIndex(F+1,I);if(G>F){e.setSchedulePosition(G);return}}let $=0;if(O)e.timelinePos=D,e.checkBuffer();else{const G=N.event.assetList,Y=p-(N[y]||N).start;for(let ne=G.length;ne--;){const X=G[ne];if(X.duration&&Y>=X.startOffset&&Y<X.startOffset+X.duration){$=ne;break}}}e.setSchedulePosition(I,$)}}},u=()=>{const p=e.effectivePlayingItem;if(e.isInterstitial(p))return p;const y=r();return e.isInterstitial(y)?y:null},f={get bufferedEnd(){const p=r(),y=e.bufferingItem;if(y&&y===p){var v;return s(y,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-y.playout.start||((v=e.bufferingAsset)==null?void 0:v.startOffset)||0}return 0},get currentTime(){const p=u(),y=e.effectivePlayingItem;return y&&y===p?s(y,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-y.playout.start:0},set currentTime(p){const y=u(),v=e.effectivePlayingItem;v&&v===y&&d(p+v.playout.start,"playout")},get duration(){const p=u();return p?p.playout.end-p.playout.start:0},get assetPlayers(){var p;const y=(p=u())==null?void 0:p.event.assetList;return y?y.map(v=>e.getAssetPlayer(v.identifier)):[]},get playingIndex(){var p;const y=(p=u())==null?void 0:p.event;return y&&e.effectivePlayingAsset?y.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};return this.manager={get events(){var p;return((p=e.schedule)==null||(p=p.events)==null?void 0:p.slice(0))||[]},get schedule(){var p;return((p=e.schedule)==null||(p=p.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return u()?f:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return r()},get bufferingIndex(){const p=r();return e.findItemIndex(p)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const p=e.effectivePlayingItem;return e.findItemIndex(p)},primary:{get bufferedEnd(){return a()},get currentTime(){const p=e.timelinePos;return p>0?p:0},set currentTime(p){d(p,"primary")},get duration(){return l("primary")},get seekableStart(){var p;return((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(r(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(p){d(p,"integrated")},get duration(){return l("integrated")},get seekableStart(){var p;return i(((p=e.primaryDetails)==null?void 0:p.fragmentStart)||0,"integrated")}},skip:()=>{const p=e.effectivePlayingItem,y=p==null?void 0:p.event;if(y&&!y.restrictions.skip){const v=e.findItemIndex(p);if(y.appendInPlace){const E=p.playout.start+p.event.duration;d(E+.001,"playout")}else e.advanceAfterAssetEnded(y,v,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const r=this.playingItem,n=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!r||!n?!1:this.findItemIndex(r)===n.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,r;if(this.mediaSelection===null)return;const n=this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&!n.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(s=this.primaryMedia);const i=(r=s)==null?void 0:r.currentTime;if(!(i===void 0||!Ve(i)))return i}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,r){const n=this.getAssetPlayer(e);n&&this.transferMediaFromPlayer(n,r)}transferMediaFromPlayer(e,r){const n=e.interstitial.appendInPlace,s=e.media;if(n&&s===this.primaryMedia){if(this.bufferingAsset=null,(!r||this.isInterstitial(r)&&!r.event.appendInPlace)&&r&&s){this.detachedData={media:s};return}const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${qt(i)}`),this.detachedData=i}else r&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,r){var n,s;if(e.media===r)return;let i=null;const a=this.hls,l=e!==a,d=l&&e.interstitial.appendInPlace,u=(n=this.detachedData)==null?void 0:n.mediaSource;let f;if(a.media)d&&(i=a.transferMedia(),this.detachedData=i),f="Primary";else if(u){const E=this.getBufferingPlayer();E?(i=E.transferMedia(),f=`${E}`):f="detached MediaSource"}else f="detached media";if(!i){if(u)i=this.detachedData,this.log(`using detachedData: MediaSource ${qt(i)}`);else if(!this.detachedData||a.media===r){const E=this.playerQueue;E.length>1&&E.forEach(b=>{if(l&&b.interstitial.appendInPlace!==d){const T=b.interstitial;this.clearInterstitial(b.interstitial,null),T.appendInPlace=!1,T.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${T}`)}}),this.hls.detachMedia(),this.detachedData={media:r}}}const p=i&&"mediaSource"in i&&((s=i.mediaSource)==null?void 0:s.readyState)!=="closed",y=p&&i?i:r;this.log(`${p?"transfering MediaSource":"attaching media"} to ${l?e:"Primary"} from ${f} (media.currentTime: ${r.currentTime})`);const v=this.schedule;if(y===i&&v){const E=l&&e.assetId===v.assetIdAtEnd;y.overrides={duration:v.duration,endOfStream:!l||E,cueRemoval:!l}}e.attachMedia(y)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,r=e==null?void 0:e.events;if(!r||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const n=this.timelinePos,s=this.effectivePlayingItem;if(n===-1){const i=this.hls.startPosition;if(this.log(Am("checkStart",i)),this.timelinePos=i,r.length&&r[0].cue.pre){const a=e.findEventIndex(r[0].identifier);this.setSchedulePosition(a)}else if(i>=0||!this.primaryLive){const a=this.timelinePos=i>0?i:0,l=e.findItemIndexAtTime(a);this.setSchedulePosition(l)}}else if(s&&!this.playingItem){const i=e.findItemIndex(s);this.setSchedulePosition(i)}}advanceAssetBuffering(e,r){const n=e.event,s=n.findAssetIndex(r),i=N1(n,s);if(!n.isAssetPastPlayoutLimit(i))this.bufferedToEvent(e,i);else if(this.schedule){var a;const l=(a=this.schedule.items)==null?void 0:a[this.findItemIndex(e)+1];l&&this.bufferedToItem(l)}}advanceAfterAssetEnded(e,r,n){const s=N1(e,n);if(e.isAssetPastPlayoutLimit(s)){if(this.schedule){const i=this.schedule.items;if(i){const a=r+1,l=i.length;if(a>=l){this.setSchedulePosition(-1);return}const d=e.resumeTime;this.timelinePos<d&&(this.log(Am("advanceAfterAssetEnded",d)),this.timelinePos=d,e.appendInPlace&&this.advanceInPlace(d),this.checkBuffer(this.bufferedPos<d)),this.setSchedulePosition(a)}}}else{if(e.appendInPlace){const i=e.assetList[s];i&&this.advanceInPlace(i.timelineStart)}this.setSchedulePosition(r,s)}}setScheduleToAssetAtTime(e,r){const n=this.schedule;if(!n)return;const s=r.parentIdentifier,i=n.getEvent(s);if(i){const a=n.findEventIndex(s),l=n.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,a,l-1)}}setSchedulePosition(e,r){var n;const s=(n=this.schedule)==null?void 0:n.items;if(!s||this.playbackDisabled)return;const i=e>=0?s[e]:null;this.log(`setSchedulePosition ${e}, ${r} (${i&&hi(i)}) pos: ${this.timelinePos}`);const a=this.waitingItem||this.playingItem,l=this.playingLastItem;if(this.isInterstitial(a)){const f=a.event,p=this.playingAsset,y=p==null?void 0:p.identifier,v=y?this.getAssetPlayer(y):null;if(v&&y&&(!this.eventItemsMatch(a,i)||r!==void 0&&y!==f.assetList[r].identifier)){var d;const E=f.findAssetIndex(p);if(this.log(`INTERSTITIAL_ASSET_ENDED ${E+1}/${f.assetList.length} ${Rc(p)}`),this.endedAsset=p,this.playingAsset=null,this.hls.trigger(M.INTERSTITIAL_ASSET_ENDED,{asset:p,assetListIndex:E,event:f,schedule:s.slice(0),scheduleIndex:e,player:v}),a!==this.playingItem){this.itemsMatch(a,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(f,this.findItemIndex(this.playingItem),E);return}this.retreiveMediaSource(y,i),v.media&&!((d=this.detachedData)!=null&&d.mediaSource)&&v.detachMedia()}if(!this.eventItemsMatch(a,i)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${f} ${hi(a)}`),f.hasPlayed=!0,this.hls.trigger(M.INTERSTITIAL_ENDED,{event:f,schedule:s.slice(0),scheduleIndex:e}),f.cue.once)){var u;this.updateSchedule();const E=(u=this.schedule)==null?void 0:u.items;if(i&&E){const b=this.findItemIndex(i);this.advanceSchedule(b,E,r,a,l)}return}}this.advanceSchedule(e,s,r,a,l)}advanceSchedule(e,r,n,s,i){const a=this.schedule;if(!a)return;const l=r[e]||null,d=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach(f=>{const p=f.interstitial,y=a.findEventIndex(p.identifier);(y<e||y>e+1)&&this.clearInterstitial(p,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);const f=l.event;if(n===void 0){n=a.findAssetIndex(f,this.timelinePos);const E=N1(f,n-1);if(f.isAssetPastPlayoutLimit(E)||f.appendInPlace&&this.timelinePos===l.end){this.advanceAfterAssetEnded(f,e,n);return}n=E}const p=this.waitingItem;this.assetsBuffered(l,d)||this.setBufferingItem(l);let y=this.preloadAssets(f,n);if(this.eventItemsMatch(l,p||s)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${hi(l)} ${f.appendInPlace?"append in place":""}`),this.hls.trigger(M.INTERSTITIAL_STARTED,{event:f,schedule:r.slice(0),scheduleIndex:e})),!f.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${f}`);return}if(f.assetListLoader&&(f.assetListLoader.destroy(),f.assetListLoader=void 0),!d){this.log(`Waiting for attachMedia to start Interstitial ${f}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;const v=f.assetList[n];if(!v){this.advanceAfterAssetEnded(f,e,n||0);return}if(y||(y=this.getAssetPlayer(v.identifier)),y===null||y.destroyed){const E=f.assetList.length;this.warn(`asset ${n+1}/${E} player destroyed ${f}`),y=this.createAssetPlayer(f,v,n),y.loadSource()}if(!this.eventItemsMatch(l,this.bufferingItem)&&f.appendInPlace&&this.isAssetBuffered(v))return;this.startAssetPlayer(y,n,r,e,d),this.shouldPlay&&DN(y.media)}else l?(this.resumePrimary(l,e,s),this.shouldPlay&&DN(this.hls.media)):i&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(a.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,r,n){var s,i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${hi(e)}`),!((s=this.detachedData)!=null&&s.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,r),this.log(Am("resumePrimary",l)),this.timelinePos=l),this.attachPrimary(l,e)}if(!n)return;const a=(i=this.schedule)==null?void 0:i.items;a&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${hi(e)}`),this.hls.trigger(M.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:r}),this.checkBuffer())}getPrimaryResumption(e,r){const n=e.start;if(this.primaryLive){const s=this.primaryDetails;if(r===0)return this.hls.startPosition;if(s&&(n<s.fragmentStart||n>s.edge))return this.hls.liveSyncPosition||-1}return n}isAssetBuffered(e){const r=this.getAssetPlayer(e.identifier);return r!=null&&r.hls?r.hls.bufferedToEnd:ht.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,r,n){r?this.setBufferingItem(r):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,s),n&&this.startLoadingPrimaryAt(e,n)),n||(this.log(Am("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,n))}startLoadingPrimaryAt(e,r){var n;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs((((n=s.mainForwardBufferInfo)==null?void 0:n.start)||s.media.currentTime)-e)>.5?s.startLoad(e,r):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(M.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(M.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,r){if(r.level===-1||!this.schedule)return;const n=this.hls.levels[r.level];if(!n.details)return;const s=$t($t({},this.mediaSelection||this.altSelection),{},{main:n});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,r){const n=this.hls.audioTracks[r.id],s=this.mediaSelection;if(!s){this.altSelection=$t($t({},this.altSelection),{},{audio:n});return}const i=$t($t({},s),{},{audio:n});this.mediaSelection=i}onSubtitleTrackUpdated(e,r){const n=this.hls.subtitleTracks[r.id],s=this.mediaSelection;if(!s){this.altSelection=$t($t({},this.altSelection),{},{subtitles:n});return}const i=$t($t({},s),{},{subtitles:n});this.mediaSelection=i}onAudioTrackSwitching(e,r){const n=VA(r);this.playerQueue.forEach(({hls:s})=>s&&(s.setAudioOption(r)||s.setAudioOption(n)))}onSubtitleTrackSwitch(e,r){const n=VA(r);this.playerQueue.forEach(({hls:s})=>s&&(s.setSubtitleOption(r)||r.id!==-1&&s.setSubtitleOption(n)))}onBufferCodecs(e,r){const n=r.tracks;n&&(this.requiredTracks=n)}onBufferAppended(e,r){this.checkBuffer()}onBufferFlushed(e,r){const n=this.playingItem;if(n&&!this.itemsMatch(n,this.bufferingItem)&&!this.isInterstitial(n)){const s=this.timelinePos;this.bufferedPos=s,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;const r=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&r){for(let s=0;s<r.length;s++){const i=r[s];if(i.cue.post){var n;const a=this.schedule.findEventIndex(i.identifier),l=(n=this.schedule.items)==null?void 0:n[a];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const r=this.playingItem;if(!this.playingLastItem&&r){const n=this.findItemIndex(r);this.setSchedulePosition(n+1)}else this.shouldPlay=!1}updateItem(e,r){var n;const s=(n=this.schedule)==null?void 0:n.items;if(e&&s){const i=this.findItemIndex(e,r);return s[i]||null}return null}trimInPlace(e,r){if(this.isInterstitial(e)&&e.event.appendInPlace&&r.end-e.end>.25){e.event.assetList.forEach((i,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(i.identifier,null)});const n=e.end+.25,s=ht.bufferInfo(this.primaryMedia,n,0);(s.end>n||(s.nextStart||0)>n)&&(this.log(`trim buffered interstitial ${hi(e)} (was ${hi(r)})`),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}itemsMatch(e,r){return!!r&&(e===r||e.event&&r.event&&this.eventItemsMatch(e,r)||!e.event&&!r.event&&this.findItemIndex(e)===this.findItemIndex(r))}eventItemsMatch(e,r){var n;return!!r&&(e===r||e.event.identifier===((n=r.event)==null?void 0:n.identifier))}findItemIndex(e,r){return e&&this.schedule?this.schedule.findItemIndex(e,r):-1}updateSchedule(e=!1){var r;const n=this.mediaSelection;n&&((r=this.schedule)==null||r.updateSchedule(n,[],e))}checkBuffer(e){var r;const n=(r=this.schedule)==null?void 0:r.items;if(!n)return;const s=ht.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=s.len<1),this.updateBufferedPos(s.end,n,e)}updateBufferedPos(e,r,n){const s=this.schedule,i=this.bufferingItem;if(this.bufferedPos>e||!s)return;if(r.length===1&&this.itemsMatch(r[0],i)){this.bufferedPos=e;return}const a=this.playingItem,l=this.findItemIndex(a);let d=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var u;const f=this.findItemIndex(i),p=Math.min(f+1,r.length-1),y=r[p];if((d===-1&&i&&e>=i.end||(u=y.event)!=null&&u.appendInPlace&&e+.01>=y.start)&&(d=p),this.isInterstitial(i)){const v=i.event;if(p-l>1&&v.appendInPlace===!1||v.assetList.length===0&&v.assetListLoader)return}if(this.bufferedPos=e,d>f&&d>l)this.bufferedToItem(y);else{const v=this.primaryDetails;this.primaryLive&&v&&e>v.edge-v.targetduration&&y.start<v.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(y)&&this.preloadAssets(y.event,0)}}else n&&a&&!this.itemsMatch(a,i)&&(d===l?this.bufferedToItem(a):d===l+1&&this.bufferedToItem(r[d]))}assetsBuffered(e,r){return e.event.assetList.length===0?!1:!e.event.assetList.some(s=>{const i=this.getAssetPlayer(s.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(r))})}setBufferingItem(e){const r=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,r)&&n){const{items:s,events:i}=n;if(!s||!i)return r;const a=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const d=l?l.remaining:r?r.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${hi(e)}`+(r?` (${d.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(a){const u=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((f,p)=>{const y=this.getAssetPlayer(f.identifier);y&&(p===u&&y.loadSource(),y.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering());this.hls.trigger(M.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:i.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return r}bufferedToItem(e,r=0){const n=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,r);else if(n!==null){this.bufferingAsset=null;const s=this.detachedData;s?s.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const r=this.findItemIndex(e),n=this.getPrimaryResumption(e,r);this.startLoadingPrimaryAt(n)}bufferedToEvent(e,r){const n=e.event,s=n.assetList.length===0&&!n.assetListLoader,i=n.cue.once;if(s||!i){const a=this.preloadAssets(n,r);if(a!=null&&a.interstitial.appendInPlace){const l=this.primaryMedia;l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,r){const n=e.assetUrl,s=e.assetList.length,i=s===0&&!e.assetListLoader,a=e.cue.once;if(i){const d=e.timelineStart;if(e.appendInPlace){var l;const y=this.playingItem;!this.isInterstitial(y)&&(y==null||(l=y.nextEvent)==null?void 0:l.identifier)===e.identifier&&this.flushFrontBuffer(d+.25)}let u,f=0;if(!this.playingItem&&this.primaryLive&&(f=this.hls.startPosition,f===-1&&(f=this.hls.liveSyncPosition||0)),f&&!(e.cue.pre||e.cue.post)){const y=f-d;y>0&&(u=Math.round(y*1e3)/1e3)}if(this.log(`Load interstitial asset ${r+1}/${n?1:s} ${e}${u?` live-start: ${f} start-offset: ${u}`:""}`),n)return this.createAsset(e,0,0,d,e.duration,n);const p=this.assetListLoader.loadAssetList(e,u);p&&(e.assetListLoader=p)}else if(!a&&s){for(let u=r;u<s;u++){const f=e.assetList[u],p=this.getAssetPlayerQueueIndex(f.identifier);(p===-1||this.playerQueue[p].destroyed)&&!f.error&&this.createAssetPlayer(e,f,u)}const d=e.assetList[r];if(d){const u=this.getAssetPlayer(d.identifier);return u&&u.loadSource(),u}}return null}flushFrontBuffer(e){const r=this.requiredTracks;if(!r)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(r).forEach(s=>{this.hls.trigger(M.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:s})})}getAssetPlayerQueueIndex(e){const r=this.playerQueue;for(let n=0;n<r.length;n++)if(e===r[n].assetId)return n;return-1}getAssetPlayer(e){const r=this.getAssetPlayerQueueIndex(e);return this.playerQueue[r]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:r}=this;if(r){for(let n=0;n<e.length;n++)if(e[n].media===r)return e[n]}return null}createAsset(e,r,n,s,i,a){const l={parentIdentifier:e.identifier,identifier:gne(e,a,r),duration:i,startOffset:n,timelineStart:s,uri:a};return this.createAssetPlayer(e,l,r)}createAssetPlayer(e,r,n){const s=this.hls,i=s.userConfig;let a=i.videoPreference;const l=s.loadLevelObj||s.levels[s.currentLevel];(a||l)&&(a=zt({},a),l.videoCodec&&(a.videoCodec=l.videoCodec),l.videoRange&&(a.allowedVideoRanges=[l.videoRange]));const d=s.audioTracks[s.audioTrack],u=s.subtitleTracks[s.subtitleTrack];let f=0;if(this.primaryLive||e.appendInPlace){const L=this.timelinePos-r.timelineStart;if(L>1){const P=r.duration;P&&L<P&&(f=L)}}const p=r.identifier,y=$t($t({},i),{},{maxMaxBufferLength:Math.min(180,s.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:p,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:f,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:d||i.audioPreference,subtitlePreference:u||i.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,r.timelineStart&&(y.timelineOffset=r.timelineStart));const v=y.cmcd;v!=null&&v.sessionId&&v.contentId&&(y.cmcd=zt({},v,{contentId:th(r.uri)})),this.getAssetPlayer(p)&&this.warn(`Duplicate date range identifier ${e} and asset ${p}`);const E=new vne(this.HlsPlayerClass,y,e,r);this.playerQueue.push(E),e.assetList[n]=r;let b=!0;const T=L=>{if(L.live){var P;const O=new Error(`Interstitials MUST be VOD assets ${e}`),F={fatal:!0,type:Qe.OTHER_ERROR,details:ue.INTERSTITIAL_ASSET_ITEM_ERROR,error:O},$=((P=this.schedule)==null?void 0:P.findEventIndex(e.identifier))||-1;this.handleAssetItemError(F,e,$,n,O.message);return}const k=L.edge-L.fragmentStart,D=r.duration;(b||D===null||k>D)&&(b=!1,this.log(`Interstitial asset "${p}" duration change ${D} > ${k}`),r.duration=k,this.updateSchedule())};E.on(M.LEVEL_UPDATED,(L,{details:P})=>T(P)),E.on(M.LEVEL_PTS_UPDATED,(L,{details:P})=>T(P)),E.on(M.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());const I=(L,P)=>{const k=this.getAssetPlayer(p);if(k&&P.tracks){k.off(M.BUFFER_CODECS,I),k.tracks=P.tracks;const D=this.primaryMedia;this.bufferingAsset===k.assetItem&&D&&!k.media&&this.bufferAssetPlayer(k,D)}};E.on(M.BUFFER_CODECS,I);const N=()=>{var L;const P=this.getAssetPlayer(p);if(this.log(`buffered to end of asset ${P}`),!P||!this.schedule)return;const k=this.schedule.findEventIndex(e.identifier),D=(L=this.schedule.items)==null?void 0:L[k];this.isInterstitial(D)&&this.advanceAssetBuffering(D,r)};E.on(M.BUFFERED_TO_END,N);const A=L=>()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;this.shouldPlay=!0;const k=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,k,L)};return E.once(M.MEDIA_ENDED,A(n)),E.once(M.PLAYOUT_LIMIT_REACHED,A(1/0)),E.on(M.ERROR,(L,P)=>{if(!this.schedule)return;const k=this.getAssetPlayer(p);if(P.details===ue.BUFFER_STALLED_ERROR){if(k!=null&&k.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(P,e,this.schedule.findEventIndex(e.identifier),n,`Asset player error ${P.error} ${e}`)}),E.on(M.DESTROYING,()=>{if(!this.getAssetPlayer(p)||!this.schedule)return;const P=new Error(`Asset player destroyed unexpectedly ${p}`),k={fatal:!0,type:Qe.OTHER_ERROR,details:ue.INTERSTITIAL_ASSET_ITEM_ERROR,error:P};this.handleAssetItemError(k,e,this.schedule.findEventIndex(e.identifier),n,P.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Rc(r)}`),this.hls.trigger(M.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:r,assetListIndex:n,event:e,player:E}),E}clearInterstitial(e,r){this.clearAssetPlayers(e,r),e.reset()}clearAssetPlayers(e,r){e.assetList.forEach(n=>{this.clearAssetPlayer(n.identifier,r)})}resetAssetPlayer(e){const r=this.getAssetPlayerQueueIndex(e);if(r!==-1){this.log(`reset asset player "${e}" after error`);const n=this.playerQueue[r];this.transferMediaFromPlayer(n,null),n.resetDetails()}}clearAssetPlayer(e,r){const n=this.getAssetPlayerQueueIndex(e);if(n!==-1){const s=this.playerQueue[n];this.log(`clear ${s} toSegment: ${r&&hi(r)}`),this.transferMediaFromPlayer(s,r),this.playerQueue.splice(n,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,r,n,s,i){const{interstitial:a,assetItem:l,assetId:d}=e,u=a.assetList.length,f=this.playingAsset;this.endedAsset=null,this.playingAsset=l,(!f||f.identifier!==d)&&(f&&(this.clearAssetPlayer(f.identifier,n[s]),delete f.error),this.log(`INTERSTITIAL_ASSET_STARTED ${r+1}/${u} ${Rc(l)}`),this.hls.trigger(M.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:r,event:a,schedule:n.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,i)}bufferAssetPlayer(e,r){var n,s;if(!this.schedule)return;const{interstitial:i,assetItem:a}=e,l=this.schedule.findEventIndex(i.identifier),d=(n=this.schedule.items)==null?void 0:n[l];if(!d)return;e.loadSource(),this.setBufferingItem(d),this.bufferingAsset=a;const u=this.getBufferingPlayer();if(u===e)return;const f=i.appendInPlace;if(f&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const p=(u==null?void 0:u.tracks)||((s=this.detachedData)==null?void 0:s.tracks)||this.requiredTracks;if(f&&a!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(p&&!Tj(p,e.tracks)){const y=new Error(`Asset ${Rc(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(p)}')`),v={fatal:!0,type:Qe.OTHER_ERROR,details:ue.INTERSTITIAL_ASSET_ITEM_ERROR,error:y},E=i.findAssetIndex(a);this.handleAssetItemError(v,i,l,E,y.message);return}}this.transferMediaTo(e,r)}handleInPlaceStall(e){const r=this.schedule,n=this.primaryMedia;if(!r||!n)return;const s=n.currentTime,i=r.findAssetIndex(e,s),a=e.assetList[i];if(a){const l=this.getAssetPlayer(a.identifier);if(l){const d=l.currentTime||s-a.timelineStart,u=l.duration-d;if(this.warn(`Stalled at ${d} of ${d+u} in ${l} ${e} (media.currentTime: ${s})`),d&&(u/n.playbackRate<.5||l.bufferedInPlaceToEnd(n))&&l.hls){const f=r.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,f,i)}}}}advanceInPlace(e){const r=this.primaryMedia;r&&r.currentTime<e&&(r.currentTime=e)}handleAssetItemError(e,r,n,s,i){if(e.details===ue.BUFFER_STALLED_ERROR)return;const a=r.assetList[s]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&Rc(a)} ${e.error}`),!this.schedule)return;const l=(a==null?void 0:a.identifier)||"",d=this.getAssetPlayerQueueIndex(l),u=this.playerQueue[d]||null,f=this.schedule.items,p=zt({},e,{fatal:!1,errorAction:lu(!0),asset:a,assetListIndex:s,event:r,schedule:f,scheduleIndex:n,player:u});if(this.hls.trigger(M.INTERSTITIAL_ASSET_ERROR,p),!e.fatal)return;const y=this.playingAsset,v=this.bufferingAsset,E=new Error(i);if(a&&(this.clearAssetPlayer(l,null),a.error=E),!r.assetList.some(b=>!b.error))r.error=E;else for(let b=s;b<r.assetList.length;b++)this.resetAssetPlayer(r.assetList[b].identifier);this.updateSchedule(!0),r.error?this.primaryFallback(r):y&&y.identifier===l?this.advanceAfterAssetEnded(r,n,s):v&&v.identifier===l&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,v)}primaryFallback(e){const r=e.timelineStart,n=this.effectivePlayingItem;let s=this.timelinePos;if(n){this.log(`Fallback to primary from event "${e.identifier}" start: ${r} pos: ${s} playing: ${hi(n)} error: ${e.error}`),s===-1&&(s=this.hls.startPosition);const a=this.updateItem(n,s);this.itemsMatch(n,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(r,null),this.flushFrontBuffer(r))}else if(s===-1){this.checkStart();return}if(!this.schedule)return;const i=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(i)}onAssetListLoaded(e,r){var n,s;const i=r.event,a=i.identifier,l=r.assetListResponse.ASSETS;if(!((n=this.schedule)!=null&&n.hasEvent(a)))return;const d=i.timelineStart,u=i.duration;let f=0;l.forEach((b,T)=>{const I=parseFloat(b.DURATION);this.createAsset(i,T,f,d+f,I,b.URI),f+=I}),i.duration=f,this.log(`Loaded asset-list with duration: ${f} (was: ${u}) ${i}`);const p=this.waitingItem,y=(p==null?void 0:p.event.identifier)===a;this.updateSchedule();const v=(s=this.bufferingItem)==null?void 0:s.event;if(y){var E;const b=this.schedule.findEventIndex(a),T=(E=this.schedule.items)==null?void 0:E[b];if(T){if(!this.playingItem&&this.timelinePos>T.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==b){i.error=new Error(`Interstitial ${l.length?"no longer within playback range":"asset-list is empty"} ${this.timelinePos} ${i}`),this.log(i.error.message),this.updateSchedule(!0),this.primaryFallback(i);return}this.setBufferingItem(T)}this.setSchedulePosition(b)}else if((v==null?void 0:v.identifier)===a){const b=i.assetList[0];if(b){const T=this.getAssetPlayer(b.identifier);if(v.appendInPlace){const I=this.primaryMedia;T&&I&&this.bufferAssetPlayer(T,I)}else T&&T.loadSource()}}}onError(e,r){if(this.schedule)switch(r.details){case ue.ASSET_LIST_PARSING_ERROR:case ue.ASSET_LIST_LOAD_ERROR:case ue.ASSET_LIST_LOAD_TIMEOUT:{const n=r.interstitial;n&&(this.updateSchedule(!0),this.primaryFallback(n));break}case ue.BUFFER_STALLED_ERROR:{const n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace){this.handleInPlaceStall(n.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0);break}}}}const kN=500;class Sne extends XE{constructor(e,r,n){super(e,r,n,"subtitle-stream-controller",ze.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(M.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(M.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(M.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(M.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,r){this.stopLoad(),this.state=be.IDLE,this.setInterval(kN),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=r?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,r){this.tracksBuffered=[],super.onMediaDetaching(e,r)}onLevelLoaded(e,r){this.mainDetails=r.details}onSubtitleFragProcessed(e,r){const{frag:n,success:s}=r;if(this.fragContextChanged(n)||(Or(n)&&(this.fragPrevious=n),this.state=be.IDLE),!s)return;const i=this.tracksBuffered[this.currentTrackId];if(!i)return;let a;const l=n.start;for(let u=0;u<i.length;u++)if(l>=i[u].start&&l<=i[u].end){a=i[u];break}const d=n.start+n.duration;a?a.end=d:(a={start:l,end:d},i.push(a)),this.fragmentTracker.fragBuffered(n),this.fragBufferedComplete(n,null),this.media&&this.tick()}onBufferFlushing(e,r){const{startOffset:n,endOffset:s}=r;if(n===0&&s!==Number.POSITIVE_INFINITY){const i=s-1;if(i<=0)return;r.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach(a=>{for(let l=0;l<a.length;){if(a[l].end<=i){a.shift();continue}else if(a[l].start<i)a[l].start=i;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(n,i,ze.SUBTITLE)}}onError(e,r){const n=r.frag;(n==null?void 0:n.type)===ze.SUBTITLE&&(r.details===ue.FRAG_GAP&&this.fragmentTracker.fragBuffered(n,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==be.STOPPED&&(this.state=be.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:r}){if(this.levels&&NM(this.levels,r)){this.levels=r.map(n=>new Gh(n));return}this.tracksBuffered=[],this.levels=r.map(n=>{const s=new Gh(n);return this.tracksBuffered[s.id]=[],s}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,ze.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,r){var n;if(this.currentTrackId=r.id,!((n=this.levels)!=null&&n.length)||this.currentTrackId===-1){this.clearInterval();return}const s=this.levels[this.currentTrackId];s!=null&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==be.STOPPED&&this.setInterval(kN)}onSubtitleTrackLoaded(e,r){var n;const{currentTrackId:s,levels:i}=this,{details:a,id:l}=r;if(!i){this.warn(`Subtitle tracks were reset while loading level ${l}`);return}const d=i[l];if(l>=i.length||!d)return;this.log(`Subtitle track ${l} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(n=d.details)!=null&&n.live){if(a.deltaUpdateFailed)return;const p=this.mainDetails;if(!p){this.startFragRequested=!1;return}const y=p.fragments[0];if(!d.details)a.hasProgramDateTime&&p.hasProgramDateTime?(wp(a,p),u=a.fragmentStart):y&&(u=y.start,$v(a,u));else{var f;u=this.alignPlaylists(a,d.details,(f=this.levelLastLoaded)==null?void 0:f.details),u===0&&y&&(u=y.start,$v(a,u))}p&&!this.startFragRequested&&this.setStartPosition(p,u)}d.details=a,this.levelLastLoaded=d,l===s&&(this.hls.trigger(M.SUBTITLE_TRACK_UPDATED,{details:a,id:l,groupId:r.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===be.IDLE&&(Xl(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),d.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:r,payload:n}=e,s=r.decryptdata,i=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&s!=null&&s.key&&s.iv&&cu(s.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(n),s.key.buffer,s.iv.buffer,YE(s.method)).catch(l=>{throw i.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:r}),l}).then(l=>{const d=performance.now();i.trigger(M.FRAG_DECRYPTED,{frag:r,payload:l,stats:{tstart:a,tdecrypt:d}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=be.IDLE})}}doTick(){if(!this.media){this.state=be.IDLE;return}if(this.state===be.IDLE){const{currentTrackId:e,levels:r}=this,n=r==null?void 0:r[e];if(!n||!r.length||!n.details||this.waitForLive(n))return;const{config:s}=this,i=this.getLoadPosition(),a=ht.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,s.maxBufferHole),{end:l,len:d}=a,u=n.details,f=this.hls.maxBufferLength+u.levelTargetDuration;if(d>f)return;const p=u.fragments,y=p.length,v=u.edge;let E=null;const b=this.fragPrevious;if(l<v){const N=s.maxFragLookUpTolerance,A=l>v-N?0:N;E=Xl(b,p,Math.max(p[0].start,l),A),!E&&b&&b.start<p[0].start&&(E=p[0])}else E=p[y-1];if(E=this.filterReplacedPrimary(E,n.details),!E)return;const T=E.sn-u.startSN,I=p[T-1];if(I&&I.cc===E.cc&&this.fragmentTracker.getState(I)===en.NOT_LOADED&&(E=I),this.fragmentTracker.getState(E)===en.NOT_LOADED){const N=this.mapToInitFragWhenRequired(E);N&&this.loadFragment(N,n,l)}}}loadFragment(e,r,n){Or(e)?super.loadFragment(e,r,n):this._loadInitSegment(e,r)}get mediaBufferTimeRanges(){return new Tne(this.tracksBuffered[this.currentTrackId]||[])}}class Tne{constructor(e){this.buffered=void 0;const r=(n,s,i)=>{if(s=s>>>0,s>i-1)throw new DOMException(`Failed to execute '${n}' on 'TimeRanges': The index provided (${s}) is greater than the maximum bound (${i})`);return e[s][n]};this.buffered={get length(){return e.length},end(n){return r("end",n,e.length)},start(n){return r("start",n,e.length)}}}}const Cne={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},GM=t=>String.fromCharCode(Cne[t]||t),pi=15,pa=100,Ane={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Nne={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ine={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Rne={25:2,26:4,29:6,30:8,31:10,27:13,28:15},_ne=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Lne{constructor(){this.time=null,this.verboseLevel=0}log(e,r){if(this.verboseLevel>=e){const n=typeof r=="function"?r():r;Vt.log(`${this.time} [${e}] ${n}`)}}}const ol=function(e){const r=[];for(let n=0;n<e.length;n++)r.push(e[n].toString(16));return r};class HM{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const r=["foreground","underline","italics","background","flash"];for(let n=0;n<r.length;n++){const s=r[n];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Pne{constructor(){this.uchar=" ",this.penState=new HM}reset(){this.uchar=" ",this.penState.reset()}setChar(e,r){this.uchar=e,this.penState.copy(r)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Dne{constructor(e){this.chars=[],this.pos=0,this.currPenState=new HM,this.cueStartTime=null,this.logger=void 0;for(let r=0;r<pa;r++)this.chars.push(new Pne);this.logger=e}equals(e){for(let r=0;r<pa;r++)if(!this.chars[r].equals(e.chars[r]))return!1;return!0}copy(e){for(let r=0;r<pa;r++)this.chars[r].copy(e.chars[r])}isEmpty(){let e=!0;for(let r=0;r<pa;r++)if(!this.chars[r].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>pa&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=pa)}moveCursor(e){const r=this.pos+e;if(e>1)for(let n=this.pos+1;n<r+1;n++)this.chars[n].setPenState(this.currPenState);this.setCursor(r)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const r=GM(e);if(this.pos>=pa){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+r+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1)}clearFromPos(e){let r;for(r=e;r<pa;r++)this.chars[r].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let r=!0;for(let n=0;n<pa;n++){const s=this.chars[n].uchar;s!==" "&&(r=!1),e.push(s)}return r?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class I1{constructor(e){this.rows=[],this.currRow=pi-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let r=0;r<pi;r++)this.rows.push(new Dne(e));this.logger=e}reset(){for(let e=0;e<pi;e++)this.rows[e].clear();this.currRow=pi-1}equals(e){let r=!0;for(let n=0;n<pi;n++)if(!this.rows[n].equals(e.rows[n])){r=!1;break}return r}copy(e){for(let r=0;r<pi;r++)this.rows[r].copy(e.rows[r])}isEmpty(){let e=!0;for(let r=0;r<pi;r++)if(!this.rows[r].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+qt(e));let r=e.row-1;if(this.nrRollUpRows&&r<this.nrRollUpRows-1&&(r=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==r){for(let l=0;l<pi;l++)this.rows[l].clear();const i=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const l=a.rows[i].cueStartTime,d=this.logger.time;if(l!==null&&d!==null&&l<d)for(let u=0;u<this.nrRollUpRows;u++)this.rows[r-this.nrRollUpRows+u+1].copy(a.rows[i+u])}}this.currRow=r;const n=this.rows[this.currRow];if(e.indent!==null){const i=e.indent,a=Math.max(i-1,0);n.setCursor(e.indent),e.color=n.chars[a].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+qt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(e,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const r=[];let n="",s=-1;for(let i=0;i<pi;i++){const a=this.rows[i].getTextString();a&&(s=i+1,e?r.push("Row "+s+": '"+a+"'"):r.push(a.trim()))}return r.length>0&&(e?n="["+r.join(" | ")+"]":n=r.join(`
`)),n}getTextAndFormat(){return this.rows}}class jN{constructor(e,r,n){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new I1(n),this.nonDisplayedMemory=new I1(n),this.lastOutputScreen=new I1(n),this.currRollUpRow=this.displayedMemory.rows[pi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[pi-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let n=0;n<e.length;n++)this.writeScreen.insertChar(e[n]);const r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>r+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const r={flash:!1};if(r.underline=e%2===1,r.italics=e>=46,r.italics)r.foreground="white";else{const n=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];r.foreground=s[n]}this.logger.log(2,"MIDROW: "+qt(r)),this.writeScreen.setPen(r)}outputDataUpdate(e=!1){const r=this.logger.time;r!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=r:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,r,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:r),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class MN{constructor(e,r,n){this.channels=void 0,this.currentChannel=0,this.cmdHistory=jne(),this.logger=void 0;const s=this.logger=new Lne;this.channels=[null,new jN(e,r,s),new jN(e+1,n,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,r){this.channels[e].setHandler(r)}addData(e,r){this.logger.time=e;for(let n=0;n<r.length;n+=2){const s=r[n]&127,i=r[n+1]&127;let a=!1,l=null;if(s===0&&i===0)continue;this.logger.log(3,()=>"["+ol([r[n],r[n+1]])+"] -> ("+ol([s,i])+")");const d=this.cmdHistory;if(s>=16&&s<=31){if(kne(s,i,d)){Nm(null,null,d),this.logger.log(3,()=>"Repeated command ("+ol([s,i])+") is dropped");continue}Nm(s,i,this.cmdHistory),a=this.parseCmd(s,i),a||(a=this.parseMidrow(s,i)),a||(a=this.parsePAC(s,i)),a||(a=this.parseBackgroundAttributes(s,i))}else Nm(null,null,d);if(!a&&(l=this.parseChars(s,i),l)){const f=this.currentChannel;f&&f>0?this.channels[f].insertChars(l):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!l&&this.logger.log(2,()=>"Couldn't parse cleaned data "+ol([s,i])+" orig: "+ol([r[n],r[n+1]]))}}parseCmd(e,r){const n=(e===20||e===28||e===21||e===29)&&r>=32&&r<=47,s=(e===23||e===31)&&r>=33&&r<=35;if(!(n||s))return!1;const i=e===20||e===21||e===23?1:2,a=this.channels[i];return e===20||e===21||e===28||e===29?r===32?a.ccRCL():r===33?a.ccBS():r===34?a.ccAOF():r===35?a.ccAON():r===36?a.ccDER():r===37?a.ccRU(2):r===38?a.ccRU(3):r===39?a.ccRU(4):r===40?a.ccFON():r===41?a.ccRDC():r===42?a.ccTR():r===43?a.ccRTD():r===44?a.ccEDM():r===45?a.ccCR():r===46?a.ccENM():r===47&&a.ccEOC():a.ccTO(r-32),this.currentChannel=i,!0}parseMidrow(e,r){let n=0;if((e===17||e===25)&&r>=32&&r<=47){if(e===17?n=1:n=2,n!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[n];return s?(s.ccMIDROW(r),this.logger.log(3,()=>"MIDROW ("+ol([e,r])+")"),!0):!1}return!1}parsePAC(e,r){let n;const s=(e>=17&&e<=23||e>=25&&e<=31)&&r>=64&&r<=127,i=(e===16||e===24)&&r>=64&&r<=95;if(!(s||i))return!1;const a=e<=23?1:2;r>=64&&r<=95?n=a===1?Ane[e]:Ine[e]:n=a===1?Nne[e]:Rne[e];const l=this.channels[a];return l?(l.setPAC(this.interpretPAC(n,r)),this.currentChannel=a,!0):!1}interpretPAC(e,r){let n;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return r>95?n=r-96:n=r-64,s.underline=(n&1)===1,n<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(n/2)]:n<=15?(s.italics=!0,s.color="white"):s.indent=Math.floor((n-16)/2)*4,s}parseChars(e,r){let n,s=null,i=null;if(e>=25?(n=2,i=e-8):(n=1,i=e),i>=17&&i<=19){let a;i===17?a=r+80:i===18?a=r+112:a=r+144,this.logger.log(2,()=>"Special char '"+GM(a)+"' in channel "+n),s=[a]}else e>=32&&e<=127&&(s=r===0?[e]:[e,r]);return s&&this.logger.log(3,()=>"Char codes =  "+ol(s).join(",")),s}parseBackgroundAttributes(e,r){const n=(e===16||e===24)&&r>=32&&r<=47,s=(e===23||e===31)&&r>=45&&r<=47;if(!(n||s))return!1;let i;const a={};e===16||e===24?(i=Math.floor((r-32)/2),a.background=_ne[i],r%2===1&&(a.background=a.background+"_semi")):r===45?a.background="transparent":(a.foreground="black",r===47&&(a.underline=!0));const l=e<=23?1:2;return this.channels[l].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const r=this.channels[e];r&&r.reset()}Nm(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let r=0;r<this.channels.length;r++){const n=this.channels[r];n&&n.cueSplitAtTime(e)}}}function Nm(t,e,r){r.a=t,r.b=e}function kne(t,e,r){return r.a===t&&r.b===e}function jne(){return{a:null,b:null}}var l2=function(){if(vp!=null&&vp.VTTCue)return self.VTTCue;const t=["","lr","rl"],e=["start","middle","end","left","right"];function r(l,d){if(typeof d!="string"||!Array.isArray(l))return!1;const u=d.toLowerCase();return~l.indexOf(u)?u:!1}function n(l){return r(t,l)}function s(l){return r(e,l)}function i(l,...d){let u=1;for(;u<arguments.length;u++){const f=arguments[u];for(const p in f)l[p]=f[p]}return l}function a(l,d,u){const f=this,p={enumerable:!0};f.hasBeenReset=!1;let y="",v=!1,E=l,b=d,T=u,I=null,N="",A=!0,L="auto",P="start",k=50,D="middle",O=50,F="middle";Object.defineProperty(f,"id",i({},p,{get:function(){return y},set:function($){y=""+$}})),Object.defineProperty(f,"pauseOnExit",i({},p,{get:function(){return v},set:function($){v=!!$}})),Object.defineProperty(f,"startTime",i({},p,{get:function(){return E},set:function($){if(typeof $!="number")throw new TypeError("Start time must be set to a number.");E=$,this.hasBeenReset=!0}})),Object.defineProperty(f,"endTime",i({},p,{get:function(){return b},set:function($){if(typeof $!="number")throw new TypeError("End time must be set to a number.");b=$,this.hasBeenReset=!0}})),Object.defineProperty(f,"text",i({},p,{get:function(){return T},set:function($){T=""+$,this.hasBeenReset=!0}})),Object.defineProperty(f,"region",i({},p,{get:function(){return I},set:function($){I=$,this.hasBeenReset=!0}})),Object.defineProperty(f,"vertical",i({},p,{get:function(){return N},set:function($){const G=n($);if(G===!1)throw new SyntaxError("An invalid or illegal string was specified.");N=G,this.hasBeenReset=!0}})),Object.defineProperty(f,"snapToLines",i({},p,{get:function(){return A},set:function($){A=!!$,this.hasBeenReset=!0}})),Object.defineProperty(f,"line",i({},p,{get:function(){return L},set:function($){if(typeof $!="number"&&$!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");L=$,this.hasBeenReset=!0}})),Object.defineProperty(f,"lineAlign",i({},p,{get:function(){return P},set:function($){const G=s($);if(!G)throw new SyntaxError("An invalid or illegal string was specified.");P=G,this.hasBeenReset=!0}})),Object.defineProperty(f,"position",i({},p,{get:function(){return k},set:function($){if($<0||$>100)throw new Error("Position must be between 0 and 100.");k=$,this.hasBeenReset=!0}})),Object.defineProperty(f,"positionAlign",i({},p,{get:function(){return D},set:function($){const G=s($);if(!G)throw new SyntaxError("An invalid or illegal string was specified.");D=G,this.hasBeenReset=!0}})),Object.defineProperty(f,"size",i({},p,{get:function(){return O},set:function($){if($<0||$>100)throw new Error("Size must be between 0 and 100.");O=$,this.hasBeenReset=!0}})),Object.defineProperty(f,"align",i({},p,{get:function(){return F},set:function($){const G=s($);if(!G)throw new SyntaxError("An invalid or illegal string was specified.");F=G,this.hasBeenReset=!0}})),f.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class Mne{decode(e,r){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function zM(t){function e(n,s,i,a){return(n|0)*3600+(s|0)*60+(i|0)+parseFloat(a||0)}const r=t.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?e(r[2],r[3],0,r[4]):e(r[1],r[2],r[3],r[4]):null}let One=class{constructor(){this.values=Object.create(null)}set(e,r){!this.get(e)&&r!==""&&(this.values[e]=r)}get(e,r,n){return n?this.has(e)?this.values[e]:r[n]:this.has(e)?this.values[e]:r}has(e){return e in this.values}alt(e,r,n){for(let s=0;s<n.length;++s)if(r===n[s]){this.set(e,r);break}}integer(e,r){/^-?\d+$/.test(r)&&this.set(e,parseInt(r,10))}percent(e,r){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(r)){const n=parseFloat(r);if(n>=0&&n<=100)return this.set(e,n),!0}return!1}};function WM(t,e,r,n){const s=n?t.split(n):[t];for(const i in s){if(typeof s[i]!="string")continue;const a=s[i].split(r);if(a.length!==2)continue;const l=a[0],d=a[1];e(l,d)}}const qv=new l2(0,0,""),Im=qv.align==="middle"?"middle":"center";function Fne(t,e,r){const n=t;function s(){const l=zM(t);if(l===null)throw new Error("Malformed timestamp: "+n);return t=t.replace(/^[^\sa-zA-Z-]+/,""),l}function i(l,d){const u=new One;WM(l,function(y,v){let E;switch(y){case"region":for(let b=r.length-1;b>=0;b--)if(r[b].id===v){u.set(y,r[b].region);break}break;case"vertical":u.alt(y,v,["rl","lr"]);break;case"line":E=v.split(","),u.integer(y,E[0]),u.percent(y,E[0])&&u.set("snapToLines",!1),u.alt(y,E[0],["auto"]),E.length===2&&u.alt("lineAlign",E[1],["start",Im,"end"]);break;case"position":E=v.split(","),u.percent(y,E[0]),E.length===2&&u.alt("positionAlign",E[1],["start",Im,"end","line-left","line-right","auto"]);break;case"size":u.percent(y,v);break;case"align":u.alt(y,v,["start",Im,"end","left","right"]);break}},/:/,/\s/),d.region=u.get("region",null),d.vertical=u.get("vertical","");let f=u.get("line","auto");f==="auto"&&qv.line===-1&&(f=-1),d.line=f,d.lineAlign=u.get("lineAlign","start"),d.snapToLines=u.get("snapToLines",!0),d.size=u.get("size",100),d.align=u.get("align",Im);let p=u.get("position","auto");p==="auto"&&qv.position===50&&(p=d.align==="start"||d.align==="left"?0:d.align==="end"||d.align==="right"?100:50),d.position=p}function a(){t=t.replace(/^\s+/,"")}if(a(),e.startTime=s(),a(),t.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);t=t.slice(3),a(),e.endTime=s(),a(),i(t,e)}function KM(t){return t.replace(/<br(?: \/)?>/gi,`
`)}class Bne{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Mne,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const r=this;e&&(r.buffer+=r.decoder.decode(e,{stream:!0}));function n(){let i=r.buffer,a=0;for(i=KM(i);a<i.length&&i[a]!=="\r"&&i[a]!==`
`;)++a;const l=i.slice(0,a);return i[a]==="\r"&&++a,i[a]===`
`&&++a,r.buffer=i.slice(a),l}function s(i){WM(i,function(a,l){},/:/)}try{let i="";if(r.state==="INITIAL"){if(!/\r\n|\n/.test(r.buffer))return this;i=n();const l=i.match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw new Error("Malformed WebVTT signature.");r.state="HEADER"}let a=!1;for(;r.buffer;){if(!/\r\n|\n/.test(r.buffer))return this;switch(a?a=!1:i=n(),r.state){case"HEADER":/:/.test(i)?s(i):i||(r.state="ID");continue;case"NOTE":i||(r.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){r.state="NOTE";break}if(!i)continue;if(r.cue=new l2(0,0,""),r.state="CUE",i.indexOf("-->")===-1){r.cue.id=i;continue}case"CUE":if(!r.cue){r.state="BADCUE";continue}try{Fne(i,r.cue,r.regionList)}catch{r.cue=null,r.state="BADCUE";continue}r.state="CUETEXT";continue;case"CUETEXT":{const l=i.indexOf("-->")!==-1;if(!i||l&&(a=!0)){r.oncue&&r.cue&&r.oncue(r.cue),r.cue=null,r.state="ID";continue}if(r.cue===null)continue;r.cue.text&&(r.cue.text+=`
`),r.cue.text+=i}continue;case"BADCUE":i||(r.state="ID")}}}catch{r.state==="CUETEXT"&&r.cue&&r.oncue&&r.oncue(r.cue),r.cue=null,r.state=r.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(r){e.onparsingerror&&e.onparsingerror(r)}return e.onflush&&e.onflush(),this}}const Une=/\r\n|\n\r|\n|\r/g,R1=function(e,r,n=0){return e.slice(n,n+r.length)===r},$ne=function(e){let r=parseInt(e.slice(-3));const n=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!Ve(r)||!Ve(n)||!Ve(s)||!Ve(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return r+=1e3*n,r+=60*1e3*s,r+=60*60*1e3*i,r};function c2(t,e,r){return th(t.toString())+th(e.toString())+th(r)}const Vne=function(e,r,n){let s=e[r],i=e[s.prevCC];if(!i||!i.new&&s.new){e.ccOffset=e.presentationOffset=s.start,s.new=!1;return}for(;(a=i)!=null&&a.new;){var a;e.ccOffset+=s.start-i.start,s.new=!1,s=i,i=e[s.prevCC]}e.presentationOffset=n};function Gne(t,e,r,n,s,i,a){const l=new Bne,d=_s(new Uint8Array(t)).trim().replace(Une,`
`).split(`
`),u=[],f=e?qte(e.baseTime,e.timescale):0;let p="00:00.000",y=0,v=0,E,b=!0;l.oncue=function(T){const I=r[n];let N=r.ccOffset;const A=(y-f)/9e4;if(I!=null&&I.new&&(v!==void 0?N=r.ccOffset=I.start:Vne(r,n,A)),A){if(!e){E=new Error("Missing initPTS for VTT MPEGTS");return}N=A-r.presentationOffset}const L=T.endTime-T.startTime,P=Es((T.startTime+N-v)*9e4,s*9e4)/9e4;T.startTime=Math.max(P,0),T.endTime=Math.max(P+L,0);const k=T.text.trim();T.text=decodeURIComponent(encodeURIComponent(k)),T.id||(T.id=c2(T.startTime,T.endTime,k)),T.endTime>0&&u.push(T)},l.onparsingerror=function(T){E=T},l.onflush=function(){if(E){a(E);return}i(u)},d.forEach(T=>{if(b)if(R1(T,"X-TIMESTAMP-MAP=")){b=!1,T.slice(16).split(",").forEach(I=>{R1(I,"LOCAL:")?p=I.slice(6):R1(I,"MPEGTS:")&&(y=parseInt(I.slice(7)))});try{v=$ne(p)/1e3}catch(I){E=I}return}else T===""&&(b=!1);l.parse(T+`
`)}),l.flush()}const _1="stpp.ttml.im1t",YM=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,qM=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Hne={left:"start",center:"center",right:"end",start:"start",end:"end"};function ON(t,e,r,n){const s=Tt(new Uint8Array(t),["mdat"]);if(s.length===0){n(new Error("Could not parse IMSC1 mdat"));return}const i=s.map(l=>_s(l)),a=Yte(e.baseTime,1,e.timescale);try{i.forEach(l=>r(zne(l,a)))}catch(l){n(l)}}function zne(t,e){const s=new DOMParser().parseFromString(t,"text/xml").getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const i={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(i).reduce((p,y)=>(p[y]=s.getAttribute(`ttp:${y}`)||i[y],p),{}),l=s.getAttribute("xml:space")!=="preserve",d=FN(L1(s,"styling","style")),u=FN(L1(s,"layout","region")),f=L1(s,"body","[begin]");return[].map.call(f,p=>{const y=XM(p,l);if(!y||!p.hasAttribute("begin"))return null;const v=D1(p.getAttribute("begin"),a),E=D1(p.getAttribute("dur"),a);let b=D1(p.getAttribute("end"),a);if(v===null)throw BN(p);if(b===null){if(E===null)throw BN(p);b=v+E}const T=new l2(v-e,b-e,y);T.id=c2(T.startTime,T.endTime,T.text);const I=u[p.getAttribute("region")],N=d[p.getAttribute("style")],A=Wne(I,N,d),{textAlign:L}=A;if(L){const P=Hne[L];P&&(T.lineAlign=P),T.align=L}return zt(T,A),T}).filter(p=>p!==null)}function L1(t,e,r){const n=t.getElementsByTagName(e)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function FN(t){return t.reduce((e,r)=>{const n=r.getAttribute("xml:id");return n&&(e[n]=r),e},{})}function XM(t,e){return[].slice.call(t.childNodes).reduce((r,n,s)=>{var i;return n.nodeName==="br"&&s?r+`
`:(i=n.childNodes)!=null&&i.length?XM(n,e):e?r+n.textContent.trim().replace(/\s+/g," "):r+n.textContent},"")}function Wne(t,e,r){const n="http://www.w3.org/ns/ttml#styling";let s=null;const i=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=t!=null&&t.hasAttribute("style")?t.getAttribute("style"):null;return a&&r.hasOwnProperty(a)&&(s=r[a]),i.reduce((l,d)=>{const u=P1(e,n,d)||P1(t,n,d)||P1(s,n,d);return u&&(l[d]=u),l},{})}function P1(t,e,r){return t&&t.hasAttributeNS(e,r)?t.getAttributeNS(e,r):null}function BN(t){return new Error(`Could not parse ttml timestamp ${t}`)}function D1(t,e){if(!t)return null;let r=zM(t);return r===null&&(YM.test(t)?r=Kne(t,e):qM.test(t)&&(r=Yne(t,e))),r}function Kne(t,e){const r=YM.exec(t),n=(r[4]|0)+(r[5]|0)/e.subFrameRate;return(r[1]|0)*3600+(r[2]|0)*60+(r[3]|0)+n/e.frameRate}function Yne(t,e){const r=qM.exec(t),n=Number(r[1]);switch(r[2]){case"h":return n*3600;case"m":return n*60;case"ms":return n*1e3;case"f":return n/e.frameRate;case"t":return n/e.tickRate}return n}class Rm{constructor(e,r){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=r}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,r,n){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=r,this.screen=n,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class qne{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=$N(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(M.FRAG_LOADING,this.onFragLoading,this),e.on(M.FRAG_LOADED,this.onFragLoaded,this),e.on(M.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(M.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(M.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(M.FRAG_LOADING,this.onFragLoading,this),e.off(M.FRAG_LOADED,this.onFragLoaded,this),e.off(M.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(M.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(M.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(M.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Rm(this,"textTrack1"),r=new Rm(this,"textTrack2"),n=new Rm(this,"textTrack3"),s=new Rm(this,"textTrack4");this.cea608Parser1=new MN(1,e,r),this.cea608Parser2=new MN(3,n,s)}addCues(e,r,n,s,i){let a=!1;for(let l=i.length;l--;){const d=i[l],u=Xne(d[0],d[1],r,n);if(u>=0&&(d[0]=Math.min(d[0],r),d[1]=Math.max(d[1],n),a=!0,u/(n-r)>.5))return}if(a||i.push([r,n]),this.config.renderTextTracksNatively){const l=this.captionsTracks[e];this.Cues.newCue(l,r,n,s)}else{const l=this.Cues.newCue(null,r,n,s);this.hls.trigger(M.CUES_PARSED,{type:"captions",cues:l,track:e})}}onInitPtsFound(e,{frag:r,id:n,initPTS:s,timescale:i,trackId:a}){const{unparsedVttFrags:l}=this;n===ze.MAIN&&(this.initPTS[r.cc]={baseTime:s,timescale:i,trackId:a}),l.length&&(this.unparsedVttFrags=[],l.forEach(d=>{this.initPTS[d.frag.cc]?this.onFragLoaded(M.FRAG_LOADED,d):this.hls.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:d.frag,error:new Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,r){const{media:n}=this;if(n)for(let s=0;s<n.textTracks.length;s++){const i=n.textTracks[s];if(UN(i,{name:e,lang:r,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:r,captionsTracks:n,media:s}=this,{label:i,languageCode:a}=r[e],l=this.getExistingTrack(i,a);if(l)n[e]=l,qc(n[e]),UM(n[e],s);else{const d=this.createTextTrack("captions",i,a);d&&(d[e]=!0,n[e]=d)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const r=this.captionsProperties[e];if(!r)return;const n=r.label,s={_id:e,label:n,kind:"captions",default:r.media?!!r.media.default:!1,closedCaptions:r.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(M.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}createTextTrack(e,r,n){const s=this.media;if(s)return s.addTextTrack(e,r,n)}onMediaAttaching(e,r){this.media=r.media,r.mediaSource||this._cleanTracks()}onMediaDetaching(e,r){const n=!!r.transferMedia;if(this.media=null,n)return;const{captionsTracks:s}=this;Object.keys(s).forEach(i=>{qc(s[i]),delete s[i]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=$N(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const r=e.textTracks;if(r)for(let n=0;n<r.length;n++)qc(r[n])}onSubtitleTracksUpdated(e,r){const n=r.subtitleTracks||[],s=n.some(i=>i.textCodec===_1);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(NM(this.tracks,n)){this.tracks=n;return}if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){const a=this.media,l=a?u0(a.textTracks):null;if(this.tracks.forEach((d,u)=>{let f;if(l){let p=null;for(let y=0;y<l.length;y++)if(l[y]&&UN(l[y],d)){p=l[y],l[y]=null;break}p&&(f=p)}if(f)qc(f);else{const p=QM(d);f=this.createTextTrack(p,d.name,d.lang),f&&(f.mode="disabled")}f&&this.textTracks.push(f)}),l!=null&&l.length){const d=l.filter(u=>u!==null).map(u=>u.label);d.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${d.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(l=>({label:l.name,kind:l.type.toLowerCase(),default:l.default,subtitleTrack:l}));this.hls.trigger(M.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,r){this.config.enableCEA708Captions&&r.captions&&r.captions.forEach(n=>{const s=/(?:CC|SERVICE)([1-4])/.exec(n.instreamId);if(!s)return;const i=`textTrack${s[1]}`,a=this.captionsProperties[i];a&&(a.label=n.name,n.lang&&(a.languageCode=n.lang),a.media=n)})}closedCaptionsForLevel(e){const r=this.hls.levels[e.level];return r==null?void 0:r.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,r){if(this.enabled&&r.frag.type===ze.MAIN){var n,s;const{cea608Parser1:i,cea608Parser2:a,lastSn:l}=this,{cc:d,sn:u}=r.frag,f=(n=(s=r.part)==null?void 0:s.index)!=null?n:-1;i&&a&&(u!==l+1||u===l&&f!==this.lastPartIndex+1||d!==this.lastCc)&&(i.reset(),a.reset()),this.lastCc=d,this.lastSn=u,this.lastPartIndex=f}}onFragLoaded(e,r){const{frag:n,payload:s}=r;if(n.type===ze.SUBTITLE)if(s.byteLength){const i=n.decryptdata,a="stats"in r;if(i==null||!i.encrypted||a){const l=this.tracks[n.level],d=this.vttCCs;d[n.cc]||(d[n.cc]={start:n.start,prevCC:this.prevCC,new:!0},this.prevCC=n.cc),l&&l.textCodec===_1?this._parseIMSC1(n,s):this._parseVTTs(r)}}else this.hls.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,r){const n=this.hls;ON(r,this.initPTS[e.cc],s=>{this._appendCues(s,e.level),n.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},s=>{n.logger.log(`Failed to parse IMSC1: ${s}`),n.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:s})})}_parseVTTs(e){var r;const{frag:n,payload:s}=e,{initPTS:i,unparsedVttFrags:a}=this,l=i.length-1;if(!i[n.cc]&&l===-1){a.push(e);return}const d=this.hls,u=(r=n.initSegment)!=null&&r.data?ri(n.initSegment.data,new Uint8Array(s)).buffer:s;Gne(u,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,f=>{this._appendCues(f,n.level),d.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})},f=>{const p=f.message==="Missing initPTS for VTT MPEGTS";p?a.push(e):this._fallbackToIMSC1(n,s),d.logger.log(`Failed to parse VTT cue: ${f}`),!(p&&l>n.cc)&&d.trigger(M.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:f})})}_fallbackToIMSC1(e,r){const n=this.tracks[e.level];n.textCodec||ON(r,this.initPTS[e.cc],()=>{n.textCodec=_1,this._parseIMSC1(e,r)},()=>{n.textCodec="wvtt"})}_appendCues(e,r){const n=this.hls;if(this.config.renderTextTracksNatively){const s=this.textTracks[r];if(!s||s.mode==="disabled")return;e.forEach(i=>$M(s,i))}else{const s=this.tracks[r];if(!s)return;const i=s.default?"default":"subtitles"+r;n.trigger(M.CUES_PARSED,{type:"subtitles",cues:e,track:i})}}onFragDecrypted(e,r){const{frag:n}=r;n.type===ze.SUBTITLE&&this.onFragLoaded(M.FRAG_LOADED,r)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,r){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:n,samples:s}=r;if(!(n.type===ze.MAIN&&this.closedCaptionsForLevel(n)==="NONE"))for(let i=0;i<s.length;i++){const a=s[i].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const l=this.extractCea608Data(a);this.cea608Parser1.addData(s[i].pts,l[0]),this.cea608Parser2.addData(s[i].pts,l[1])}}}onBufferFlushing(e,{startOffset:r,endOffset:n,endOffsetSubtitles:s,type:i}){const{media:a}=this;if(!(!a||a.currentTime<n)){if(!i||i==="video"){const{captionsTracks:l}=this;Object.keys(l).forEach(d=>Yv(l[d],r,n))}if(this.config.renderTextTracksNatively&&r===0&&s!==void 0){const{textTracks:l}=this;Object.keys(l).forEach(d=>Yv(l[d],r,s))}}}extractCea608Data(e){const r=[[],[]],n=e[0]&31;let s=2;for(let i=0;i<n;i++){const a=e[s++],l=127&e[s++],d=127&e[s++];if(l===0&&d===0)continue;if((4&a)!==0){const f=3&a;(f===0||f===1)&&(r[f].push(l),r[f].push(d))}}return r}}function QM(t){return t.characteristics&&/transcribes-spoken-dialog/gi.test(t.characteristics)&&/describes-music-and-sound/gi.test(t.characteristics)?"captions":"subtitles"}function UN(t,e){return!!t&&t.kind===QM(e)&&Hv(e,t)}function Xne(t,e,r,n){return Math.min(e,n)-Math.max(t,r)}function $N(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const Qne=/\s/,Zne={newCue(t,e,r,n){const s=[];let i,a,l,d,u;const f=self.VTTCue||self.TextTrackCue;for(let y=0;y<n.rows.length;y++)if(i=n.rows[y],l=!0,d=0,u="",!i.isEmpty()){var p;for(let b=0;b<i.chars.length;b++)Qne.test(i.chars[b].uchar)&&l?d++:(u+=i.chars[b].uchar,l=!1);i.cueStartTime=e,e===r&&(r+=1e-4),d>=16?d--:d++;const v=KM(u.trim()),E=c2(e,r,v);t!=null&&(p=t.cues)!=null&&p.getCueById(E)||(a=new f(e,r,v),a.id=E,a.line=y+1,a.align="left",a.position=10+Math.min(80,Math.floor(d*8/32)*10),s.push(a))}return t&&s.length&&(s.sort((y,v)=>y.line==="auto"||v.line==="auto"?0:y.line>8&&v.line>8?v.line-y.line:y.line-v.line),s.forEach(y=>$M(t,y))),s}};function Jne(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const ese=/(\d+)-(\d+)\/(\d+)/;class VN{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||sse,this.controller=new self.AbortController,this.stats=new $E}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,r,n){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const i=tse(e,this.controller.signal),a=e.responseType==="arraybuffer",l=a?"byteLength":"length",{maxTimeToFirstByteMs:d,maxLoadTimeMs:u}=r.loadPolicy;this.context=e,this.config=r,this.callbacks=n,this.request=this.fetchSetup(e,i),self.clearTimeout(this.requestTimeout),r.timeout=d&&Ve(d)?d:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},r.timeout),(Wh(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(p=>{var y;this.response=this.loader=p;const v=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),r.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},u-(v-s.loading.start)),!p.ok){const{status:b,statusText:T}=p;throw new ise(T||"fetch, bad network response",b,p)}s.loading.first=v,s.total=nse(p.headers)||s.total;const E=(y=this.callbacks)==null?void 0:y.onProgress;return E&&Ve(r.highWaterMark)?this.loadProgressively(p,s,e,r.highWaterMark,E):a?p.arrayBuffer():e.responseType==="json"?p.json():p.text()}).then(p=>{var y,v;const E=this.response;if(!E)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const b=p[l];b&&(s.loaded=s.total=b);const T={url:E.url,data:p,code:E.status},I=(y=this.callbacks)==null?void 0:y.onProgress;I&&!Ve(r.highWaterMark)&&I(s,e,p,E),(v=this.callbacks)==null||v.onSuccess(T,s,e,E)}).catch(p=>{var y;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const v=p&&p.code||0,E=p?p.message:null;(y=this.callbacks)==null||y.onError({code:v,text:E},e,p?p.details:null,s)})}getCacheAge(){let e=null;if(this.response){const r=this.response.headers.get("age");e=r?parseFloat(r):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,r,n,s=0,i){const a=new oM,l=e.body.getReader(),d=()=>l.read().then(u=>{if(u.done)return a.dataLength&&i(r,n,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const f=u.value,p=f.length;return r.loaded+=p,p<s||a.dataLength?(a.push(f),a.dataLength>=s&&i(r,n,a.flush().buffer,e)):i(r,n,f.buffer,e),d()}).catch(()=>Promise.reject());return d()}}function tse(t,e){const r={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(zt({},t.headers))};return t.rangeEnd&&r.headers.set("Range","bytes="+t.rangeStart+"-"+String(t.rangeEnd-1)),r}function rse(t){const e=ese.exec(t);if(e)return parseInt(e[2])-parseInt(e[1])+1}function nse(t){const e=t.get("Content-Range");if(e){const n=rse(e);if(Ve(n))return n}const r=t.get("Content-Length");if(r)return parseInt(r)}function sse(t,e){return new self.Request(t.url,e)}class ise extends Error{constructor(e,r,n){super(e),this.code=void 0,this.details=void 0,this.code=r,this.details=n}}const ase=/^age:\s*[\d.]+\s*$/im;class ZM{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new $E,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,r,n){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=r,this.callbacks=n,this.loadInternal()}loadInternal(){const{config:e,context:r}=this;if(!e||!r)return;const n=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const i=this.xhrSetup;i?Promise.resolve().then(()=>{if(!(this.loader!==n||this.stats.aborted))return i(n,r.url)}).catch(a=>{if(!(this.loader!==n||this.stats.aborted))return n.open("GET",r.url,!0),i(n,r.url)}).then(()=>{this.loader!==n||this.stats.aborted||this.openAndSendXhr(n,r,e)}).catch(a=>{var l;(l=this.callbacks)==null||l.onError({code:n.status,text:a.message},r,n,s)}):this.openAndSendXhr(n,r,e)}openAndSendXhr(e,r,n){e.readyState||e.open("GET",r.url,!0);const s=r.headers,{maxTimeToFirstByteMs:i,maxLoadTimeMs:a}=n.loadPolicy;if(s)for(const l in s)e.setRequestHeader(l,s[l]);r.rangeEnd&&e.setRequestHeader("Range","bytes="+r.rangeStart+"-"+(r.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=r.responseType,self.clearTimeout(this.requestTimeout),n.timeout=i&&Ve(i)?i:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),e.send()}readystatechange(){const{context:e,loader:r,stats:n}=this;if(!e||!r)return;const s=r.readyState,i=this.config;if(!n.aborted&&s>=2&&(n.loading.first===0&&(n.loading.first=Math.max(self.performance.now(),n.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(n.loading.first-n.loading.start)))),s===4)){self.clearTimeout(this.requestTimeout),r.onreadystatechange=null,r.onprogress=null;const u=r.status,f=r.responseType==="text"?r.responseText:null;if(u>=200&&u<300){const E=f??r.response;if(E!=null){var a,l;n.loading.end=Math.max(self.performance.now(),n.loading.first);const b=r.responseType==="arraybuffer"?E.byteLength:E.length;n.loaded=n.total=b,n.bwEstimate=n.total*8e3/(n.loading.end-n.loading.first);const T=(a=this.callbacks)==null?void 0:a.onProgress;T&&T(n,e,E,r);const I={url:r.responseURL,data:E,code:u};(l=this.callbacks)==null||l.onSuccess(I,n,e,r);return}}const p=i.loadPolicy.errorRetry,y=n.retry,v={url:e.url,data:void 0,code:u};if(xp(p,y,!1,v))this.retry(p);else{var d;Vt.error(`${u} while loading ${e.url}`),(d=this.callbacks)==null||d.onError({code:u,text:r.statusText},e,r,n)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,r=this.stats.retry;if(xp(e,r,!0))this.retry(e);else{var n;Vt.warn(`timeout while loading ${(n=this.context)==null?void 0:n.url}`);const s=this.callbacks;s&&(this.abortInternal(),s.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:r,stats:n}=this;this.retryDelay=zE(e,n.retry),n.retry++,Vt.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${r==null?void 0:r.url}, retrying ${n.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const r=this.stats;r.loaded=e.loaded,e.lengthComputable&&(r.total=e.total)}getCacheAge(){let e=null;if(this.loader&&ase.test(this.loader.getAllResponseHeaders())){const r=this.loader.getResponseHeader("age");e=r?parseFloat(r):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const ose={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},lse=$t($t({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:ZM,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:wee,bufferController:ure,capLevelController:i2,errorController:Cee,fpsController:dne,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Xj,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:ose},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},cse()),{},{subtitleStreamController:Sne,subtitleTrackController:mne,timelineController:qne,audioStreamController:are,audioTrackController:ore,emeController:uu,cmcdController:one,contentSteeringController:cne,interstitialsController:Ene});function cse(){return{cueHandler:Zne,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function use(t,e,r){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const n=Xv(t),s=["manifest","level","frag"],i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return s.forEach(a=>{const l=`${a==="level"?"playlist":a}LoadPolicy`,d=e[l]===void 0,u=[];i.forEach(f=>{const p=`${a}Loading${f}`,y=e[p];if(y!==void 0&&d){u.push(p);const v=n[l].default;switch(e[l]={default:v},f){case"TimeOut":v.maxLoadTimeMs=y,v.maxTimeToFirstByteMs=y;break;case"MaxRetry":v.errorRetry.maxNumRetry=y,v.timeoutRetry.maxNumRetry=y;break;case"RetryDelay":v.errorRetry.retryDelayMs=y,v.timeoutRetry.retryDelayMs=y;break;case"MaxRetryTimeout":v.errorRetry.maxRetryDelayMs=y,v.timeoutRetry.maxRetryDelayMs=y;break}}}),u.length&&r.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${l}": ${qt(e[l])}`)}),$t($t({},n),e)}function Xv(t){return t&&typeof t=="object"?Array.isArray(t)?t.map(Xv):Object.keys(t).reduce((e,r)=>(e[r]=Xv(t[r]),e),{}):t}function dse(t,e){const r=t.loader;r!==VN&&r!==ZM?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),t.progressive=!1):Jne()&&(t.loader=VN,t.progressive=!0,t.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const d0=2,hse=.1,fse=.05,mse=100;class pse extends zj{constructor(e,r){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var n;(n=this.media)!=null&&n.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var n;this.ended=((n=this.media)==null?void 0:n.currentTime)||1,this.hls.trigger(M.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=r,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,r){this.setInterval(mse),this.mediaSource=r.mediaSource;const n=this.media=r.media;Wn(n,"playing",this.onMediaPlaying),Wn(n,"waiting",this.onMediaWaiting),Wn(n,"ended",this.onMediaEnded)}onMediaDetaching(e,r){this.clearInterval();const{media:n}=this;n&&(ls(n,"playing",this.onMediaPlaying),ls(n,"waiting",this.onMediaWaiting),ls(n,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,r){this.buffered=r.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const r=this.media.currentTime;this.poll(r,this.lastCurrentTime),this.lastCurrentTime=r}poll(e,r){var n,s;const i=(n=this.hls)==null?void 0:n.config;if(!i)return;const a=this.media;if(!a)return;const{seeking:l}=a,d=this.seeking&&!l,u=!this.seeking&&l,f=a.paused&&!l||a.ended||a.playbackRate===0;if(this.seeking=l,e!==r){r&&(this.ended=0),this.moved=!0,l||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!f&&e>r&&this.nudgeOnVideoHole(e,r)),this.waiting===0&&this.stallResolved(e);return}if(u||d){d&&this.stallResolved(e);return}if(f){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(M.MEDIA_ENDED,{stalled:!1}));return}if(!ht.getBuffered(a).length){this.nudgeRetry=0;return}const p=ht.bufferInfo(a,e,0),y=p.nextStart||0,v=this.fragmentTracker;if(l&&v&&this.hls){const k=GN(this.hls.inFlightFragments,e),D=p.len>d0,O=!y||k||y-e>d0&&!v.getPartialFragment(e);if(D||O)return;this.moved=!1}const E=(s=this.hls)==null?void 0:s.latestLevelDetails;if(!this.moved&&this.stalled!==null&&v){if(!(p.len>0)&&!y)return;const D=Math.max(y,p.start||0)-e,F=!!(E!=null&&E.live)?E.targetduration*2:d0,$=_m(e,v);if(D>0&&(D<=F||$)){a.paused||this._trySkipBufferHole($);return}}const b=i.detectStallWithCurrentTimeMs,T=self.performance.now(),I=this.waiting;let N=this.stalled;if(N===null)if(I>0&&T-I<b)N=this.stalled=I;else{this.stalled=T;return}const A=T-N;if(!l&&(A>=b||I)&&this.hls){var L;if(((L=this.mediaSource)==null?void 0:L.readyState)==="ended"&&!(E!=null&&E.live)&&Math.abs(e-((E==null?void 0:E.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(M.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(p),!this.media||!this.hls)return}const P=ht.bufferInfo(a,e,i.maxBufferHole);this._tryFixBufferStall(P,A,e)}stallResolved(e){const r=this.stalled;if(r&&this.hls&&(this.stalled=null,this.stallReported)){const n=self.performance.now()-r;this.log(`playback not stuck anymore @${e}, after ${Math.round(n)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(M.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,r){var n;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(n=this.buffered.audio)!=null&&n.length&&s&&s.length>1&&e>s.end(0)){const i=ht.bufferedInfo(ht.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&r>=i.start){const a=ht.timeRangesToArray(s),l=ht.bufferedInfo(a,r,0).bufferedIndex;if(l>-1&&l<a.length-1){const d=ht.bufferedInfo(a,e,0).bufferedIndex,u=a[l].end,f=a[l+1].start;if((d===-1||d>l)&&f-u<1&&e-u<2){const p=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${f} buffered index: ${d}`);this.warn(p.message),this.media.currentTime+=1e-6;let y=_m(e,this.fragmentTracker);y&&"fragment"in y?y=y.fragment:y||(y=void 0);const v=ht.bufferInfo(this.media,e,0);this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:p,reason:p.message,frag:y,buffer:v.len,bufferInfo:v})}}}}}_tryFixBufferStall(e,r,n){var s,i;const{fragmentTracker:a,media:l}=this,d=(s=this.hls)==null?void 0:s.config;if(!l||!a||!d)return;const u=(i=this.hls)==null?void 0:i.latestLevelDetails,f=_m(n,a);if((f||u!=null&&u.live&&n<u.fragmentStart)&&(this._trySkipBufferHole(f)||!this.media))return;const p=e.buffered,y=this.adjacentTraversal(e,n);(p&&p.length>1&&e.len>d.maxBufferHole||e.nextStart&&(e.nextStart-n<d.maxBufferHole||y))&&(r>d.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,r){const n=this.fragmentTracker,s=e.nextStart;if(n&&s){const i=n.getFragAtPos(r,ze.MAIN),a=n.getFragAtPos(s,ze.MAIN);if(i&&a)return a.sn-i.sn<2}return!1}_reportStall(e){const{hls:r,media:n,stallReported:s,stalled:i}=this;if(!s&&i!==null&&n&&r){this.stallReported=!0;const a=new Error(`Playback stalling at @${n.currentTime} due to low buffer (${qt(e)})`);this.warn(a.message),r.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}_trySkipBufferHole(e){var r;const{fragmentTracker:n,media:s}=this,i=(r=this.hls)==null?void 0:r.config;if(!s||!n||!i)return 0;const a=s.currentTime,l=ht.bufferInfo(s,a,0),d=a<l.start?l.start:l.nextStart;if(d&&this.hls){const f=l.len<=i.maxBufferHole,p=l.len>0&&l.len<1&&s.readyState<3,y=d-a;if(y>0&&(f||p)){if(y>i.maxBufferHole){let E=!1;if(a===0){const b=n.getAppendedFrag(0,ze.MAIN);b&&d<b.end&&(E=!0)}if(!E&&e){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||GN(this.hls.inFlightFragments,d))return 0;let T=!1,I=e.end;for(;I<d;){const N=_m(I,n);if(N)I+=N.duration;else{T=!0;break}}if(T)return 0}}const v=Math.max(d+fse,a+hse);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${v}`),this.moved=!0,s.currentTime=v,!(e!=null&&e.gap)){const E=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${v}`),b={type:Qe.MEDIA_ERROR,details:ue.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:E,reason:E.message,buffer:l.len,bufferInfo:l};e&&("fragment"in e?b.part=e:b.frag=e),this.hls.trigger(M.ERROR,b)}return v}}return 0}_tryNudgeBuffer(e){const{hls:r,media:n,nudgeRetry:s}=this,i=r==null?void 0:r.config;if(!n||!i)return 0;const a=n.currentTime;if(this.nudgeRetry++,s<i.nudgeMaxRetry){const l=a+(s+1)*i.nudgeOffset,d=new Error(`Nudging 'currentTime' from ${a} to ${l}`);this.warn(d.message),n.currentTime=l,r.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_NUDGE_ON_STALL,error:d,fatal:!1,buffer:e.len,bufferInfo:e})}else{const l=new Error(`Playhead still not moving while enough data buffered @${a} after ${i.nudgeMaxRetry} nudges`);this.error(l.message),r.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}}function GN(t,e){const r=HN(t.main);if(r&&r.start<=e)return r;const n=HN(t.audio);return n&&n.start<=e?n:null}function HN(t){if(!t)return null;switch(t.state){case be.IDLE:case be.STOPPED:case be.ENDED:case be.ERROR:return null}return t.frag}function _m(t,e){return e.getAppendedFrag(t,ze.MAIN)||e.getPartialFragment(t)}const gse=.25;function Qv(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function k1(t,e,r,n,s){let i=new t(e,r,"");try{i.value=n,s&&(i.type=s)}catch{i=new t(e,r,qt(s?$t({type:s},n):n))}return i}const Lm=(()=>{const t=Qv();try{t&&new t(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class xse{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(M.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e&&(e.on(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(M.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,r){var n;this.media=r.media,((n=r.overrides)==null?void 0:n.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;const r=(e=this.hls)==null?void 0:e.latestLevelDetails;r&&this.updateDateRangeCues(r)}onMediaDetaching(e,r){this.media=null,!r.transferMedia&&(this.id3Track&&(this.removeCues&&qc(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const r=this.getID3Track(e.textTracks);return r.mode="hidden",r}getID3Track(e){if(this.media){for(let r=0;r<e.length;r++){const n=e[r];if(n.kind==="metadata"&&n.label==="id3")return UM(n,this.media),n}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,r){if(!this.media||!this.hls)return;const{enableEmsgMetadataCues:n,enableID3MetadataCues:s}=this.hls.config;if(!n&&!s)return;const{samples:i}=r;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=Qv();if(a)for(let l=0;l<i.length;l++){const d=i[l].type;if(d===As.emsg&&!n||!s)continue;const u=mM(i[l].data),f=i[l].pts;let p=f+i[l].duration;p>Lm&&(p=Lm),p-f<=0&&(p=f+gse);for(let v=0;v<u.length;v++){const E=u[v];if(!pM(E)){this.updateId3CueEnds(f,d);const b=k1(a,f,p,E,d);b&&this.id3Track.addCue(b)}}}}updateId3CueEnds(e,r){var n;const s=(n=this.id3Track)==null?void 0:n.cues;if(s)for(let i=s.length;i--;){const a=s[i];a.type===r&&a.startTime<e&&a.endTime===Lm&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:r,endOffset:n,type:s}){const{id3Track:i,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:d}}=a;if(i&&(l||d)){let u;s==="audio"?u=f=>f.type===As.audioId3&&d:s==="video"?u=f=>f.type===As.emsg&&l:u=f=>f.type===As.audioId3&&d||f.type===As.emsg&&l,Yv(i,r,n,u)}}onLevelUpdated(e,{details:r}){this.updateDateRangeCues(r,!0)}onLevelPtsUpdated(e,r){Math.abs(r.drift)>.01&&this.updateDateRangeCues(r.details)}updateDateRangeCues(e,r){if(!this.hls||!this.media)return;const{assetPlayerId:n,timelineOffset:s,enableDateRangeMetadataCues:i,interstitialsController:a}=this.hls.config;if(!i)return;const l=Qv();if(n&&s&&!a){const{fragmentStart:b,fragmentEnd:T}=e;let I=this.assetCue;I?(I.startTime=b,I.endTime=T):l&&(I=this.assetCue=k1(l,b,T,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"),I&&(I.id=n,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(I),I.addEventListener("enter",this.onEventCueEnter)))}if(!e.hasProgramDateTime)return;const{id3Track:d}=this,{dateRanges:u}=e,f=Object.keys(u);let p=this.dateRangeCuesAppended;if(d&&r){var y;if((y=d.cues)!=null&&y.length){const b=Object.keys(p).filter(T=>!f.includes(T));for(let T=b.length;T--;){var v;const I=b[T],N=(v=p[I])==null?void 0:v.cues;delete p[I],N&&Object.keys(N).forEach(A=>{const L=N[A];if(L){L.removeEventListener("enter",this.onEventCueEnter);try{d.removeCue(L)}catch{}}})}}else p=this.dateRangeCuesAppended={}}const E=e.fragments[e.fragments.length-1];if(!(f.length===0||!Ve(E==null?void 0:E.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let b=0;b<f.length;b++){const T=f[b],I=u[T],N=I.startTime,A=p[T],L=(A==null?void 0:A.cues)||{};let P=(A==null?void 0:A.durationKnown)||!1,k=Lm;const{duration:D,endDate:O}=I;if(O&&D!==null)k=N+D,P=!0;else if(I.endOnNext&&!P){const $=f.reduce((G,Y)=>{if(Y!==I.id){const ne=u[Y];if(ne.class===I.class&&ne.startDate>I.startDate&&(!G||I.startDate<G.startDate))return ne}return G},null);$&&(k=$.startTime,P=!0)}const F=Object.keys(I.attr);for(let $=0;$<F.length;$++){const G=F[$];if(!Fee(G))continue;const Y=L[G];if(Y)P&&!(A!=null&&A.durationKnown)?Y.endTime=k:Math.abs(Y.startTime-N)>.01&&(Y.startTime=N,Y.endTime=k);else if(l){let ne=I.attr[G];Bee(G)&&(ne=Cj(ne));const z=k1(l,N,k,{key:G,data:ne},As.dateRange);z&&(z.id=T,this.id3Track.addCue(z),L[G]=z,a&&(G==="X-ASSET-LIST"||G==="X-ASSET-URL")&&z.addEventListener("enter",this.onEventCueEnter))}}p[T]={cues:L,dateRange:I,durationKnown:P}}}}}class yse{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:r}=this,n=this.levelDetails;if(!r||!n)return;this.currentTime=r.currentTime;const s=this.computeLatency();if(s===null)return;this._latency=s;const{lowLatencyMode:i,maxLiveSyncPlaybackRate:a}=this.config;if(!i||a===1||!n.live)return;const l=this.targetLatency;if(l===null)return;const d=s-l,u=Math.min(this.maxLatency,l+n.targetduration);if(d<u&&d>.05&&this.forwardBufferLength>1){const p=Math.min(2,Math.max(1,a)),y=Math.round(2/(1+Math.exp(-.75*d-this.edgeStalled))*20)/20,v=Math.min(p,Math.max(1,y));this.changeMediaPlaybackRate(r,v)}else r.playbackRate!==1&&r.playbackRate!==0&&this.changeMediaPlaybackRate(r,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const r=this.levelDetails;return r?e.liveMaxLatencyDurationCount*r.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:r,partHoldBack:n,targetduration:s}=e,{liveSyncDuration:i,liveSyncDurationCount:a,lowLatencyMode:l}=this.config,d=this.hls.userConfig;let u=l&&n||r;(this._targetLatencyUpdated||d.liveSyncDuration||d.liveSyncDurationCount||u===0)&&(u=i!==void 0?i:a*s);const f=s;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,f)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),r=this.targetLatency;if(e===null||r===null)return null;const n=this.levelDetails;if(n===null)return null;const s=n.edge,i=e-r-this.edgeStalled,a=s-n.totalduration,l=s-(this.config.lowLatencyMode&&n.partTarget||n.targetduration);return Math.min(Math.max(a,i),l)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const r=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-r,0)}get forwardBufferLength(){const{media:e}=this,r=this.levelDetails;if(!e||!r)return 0;const n=e.buffered.length;return(n?e.buffered.end(n-1):r.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(M.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(M.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(M.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(M.ERROR,this.onError,this))}onMediaAttached(e,r){this.media=r.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:r}){r.advanced&&this.onTimeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,r){var n;r.details===ue.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(n=this.levelDetails)!=null&&n.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,r){var n,s;e.playbackRate!==r&&((n=this.hls)==null||n.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(s=this.targetLatency)==null?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${r}`),e.playbackRate=r)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class vse extends s2{constructor(e,r){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=r,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this),e.on(M.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this),e.off(M.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(r=>{r.loadError=0,r.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,r){this.resetLevels()}onManifestLoaded(e,r){const n=this.hls.config.preferManagedMediaSource,s=[],i={},a={};let l=!1,d=!1,u=!1;r.levels.forEach(f=>{const p=f.attrs;let{audioCodec:y,videoCodec:v}=f;y&&(f.audioCodec=y=fp(y,n)||void 0),v&&(v=f.videoCodec=tee(v));const{width:E,height:b,unknownCodecs:T}=f,I=(T==null?void 0:T.length)||0;if(l||(l=!!(E&&b)),d||(d=!!v),u||(u=!!y),I||y&&!this.isAudioSupported(y)||v&&!this.isVideoSupported(v)){this.log(`Some or all CODECS not supported "${p.CODECS}"`);return}const{CODECS:N,"FRAME-RATE":A,"HDCP-LEVEL":L,"PATHWAY-ID":P,RESOLUTION:k,"VIDEO-RANGE":D}=p,F=`${`${P||"."}-`}${f.bitrate}-${k}-${A}-${N}-${D}-${L}`;if(i[F])if(i[F].uri!==f.url&&!f.attrs["PATHWAY-ID"]){const $=a[F]+=1;f.attrs["PATHWAY-ID"]=new Array($+1).join(".");const G=this.createLevel(f);i[F]=G,s.push(G)}else i[F].addGroupId("audio",p.AUDIO),i[F].addGroupId("text",p.SUBTITLES);else{const $=this.createLevel(f);i[F]=$,a[F]=1,s.push($)}}),this.filterAndSortMediaOptions(s,r,l,d,u)}createLevel(e){const r=new Gh(e),n=e.supplemental;if(n!=null&&n.videoCodec&&!this.isVideoSupported(n.videoCodec)){const s=new Error(`SUPPLEMENTAL-CODECS not supported "${n.videoCodec}"`);this.log(s.message),r.supportedResult=Oj(s,[])}return r}isAudioSupported(e){return $h(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return $h(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,r,n,s,i){var a;let l=[],d=[],u=e;const f=((a=r.stats)==null?void 0:a.parsing)||{};if((n||s)&&i&&(u=u.filter(({videoCodec:N,videoRange:A,width:L,height:P})=>(!!N||!!(L&&P))&&dee(A))),u.length===0){Promise.resolve().then(()=>{if(this.hls){let N="no level with compatible codecs found in manifest",A=N;r.levels.length&&(A=`one or more CODECS in variant not supported: ${qt(r.levels.map(P=>P.attrs.CODECS).filter((P,k,D)=>D.indexOf(P)===k))}`,this.warn(A),N+=` (${A})`);const L=new Error(N);this.hls.trigger(M.ERROR,{type:Qe.MEDIA_ERROR,details:ue.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:r.url,error:L,reason:A})}}),f.end=performance.now();return}r.audioTracks&&(l=r.audioTracks.filter(N=>!N.audioCodec||this.isAudioSupported(N.audioCodec)),zN(l)),r.subtitles&&(d=r.subtitles,zN(d));const p=u.slice(0);u.sort((N,A)=>{if(N.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(N.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(n&&N.height!==A.height)return N.height-A.height;if(N.frameRate!==A.frameRate)return N.frameRate-A.frameRate;if(N.videoRange!==A.videoRange)return mp.indexOf(N.videoRange)-mp.indexOf(A.videoRange);if(N.videoCodec!==A.videoCodec){const L=MA(N.videoCodec),P=MA(A.videoCodec);if(L!==P)return P-L}if(N.uri===A.uri&&N.codecSet!==A.codecSet){const L=hp(N.codecSet),P=hp(A.codecSet);if(L!==P)return P-L}return N.averageBitrate!==A.averageBitrate?N.averageBitrate-A.averageBitrate:0});let y=p[0];if(this.steering&&(u=this.steering.filterParsedLevels(u),u.length!==p.length)){for(let N=0;N<p.length;N++)if(p[N].pathwayId===u[0].pathwayId){y=p[N];break}}this._levels=u;for(let N=0;N<u.length;N++)if(u[N]===y){var v;this._firstLevel=N;const A=y.bitrate,L=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${u.length} level(s) found, first bitrate: ${A}`),((v=this.hls.userConfig)==null?void 0:v.abrEwmaDefaultEstimate)===void 0){const P=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);P>L&&L===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=P)}break}const E=i&&!s,b=this.hls.config,T=!!(b.audioStreamController&&b.audioTrackController),I={levels:u,audioTracks:l,subtitleTracks:d,sessionData:r.sessionData,sessionKeys:r.sessionKeys,firstLevel:this._firstLevel,stats:r.stats,audio:i,video:s,altAudio:T&&!E&&l.some(N=>!!N.url)};f.end=performance.now(),this.hls.trigger(M.MANIFEST_PARSED,I)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const r=this._levels;if(r.length===0)return;if(e<0||e>=r.length){const f=new Error("invalid level idx"),p=e<0;if(this.hls.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.LEVEL_SWITCH_ERROR,level:e,fatal:p,error:f,reason:f.message}),p)return;e=Math.min(e,r.length-1)}const n=this.currentLevelIndex,s=this.currentLevel,i=s?s.attrs["PATHWAY-ID"]:void 0,a=r[e],l=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,n===e&&s&&i===l)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${l?" with Pathway "+l:""} from level ${n}${i?" with Pathway "+i:""}`);const d={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(M.LEVEL_SWITCHING,d);const u=a.details;if(!u||u.live){const f=this.switchParams(a.uri,s==null?void 0:s.details,u);this.loadPlaylist(f)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const r=this.steering.pathways(),n=e.filter(s=>r.indexOf(s)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${r}`);return}this.steering.pathwayPriority=n}}onError(e,r){r.fatal||!r.context||r.context.type===Ct.LEVEL&&r.context.level===this.level&&this.checkRetry(r)}onFragBuffered(e,{frag:r}){if(r!==void 0&&r.type===ze.MAIN){const n=r.elementaryStreams;if(!Object.keys(n).some(i=>!!n[i]))return;const s=this._levels[r.level];s!=null&&s.loadError&&(this.log(`Resetting level error count of ${s.loadError} on frag buffered`),s.loadError=0)}}onLevelLoaded(e,r){var n;const{level:s,details:i}=r,a=r.levelInfo;if(!a){var l;this.warn(`Invalid level index ${s}`),(l=r.deliveryDirectives)!=null&&l.skip&&(i.deltaUpdateFailed=!0);return}if(a===this.currentLevel||r.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let d=a.details;d===r.details&&d.advanced&&(d=void 0),this.playlistLoaded(s,r,d)}else(n=r.deliveryDirectives)!=null&&n.skip&&(i.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,r){super.loadingPlaylist(e,r);const n=this.getUrlWithDirectives(e.uri,r),s=this.currentLevelIndex,i=e.attrs["PATHWAY-ID"],a=e.details,l=a==null?void 0:a.age;this.log(`Loading level index ${s}${(r==null?void 0:r.msn)!==void 0?" at sn "+r.msn+" part "+r.part:""}${i?" Pathway "+i:""}${l&&a.live?" age "+l.toFixed(1)+(a.type&&" "+a.type||""):""} ${n}`),this.hls.trigger(M.LEVEL_LOADING,{url:n,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:r||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var r;if(this._levels.length===1)return;const n=this._levels.filter((i,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(i),i===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,i.details&&i.details.fragments.forEach(l=>l.level=-1)),!1));sM(n),this._levels=n,this.currentLevelIndex>-1&&(r=this.currentLevel)!=null&&r.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=n.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(M.LEVELS_UPDATED,{levels:n})}onLevelsUpdated(e,{levels:r}){this._levels=r}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:r,maxHdcpLevel:n}=this.hls;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger(M.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}}function zN(t){const e={};t.forEach(r=>{const n=r.groupId||"";r.id=e[n]=e[n]||0,e[n]++})}function JM(){return self.SourceBuffer||self.WebKitSourceBuffer}function eO(){if(!Bo())return!1;const e=JM();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function wse(){if(!eO())return!1;const t=Bo();return typeof(t==null?void 0:t.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>t.isTypeSupported(Vh(e,"video")))||["mp4a.40.2","fLaC"].some(e=>t.isTypeSupported(Vh(e,"audio"))))}function bse(){var t;const e=JM();return typeof(e==null||(t=e.prototype)==null?void 0:t.changeType)=="function"}const Ese=100;class Sse extends XE{constructor(e,r,n){super(e,r,n,"stream-controller",ze.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const s=this.media,i=s?s.currentTime:null;if(i===null||!Ve(i)||(this.log(`Media seeked to ${i.toFixed(3)}`),!this.getBufferedFrag(i)))return;const a=this.getFwdBufferInfoAtPos(s,i,ze.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${i} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(M.MANIFEST_PARSED,this.onManifestParsed,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.LEVEL_LOADED,this.onLevelLoaded,this),e.on(M.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(M.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(M.BUFFER_CREATED,this.onBufferCreated,this),e.on(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(M.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(M.MANIFEST_PARSED,this.onManifestParsed,this),e.off(M.LEVEL_LOADED,this.onLevelLoaded,this),e.off(M.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(M.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(M.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(M.BUFFER_CREATED,this.onBufferCreated,this),e.off(M.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(M.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,r){if(this.levels){const{lastCurrentTime:n,hls:s}=this;if(this.stopLoad(),this.setInterval(Ese),this.level=-1,!this.startFragRequested){let i=s.startLevel;i===-1&&(s.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=s.firstAutoLevel),s.nextLoadLevel=i,this.level=s.loadLevel,this._hasEnoughToStart=!!r}n>0&&e===-1&&!r&&(this.log(`Override startPosition with lastCurrentTime @${n.toFixed(3)}`),e=n),this.state=be.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=r?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=be.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case be.WAITING_LEVEL:{const{levels:e,level:r}=this,n=e==null?void 0:e[r],s=n==null?void 0:n.details;if(s&&(!s.live||this.levelLastLoaded===n&&!this.waitForLive(n))){if(this.waitForCdnTuneIn(s))break;this.state=be.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=be.IDLE;break}break}case be.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break}this.state===be.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:r,levels:n,media:s}=this;if(r===null||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const i=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(n!=null&&n[i]))return;const a=n[i],l=this.getMainFwdBufferInfo();if(l===null)return;const d=this.getLevelDetails();if(d&&this._streamEnded(l,d)){const b={};this.altAudio===2&&(b.type="video"),this.hls.trigger(M.BUFFER_EOS,b),this.state=be.ENDED;return}if(!this.buffering)return;e.loadLevel!==i&&e.manualLevel===-1&&this.log(`Adapting to level ${i} from level ${this.level}`),this.level=e.nextLoadLevel=i;const u=a.details;if(!u||this.state===be.WAITING_LEVEL||this.waitForLive(a)){this.level=i,this.state=be.WAITING_LEVEL,this.startFragRequested=!1;return}const f=l.len,p=this.getMaxBufferLength(a.maxBitrate);if(f>=p)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);const y=this.backtrackFragment?this.backtrackFragment.start:l.end;let v=this.getNextFragment(y,u);if(this.couldBacktrack&&!this.fragPrevious&&v&&Or(v)&&this.fragmentTracker.getState(v)!==en.OK){var E;const T=((E=this.backtrackFragment)!=null?E:v).sn-u.startSN,I=u.fragments[T-1];I&&v.cc===I.cc&&(v=I,this.fragmentTracker.removeFragment(I))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(v&&this.isLoopLoading(v,y)){if(!v.gap){const T=this.audioOnly&&!this.altAudio?Yt.AUDIO:Yt.VIDEO,I=(T===Yt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;I&&this.afterBufferFlushed(I,T,ze.MAIN)}v=this.getNextFragmentLoopLoading(v,u,l,ze.MAIN,p)}v&&(v.initSegment&&!v.initSegment.data&&!this.bitrateTest&&(v=v.initSegment),this.loadFragment(v,a,y))}loadFragment(e,r,n){const s=this.fragmentTracker.getState(e);s===en.NOT_LOADED||s===en.PARTIAL?Or(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,r)):super.loadFragment(e,r,n):this._loadInitSegment(e,r):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,ze.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:r}=this;if(r!=null&&r.readyState){let n;const s=this.getAppendedFrag(r.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const i=this.getLevelDetails();if(i!=null&&i.live){const l=this.getMainFwdBufferInfo();if(!l||l.len<i.targetduration*2)return}if(!r.paused&&e){const l=this.hls.nextLoadLevel,d=e[l],u=this.fragLastKbps;u&&this.fragCurrent?n=this.fragCurrent.duration*d.maxBitrate/(1e3*u)+1:n=0}else n=0;const a=this.getBufferedFrag(r.currentTime+n);if(a){const l=this.followingBufferedFrag(a);if(l){this.abortCurrentFrag();const d=l.maxStartPTS?l.maxStartPTS:l.start,u=l.duration,f=Math.max(a.end,d+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(f,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case be.KEY_LOADING:case be.FRAG_LOADING:case be.FRAG_LOADING_WAITING_RETRY:case be.PARSING:case be.PARSED:this.state=be.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,r){super.flushMainBuffer(e,r,this.altAudio===2?"video":null)}onMediaAttached(e,r){super.onMediaAttached(e,r);const n=r.media;Wn(n,"playing",this.onMediaPlaying),Wn(n,"seeked",this.onMediaSeeked)}onMediaDetaching(e,r){const{media:n}=this;n&&(ls(n,"playing",this.onMediaPlaying),ls(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,r),!r.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,r){let n=!1,s=!1;for(let i=0;i<r.levels.length;i++){const a=r.levels[i].audioCodec;a&&(n=n||a.indexOf("mp4a.40.2")!==-1,s=s||a.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=n&&s&&!bse(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=r.levels,this.startFragRequested=!1}onLevelLoading(e,r){const{levels:n}=this;if(!n||this.state!==be.IDLE)return;const s=r.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=be.WAITING_LEVEL)}onLevelLoaded(e,r){var n;const{levels:s,startFragRequested:i}=this,a=r.level,l=r.details,d=l.totalduration;if(!s){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""}, cc [${l.startCC}, ${l.endCC}] duration:${d}`);const u=r.levelInfo,f=this.fragCurrent;f&&(this.state===be.FRAG_LOADING||this.state===be.FRAG_LOADING_WAITING_RETRY)&&f.level!==r.level&&f.loader&&this.abortCurrentFrag();let p=0;if(l.live||(n=u.details)!=null&&n.live){var y;if(this.checkLiveUpdate(l),l.deltaUpdateFailed)return;p=this.alignPlaylists(l,u.details,(y=this.levelLastLoaded)==null?void 0:y.details)}if(u.details=l,this.levelLastLoaded=u,i||this.setStartPosition(l,p),this.hls.trigger(M.LEVEL_UPDATED,{details:l,level:a}),this.state===be.WAITING_LEVEL){if(this.waitForCdnTuneIn(l))return;this.state=be.IDLE}i&&l.live&&this.synchronizeToLiveEdge(l),this.tick()}synchronizeToLiveEdge(e){const{config:r,media:n}=this;if(!n)return;const s=this.hls.liveSyncPosition,i=this.getLoadPosition(),a=e.fragmentStart,l=e.edge,d=i>=a-r.maxFragLookUpTolerance&&i<=l;if(s!==null&&n.duration>s&&(i<s||!d)){const f=r.liveMaxLatencyDuration!==void 0?r.liveMaxLatencyDuration:r.liveMaxLatencyDurationCount*e.targetduration;if((!d&&n.readyState<4||i<l-f)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),n.readyState))if(this.warn(`Playback: ${i.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${s.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const p=ht.bufferInfo(n,s,0);if(!((u=p.buffered)!=null&&u.length)){n.currentTime=s;return}if(p.start<=i){n.currentTime=s;return}const{nextStart:v}=ht.bufferedInfo(p.buffered,i,0);v&&(n.currentTime=v)}else n.currentTime=s}}_handleFragmentLoadProgress(e){var r;const n=e.frag,{part:s,payload:i}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${n.sn} of level ${n.level} will not be buffered`);return}const l=a[n.level];if(!l){this.warn(`Level ${n.level} not found on progress`);return}const d=l.details;if(!d){this.warn(`Dropping fragment ${n.sn} of level ${n.level} after level details were reset`),this.fragmentTracker.removeFragment(n);return}const u=l.videoCodec,f=d.PTSKnown||!d.live,p=(r=n.initSegment)==null?void 0:r.data,y=this._getAudioCodec(l),v=this.transmuxer=this.transmuxer||new AM(this.hls,ze.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),E=s?s.index:-1,b=E!==-1,T=new KE(n.level,n.sn,n.stats.chunkCount,i.byteLength,E,b),I=this.initPTS[n.cc];v.push(i,p,y,u,n,s,d.totalduration,f,T,I)}onAudioTrackSwitching(e,r){const n=this.hls,s=this.altAudio!==0;if(pp(r.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s){this.altAudio=0,this.fragmentTracker.removeAllFragments(),n.once(M.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(M.AUDIO_TRACK_SWITCHED,r)}),n.trigger(M.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}n.trigger(M.AUDIO_TRACK_SWITCHED,r)}}onAudioTrackSwitched(e,r){const n=pp(r.url,this.hls);if(n){const s=this.videoBuffer;s&&this.mediaBuffer!==s&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=s)}this.altAudio=n?2:0,this.tick()}onBufferCreated(e,r){const n=r.tracks;let s,i,a=!1;for(const l in n){const d=n[l];if(d.id==="main"){if(i=l,s=d,l==="video"){const u=n[l];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&s?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,r){const{frag:n,part:s}=r,i=n.type===ze.MAIN;if(i){if(this.fragContextChanged(n)){this.warn(`Fragment ${n.sn}${s?" p: "+s.index:""} of level ${n.level} finished buffering, but was aborted. state: ${this.state}`),this.state===be.PARSED&&(this.state=be.IDLE);return}const l=s?s.stats:n.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),Or(n)&&(this.fragPrevious=n),this.fragBufferedComplete(n,s)}const a=this.media;a&&(!this._hasEnoughToStart&&ht.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,r){var n;if(r.fatal){this.state=be.ERROR;return}switch(r.details){case ue.FRAG_GAP:case ue.FRAG_PARSING_ERROR:case ue.FRAG_DECRYPT_ERROR:case ue.FRAG_LOAD_ERROR:case ue.FRAG_LOAD_TIMEOUT:case ue.KEY_LOAD_ERROR:case ue.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ze.MAIN,r);break;case ue.LEVEL_LOAD_ERROR:case ue.LEVEL_LOAD_TIMEOUT:case ue.LEVEL_PARSING_ERROR:!r.levelRetry&&this.state===be.WAITING_LEVEL&&((n=r.context)==null?void 0:n.type)===Ct.LEVEL&&(this.state=be.IDLE);break;case ue.BUFFER_ADD_CODEC_ERROR:case ue.BUFFER_APPEND_ERROR:if(r.parent!=="main")return;this.reduceLengthAndFlushBuffer(r)&&this.resetLoadingState();break;case ue.BUFFER_FULL_ERROR:if(r.parent!=="main")return;this.reduceLengthAndFlushBuffer(r)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case ue.INTERNAL_EXCEPTION:this.recoverWorkerError(r);break}}onFragLoadEmergencyAborted(){this.state=be.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:r}){if(r!==Yt.AUDIO||!this.altAudio){const n=(r===Yt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,r,ze.MAIN),this.tick())}}onLevelsUpdated(e,r){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=r.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const r=e.currentTime;let n=this.startPosition;if(n>=0&&r<n){if(e.seeking){this.log(`could not seek to ${n}, already seeking at ${r}`);return}const s=this.timelineOffset;s&&n&&(n+=s);const i=this.getLevelDetails(),a=ht.getBuffered(e),l=a.length?a.start(0):0,d=l-n,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||d>0&&(d<u||this.loadingParts&&d<2*((i==null?void 0:i.partTarget)||0)))&&(this.log(`adjusting start position by ${d} to match buffer start`),n+=d,this.startPosition=n),r<n&&(this.log(`seek to target start position ${n} from current time ${r} buffer start ${l}`),e.currentTime=n)}}_getAudioCodec(e){let r=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&r&&(this.log("Swapping audio codec"),r.indexOf("mp4a.40.5")!==-1?r="mp4a.40.2":r="mp4a.40.5"),r}_loadBitrateTestFrag(e,r){e.bitrateTest=!0,this._doFragLoad(e,r).then(n=>{const{hls:s}=this,i=n==null?void 0:n.frag;if(!i||this.fragContextChanged(i))return;r.fragmentError=0,this.state=be.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=i.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),s.trigger(M.FRAG_LOADED,n),i.bitrateTest=!1}).catch(n=>{this.state===be.STOPPED||this.state===be.ERROR||(this.warn(n),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){const r=this.playlistType,{hls:n}=this,{remuxResult:s,chunkMeta:i}=e,a=this.getCurrentContext(i);if(!a){this.resetWhenMissingContext(i);return}const{frag:l,part:d,level:u}=a,{video:f,text:p,id3:y,initSegment:v}=s,{details:E}=u,b=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=be.PARSING,v){const T=v.tracks;if(T){const L=l.initSegment||l;if(this.unhandledEncryptionError(v,l))return;this._bufferInitSegment(u,T,L,i),n.trigger(M.FRAG_PARSING_INIT_SEGMENT,{frag:L,id:r,tracks:T})}const I=v.initPTS,N=v.timescale,A=this.initPTS[l.cc];if(Ve(I)&&(!A||A.baseTime!==I||A.timescale!==N)){const L=v.trackId;this.initPTS[l.cc]={baseTime:I,timescale:N,trackId:L},n.trigger(M.INIT_PTS_FOUND,{frag:l,id:r,initPTS:I,timescale:N,trackId:L})}}if(f&&E){b&&f.type==="audiovideo"&&this.logMuxedErr(l);const T=E.fragments[l.sn-1-E.startSN],I=l.sn===E.startSN,N=!T||l.cc>T.cc;if(s.independent!==!1){const{startPTS:A,endPTS:L,startDTS:P,endDTS:k}=f;if(d)d.elementaryStreams[f.type]={startPTS:A,endPTS:L,startDTS:P,endDTS:k};else if(f.firstKeyFrame&&f.independent&&i.id===1&&!N&&(this.couldBacktrack=!0),f.dropped&&f.independent){const D=this.getMainFwdBufferInfo(),O=(D?D.end:this.getLoadPosition())+this.config.maxBufferHole,F=f.firstKeyFramePTS?f.firstKeyFramePTS:A;if(!I&&O<F-this.config.maxBufferHole&&!N){this.backtrack(l);return}else N&&(l.gap=!0);l.setElementaryStreamInfo(f.type,l.start,L,l.start,k,!0)}else I&&A-(E.appliedTimelineOffset||0)>d0&&(l.gap=!0);l.setElementaryStreamInfo(f.type,A,L,P,k),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(f,l,d,i,I||N)}else if(I||N)l.gap=!0;else{this.backtrack(l);return}}if(b){const{startPTS:T,endPTS:I,startDTS:N,endDTS:A}=b;d&&(d.elementaryStreams[Yt.AUDIO]={startPTS:T,endPTS:I,startDTS:N,endDTS:A}),l.setElementaryStreamInfo(Yt.AUDIO,T,I,N,A),this.bufferFragmentData(b,l,d,i)}if(E&&y!=null&&y.samples.length){const T={id:r,frag:l,details:E,samples:y.samples};n.trigger(M.FRAG_PARSING_METADATA,T)}if(E&&p){const T={id:r,frag:l,details:E,samples:p.samples};n.trigger(M.FRAG_PARSING_USERDATA,T)}}logMuxedErr(e){this.warn(`${Or(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,r,n,s){if(this.state!==be.PARSING)return;this.audioOnly=!!r.audio&&!r.video,this.altAudio&&!this.audioOnly&&(delete r.audio,r.audiovideo&&this.logMuxedErr(n));const{audio:i,video:a,audiovideo:l}=r;if(i){const u=e.audioCodec;let f=s0(i.codec,u);f==="mp4a"&&(f="mp4a.40.5");const p=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){f&&(f.indexOf("mp4a.40.5")!==-1?f="mp4a.40.2":f="mp4a.40.5");const y=i.metadata;y&&"channelCount"in y&&(y.channelCount||1)!==1&&p.indexOf("firefox")===-1&&(f="mp4a.40.5")}f&&f.indexOf("mp4a.40.5")!==-1&&p.indexOf("android")!==-1&&i.container!=="audio/mpeg"&&(f="mp4a.40.2",this.log(`Android: force audio codec to ${f}`)),u&&u!==f&&this.log(`Swapping manifest audio codec "${u}" for "${f}"`),i.levelCodec=f,i.id=ze.MAIN,this.log(`Init audio buffer, container:${i.container}, codecs[selected/level/parsed]=[${f||""}/${u||""}/${i.codec}]`),delete r.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=ze.MAIN;const u=a.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${a.codec!==u?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete r.audiovideo}l&&(this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),delete r.video,delete r.audio);const d=Object.keys(r);if(d.length){if(this.hls.trigger(M.BUFFER_CODECS,r),!this.hls)return;d.forEach(u=>{const p=r[u].initSegment;p!=null&&p.byteLength&&this.hls.trigger(M.BUFFER_APPENDING,{type:u,data:p,frag:n,part:null,chunkMeta:s,parent:n.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ze.MAIN)}get maxBufferLength(){const{levels:e,level:r}=this,n=e==null?void 0:e[r];return n?this.getMaxBufferLength(n.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=be.IDLE}checkFragmentChanged(){const e=this.media;let r=null;if(e&&e.readyState>1&&e.seeking===!1){const n=e.currentTime;if(ht.isBuffered(e,n)?r=this.getAppendedFrag(n):ht.isBuffered(e,n+.1)&&(r=this.getAppendedFrag(n+.1)),r){this.backtrackFragment=null;const s=this.fragPlaying,i=r.level;(!s||r.sn!==s.sn||s.level!==i)&&(this.fragPlaying=r,this.hls.trigger(M.FRAG_CHANGED,{frag:r}),(!s||s.level!==i)&&this.hls.trigger(M.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const r=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return Ve(r)?this.getAppendedFrag(r):null}get currentProgramDateTime(){var e;const r=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(Ve(r)){const n=this.getLevelDetails(),s=this.currentFrag||(n?Xl(null,n.fragments,r):null);if(s){const i=s.programDateTime;if(i!==null){const a=i+(r-s.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Tse extends ii{constructor(e,r){super("key-loader",r),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const n in this.keyIdToKeyInfo){const s=this.keyIdToKeyInfo[n].loader;if(s){var r;if(e&&e!==((r=s.context)==null?void 0:r.frag.type))return;s.abort()}}}detach(){for(const e in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[e];(r.mediaKeySessionContext||r.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyIdToKeyInfo){const r=this.keyIdToKeyInfo[e].loader;r&&r.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,r=ue.KEY_LOAD_ERROR,n,s,i){return new va({type:Qe.NETWORK_ERROR,details:r,fatal:!1,frag:e,response:i,error:n,networkDetails:s})}loadClear(e,r,n){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(r.length)for(let s=0,i=r.length;s<i;s++){const a=r[s];if(e.cc<=a.cc&&(!Or(e)||!Or(a)||e.sn<a.sn)||!n&&s==i-1)return this.emeController.selectKeySystemFormat(a).then(l=>{if(!this.emeController)return;a.setKeyFormat(l);const d=a0(l);if(d)return this.emeController.getKeySystemAccess([d])})}if(this.config.requireKeySystemAccessOnStart){const s=Fd(this.config);if(s.length)return this.emeController.getKeySystemAccess(s)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(r=>this.loadInternal(e,r)):this.loadInternal(e)}loadInternal(e,r){var n,s;r&&e.setKeyFormat(r);const i=e.decryptdata;if(!i){const u=new Error(r?`Expected frag.decryptdata to be defined after setting format ${r}`:`Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ${this.emeController&&this.config.emeEnabled})`);return Promise.reject(this.createKeyLoadError(e,ue.KEY_LOAD_ERROR,u))}const a=i.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,ue.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));const l=j1(i);let d=this.keyIdToKeyInfo[l];if((n=d)!=null&&n.decryptdata.key)return i.key=d.decryptdata.key,Promise.resolve({frag:e,keyInfo:d});if(this.emeController&&(s=d)!=null&&s.keyLoadPromise)switch(this.emeController.getKeyStatus(d.decryptdata)){case"usable":case"usable-in-future":return d.keyLoadPromise.then(f=>{const{keyInfo:p}=f;return i.key=p.decryptdata.key,{frag:e,keyInfo:p}})}switch(this.log(`${this.keyIdToKeyInfo[l]?"Rel":"L"}oading${i.keyId?" keyId: "+wn(i.keyId):""} URI: ${i.uri} from ${e.type} ${e.level}`),d=this.keyIdToKeyInfo[l]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return i.keyFormat==="identity"?this.loadKeyHTTP(d,e):this.loadKeyEME(d,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(d,e);default:return Promise.reject(this.createKeyLoadError(e,ue.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${i.method}"`)))}}loadKeyEME(e,r){const n={frag:r,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var s;if(!e.decryptdata.keyId&&(s=r.initSegment)!=null&&s.data){const a=GJ(r.initSegment.data);if(a.length){let l=a[0];l.some(d=>d!==0)?(this.log(`Using keyId found in init segment ${wn(l)}`),Ao.setKeyIdForUri(e.decryptdata.uri,l)):(l=Ao.addKeyIdForUri(e.decryptdata.uri),this.log(`Generating keyId to patch media ${wn(l)}`)),e.decryptdata.keyId=l}}if(!e.decryptdata.keyId&&!Or(r))return Promise.resolve(n);const i=this.emeController.loadKey(n);return(e.keyLoadPromise=i.then(a=>(e.mediaKeySessionContext=a,n))).catch(a=>{throw e.keyLoadPromise=null,"data"in a&&(a.data.frag=r),a})}return Promise.resolve(n)}loadKeyHTTP(e,r){const n=this.config,s=n.loader,i=new s(n);return r.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((a,l)=>{const d={keyInfo:e,frag:r,responseType:"arraybuffer",url:e.decryptdata.uri},u=n.keyLoadPolicy.default,f={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},p={onSuccess:(y,v,E,b)=>{const{frag:T,keyInfo:I}=E,N=j1(I.decryptdata);if(!T.decryptdata||I!==this.keyIdToKeyInfo[N])return l(this.createKeyLoadError(T,ue.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),b));I.decryptdata.key=T.decryptdata.key=new Uint8Array(y.data),T.keyLoader=null,I.loader=null,a({frag:T,keyInfo:I})},onError:(y,v,E,b)=>{this.resetLoader(v),l(this.createKeyLoadError(r,ue.KEY_LOAD_ERROR,new Error(`HTTP Error ${y.code} loading key ${y.text}`),E,$t({url:d.url,data:void 0},y)))},onTimeout:(y,v,E)=>{this.resetLoader(v),l(this.createKeyLoadError(r,ue.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),E))},onAbort:(y,v,E)=>{this.resetLoader(v),l(this.createKeyLoadError(r,ue.INTERNAL_ABORTED,new Error("key loading aborted"),E))}};i.load(d,f,p)})}resetLoader(e){const{frag:r,keyInfo:n,url:s}=e,i=n.loader;r.keyLoader===i&&(r.keyLoader=null,n.loader=null);const a=j1(n.decryptdata)||s;delete this.keyIdToKeyInfo[a],i&&i.destroy()}}function j1(t){if(t.keyFormat!==En.FAIRPLAY){const e=t.keyId;if(e)return wn(e)}return t.uri}function WN(t){const{type:e}=t;switch(e){case Ct.AUDIO_TRACK:return ze.AUDIO;case Ct.SUBTITLE_TRACK:return ze.SUBTITLE;default:return ze.MAIN}}function M1(t,e){let r=t.url;return(r===void 0||r.indexOf("data:")===0)&&(r=e.url),r}class Cse{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(M.MANIFEST_LOADING,this.onManifestLoading,this),e.on(M.LEVEL_LOADING,this.onLevelLoading,this),e.on(M.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(M.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(M.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(M.MANIFEST_LOADING,this.onManifestLoading,this),e.off(M.LEVEL_LOADING,this.onLevelLoading,this),e.off(M.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(M.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(M.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const r=this.hls.config,n=r.pLoader,s=r.loader,i=n||s,a=new i(r);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const r=this.loaders[e];r&&r.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,r){const{url:n}=r;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Ct.MANIFEST,url:n,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,r){const{id:n,level:s,pathwayId:i,url:a,deliveryDirectives:l,levelInfo:d}=r;this.load({id:n,level:s,pathwayId:i,responseType:"text",type:Ct.LEVEL,url:a,deliveryDirectives:l,levelOrTrack:d})}onAudioTrackLoading(e,r){const{id:n,groupId:s,url:i,deliveryDirectives:a,track:l}=r;this.load({id:n,groupId:s,level:null,responseType:"text",type:Ct.AUDIO_TRACK,url:i,deliveryDirectives:a,levelOrTrack:l})}onSubtitleTrackLoading(e,r){const{id:n,groupId:s,url:i,deliveryDirectives:a,track:l}=r;this.load({id:n,groupId:s,level:null,responseType:"text",type:Ct.SUBTITLE_TRACK,url:i,deliveryDirectives:a,levelOrTrack:l})}onLevelsUpdated(e,r){const n=this.loaders[Ct.LEVEL];if(n){const s=n.context;s&&!r.levels.some(i=>i===s.levelOrTrack)&&(n.abort(),delete this.loaders[Ct.LEVEL])}}load(e){var r;const n=this.hls.config;let s=this.getInternalLoader(e);if(s){const u=this.hls.logger,f=s.context;if(f&&f.levelOrTrack===e.levelOrTrack&&(f.url===e.url||f.deliveryDirectives&&!e.deliveryDirectives)){f.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${f.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),s.abort()}let i;if(e.type===Ct.MANIFEST?i=n.manifestLoadPolicy.default:i=zt({},n.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),s=this.createInternalLoader(e),Ve((r=e.deliveryDirectives)==null?void 0:r.part)){let u;if(e.type===Ct.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===Ct.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===Ct.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const f=u.partTarget,p=u.targetduration;if(f&&p){const y=Math.max(f*3,p*.8)*1e3;i=zt({},i,{maxTimeToFirstByteMs:Math.min(y,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(y,i.maxTimeToFirstByteMs)})}}}const a=i.errorRetry||i.timeoutRetry||{},l={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},d={onSuccess:(u,f,p,y)=>{const v=this.getInternalLoader(p);this.resetInternalLoader(p.type);const E=u.data;f.parsing.start=performance.now(),Zi.isMediaPlaylist(E)||p.type!==Ct.MANIFEST?this.handleTrackOrLevelPlaylist(u,f,p,y||null,v):this.handleMasterPlaylist(u,f,p,y)},onError:(u,f,p,y)=>{this.handleNetworkError(f,p,!1,u,y)},onTimeout:(u,f,p)=>{this.handleNetworkError(f,p,!0,void 0,u)}};s.load(e,l,d)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:r},forceStartLoad:n}=this.hls;(e||n)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${r}`),this.hls.startLoad(r))}handleMasterPlaylist(e,r,n,s){const i=this.hls,a=e.data,l=M1(e,n),d=Zi.parseMasterPlaylist(a,l);if(d.playlistParsingError){r.parsing.end=performance.now(),this.handleManifestParsingError(e,n,d.playlistParsingError,s,r);return}const{contentSteering:u,levels:f,sessionData:p,sessionKeys:y,startTimeOffset:v,variableList:E}=d;this.variableList=E,f.forEach(N=>{const{unknownCodecs:A}=N;if(A){const{preferManagedMediaSource:L}=this.hls.config;let{audioCodec:P,videoCodec:k}=N;for(let D=A.length;D--;){const O=A[D];$h(O,"audio",L)?(N.audioCodec=P=P?`${P},${O}`:O,Ou.audio[P.substring(0,4)]=2,A.splice(D,1)):$h(O,"video",L)&&(N.videoCodec=k=k?`${k},${O}`:O,Ou.video[k.substring(0,4)]=2,A.splice(D,1))}}});const{AUDIO:b=[],SUBTITLES:T,"CLOSED-CAPTIONS":I}=Zi.parseMasterPlaylistMedia(a,l,d);b.length&&!b.some(A=>!A.url)&&f[0].audioCodec&&!f[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),b.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new dr({}),bitrate:0,url:""})),i.trigger(M.MANIFEST_LOADED,{levels:f,audioTracks:b,subtitles:T,captions:I,contentSteering:u,url:l,stats:r,networkDetails:s,sessionData:p,sessionKeys:y,startTimeOffset:v,variableList:E})}handleTrackOrLevelPlaylist(e,r,n,s,i){const a=this.hls,{id:l,level:d,type:u}=n,f=M1(e,n),p=Ve(d)?d:Ve(l)?l:0,y=WN(n),v=Zi.parseLevelPlaylist(e.data,f,p,y,0,this.variableList);if(u===Ct.MANIFEST){const E={attrs:new dr({}),bitrate:0,details:v,name:"",url:f};v.requestScheduled=r.loading.start+tM(v,0),a.trigger(M.MANIFEST_LOADED,{levels:[E],audioTracks:[],url:f,stats:r,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}r.parsing.end=performance.now(),n.levelDetails=v,this.handlePlaylistLoaded(v,e,r,n,s,i)}handleManifestParsingError(e,r,n,s,i){this.hls.trigger(M.ERROR,{type:Qe.NETWORK_ERROR,details:ue.MANIFEST_PARSING_ERROR,fatal:r.type===Ct.MANIFEST,url:e.url,err:n,error:n,reason:n.message,response:e,context:r,networkDetails:s,stats:i})}handleNetworkError(e,r,n=!1,s,i){let a=`A network ${n?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===Ct.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===Ct.AUDIO_TRACK||e.type===Ct.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const l=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let d=ue.UNKNOWN,u=!1;const f=this.getInternalLoader(e);switch(e.type){case Ct.MANIFEST:d=n?ue.MANIFEST_LOAD_TIMEOUT:ue.MANIFEST_LOAD_ERROR,u=!0;break;case Ct.LEVEL:d=n?ue.LEVEL_LOAD_TIMEOUT:ue.LEVEL_LOAD_ERROR,u=!1;break;case Ct.AUDIO_TRACK:d=n?ue.AUDIO_TRACK_LOAD_TIMEOUT:ue.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case Ct.SUBTITLE_TRACK:d=n?ue.SUBTITLE_TRACK_LOAD_TIMEOUT:ue.SUBTITLE_LOAD_ERROR,u=!1;break}f&&this.resetInternalLoader(e.type);const p={type:Qe.NETWORK_ERROR,details:d,fatal:u,url:e.url,loader:f,context:e,error:l,networkDetails:r,stats:i};if(s){const y=(r==null?void 0:r.url)||e.url;p.response=$t({url:y,data:void 0},s)}this.hls.trigger(M.ERROR,p)}handlePlaylistLoaded(e,r,n,s,i,a){const l=this.hls,{type:d,level:u,levelOrTrack:f,id:p,groupId:y,deliveryDirectives:v}=s,E=M1(r,s),b=WN(s);let T=typeof s.level=="number"&&b===ze.MAIN?u:void 0;const I=e.playlistParsingError;if(I){if(this.hls.logger.warn(`${I} ${e.url}`),!l.config.ignorePlaylistParsingErrors){l.trigger(M.ERROR,{type:Qe.NETWORK_ERROR,details:ue.LEVEL_PARSING_ERROR,fatal:!1,url:E,error:I,reason:I.message,response:r,context:s,level:T,parent:b,networkDetails:i,stats:n});return}e.playlistParsingError=null}if(!e.fragments.length){const N=e.playlistParsingError=new Error("No Segments found in Playlist");l.trigger(M.ERROR,{type:Qe.NETWORK_ERROR,details:ue.LEVEL_EMPTY_ERROR,fatal:!1,url:E,error:N,reason:N.message,response:r,context:s,level:T,parent:b,networkDetails:i,stats:n});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),d){case Ct.MANIFEST:case Ct.LEVEL:if(T){if(!f)T=0;else if(f!==l.levels[T]){const N=l.levels.indexOf(f);N>-1&&(T=N)}}l.trigger(M.LEVEL_LOADED,{details:e,levelInfo:f||l.levels[0],level:T||0,id:p||0,stats:n,networkDetails:i,deliveryDirectives:v,withoutMultiVariant:d===Ct.MANIFEST});break;case Ct.AUDIO_TRACK:l.trigger(M.AUDIO_TRACK_LOADED,{details:e,track:f,id:p||0,groupId:y||"",stats:n,networkDetails:i,deliveryDirectives:v});break;case Ct.SUBTITLE_TRACK:l.trigger(M.SUBTITLE_TRACK_LOADED,{details:e,track:f,id:p||0,groupId:y||"",stats:n,networkDetails:i,deliveryDirectives:v});break}}}class Sn{static get version(){return Hh}static isMSESupported(){return eO()}static isSupported(){return wse()}static getMediaSource(){return Bo()}static get Events(){return M}static get MetadataSchema(){return As}static get ErrorTypes(){return Qe}static get ErrorDetails(){return ue}static get DefaultConfig(){return Sn.defaultConfig?Sn.defaultConfig:lse}static set DefaultConfig(e){Sn.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new QE,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const r=this.logger=LJ(e.debug||!1,"Hls instance",e.assetPlayerId),n=this.config=use(Sn.DefaultConfig,e,r);this.userConfig=e,n.progressive&&dse(n,r);const{abrController:s,bufferController:i,capLevelController:a,errorController:l,fpsController:d}=n,u=new l(this),f=this.abrController=new s(this),p=new Aee(this),y=n.interstitialsController,v=y?this.interstitialsController=new y(this,Sn):null,E=this.bufferController=new i(this,p),b=this.capLevelController=new a(this),T=new d(this),I=new Cse(this),N=n.contentSteeringController,A=N?new N(this):null,L=this.levelController=new vse(this,A),P=new xse(this),k=new Tse(this.config,this.logger),D=this.streamController=new Sse(this,p,k),O=this.gapController=new pse(this,p);b.setStreamController(D),T.setStreamController(D);const F=[I,L,D];v&&F.splice(1,0,v),A&&F.splice(1,0,A),this.networkControllers=F;const $=[f,E,O,b,T,P,p];this.audioTrackController=this.createController(n.audioTrackController,F);const G=n.audioStreamController;G&&F.push(this.audioStreamController=new G(this,p,k)),this.subtitleTrackController=this.createController(n.subtitleTrackController,F);const Y=n.subtitleStreamController;Y&&F.push(this.subtititleStreamController=new Y(this,p,k)),this.createController(n.timelineController,$),k.emeController=this.emeController=this.createController(n.emeController,$),this.cmcdController=this.createController(n.cmcdController,$),this.latencyController=this.createController(yse,$),this.coreComponents=$,F.push(u);const ne=u.onErrorOut;typeof ne=="function"&&this.on(M.ERROR,ne,u),this.on(M.MANIFEST_LOADED,I.onManifestLoaded,I)}createController(e,r){if(e){const n=new e(this);return r&&r.push(n),n}return null}on(e,r,n=this){this._emitter.on(e,r,n)}once(e,r,n=this){this._emitter.once(e,r,n)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,r,n=this,s){this._emitter.off(e,r,n,s)}listeners(e){return this._emitter.listeners(e)}emit(e,r,n){return this._emitter.emit(e,r,n)}trigger(e,r){if(this.config.debug)return this.emit(e,e,r);try{return this.emit(e,e,r)}catch(n){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+n.message+'". Here is a stacktrace:',n),!this.triggeringException){this.triggeringException=!0;const s=e===M.ERROR;this.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.INTERNAL_EXCEPTION,fatal:s,event:e,error:n}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(M.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(r=>r.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(r=>r.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const i=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(M.ERROR,{type:Qe.OTHER_ERROR,details:ue.ATTACH_MEDIA_ERROR,fatal:!0,error:i});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const r="media"in e,n=r?e.media:e,s=r?e:{media:n};this._media=n,this.trigger(M.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(M.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(M.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const r=this.media,n=this._url,s=this._url=UE.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),r&&n&&(n!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(r)),this.trigger(M.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,r){this.logger.log(`startLoad(${e+(r?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let n=0;n<this.networkControllers.length&&(this.networkControllers[n].startLoad(e,r),!(!this.started||!this.networkControllers));n++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[ze.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[ze.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[ze.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,r=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),r&&this.startLoad(r))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=pne()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const r=!!e;r!==this.config.capLevelToPlayerSize&&(r?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=r)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){uee(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:r}}=this;if(!e)return 0;const n=e.length;for(let s=0;s<n;s++)if(e[s].maxBitrate>=r)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:r,maxHdcpLevel:n}=this;let s;if(r===-1&&e!=null&&e.length?s=e.length-1:s=r,n)for(let i=s;i--;){const a=e[i].attrs["HDCP-LEVEL"];if(a&&a<=n)return i}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var r;return((r=this.audioTrackController)==null?void 0:r.setAudioOption(e))||null}setSubtitleOption(e){var r;return((r=this.subtitleTrackController)==null?void 0:r.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const r=this.audioTrackController;r&&(r.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const r=this.subtitleTrackController;r&&(r.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const r=this.subtitleTrackController;r&&(r.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,r=this.allAudioTracks){const n=Uj(r);return Fj(e,n,navigator.mediaCapabilities)}}Sn.defaultConfig=void 0;var tO=["PageUp","PageDown"],rO=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],nO={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},sd="Slider",[Zv,Ase,Nse]=tf(sd),[sO,Bae]=hn(sd,[Nse]),[Ise,jg]=sO(sd),iO=C.forwardRef((t,e)=>{const{name:r,min:n=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:l=!1,minStepsBetweenThumbs:d=0,defaultValue:u=[n],value:f,onValueChange:p=()=>{},onValueCommit:y=()=>{},inverted:v=!1,form:E,...b}=t,T=C.useRef(new Set),I=C.useRef(0),A=a==="horizontal"?Rse:_se,[L=[],P]=Ai({prop:f,defaultProp:u,onChange:G=>{var ne;(ne=[...T.current][I.current])==null||ne.focus(),p(G)}}),k=C.useRef(L);function D(G){const Y=jse(L,G);$(G,Y)}function O(G){$(G,I.current)}function F(){const G=k.current[I.current];L[I.current]!==G&&y(L)}function $(G,Y,{commit:ne}={commit:!1}){const X=Bse(i),z=Use(Math.round((G-n)/i)*i+n,X),Z=Fh(z,[n,s]);P((ee=[])=>{const q=Dse(ee,Z,Y);if(Fse(q,d*i)){I.current=q.indexOf(Z);const K=String(q)!==String(ee);return K&&ne&&y(q),K?q:ee}else return ee})}return o.jsx(Ise,{scope:t.__scopeSlider,name:r,disabled:l,min:n,max:s,valueIndexToChangeRef:I,thumbs:T.current,values:L,orientation:a,form:E,children:o.jsx(Zv.Provider,{scope:t.__scopeSlider,children:o.jsx(Zv.Slot,{scope:t.__scopeSlider,children:o.jsx(A,{"aria-disabled":l,"data-disabled":l?"":void 0,...b,ref:e,onPointerDown:Re(b.onPointerDown,()=>{l||(k.current=L)}),min:n,max:s,inverted:v,onSlideStart:l?void 0:D,onSlideMove:l?void 0:O,onSlideEnd:l?void 0:F,onHomeKeyDown:()=>!l&&$(n,0,{commit:!0}),onEndKeyDown:()=>!l&&$(s,L.length-1,{commit:!0}),onStepKeyDown:({event:G,direction:Y})=>{if(!l){const z=tO.includes(G.key)||G.shiftKey&&rO.includes(G.key)?10:1,Z=I.current,ee=L[Z],q=i*z*Y;$(ee+q,Z,{commit:!0})}}})})})})});iO.displayName=sd;var[aO,oO]=sO(sd,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Rse=C.forwardRef((t,e)=>{const{min:r,max:n,dir:s,inverted:i,onSlideStart:a,onSlideMove:l,onSlideEnd:d,onStepKeyDown:u,...f}=t,[p,y]=C.useState(null),v=st(e,A=>y(A)),E=C.useRef(void 0),b=rc(s),T=b==="ltr",I=T&&!i||!T&&i;function N(A){const L=E.current||p.getBoundingClientRect(),P=[0,L.width],D=u2(P,I?[r,n]:[n,r]);return E.current=L,D(A-L.left)}return o.jsx(aO,{scope:t.__scopeSlider,startEdge:I?"left":"right",endEdge:I?"right":"left",direction:I?1:-1,size:"width",children:o.jsx(lO,{dir:b,"data-orientation":"horizontal",...f,ref:v,style:{...f.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:A=>{const L=N(A.clientX);a==null||a(L)},onSlideMove:A=>{const L=N(A.clientX);l==null||l(L)},onSlideEnd:()=>{E.current=void 0,d==null||d()},onStepKeyDown:A=>{const P=nO[I?"from-left":"from-right"].includes(A.key);u==null||u({event:A,direction:P?-1:1})}})})}),_se=C.forwardRef((t,e)=>{const{min:r,max:n,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:l,onStepKeyDown:d,...u}=t,f=C.useRef(null),p=st(e,f),y=C.useRef(void 0),v=!s;function E(b){const T=y.current||f.current.getBoundingClientRect(),I=[0,T.height],A=u2(I,v?[n,r]:[r,n]);return y.current=T,A(b-T.top)}return o.jsx(aO,{scope:t.__scopeSlider,startEdge:v?"bottom":"top",endEdge:v?"top":"bottom",size:"height",direction:v?1:-1,children:o.jsx(lO,{"data-orientation":"vertical",...u,ref:p,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const T=E(b.clientY);i==null||i(T)},onSlideMove:b=>{const T=E(b.clientY);a==null||a(T)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:b=>{const I=nO[v?"from-bottom":"from-top"].includes(b.key);d==null||d({event:b,direction:I?-1:1})}})})}),lO=C.forwardRef((t,e)=>{const{__scopeSlider:r,onSlideStart:n,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:l,onStepKeyDown:d,...u}=t,f=jg(sd,r);return o.jsx(He.span,{...u,ref:e,onKeyDown:Re(t.onKeyDown,p=>{p.key==="Home"?(a(p),p.preventDefault()):p.key==="End"?(l(p),p.preventDefault()):tO.concat(rO).includes(p.key)&&(d(p),p.preventDefault())}),onPointerDown:Re(t.onPointerDown,p=>{const y=p.target;y.setPointerCapture(p.pointerId),p.preventDefault(),f.thumbs.has(y)?y.focus():n(p)}),onPointerMove:Re(t.onPointerMove,p=>{p.target.hasPointerCapture(p.pointerId)&&s(p)}),onPointerUp:Re(t.onPointerUp,p=>{const y=p.target;y.hasPointerCapture(p.pointerId)&&(y.releasePointerCapture(p.pointerId),i(p))})})}),cO="SliderTrack",uO=C.forwardRef((t,e)=>{const{__scopeSlider:r,...n}=t,s=jg(cO,r);return o.jsx(He.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...n,ref:e})});uO.displayName=cO;var Jv="SliderRange",dO=C.forwardRef((t,e)=>{const{__scopeSlider:r,...n}=t,s=jg(Jv,r),i=oO(Jv,r),a=C.useRef(null),l=st(e,a),d=s.values.length,u=s.values.map(y=>mO(y,s.min,s.max)),f=d>1?Math.min(...u):0,p=100-Math.max(...u);return o.jsx(He.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...n,ref:l,style:{...t.style,[i.startEdge]:f+"%",[i.endEdge]:p+"%"}})});dO.displayName=Jv;var ew="SliderThumb",hO=C.forwardRef((t,e)=>{const r=Ase(t.__scopeSlider),[n,s]=C.useState(null),i=st(e,l=>s(l)),a=C.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return o.jsx(Lse,{...t,ref:i,index:a})}),Lse=C.forwardRef((t,e)=>{const{__scopeSlider:r,index:n,name:s,...i}=t,a=jg(ew,r),l=oO(ew,r),[d,u]=C.useState(null),f=st(e,N=>u(N)),p=d?a.form||!!d.closest("form"):!0,y=Jp(d),v=a.values[n],E=v===void 0?0:mO(v,a.min,a.max),b=kse(n,a.values.length),T=y==null?void 0:y[l.size],I=T?Mse(T,E,l.direction):0;return C.useEffect(()=>{if(d)return a.thumbs.add(d),()=>{a.thumbs.delete(d)}},[d,a.thumbs]),o.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${E}% + ${I}px)`},children:[o.jsx(Zv.ItemSlot,{scope:t.__scopeSlider,children:o.jsx(He.span,{role:"slider","aria-label":t["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":v,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:f,style:v===void 0?{display:"none"}:t.style,onFocus:Re(t.onFocus,()=>{a.valueIndexToChangeRef.current=n})})}),p&&o.jsx(fO,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:v},n)]})});hO.displayName=ew;var Pse="RadioBubbleInput",fO=C.forwardRef(({__scopeSlider:t,value:e,...r},n)=>{const s=C.useRef(null),i=st(s,n),a=Ig(e);return C.useEffect(()=>{const l=s.current;if(!l)return;const d=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(d,"value").set;if(a!==e&&f){const p=new Event("input",{bubbles:!0});f.call(l,e),l.dispatchEvent(p)}},[a,e]),o.jsx(He.input,{style:{display:"none"},...r,ref:i,defaultValue:e})});fO.displayName=Pse;function Dse(t=[],e,r){const n=[...t];return n[r]=e,n.sort((s,i)=>s-i)}function mO(t,e,r){const i=100/(r-e)*(t-e);return Fh(i,[0,100])}function kse(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function jse(t,e){if(t.length===1)return 0;const r=t.map(s=>Math.abs(s-e)),n=Math.min(...r);return r.indexOf(n)}function Mse(t,e,r){const n=t/2,i=u2([0,50],[0,n]);return(n-i(e)*r)*r}function Ose(t){return t.slice(0,-1).map((e,r)=>t[r+1]-e)}function Fse(t,e){if(e>0){const r=Ose(t);return Math.min(...r)>=e}return!0}function u2(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(t[1]-t[0]);return e[0]+n*(r-t[0])}}function Bse(t){return(String(t).split(".")[1]||"").length}function Use(t,e){const r=Math.pow(10,e);return Math.round(t*r)/r}var pO=iO,$se=uO,Vse=dO,Gse=hO;const yl=C.forwardRef(({className:t,...e},r)=>o.jsxs(pO,{ref:r,className:Ye("relative flex w-full touch-none select-none items-center",t),...e,children:[o.jsx($se,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:o.jsx(Vse,{className:"absolute h-full bg-primary"})}),o.jsx(Gse,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));yl.displayName=pO.displayName;var d2="Progress",h2=100,[Hse,Uae]=hn(d2),[zse,Wse]=Hse(d2),gO=C.forwardRef((t,e)=>{const{__scopeProgress:r,value:n=null,max:s,getValueLabel:i=Kse,...a}=t;(s||s===0)&&!KN(s)&&console.error(Yse(`${s}`,"Progress"));const l=KN(s)?s:h2;n!==null&&!YN(n,l)&&console.error(qse(`${n}`,"Progress"));const d=YN(n,l)?n:null,u=Sp(d)?i(d,l):void 0;return o.jsx(zse,{scope:r,value:d,max:l,children:o.jsx(He.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":Sp(d)?d:void 0,"aria-valuetext":u,role:"progressbar","data-state":vO(d,l),"data-value":d??void 0,"data-max":l,...a,ref:e})})});gO.displayName=d2;var xO="ProgressIndicator",yO=C.forwardRef((t,e)=>{const{__scopeProgress:r,...n}=t,s=Wse(xO,r);return o.jsx(He.div,{"data-state":vO(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...n,ref:e})});yO.displayName=xO;function Kse(t,e){return`${Math.round(t/e*100)}%`}function vO(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function Sp(t){return typeof t=="number"}function KN(t){return Sp(t)&&!isNaN(t)&&t>0}function YN(t,e){return Sp(t)&&!isNaN(t)&&t<=e&&t>=0}function Yse(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${h2}\`.`}function qse(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${h2} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var wO=gO,Xse=yO;const bO=C.forwardRef(({className:t,value:e,...r},n)=>o.jsx(wO,{ref:n,className:Ye("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:o.jsx(Xse,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));bO.displayName=wO.displayName;var Ut;(function(t){t.LOAD="LOAD",t.EXEC="EXEC",t.FFPROBE="FFPROBE",t.WRITE_FILE="WRITE_FILE",t.READ_FILE="READ_FILE",t.DELETE_FILE="DELETE_FILE",t.RENAME="RENAME",t.CREATE_DIR="CREATE_DIR",t.LIST_DIR="LIST_DIR",t.DELETE_DIR="DELETE_DIR",t.ERROR="ERROR",t.DOWNLOAD="DOWNLOAD",t.PROGRESS="PROGRESS",t.LOG="LOG",t.MOUNT="MOUNT",t.UNMOUNT="UNMOUNT"})(Ut||(Ut={}));const Qse=(()=>{let t=0;return()=>t++})(),Zse=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),Jse=new Error("called FFmpeg.terminate()");var bs,fo,Sa,Cl,Al,Tp,Vn;class eie{constructor(){St(this,bs,null);St(this,fo,{});St(this,Sa,{});St(this,Cl,[]);St(this,Al,[]);an(this,"loaded",!1);St(this,Tp,()=>{me(this,bs)&&(me(this,bs).onmessage=({data:{id:e,type:r,data:n}})=>{switch(r){case Ut.LOAD:this.loaded=!0,me(this,fo)[e](n);break;case Ut.MOUNT:case Ut.UNMOUNT:case Ut.EXEC:case Ut.FFPROBE:case Ut.WRITE_FILE:case Ut.READ_FILE:case Ut.DELETE_FILE:case Ut.RENAME:case Ut.CREATE_DIR:case Ut.LIST_DIR:case Ut.DELETE_DIR:me(this,fo)[e](n);break;case Ut.LOG:me(this,Cl).forEach(s=>s(n));break;case Ut.PROGRESS:me(this,Al).forEach(s=>s(n));break;case Ut.ERROR:me(this,Sa)[e](n);break}delete me(this,fo)[e],delete me(this,Sa)[e]})});St(this,Vn,({type:e,data:r},n=[],s)=>me(this,bs)?new Promise((i,a)=>{const l=Qse();me(this,bs)&&me(this,bs).postMessage({id:l,type:e,data:r},n),me(this,fo)[l]=i,me(this,Sa)[l]=a,s==null||s.addEventListener("abort",()=>{a(new DOMException(`Message # ${l} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(Zse));an(this,"load",({classWorkerURL:e,...r}={},{signal:n}={})=>(me(this,bs)||(lt(this,bs,e?new Worker(new URL(e,import.meta.url),{type:"module"}):new Worker(new URL("/assets/worker-DYSz7Krg.js",import.meta.url),{type:"module"})),me(this,Tp).call(this)),me(this,Vn).call(this,{type:Ut.LOAD,data:r},void 0,n)));an(this,"exec",(e,r=-1,{signal:n}={})=>me(this,Vn).call(this,{type:Ut.EXEC,data:{args:e,timeout:r}},void 0,n));an(this,"ffprobe",(e,r=-1,{signal:n}={})=>me(this,Vn).call(this,{type:Ut.FFPROBE,data:{args:e,timeout:r}},void 0,n));an(this,"terminate",()=>{const e=Object.keys(me(this,Sa));for(const r of e)me(this,Sa)[r](Jse),delete me(this,Sa)[r],delete me(this,fo)[r];me(this,bs)&&(me(this,bs).terminate(),lt(this,bs,null),this.loaded=!1)});an(this,"writeFile",(e,r,{signal:n}={})=>{const s=[];return r instanceof Uint8Array&&s.push(r.buffer),me(this,Vn).call(this,{type:Ut.WRITE_FILE,data:{path:e,data:r}},s,n)});an(this,"mount",(e,r,n)=>{const s=[];return me(this,Vn).call(this,{type:Ut.MOUNT,data:{fsType:e,options:r,mountPoint:n}},s)});an(this,"unmount",e=>{const r=[];return me(this,Vn).call(this,{type:Ut.UNMOUNT,data:{mountPoint:e}},r)});an(this,"readFile",(e,r="binary",{signal:n}={})=>me(this,Vn).call(this,{type:Ut.READ_FILE,data:{path:e,encoding:r}},void 0,n));an(this,"deleteFile",(e,{signal:r}={})=>me(this,Vn).call(this,{type:Ut.DELETE_FILE,data:{path:e}},void 0,r));an(this,"rename",(e,r,{signal:n}={})=>me(this,Vn).call(this,{type:Ut.RENAME,data:{oldPath:e,newPath:r}},void 0,n));an(this,"createDir",(e,{signal:r}={})=>me(this,Vn).call(this,{type:Ut.CREATE_DIR,data:{path:e}},void 0,r));an(this,"listDir",(e,{signal:r}={})=>me(this,Vn).call(this,{type:Ut.LIST_DIR,data:{path:e}},void 0,r));an(this,"deleteDir",(e,{signal:r}={})=>me(this,Vn).call(this,{type:Ut.DELETE_DIR,data:{path:e}},void 0,r))}on(e,r){e==="log"?me(this,Cl).push(r):e==="progress"&&me(this,Al).push(r)}off(e,r){e==="log"?lt(this,Cl,me(this,Cl).filter(n=>n!==r)):e==="progress"&&lt(this,Al,me(this,Al).filter(n=>n!==r))}}bs=new WeakMap,fo=new WeakMap,Sa=new WeakMap,Cl=new WeakMap,Al=new WeakMap,Tp=new WeakMap,Vn=new WeakMap;var qN;(function(t){t.MEMFS="MEMFS",t.NODEFS="NODEFS",t.NODERAWFS="NODERAWFS",t.IDBFS="IDBFS",t.WORKERFS="WORKERFS",t.PROXYFS="PROXYFS"})(qN||(qN={}));const tie=t=>new Promise((e,r)=>{const n=new FileReader;n.onload=()=>{const{result:s}=n;s instanceof ArrayBuffer?e(new Uint8Array(s)):e(new Uint8Array)},n.onerror=s=>{var i,a;r(Error(`File could not be read! Code=${((a=(i=s==null?void 0:s.target)==null?void 0:i.error)==null?void 0:a.code)||-1}`))},n.readAsArrayBuffer(t)}),rie=async t=>{let e;if(typeof t=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(t)?e=atob(t.split(",")[1]).split("").map(r=>r.charCodeAt(0)):e=await(await fetch(t)).arrayBuffer();else if(t instanceof URL)e=await(await fetch(t)).arrayBuffer();else if(t instanceof File||t instanceof Blob)e=await tie(t);else return new Uint8Array;return new Uint8Array(e)};class nie{constructor(){an(this,"ffmpeg",null);an(this,"loading",!1);an(this,"loaded",!1)}async load(e){if(this.loaded){console.log("[FFmpeg] Already loaded");return}if(this.loading){for(;this.loading;)await new Promise(r=>setTimeout(r,100));return}try{this.loading=!0,this.ffmpeg=new eie,this.ffmpeg.on("log",({message:n})=>{console.log("[FFmpeg]",n)});const r="https://unpkg.com/@ffmpeg/core@0.12.6/dist/esm";console.log("[FFmpeg] Loading from:",r),await this.ffmpeg.load({coreURL:`${r}/ffmpeg-core.js`,wasmURL:`${r}/ffmpeg-core.wasm`}),this.loaded=!0,this.loading=!1,console.log("[FFmpeg] Loaded successfully"),e&&e(1)}catch(r){throw this.loading=!1,console.error("[FFmpeg] Load failed:",r),new Error("Failed to load FFmpeg: "+r.message)}}isLoaded(){return this.loaded}async cutVideo(e,r,n,s){if(!this.ffmpeg||!this.loaded)throw new Error("FFmpeg not loaded. Call load() first.");try{const i="input.webm",a="output.mp4",l=n-r;console.log(`[FFmpeg] Cutting video: ${r}s to ${n}s (duration: ${l}s)`),await this.ffmpeg.writeFile(i,await rie(e)),s&&this.ffmpeg.on("progress",({progress:f})=>{s(f)}),await this.ffmpeg.exec(["-ss",r.toString(),"-i",i,"-t",l.toString(),"-c:v","libx264","-preset","ultrafast","-crf","23","-c:a","aac","-b:a","128k",a]);const d=await this.ffmpeg.readFile(a);await this.ffmpeg.deleteFile(i),await this.ffmpeg.deleteFile(a);const u=new Blob([d.buffer],{type:"video/mp4"});return console.log(`[FFmpeg] Cut complete. Output size: ${(u.size/1024/1024).toFixed(2)}MB`),u}catch(i){throw console.error("[FFmpeg] Cut failed:",i),new Error("Video cutting failed: "+i.message)}}terminate(){this.ffmpeg&&(this.ffmpeg.terminate(),this.ffmpeg=null,this.loaded=!1,this.loading=!1,console.log("[FFmpeg] Terminated"))}}const O1=new nie;function EO({isOpen:t,onClose:e,video:r,onClipCreated:n}){const[s,i]=C.useState(!1),[a,l]=C.useState(""),[d,u]=C.useState(!1),[f,p]=C.useState(""),[y,v]=C.useState(0),[E,b]=C.useState(!1),[T,I]=C.useState(0),[N,A]=C.useState(0),[L,P]=C.useState(!1),[k,D]=C.useState(0),[O,F]=C.useState(30),[$,G]=C.useState(""),[Y,ne]=C.useState(""),X=C.useRef(null),z=C.useRef(null),[Z,ee]=C.useState(null),q=C.useCallback(_e=>{_e&&(X.current=_e,ee(_e),console.log("[VideoClipEditor] Video element mounted"))},[]);C.useEffect(()=>{if(!r||!t||!Z){z.current&&(z.current.destroy(),z.current=null);return}const _e=r.file_url||"";if(!_e)return;z.current&&(z.current.destroy(),z.current=null);const ce=_e.includes(".mp4"),Se=_e.includes(".m3u8");if(ce)Z.src=_e,Z.load();else if(Se&&Sn.isSupported()){const Pe=new Sn({enableWorker:!0});Pe.loadSource(_e),Pe.attachMedia(Z),z.current=Pe,Pe.on(Sn.Events.MANIFEST_PARSED,()=>{console.log("[ClipEditor] HLS Ready")}),Pe.on(Sn.Events.ERROR,(Be,tt)=>{tt.fatal&&(console.error("[ClipEditor] HLS error:",tt),l("Erreur de lecture vido"))})}return()=>{z.current&&(z.current.destroy(),z.current=null)}},[r,t,Z]);const K=()=>{if(X.current){const _e=X.current.duration;A(_e),F(Math.min(30,_e))}},ae=()=>{if(X.current){const _e=X.current.currentTime;I(_e),L&&_e>=O&&(X.current.pause(),b(!1),P(!1))}},Q=_e=>{const ce=Math.floor(_e/60),Se=Math.floor(_e%60);return`${ce}:${Se.toString().padStart(2,"0")}`},re=()=>{X.current&&(X.current.currentTime=k,X.current.play(),P(!0),b(!0))},Ee=()=>{X.current&&(X.current.currentTime=k,P(!1))},ie=()=>{X.current&&(X.current.currentTime=O,P(!1))},se=async(_e,ce,Se)=>new Promise((Pe,Be)=>{const tt=document.createElement("video");tt.crossOrigin="anonymous",tt.src=_e;const we=[];let Ne;tt.onloadedmetadata=()=>{tt.currentTime=ce},tt.onseeked=()=>{const Je=tt.captureStream();Ne=new MediaRecorder(Je,{mimeType:"video/webm;codecs=vp8,opus"}),Ne.ondataavailable=Xe=>{Xe.data.size>0&&we.push(Xe.data)},Ne.onstop=()=>{const Xe=new Blob(we,{type:"video/webm"});Pe(Xe)},Ne.start(),tt.play(),setTimeout(()=>{Ne.stop(),tt.pause()},(Se-ce)*1e3)},tt.onerror=()=>Be(new Error("Video download failed"))}),oe=async()=>{var _e,ce;if(!$.trim()){l("Veuillez entrer un titre");return}if(O-k<1){l("Le clip doit durer au moins 1 seconde");return}if(O-k>60){l("Le clip ne peut pas durer plus de 60 secondes");return}if(!r){l("Aucune vido slectionne");return}i(!0),l(""),v(0);try{p("ffmpeg-load"),O1.isLoaded()?v(25):(Ge.info("Chargement de FFmpeg..."),await O1.load(Ne=>v(Ne*25))),p("download"),v(30),Ge.info("Tlchargement du segment vido...");const Se=r.file_url||"",Pe=await se(Se,k,O);v(50),p("cut"),Ge.info("Dcoupage avec FFmpeg...");const Be=await O1.cutVideo(Pe,0,O-k,Ne=>v(50+Ne*25));v(75),p("upload"),Ge.info("Upload vers le serveur...");const tt=new FormData;tt.append("file",Be,`clip_${Date.now()}.mp4`),tt.append("video_id",r.id),tt.append("title",$.trim()),tt.append("description",Y.trim()),tt.append("start_time",k.toString()),tt.append("end_time",O.toString());const we=await Y0.uploadDirectClip(tt);v(100),u(!0),Ge.success("Clip cr avec succs !"),n&&n(we.data.clip),setTimeout(()=>{e(),u(!1),G(""),ne(""),p("")},2e3)}catch(Se){console.error("[Clip] Creation error:",Se);const Pe=((ce=(_e=Se.response)==null?void 0:_e.data)==null?void 0:ce.error)||Se.message||"Erreur lors de la cration du clip";l(Pe),Ge.error(Pe)}finally{i(!1)}},fe=()=>{switch(f){case"ffmpeg-load":return"Chargement FFmpeg...";case"download":return"Tlchargement vido...";case"cut":return"Dcoupage...";case"upload":return"Upload...";default:return"Traitement..."}},Le=()=>{switch(f){case"ffmpeg-load":return o.jsx(Sh,{className:"h-4 w-4 mr-2"});case"download":return o.jsx(Sh,{className:"h-4 w-4 mr-2"});case"cut":return o.jsx(Na,{className:"h-4 w-4 mr-2"});case"upload":return o.jsx(dL,{className:"h-4 w-4 mr-2"});default:return o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"})}};return r?o.jsx(Ir,{open:t,onOpenChange:e,children:o.jsxs(fr,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{className:"flex items-center gap-2",children:[o.jsx(Na,{className:"h-5 w-5"}),"Crer un Clip"]}),o.jsx(bn,{children:"Slectionnez un segment et crez votre meilleur moment"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Vido"}),o.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden",children:[o.jsx("video",{ref:q,className:"w-full aspect-video",controls:!0,playsInline:!0,onLoadedMetadata:K,onTimeUpdate:ae,children:"Votre navigateur ne supporte pas la lecture vido."}),N>0&&o.jsxs("div",{className:"absolute bottom-16 left-2 right-2 h-1 bg-white/20 rounded-full overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0"}),o.jsx("div",{className:"absolute h-full bg-blue-500/60",style:{left:`${k/N*100}%`,width:`${(O-k)/N*100}%`}}),o.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-green-500",style:{left:`${k/N*100}%`},children:o.jsx("div",{className:"absolute -top-1 -left-1 w-2 h-2 rounded-full bg-green-500"})}),o.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-red-500",style:{left:`${O/N*100}%`},children:o.jsx("div",{className:"absolute -top-1 -left-1 w-2 h-2 rounded-full bg-red-500"})}),o.jsx("div",{className:"absolute top-0 bottom-0 w-0.5 bg-white",style:{left:`${T/N*100}%`}})]})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(Ce,{children:["Slection (",Q(O-k),")"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-sm text-muted-foreground",children:[Q(k)," - ",Q(O)]}),o.jsxs(ve,{type:"button",variant:"outline",size:"sm",onClick:re,disabled:s||O-k<1,className:"gap-1.5",children:[o.jsx(Ps,{className:"h-3.5 w-3.5"}),"Prvisualiser"]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(Ce,{className:"text-sm",children:"Dbut"}),o.jsx(ve,{type:"button",variant:"ghost",size:"sm",onClick:Ee,className:"h-6 px-2 text-xs",children:"Aller au dbut"})]}),o.jsx(yl,{value:[k],onValueChange:_e=>D(Math.min(_e[0],O-1)),max:N,step:.1,className:"w-full"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(Ce,{className:"text-sm",children:"Fin"}),o.jsx(ve,{type:"button",variant:"ghost",size:"sm",onClick:ie,className:"h-6 px-2 text-xs",children:"Aller  la fin"})]}),o.jsx(yl,{value:[O],onValueChange:_e=>F(Math.max(_e[0],k+1)),max:N,step:.1,className:"w-full"})]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"clip-title",children:"Titre *"}),o.jsx(Ue,{id:"clip-title",placeholder:"Mon meilleur point",value:$,onChange:_e=>G(_e.target.value),disabled:s})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"clip-description",children:"Description"}),o.jsx(qo,{id:"clip-description",placeholder:"Description optionnelle...",value:Y,onChange:_e=>ne(_e.target.value),disabled:s,rows:3})]})]}),s&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center text-sm",children:[Le(),o.jsx("span",{children:fe()})]}),o.jsx(bO,{value:y,className:"w-full"})]}),a&&o.jsxs(Xt,{variant:"destructive",children:[o.jsx(Ho,{className:"h-4 w-4"}),o.jsx(Qt,{children:a})]}),d&&o.jsxs(Xt,{className:"border-green-500 bg-green-50",children:[o.jsx(Z_,{className:"h-4 w-4 text-green-600"}),o.jsx(Qt,{className:"text-green-600",children:"Clip cr avec succs !"})]}),o.jsxs("div",{className:"flex gap-3 justify-end",children:[o.jsx(ve,{variant:"outline",onClick:e,disabled:s,children:"Annuler"}),o.jsx(ve,{onClick:oe,disabled:s||!$.trim(),className:"gap-2",children:s?o.jsxs(o.Fragment,{children:[o.jsx(ft,{className:"h-4 w-4 animate-spin"}),"Traitement..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Na,{className:"h-4 w-4"}),"Crer le Clip"]})})]})]})]})}):null}function SO({isOpen:t,onClose:e,video:r}){const n=C.useRef(null),s=C.useRef(null),[i,a]=C.useState(null),[l,d]=C.useState(!1),u=C.useCallback(f=>{f&&(n.current=f,a(f),console.log("[VideoPlayer] Video element mounted"))},[]);return C.useEffect(()=>{if(console.log("[VideoPlayer] useEffect START",{hasVideo:!!r,isOpen:t,hasVideoElement:!!i}),!r||!t||!i){console.log("[VideoPlayer] Skipping HLS init:",{hasVideo:!!r,isOpen:t,hasVideoElement:!!i}),s.current&&(s.current.destroy(),s.current=null);return}const f=r.file_url||"";if(!f){console.log("[VideoPlayer] No video URL found");return}console.log("[VideoPlayer] Loading video URL:",f),s.current&&(s.current.destroy(),s.current=null);const p=f.includes(".m3u8");if(f.includes(".mp4"))i.src=f,i.load(),console.log("[VideoPlayer] Loading MP4 video");else if(p&&Sn.isSupported()){console.log("[VideoPlayer] Creating HLS instance...");const v=new Sn({enableWorker:!0,lowLatencyMode:!1});v.loadSource(f),v.attachMedia(i),s.current=v,v.on(Sn.Events.MANIFEST_PARSED,()=>{console.log("[VideoPlayer] HLS Ready")}),v.on(Sn.Events.ERROR,(E,b)=>{if(console.error("[VideoPlayer] HLS Error:",b),b.fatal)switch(b.type){case Sn.ErrorTypes.NETWORK_ERROR:console.log("[VideoPlayer] Network error, trying to recover..."),v.startLoad();break;case Sn.ErrorTypes.MEDIA_ERROR:console.log("[VideoPlayer] Media error, trying to recover..."),v.recoverMediaError();break;default:console.log("[VideoPlayer] Fatal error, cannot recover"),v.destroy();break}})}else p&&i.canPlayType("application/vnd.apple.mpegurl")&&(i.src=f,i.load(),console.log("[VideoPlayer] Using native HLS support"));return()=>{s.current&&(s.current.destroy(),s.current=null)}},[r,t,i]),r?o.jsxs(o.Fragment,{children:[o.jsx(Ir,{open:t,onOpenChange:e,children:o.jsxs(fr,{className:"max-w-5xl p-0",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[o.jsx("h3",{className:"font-semibold text-lg",children:r.title||"Lecteur vido"}),o.jsxs(ve,{variant:"outline",size:"sm",onClick:()=>d(!0),className:"gap-2",children:[o.jsx(Na,{className:"h-4 w-4"}),"Crer un Clip"]})]}),o.jsx("div",{className:"relative bg-black",children:o.jsx("video",{ref:u,className:"w-full aspect-video",controls:!0,playsInline:!0,children:"Votre navigateur ne supporte pas la lecture vido."})})]})}),l&&o.jsx(EO,{isOpen:l,onClose:()=>d(!1),video:r,onClipCreated:()=>{d(!1)}})]}):null}function sie({isOpen:t,onClose:e,video:r,onSuccess:n}){const[s,i]=C.useState(""),[a,l]=C.useState(""),[d,u]=C.useState(!1),[f,p]=C.useState("");C.useEffect(()=>{r&&(i(r.title||""),l(r.description||""),p(""))},[r]);const y=async E=>{var b,T;if(E.preventDefault(),!s.trim()){p("Le titre est requis");return}if(r){u(!0),p("");try{await qs.updateVideo(r.id,{title:s.trim(),description:a.trim()}),Ge.success("Vido mise  jour avec succs"),n&&n(),v()}catch(I){console.error("Erreur mise  jour vido:",I);const N=((T=(b=I.response)==null?void 0:b.data)==null?void 0:T.error)||"Erreur lors de la mise  jour";p(N),Ge.error(N)}finally{u(!1)}}},v=()=>{d||(i(""),l(""),p(""),e())};return r?o.jsx(Ir,{open:t,onOpenChange:v,children:o.jsxs(fr,{className:"sm:max-w-md",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{className:"flex items-center gap-2",children:[o.jsx(KS,{className:"h-5 w-5 text-primary"}),"Modifier la vido"]}),o.jsx(bn,{children:"Modifiez le titre et la description de votre vido"})]}),o.jsxs("form",{onSubmit:y,className:"space-y-4",children:[f&&o.jsxs(Xt,{variant:"destructive",children:[o.jsx(Ho,{className:"h-4 w-4"}),o.jsx(Qt,{children:f})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"title",children:["Titre ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx(Ue,{id:"title",value:s,onChange:E=>i(E.target.value),placeholder:"Titre de la vido",maxLength:200,required:!0,disabled:d,className:"bg-background/50 border-border/50 focus:border-primary/50"}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.length,"/200 caractres"]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"description",children:"Description"}),o.jsx(qo,{id:"description",value:a,onChange:E=>l(E.target.value),placeholder:"Description optionnelle de la vido...",rows:3,maxLength:500,disabled:d,className:"bg-background/50 border-border/50 focus:border-primary/50"}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[a.length,"/500 caractres"]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:v,disabled:d,children:"Annuler"}),o.jsx(ve,{type:"submit",disabled:d||!s.trim(),variant:"neon",className:"gap-2",children:d?o.jsxs(o.Fragment,{children:[o.jsx(ft,{className:"h-4 w-4 animate-spin"}),o.jsx("span",{children:"Enregistrement..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(KS,{className:"h-4 w-4"}),o.jsx("span",{children:"Enregistrer"})]})})]})]})]})}):null}const XN={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},QN={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:[.25,.1,.25,1]}}},iie=()=>{var re,Ee,ie;const{user:t}=ps(),e=ni(),[r,n]=C.useState(""),[s,i]=C.useState(!1),[a,l]=C.useState(!1),[d,u]=C.useState(!1),[f,p]=C.useState(!1),[y,v]=C.useState(!1),[E,b]=C.useState(null),[T,I]=C.useState([]),[N,A]=C.useState(null),[L,P]=C.useState(!0),[k,D]=C.useState(0),[O,F]=C.useState(!1),$=se=>{const oe=typeof se=="string"?parseFloat(se):se;if(isNaN(oe))return"00:00";const fe=Math.floor(oe/60),Le=Math.floor(oe%60);return`${fe}:${Le.toString().padStart(2,"0")}`};C.useEffect(()=>{(async()=>{var oe;try{const fe=await qs.getMyVideos();I(fe.data.videos||[])}catch(fe){console.error("Failed to fetch videos:",fe),((oe=fe.response)==null?void 0:oe.status)!==401&&Ge.error("Impossible de charger les vidos")}finally{P(!1)}})()},[]),C.useEffect(()=>{(async()=>{var oe;try{const{clipService:fe}=await n1(async()=>{const{clipService:_e}=await Promise.resolve().then(()=>$x);return{clipService:_e}},void 0),Le=await fe.getMyClips();D(((oe=Le.data.clips)==null?void 0:oe.length)||0)}catch(fe){console.error("Failed to fetch clips count:",fe)}})()},[]),C.useEffect(()=>{const se=async()=>{try{const fe=await Ph.getMyActiveRecording();fe.data.active_recording?A(fe.data.active_recording):A(null)}catch(fe){console.error("Failed to fetch active recording:",fe)}};se();const oe=setInterval(se,3e4);return()=>clearInterval(oe)},[]);const G=async()=>{var se,oe;if(N&&confirm("Voulez-vous vraiment arrter cet enregistrement ?"))try{await Ph.stopRecording(N.recording_id),Ge.success("Enregistrement arrt avec succs"),A(null);const fe=await qs.getMyVideos();I(fe.data.videos||[])}catch(fe){console.error("Failed to stop recording:",fe),Ge.error(((oe=(se=fe.response)==null?void 0:se.data)==null?void 0:oe.error)||"Erreur lors de l'arrt de l'enregistrement")}},Y=T.filter(se=>{var oe;return(oe=se.title)==null?void 0:oe.toLowerCase().includes(r.toLowerCase())}),ne=se=>{b(se),p(!0)},X=se=>{b(se),l(!0)},z=se=>{b(se),v(!0)},Z=async se=>{var oe,fe;if((t==null?void 0:t.role)==="super_admin"){const Le=window.prompt(` MODE DE SUPPRESSION (Super Admin)

Choisissez le mode de suppression pour "${se.title}":

1  "database" - Supprimer seulement de la base de donnes
2  "bunny" - Supprimer seulement de Bunny CDN
3  "both" - Suppression complte (recommand)

Entrez: database, bunny, ou both`,"both");if(!Le)return;const _e=["database","bunny","both"],ce=Le.toLowerCase().trim();if(!_e.includes(ce)){Ge.error("Mode invalide. Utilisez: database, bunny, ou both");return}if(!confirm(`Confirmer la suppression (${ce}) de "${se.title}" ?`))return;try{const{adminService:Se}=await n1(async()=>{const{adminService:we}=await Promise.resolve().then(()=>$x);return{adminService:we}},void 0),Be={database:"local_only",bunny:"cloud_only",both:"local_and_cloud"}[ce]||"local_and_cloud",tt=await Se.deleteVideo(se.id,Be);(ce==="database"||ce==="both")&&I(T.filter(we=>we.id!==se.id)),Ge.success(tt.data.message||`Vido supprime (${ce})`)}catch(Se){console.error("Failed to delete video:",Se);const Pe=((fe=(oe=Se.response)==null?void 0:oe.data)==null?void 0:fe.error)||"Erreur lors de la suppression";Ge.error(Pe)}}else{if(!confirm("tes-vous sr de vouloir supprimer cette vido ?"))return;try{await qs.deleteVideo(se.id),I(T.filter(Le=>Le.id!==se.id)),Ge.success("Vido supprime avec succs")}catch(Le){console.error("Failed to delete video:",Le),Ge.error("Erreur lors de la suppression")}}},ee=async se=>{if(se.is_expired||se.processing_status!=="ready"){Ge.error("Cette vido n'est pas disponible pour tlchargement");return}if(!se.bunny_video_id){Ge.error("Cette vido n'a pas t uploade sur Bunny Stream");return}try{const fe=`https://vz-cc4565cd-4e9.b-cdn.net/${se.bunny_video_id}/play_720p.mp4`;Ge.loading("Tlchargement en cours...",{id:"download-toast"});const Le=await fetch(fe);if(!Le.ok)throw new Error("Network response was not ok");const _e=await Le.blob(),ce=window.URL.createObjectURL(_e),Se=document.createElement("a");Se.href=ce,Se.download=`${se.title||"video"}.mp4`,document.body.appendChild(Se),Se.click(),window.URL.revokeObjectURL(ce),document.body.removeChild(Se),Ge.dismiss("download-toast"),Ge.success("Tlchargement termin !")}catch(oe){console.error("Download error:",oe),Ge.dismiss("download-toast");const Le=`https://vz-cc4565cd-4e9.b-cdn.net/${se.bunny_video_id}/play_720p.mp4`;window.open(Le,"_blank"),Ge.error("Tlchargement direct chou, ouverture du lien...")}},q=se=>{b(se),F(!0)},K=T.filter(se=>!se.is_shared),ae=T.filter(se=>se.is_shared),Q=[{icon:yr,label:"Vidos",value:K.length.toString(),color:"primary"},{icon:Na,label:"Clips",value:k.toString(),color:"accent"},{icon:Ul,label:"Crdits",value:((re=(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits))==null?void 0:re.toString())||"0",color:"cyan"},{icon:Vl,label:"Partages",value:ae.length.toString(),color:"purple"}];return L?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ft,{className:"h-12 w-12 animate-spin mx-auto text-primary mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:"Chargement du dashboard..."})]})}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(rd,{credits:(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits)||0}),o.jsxs("main",{className:"pt-20 pb-12",children:[N&&o.jsx(tZ,{court:((Ee=N.court)==null?void 0:Ee.name)||"Court",club:((ie=N.club)==null?void 0:ie.name)||"Club",startTime:new Date(N.start_time.endsWith("Z")?N.start_time:N.start_time+"Z"),duration:N.planned_duration,onStop:G}),o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[o.jsxs("h1",{className:"text-3xl lg:text-4xl font-bold font-orbitron mb-2",children:["Bonjour, ",o.jsx("span",{className:"gradient-text",children:(t==null?void 0:t.name)||"Joueur"})," "]}),o.jsx("p",{className:"text-muted-foreground text-lg",children:"Prt  analyser tes performances ?"})]}),o.jsx(Me.div,{variants:XN,initial:"hidden",animate:"visible",className:"grid grid-cols-2 lg:grid-cols-4 gap-4 lg:gap-6 mb-8",children:Q.map((se,oe)=>o.jsx(Me.div,{variants:QN,children:o.jsx(ZQ,{icon:se.icon,label:se.label,value:se.value,color:se.color})},se.label))}),o.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},className:"flex flex-wrap gap-3 mb-8",children:[o.jsxs(ve,{variant:"neon",className:"gap-2",onClick:()=>i(!0),disabled:!!N,children:[o.jsx(Ps,{className:"h-4 w-4"}),"Dmarrer un enregistrement"]}),o.jsxs(ve,{variant:"neonOutline",className:"gap-2",onClick:()=>u(!0),children:[o.jsx(ub,{className:"h-4 w-4"}),"Scanner QR"]}),o.jsxs(ve,{variant:"neonOutline",className:"gap-2",onClick:()=>e("/credits"),children:[o.jsx(as,{className:"h-4 w-4"}),"Acheter des crdits"]})]}),o.jsxs(Me.section,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold font-orbitron",children:"Mes Vidos"}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"relative flex-1 sm:w-64",children:[o.jsx(uf,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Ue,{placeholder:"Rechercher...",value:r,onChange:se=>n(se.target.value),className:"pl-10 bg-card/50 border-border/50 focus:border-primary/50"})]}),o.jsx(ve,{variant:"ghost",size:"icon",className:"shrink-0",children:o.jsx(Wp,{className:"h-4 w-4"})})]})]}),o.jsx(Me.div,{variants:XN,initial:"hidden",animate:"visible",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Y.map((se,oe)=>o.jsx(Me.div,{variants:QN,custom:oe,children:o.jsx(eZ,{id:se.id,title:se.title||"Sans titre",thumbnail:se.thumbnail||"https://images.unsplash.com/photo-1554068865-24cecd4e34b8?w=400",duration:$(se.duration||0),date:se.created_at||new Date().toISOString(),shared:se.is_shared||!1,court:se.court_name||"Court",isExpired:se.is_expired||!1,processingStatus:se.processing_status,onPlay:()=>ne(se),onShare:()=>X(se),onEdit:()=>z(se),onDelete:()=>Z(se),onDownload:()=>ee(se),onCreateClip:()=>q(se)})},se.id))}),Y.length===0&&o.jsxs(Me.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-16",children:[o.jsx(yr,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),o.jsx("p",{className:"text-muted-foreground text-lg",children:T.length===0?"Aucune vido enregistre":"Aucune vido trouve"}),T.length===0&&o.jsxs(ve,{variant:"neon",className:"mt-4",onClick:()=>i(!0),children:[o.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Crer votre premire vido"]})]})]})]})]}),o.jsx(bJ,{open:s,onOpenChange:i,onRecordingStarted:se=>{A(se)}}),o.jsx(EJ,{open:a,onOpenChange:l,videoId:E==null?void 0:E.id,videoTitle:(E==null?void 0:E.title)||""}),o.jsx(SO,{isOpen:f,onClose:()=>{p(!1),b(null)},video:E}),o.jsx(sie,{isOpen:y,onClose:()=>{v(!1),b(null)},video:E,onSuccess:async()=>{const se=await qs.getMyVideos();I(se.data.videos||[]),v(!1),b(null)}}),o.jsx(EO,{isOpen:O,onClose:()=>{F(!1),b(null)},video:E,onClipCreated:async se=>{var Le;Ge.success("Clip cr avec succs !");const{clipService:oe}=await n1(async()=>{const{clipService:_e}=await Promise.resolve().then(()=>$x);return{clipService:_e}},void 0),fe=await oe.getMyClips();D(((Le=fe.data.clips)==null?void 0:Le.length)||0)}})]})};function aie({id:t,title:e,thumbnail:r,duration:n,date:s,videoTitle:i,status:a="completed",onPlay:l,onShare:d,onDownload:u,onDelete:f}){const[p,y]=C.useState(!1),v=E=>(E.endsWith("Z")||E+"",new Date(E).toLocaleDateString("fr-FR",{day:"numeric",month:"short"}));return o.jsxs(Me.div,{whileHover:{y:-8},transition:{duration:.3},onMouseEnter:()=>y(!0),onMouseLeave:()=>y(!1),className:"group relative rounded-2xl overflow-hidden glass border border-accent/20 hover:border-accent/50 transition-all duration-300",style:{boxShadow:p?"0 0 30px hsl(var(--accent) / 0.2)":"none"},children:[o.jsxs("div",{className:"relative aspect-video overflow-hidden",children:[o.jsx("img",{src:r,alt:e,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"}),o.jsx(Me.div,{initial:{opacity:0,scale:.8},animate:{opacity:p?1:0,scale:p?1:.8},transition:{duration:.2},className:"absolute inset-0 flex items-center justify-center",children:o.jsx(ve,{variant:"neonGreen",size:"icon",onClick:l,className:"h-14 w-14 rounded-full",children:o.jsx(Ps,{className:"h-6 w-6 fill-current"})})}),o.jsxs("div",{className:"absolute bottom-3 left-3 flex items-center gap-1.5 px-2 py-1 rounded-md bg-accent/80 backdrop-blur-sm",children:[o.jsx(hs,{className:"h-3 w-3 text-accent-foreground"}),o.jsx("span",{className:"text-xs font-medium text-accent-foreground",children:n})]}),o.jsxs("div",{className:"absolute top-3 left-3",children:[a==="completed"&&o.jsxs(Hr,{variant:"default",className:"bg-green-500/90 hover:bg-green-500",children:[o.jsx(Z_,{className:"h-3 w-3 mr-1"}),"Prt"]}),a==="processing"&&o.jsxs(Hr,{variant:"secondary",className:"bg-blue-500/90 hover:bg-blue-500",children:[o.jsx(ft,{className:"h-3 w-3 mr-1 animate-spin"}),"Traitement..."]}),a==="pending"&&o.jsxs(Hr,{variant:"secondary",className:"bg-yellow-500/90 hover:bg-yellow-500",children:[o.jsx(hs,{className:"h-3 w-3 mr-1"}),"En attente"]}),a==="failed"&&o.jsxs(Hr,{variant:"destructive",children:[o.jsx(cB,{className:"h-3 w-3 mr-1"}),"chec"]})]}),o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsx(ve,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 h-8 w-8 bg-black/40 hover:bg-black/60 text-white",children:o.jsx(lf,{className:"h-4 w-4"})})}),o.jsxs(Qo,{align:"end",className:"w-48",children:[o.jsxs(kt,{onClick:l,children:[o.jsx(Ps,{className:"h-4 w-4 mr-2"}),"Lire"]}),o.jsxs(kt,{onClick:d,children:[o.jsx(Vl,{className:"h-4 w-4 mr-2"}),"Partager"]}),o.jsxs(kt,{onClick:u,children:[o.jsx(Sh,{className:"h-4 w-4 mr-2"}),"Tlcharger"]}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:f,className:"text-destructive focus:text-destructive",children:[o.jsx(Fa,{className:"h-4 w-4 mr-2"}),"Supprimer"]})]})]})]}),o.jsxs("div",{className:"p-4",children:[o.jsx("h3",{className:"font-semibold text-foreground line-clamp-1 mb-2 group-hover:text-accent transition-colors",children:e}),o.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[o.jsx("span",{children:v(s)}),i&&o.jsxs("div",{className:"flex items-center gap-1 max-w-[120px]",children:[o.jsx(tL,{className:"h-3 w-3 shrink-0"}),o.jsx("span",{className:"truncate",children:i})]})]})]})]})}const oie=[{name:"TikTok",icon:wB,color:"bg-black",hoverColor:"hover:bg-gray-900"},{name:"Facebook",icon:hB,color:"bg-[#4267B2]",hoverColor:"hover:bg-[#375695]"},{name:"Instagram",icon:iL,color:"bg-gradient-to-br from-[#833AB4] via-[#FD1D1D] to-[#F77737]",hoverColor:""}];function lie({open:t,onOpenChange:e,clipId:r,clipTitle:n,bunnyVideoId:s}){const{toast:i}=la(),[a,l]=C.useState(!1),d=s?`https://vz-cc4565cd-4e9.b-cdn.net/${s}/play_720p.mp4`:`${window.location.protocol}//${window.location.host}/clip/${r}`,u=async()=>{try{await navigator.clipboard.writeText(d),l(!0),i({title:"Lien copi",description:"Le lien direct MP4 a t copi."}),setTimeout(()=>l(!1),2e3)}catch{i({title:"Erreur",description:"Impossible de copier le lien.",variant:"destructive"})}},f=p=>{let y="";switch(p){case"TikTok":i({title:"Partage TikTok",description:"Copiez le lien MP4 pour le poster sur TikTok."}),u();return;case"Facebook":y=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(d)}`;break;case"Instagram":i({title:"Partage Instagram",description:"Copiez le lien MP4 pour le poster sur Instagram."}),u();return}y&&window.open(y,"_blank","width=600,height=400")};return o.jsx(Ir,{open:t,onOpenChange:e,children:o.jsxs(fr,{className:"glass border-border/50 sm:max-w-md",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx("div",{className:"h-10 w-10 rounded-xl bg-accent/10 flex items-center justify-center",children:o.jsx(Vl,{className:"h-5 w-5 text-accent"})}),"Partager le clip"]}),o.jsxs(bn,{className:"text-muted-foreground",children:['Partagez "',n,'" sur vos rseaux sociaux ou copiez le lien.']})]}),o.jsxs(Me.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"space-y-6 pt-4",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsx(Ce,{className:"text-sm font-medium",children:"Partager sur les rseaux"}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:oie.map(p=>o.jsxs(Me.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>f(p.name),className:`flex flex-col items-center justify-center gap-2 p-4 rounded-xl ${p.color} ${p.hoverColor} text-white transition-all`,children:[o.jsx(p.icon,{className:"h-6 w-6"}),o.jsx("span",{className:"text-xs font-medium",children:p.name})]},p.name))})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(Ce,{className:"text-sm font-medium flex items-center gap-2",children:[o.jsx(yB,{className:"h-4 w-4 text-muted-foreground"}),"Ou copier le lien"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(Ue,{value:d,readOnly:!0,className:"bg-card/50 text-sm"}),o.jsx(ve,{variant:a?"neonGreen":"neonOutline",size:"icon",onClick:u,className:"shrink-0",children:a?o.jsx(Ts,{className:"h-4 w-4"}):o.jsx(uB,{className:"h-4 w-4"})})]})]}),o.jsx("div",{className:"flex justify-end pt-2",children:o.jsx(ve,{variant:"ghost",onClick:()=>e(!1),children:"Fermer"})})]})]})})}const cie={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},uie={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:[.25,.1,.25,1]}}},die=()=>{const{user:t}=ps(),e=ni(),[r,n]=C.useState(""),[s,i]=C.useState(!1),[a,l]=C.useState(!1),[d,u]=C.useState(null),[f,p]=C.useState(null),[y,v]=C.useState([]),[E,b]=C.useState(!0);C.useEffect(()=>{(async()=>{var k;try{const D=await Y0.getMyClips();v(D.data.clips||[])}catch(D){console.error("Failed to load clips:",D),((k=D.response)==null?void 0:k.status)!==401&&Ge.error("Impossible de charger les clips")}finally{b(!1)}})()},[]);const T=async P=>{if(confirm("tes-vous sr de vouloir supprimer ce clip ?"))try{await Y0.deleteClip(P),v(y.filter(k=>k.id!==P)),Ge.success("Clip supprim avec succs")}catch(k){console.error("Failed to delete clip:",k),Ge.error("Erreur lors de la suppression du clip")}},I=y.filter(P=>{var k;return(k=P.title)==null?void 0:k.toLowerCase().includes(r.toLowerCase())}),N=P=>{u(P),i(!0)},A=P=>{p({id:P.id,title:P.title,file_url:P.file_url}),l(!0)},L=async P=>{if(P.status!=="completed"){Ge.error("Ce clip n'est pas encore prt pour tlchargement");return}if(!P.bunny_video_id){Ge.error("Ce clip n'a pas t upload sur Bunny Stream");return}try{const D=`https://vz-cc4565cd-4e9.b-cdn.net/${P.bunny_video_id}/play_720p.mp4`;Ge.loading("Tlchargement en cours...",{id:"download-toast"});const O=await fetch(D);if(!O.ok)throw new Error("Network response was not ok");const F=await O.blob(),$=window.URL.createObjectURL(F),G=document.createElement("a");G.href=$,G.download=`${P.title||"clip"}.mp4`,document.body.appendChild(G),G.click(),window.URL.revokeObjectURL($),document.body.removeChild(G),Ge.dismiss("download-toast"),Ge.success("Tlchargement termin !")}catch(k){console.error("Download error:",k),Ge.dismiss("download-toast");const O=`https://vz-cc4565cd-4e9.b-cdn.net/${P.bunny_video_id}/play_720p.mp4`;window.open(O,"_blank"),Ge.error("Tlchargement direct chou, ouverture du lien...")}};return E?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ft,{className:"h-12 w-12 animate-spin mx-auto text-primary mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:"Chargement des clips..."})]})}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(rd,{credits:(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits)||0}),o.jsx("main",{className:"pt-20 pb-12",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[o.jsx("div",{className:"p-2 rounded-xl bg-accent/10",children:o.jsx(Na,{className:"h-6 w-6 text-accent"})}),o.jsxs("h1",{className:"text-3xl lg:text-4xl font-bold font-orbitron",children:["Mes ",o.jsx("span",{className:"gradient-text-accent",children:"Clips"})]})]}),o.jsx("p",{className:"text-muted-foreground text-lg",children:"Tes meilleurs moments en un clic"})]}),o.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[o.jsxs("div",{className:"relative flex-1 sm:max-w-sm",children:[o.jsx(uf,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Ue,{placeholder:"Rechercher un clip...",value:r,onChange:P=>n(P.target.value),className:"pl-10 bg-card/50 border-border/50 focus:border-primary/50"})]}),o.jsx(ve,{variant:"ghost",size:"icon",children:o.jsx(Wp,{className:"h-4 w-4"})})]}),o.jsxs(ve,{variant:"neonGreen",className:"gap-2",onClick:()=>e("/dashboard"),children:[o.jsx(as,{className:"h-4 w-4"}),"Crer un clip"]})]}),I.length>0?o.jsx(Me.div,{variants:cie,initial:"hidden",animate:"visible",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:I.map((P,k)=>o.jsx(Me.div,{variants:uie,custom:k,children:o.jsx(aie,{id:P.id,title:P.title||"Sans titre",thumbnail:P.thumbnail_url||"https://images.unsplash.com/photo-1554068865-24cecd4e34b8?w=400",duration:P.duration?`${Math.floor(P.duration/60)}:${(P.duration%60).toString().padStart(2,"0")}`:"0:00",date:P.created_at||new Date().toISOString(),videoTitle:P.video_title||"Vido",status:P.status,onPlay:()=>A(P),onShare:()=>N({id:P.id,title:P.title,bunny_video_id:P.bunny_video_id}),onDownload:()=>L(P),onDelete:()=>T(P.id)})},P.id))}):o.jsxs(Me.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-16",children:[o.jsx("div",{className:"inline-flex p-4 rounded-full bg-accent/10 mb-4",children:o.jsx(Na,{className:"h-12 w-12 text-accent/50"})}),o.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Aucun clip trouv"}),o.jsx("p",{className:"text-muted-foreground mb-6",children:r?"Aucun clip ne correspond  ta recherche":"Cre ton premier clip  partir d'une Vido"}),o.jsxs(ve,{variant:"neonGreen",className:"gap-2",onClick:()=>e("/dashboard"),children:[o.jsx(yr,{className:"h-4 w-4"}),"Voir mes Vidos"]})]})]})}),o.jsx(lie,{open:s,onOpenChange:i,clipId:(d==null?void 0:d.id)||0,clipTitle:(d==null?void 0:d.title)||"",bunnyVideoId:d==null?void 0:d.bunny_video_id}),o.jsx(SO,{isOpen:a,onClose:()=>l(!1),video:f})]})},hie={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},fie={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:[.25,.1,.25,1]}}},mie=()=>{const{user:t}=ps(),[e,r]=C.useState([]),[n,s]=C.useState(new Set),[i,a]=C.useState(""),[l,d]=C.useState(!0),[u,f]=C.useState("");C.useEffect(()=>{p()},[]);const p=async()=>{try{d(!0),f("");const[b,T]=await Promise.all([Vc.getAvailableClubs(),Vc.getFollowedClubs()]),I=T.data.clubs||[],N=b.data.clubs||[],A=new Set(I.map(P=>P.id));s(A);const L=[...I,...N.filter(P=>!A.has(P.id))];r(L)}catch(b){console.error("Error loading clubs:",b),f("Erreur lors du chargement des clubs"),Ge.error("Impossible de charger les clubs")}finally{d(!1)}},y=async(b,T)=>{try{T?(await Vc.unfollowClub(b.toString()),Ge.success("Club retir de vos favoris")):(await Vc.followClub(b.toString()),Ge.success("Club ajout  vos favoris")),await p()}catch(I){console.error("Error toggling follow:",I),Ge.error("Une erreur est survenue"),await p()}},v=e.filter(b=>b.name.toLowerCase().includes(i.toLowerCase())),E=b=>new Date(b).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"});return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(rd,{credits:(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits)||0}),o.jsx("main",{className:"pt-20 pb-12",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[o.jsx("h1",{className:"text-3xl lg:text-4xl font-bold font-orbitron mb-2",children:o.jsx("span",{className:"gradient-text",children:"Clubs"})}),o.jsx("p",{className:"text-muted-foreground text-lg",children:"Suivez vos clubs prfrs"})]}),o.jsx(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"mb-8",children:o.jsxs("div",{className:"relative max-w-md",children:[o.jsx(uf,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Ue,{placeholder:"Rechercher un club...",value:i,onChange:b=>a(b.target.value),className:"pl-10 bg-card/50 border-border/50"})]})}),u&&o.jsx(Xt,{variant:"destructive",className:"mb-6",children:o.jsx(Qt,{children:u})}),l?o.jsx("div",{className:"flex justify-center py-16",children:o.jsx(ft,{className:"h-8 w-8 animate-spin text-primary"})}):o.jsxs(o.Fragment,{children:[o.jsxs(Me.h2,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-xl font-semibold mb-6",children:["Tous les Clubs (",v.length,")"]}),v.length>0?o.jsx(Me.div,{variants:hie,initial:"hidden",animate:"visible",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(b=>{const T=n.has(b.id);return o.jsxs(Me.div,{variants:fie,className:"p-6 rounded-2xl bg-card border border-border/50 hover:border-primary/30 transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center",children:o.jsx(wh,{className:"h-5 w-5 text-primary"})}),o.jsx("h3",{className:"font-semibold text-lg",children:b.name})]}),o.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${T?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`,children:T?"Suivi":"Non suivi"})]}),o.jsxs("div",{className:"space-y-2 mb-4",children:[b.address&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx(Oa,{className:"h-4 w-4"}),o.jsx("span",{children:b.address})]}),b.phone_number&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx(cf,{className:"h-4 w-4"}),o.jsx("span",{children:b.phone_number})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx(Lo,{className:"h-4 w-4"}),o.jsx("span",{children:b.email})]}),o.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[o.jsx(Hp,{className:"h-4 w-4"}),o.jsxs("span",{children:["Cr le ",E(b.created_at)]})]})]}),o.jsxs(ve,{variant:T?"ghost":"neon",className:"w-full gap-2",onClick:()=>y(b.id,T),children:[o.jsx(sL,{className:`h-4 w-4 ${T?"":"fill-current"}`}),T?"Ne plus suivre":"Suivre"]})]},b.id)})}):o.jsxs(Me.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-16",children:[o.jsx(wh,{className:"h-16 w-16 mx-auto text-muted-foreground/50 mb-4"}),o.jsx("p",{className:"text-muted-foreground text-lg",children:i?"Aucun club trouv":"Aucun club disponible"})]})]})]})})]})},pie=t=>{switch(t){case"simulation":return Yp;case"konnect":return cL;case"flouci":return My;case"card":case"carte_bancaire":return Ul;default:return My}},gie={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},xie={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,ease:[.25,.1,.25,1]}}},yie=()=>{const{user:t,refreshUser:e}=ps(),[r,n]=C.useState(null),[s,i]=C.useState(null),[a,l]=C.useState([]),[d,u]=C.useState([]),[f,p]=C.useState(!0),[y,v]=C.useState(!1);C.useEffect(()=>{(async()=>{var T;try{const[I,N]=await Promise.all([qs.getCreditPackages(),qs.getPaymentMethods()]);l(I.data.packages||[]);const A=(N.data.payment_methods||[]).filter(P=>P.id!=="simulation");u(A);const L=N.data.default_method==="simulation"?"konnect":N.data.default_method||"konnect";i(L)}catch(I){console.error("Failed to load data:",I),((T=I.response)==null?void 0:T.status)!==401&&Ge.error("Impossible de charger les donnes")}finally{p(!1)}})()},[]);const E=async()=>{var T,I;if(!r){Ge.error("Veuillez slectionner un pack de crdits");return}if(!s){Ge.error("Veuillez slectionner une mthode de paiement");return}v(!0);const b=a.find(N=>N.id===r);try{const N=await qs.buyCredits({package_id:r,credits_amount:b==null?void 0:b.credits,payment_method:s,package_type:r.startsWith("pack_")?"pack":"individual"});Ge.success(`Achat de ${b==null?void 0:b.credits} crdits russi !`),await e(),n(null),i(null)}catch(N){console.error("Purchase failed:",N),Ge.error(((I=(T=N.response)==null?void 0:T.data)==null?void 0:I.error)||"Erreur lors de l'achat")}finally{v(!1)}};return f?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx(ft,{className:"h-12 w-12 animate-spin mx-auto text-primary mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:"Chargement des packages..."})]})}):o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(rd,{credits:(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits)||0}),o.jsx("main",{className:"pt-20 pb-12",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[o.jsx("h1",{className:"text-3xl lg:text-4xl font-bold font-orbitron mb-2",children:o.jsx("span",{className:"gradient-text",children:"Crdits"})}),o.jsx("p",{className:"text-muted-foreground text-lg",children:"Achetez des crdits pour dbloquer vos vidos"})]}),o.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-6 rounded-2xl bg-card border border-border/50 mb-8",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center",children:o.jsx(Cn,{className:"h-5 w-5 text-primary"})}),o.jsx("h2",{className:"text-lg font-semibold",children:"Systme de Crdits MySmash"})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-6 mb-6",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-3xl font-bold text-primary",children:(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits)||0}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Crdits disponibles"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-3xl font-bold text-neon-green",children:"20 DT"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Prix par crdit"})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-3xl font-bold text-accent",children:a.length}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Packs disponibles"})]})]}),o.jsxs(ve,{variant:"neon",className:"w-full gap-2",onClick:()=>{const b=document.getElementById("packages");b==null||b.scrollIntoView({behavior:"smooth"})},children:[o.jsx(Cn,{className:"h-4 w-4"}),"Recharger mes crdits"]})]}),o.jsxs(Me.div,{id:"packages",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"mb-8",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(Cn,{className:"h-5 w-5 text-primary"}),o.jsx("h2",{className:"text-xl font-semibold",children:"Packages Disponibles"})]}),a.length>0?o.jsx(Me.div,{variants:gie,initial:"hidden",animate:"visible",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map(b=>o.jsxs(Me.button,{variants:xie,whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>n(b.id),className:`relative p-6 rounded-2xl border text-left transition-all ${r===b.id?"border-primary bg-primary/10 shadow-[0_0_30px_hsl(var(--primary)/0.2)]":"border-border/50 bg-card hover:border-primary/50"}`,children:[b.popular&&o.jsx("span",{className:"absolute -top-3 right-4 px-3 py-1 rounded-full bg-primary text-primary-foreground text-xs font-medium",children:"Populaire"}),o.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[o.jsxs("h3",{className:"text-2xl font-bold",children:[b.credits," crdits"]}),b.badge&&o.jsx("span",{className:"px-2 py-1 rounded-full bg-green-100 text-green-700 text-xs font-medium",children:b.badge})]}),o.jsxs("div",{className:"mb-2",children:[o.jsxs("p",{className:"text-xl font-semibold text-primary",children:[b.price_dt||b.price," ",b.currency||"DT"]}),(b.original_price_dt||b.original_price)&&o.jsxs("p",{className:"text-sm text-muted-foreground line-through",children:[b.original_price_dt||b.original_price," ",b.currency||"DT"]}),(b.savings_dt||b.savings)&&(b.savings_dt||b.savings)>0&&o.jsxs("p",{className:"text-xs text-green-600 font-medium mt-1",children:["conomie: ",b.savings_dt||b.savings," ",b.currency||"DT"]})]}),o.jsx("p",{className:"text-sm text-muted-foreground",children:b.description}),r===b.id&&o.jsx("div",{className:"absolute top-4 right-4",children:o.jsx(Ts,{className:"h-5 w-5 text-primary"})})]},b.id))}):o.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Aucun package disponible pour le moment"})]}),o.jsxs(Me.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"p-6 rounded-2xl bg-card border border-border/50",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx(Gu,{className:"h-5 w-5 text-accent"}),o.jsx("h2",{className:"text-xl font-semibold",children:"Mthodes de Paiement Scurises"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:d.map(b=>{const T=pie(b.id),I=b.enabled!==!1;return o.jsxs(Me.button,{whileHover:{scale:1.01},whileTap:{scale:.99},onClick:()=>I&&i(b.id),disabled:!I,className:`p-4 rounded-xl border flex items-center justify-between transition-all ${s===b.id?"border-primary bg-primary/10":"border-border/50 bg-background/50 hover:border-primary/50"} ${!I&&"opacity-50 cursor-not-allowed"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-lg bg-muted flex items-center justify-center",children:o.jsx(T,{className:"h-5 w-5"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium",children:b.name}),o.jsx("p",{className:"text-xs text-muted-foreground",children:b.description})]})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${I?"bg-neon-green/10 text-neon-green":"bg-muted text-muted-foreground"}`,children:I?"Disponible":"Bientt"}),b.processing_time&&o.jsxs("p",{className:"text-xs text-muted-foreground mt-1 flex items-center gap-1 justify-end",children:[o.jsx(hs,{className:"h-3 w-3"}),b.processing_time]})]})]},b.id)})}),o.jsx(ve,{variant:"neon",className:"w-full gap-2",onClick:E,disabled:!r||!s||y,children:y?o.jsxs(o.Fragment,{children:[o.jsx(ft,{className:"h-4 w-4 animate-spin"}),"Traitement en cours..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ul,{className:"h-4 w-4"}),"Procder au paiement"]})})]})]})})]})},vie=()=>{const{toast:t}=la(),{user:e,fetchUser:r}=ps(),[n,s]=C.useState(!1),[i,a]=C.useState(!1),[l,d]=C.useState({firstName:"",lastName:"",email:"",phone:"",avatar:""});C.useEffect(()=>{var N;if(e){const A=((N=e.name)==null?void 0:N.split(" "))||["",""];d({firstName:A[0]||"",lastName:A.slice(1).join(" ")||"",email:e.email||"",phone:e.phone||"",avatar:e.avatar||""}),console.log("Profile updated from user:",e),console.log("Avatar URL:",Lu(e.avatar||""))}},[e]);const[u,f]=C.useState({current:"",new:"",confirm:""}),p=async()=>{var N,A;try{a(!0);const L=`${l.firstName} ${l.lastName}`.trim();await cn.updateProfile({name:L,email:l.email,phone:l.phone}),await r(),t({title:"Profil mis  jour",description:"Vos informations ont t enregistres avec succs."}),s(!1)}catch(L){t({title:"Erreur",description:((A=(N=L.response)==null?void 0:N.data)==null?void 0:A.error)||"Impossible de mettre  jour le profil",variant:"destructive"})}finally{a(!1)}},y=async()=>{var N,A;if(u.new!==u.confirm){t({title:"Erreur",description:"Les mots de passe ne correspondent pas.",variant:"destructive"});return}try{await cn.changePassword({current_password:u.current,new_password:u.new}),t({title:"Mot de passe modifi",description:"Votre mot de passe a t chang avec succs."}),f({current:"",new:"",confirm:""})}catch(L){t({title:"Erreur",description:((A=(N=L.response)==null?void 0:N.data)==null?void 0:A.error)||"Impossible de changer le mot de passe",variant:"destructive"})}},[v,E]=C.useState(!1),b=async N=>{var L,P,k;const A=(L=N.target.files)==null?void 0:L[0];if(A){if(A.size>5*1024*1024){t({title:"Fichier trop volumineux",description:"L'image ne doit pas dpasser 5 Mo.",variant:"destructive"});return}try{E(!0);const D=new FormData;D.append("avatar",A),await cn.uploadAvatar(D),await r(),t({title:"Photo mise  jour",description:"Votre photo de profil a t modifie avec succs."})}catch(D){t({title:"Erreur",description:((k=(P=D.response)==null?void 0:P.data)==null?void 0:k.error)||"Impossible de mettre  jour la photo",variant:"destructive"})}finally{E(!1),N.target&&(N.target.value="")}}},T=l.firstName&&l.lastName?`${l.firstName[0]}${l.lastName[0]}`.toUpperCase():e!=null&&e.name?e.name.split(" ").map(N=>N[0]).join("").toUpperCase().slice(0,2):"U",I=(e==null?void 0:e.credits_balance)||(e==null?void 0:e.credits)||0;return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(rd,{credits:I}),o.jsx("main",{className:"pt-20 pb-12",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8 max-w-4xl",children:[o.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.6},className:"mb-8",children:[o.jsxs("h1",{className:"text-3xl lg:text-4xl font-bold font-orbitron mb-2",children:["Mon ",o.jsx("span",{className:"gradient-text",children:"Profil"})]}),o.jsx("p",{className:"text-muted-foreground text-lg",children:"Grez vos informations personnelles"})]}),o.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"glass rounded-2xl p-6 lg:p-8 mb-8",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-6 mb-8 pb-8 border-b border-border/50",children:[o.jsxs("div",{className:"relative",children:[o.jsxs(PE,{className:"h-24 w-24 border-4 border-primary/30",children:[o.jsx(DE,{src:Lu(l.avatar),alt:`${l.firstName} ${l.lastName}`}),o.jsx(kE,{className:"bg-primary/10 text-primary font-bold text-2xl",children:T})]}),o.jsxs("div",{className:"absolute -bottom-2 -right-2",children:[o.jsx("input",{type:"file",id:"avatar-upload",className:"hidden",accept:"image/*",onChange:b}),o.jsx(ve,{variant:"neon",size:"icon",className:"h-10 w-10 rounded-full",onClick:()=>{var N;return(N=document.getElementById("avatar-upload"))==null?void 0:N.click()},disabled:v,children:v?o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):o.jsx(bh,{className:"h-4 w-4"})})]})]}),o.jsxs("div",{className:"text-center sm:text-left",children:[o.jsxs("h2",{className:"text-2xl font-bold",children:[l.firstName," ",l.lastName]}),o.jsx("p",{className:"text-muted-foreground",children:l.email}),o.jsxs("div",{className:"flex items-center gap-2 mt-2 justify-center sm:justify-start",children:[o.jsx(Gu,{className:"h-4 w-4 text-accent"}),o.jsx("span",{className:"text-sm text-accent font-medium",children:"Joueur vrifi"})]})]})]}),o.jsxs("div",{className:"grid gap-6",children:[o.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"firstName",className:"flex items-center gap-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"}),"Prnom"]}),o.jsx(Ue,{id:"firstName",value:l.firstName,onChange:N=>d({...l,firstName:N.target.value}),disabled:!n,className:"bg-card/50"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"lastName",className:"flex items-center gap-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-muted-foreground"}),"Nom"]}),o.jsx(Ue,{id:"lastName",value:l.lastName,onChange:N=>d({...l,lastName:N.target.value}),disabled:!n,className:"bg-card/50"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"email",className:"flex items-center gap-2",children:[o.jsx(Lo,{className:"h-4 w-4 text-muted-foreground"}),"Email"]}),o.jsx(Ue,{id:"email",type:"email",value:l.email,onChange:N=>d({...l,email:N.target.value}),disabled:!n,className:"bg-card/50"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs(Ce,{htmlFor:"phone",className:"flex items-center gap-2",children:[o.jsx(cf,{className:"h-4 w-4 text-muted-foreground"}),"Tlphone"]}),o.jsx(Ue,{id:"phone",type:"tel",value:l.phone,onChange:N=>d({...l,phone:N.target.value}),disabled:!n,className:"bg-card/50"})]}),o.jsx("div",{className:"flex gap-3 pt-4",children:n?o.jsxs(o.Fragment,{children:[o.jsxs(ve,{variant:"neon",className:"gap-2",onClick:p,disabled:i,children:[o.jsx(hb,{className:"h-4 w-4"}),i?"Enregistrement...":"Enregistrer"]}),o.jsx(ve,{variant:"ghost",onClick:()=>s(!1),children:"Annuler"})]}):o.jsx(ve,{variant:"neonOutline",onClick:()=>s(!0),children:"Modifier le profil"})})]})]}),o.jsxs(Me.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},className:"glass rounded-2xl p-6 lg:p-8",children:[o.jsxs("h3",{className:"text-xl font-bold mb-6 flex items-center gap-2",children:[o.jsx(Rl,{className:"h-5 w-5 text-primary"}),"Changer le mot de passe"]}),o.jsxs("div",{className:"grid gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"currentPassword",children:"Mot de passe actuel"}),o.jsx(Ue,{id:"currentPassword",type:"password",value:u.current,onChange:N=>f({...u,current:N.target.value}),className:"bg-card/50",placeholder:""})]}),o.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"newPassword",children:"Nouveau mot de passe"}),o.jsx(Ue,{id:"newPassword",type:"password",value:u.new,onChange:N=>f({...u,new:N.target.value}),className:"bg-card/50",placeholder:""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"confirmPassword",children:"Confirmer le mot de passe"}),o.jsx(Ue,{id:"confirmPassword",type:"password",value:u.confirm,onChange:N=>f({...u,confirm:N.target.value}),className:"bg-card/50",placeholder:""})]})]}),o.jsx("div",{className:"pt-4",children:o.jsxs(ve,{variant:"neon",className:"gap-2",onClick:y,disabled:!u.current||!u.new||!u.confirm,children:[o.jsx(Rl,{className:"h-4 w-4"}),"Modifier le mot de passe"]})})]})]})]})})]})},ZN=["image/png","image/jpeg","image/jpg"],wie=5,bie=3;function Eie({onImagesChange:t,maxFiles:e=bie,maxSizeMB:r=wie}){const[n,s]=C.useState([]),[i,a]=C.useState(!1),[l,d]=C.useState([]),u=T=>{if(!ZN.includes(T.type))return Ge.error(`Format non support: ${T.name}. Utilisez PNG ou JPG.`),!1;const I=T.size/(1024*1024);return I>r?(Ge.error(`Fichier trop volumineux: ${T.name} (${I.toFixed(1)}MB). Max: ${r}MB`),!1):!0},f=C.useCallback(T=>{if(!T)return;const I=Array.from(T);if(n.length+I.length>e){Ge.error(`Maximum ${e} images autorises`);return}const N=I.filter(u);if(N.length===0)return;const A=N.map(k=>URL.createObjectURL(k)),L=[...n,...N],P=[...l,...A];s(L),d(P),t(L),Ge.success(`${N.length} image(s) ajoute(s)`)},[n,l,e,r,t]),p=T=>{URL.revokeObjectURL(l[T]);const I=n.filter((A,L)=>L!==T),N=l.filter((A,L)=>L!==T);s(I),d(N),t(I)},y=T=>{T.preventDefault(),T.stopPropagation(),T.type==="dragenter"||T.type==="dragover"?a(!0):T.type==="dragleave"&&a(!1)},v=T=>{T.preventDefault(),T.stopPropagation(),a(!1),f(T.dataTransfer.files)},E=T=>{f(T.target.files)},b=n.reduce((T,I)=>T+I.size,0)/(1024*1024);return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:`relative border-2 border-dashed rounded-lg p-6 transition-colors ${i?"border-primary bg-primary/5":"border-border/50 hover:border-primary/50"}`,onDragEnter:y,onDragLeave:y,onDragOver:y,onDrop:v,children:[o.jsx("input",{type:"file",id:"image-upload",className:"hidden",accept:ZN.join(","),multiple:!0,onChange:E,disabled:n.length>=e}),o.jsxs("label",{htmlFor:"image-upload",className:"flex flex-col items-center justify-center cursor-pointer",children:[o.jsx(dL,{className:"h-10 w-10 text-muted-foreground mb-3"}),o.jsx("p",{className:"text-sm font-medium text-foreground mb-1",children:"Cliquez pour ajouter des images"}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:["ou glissez-dposez  PNG, JPG  Max ",r,"MB  ",e," images max"]})]})]}),n.length>0&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center justify-between text-sm",children:[o.jsxs("span",{className:"text-muted-foreground",children:[n.length," / ",e," images"]}),o.jsxs("span",{className:"text-muted-foreground",children:[b.toFixed(2)," MB"]})]}),o.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.map((T,I)=>o.jsxs("div",{className:"relative group aspect-square rounded-lg overflow-hidden border border-border/50",children:[o.jsx("img",{src:T,alt:`Preview ${I+1}`,className:"w-full h-full object-cover"}),o.jsx("button",{onClick:()=>p(I),className:"absolute top-1 right-1 p-1 rounded-full bg-black/60 text-white opacity-0 group-hover:opacity-100 transition-opacity",type:"button",children:o.jsx(tc,{className:"h-4 w-4"})}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2",children:[o.jsx("p",{className:"text-xs text-white truncate",children:n[I].name}),o.jsxs("p",{className:"text-xs text-white/70",children:[(n[I].size/1024).toFixed(0)," KB"]})]})]},I)),n.length<e&&o.jsxs("label",{htmlFor:"image-upload",className:"aspect-square rounded-lg border-2 border-dashed border-border/50 hover:border-primary/50 flex flex-col items-center justify-center cursor-pointer transition-colors",children:[o.jsx(lb,{className:"h-8 w-8 text-muted-foreground mb-1"}),o.jsx("span",{className:"text-xs text-muted-foreground",children:"Ajouter"})]})]})]})]})}const Sie=[{value:"low",label:"Basse"},{value:"medium",label:"Moyenne"},{value:"high",label:"Haute"}],Tie=()=>{const{user:t}=ps(),[e,r]=C.useState(""),[n,s]=C.useState("medium"),[i,a]=C.useState(""),[l,d]=C.useState([]),[u,f]=C.useState(!1),[p,y]=C.useState([]),[v,E]=C.useState(!0);C.useEffect(()=>{b()},[]);const b=async()=>{var N;try{E(!0);const A=await iu.getMyMessages();y(A.data.messages||[])}catch(A){console.error("Failed to load messages:",A),((N=A.response)==null?void 0:N.status)!==401&&Ge.error("Impossible de charger les messages")}finally{E(!1)}},T=async N=>{var A,L;if(N.preventDefault(),!e||!i){Ge.error("Veuillez remplir tous les champs requis");return}f(!0);try{const P=new FormData;P.append("subject",e),P.append("message",i),P.append("priority",n),l.forEach((k,D)=>{P.append("images",k)}),await iu.createMessage(P),Ge.success("Message envoy avec succs !"),r(""),a(""),s("medium"),d([]),setTimeout(()=>{b()},1e3)}catch(P){console.error("Failed to send message:",P),Ge.error(((L=(A=P.response)==null?void 0:A.data)==null?void 0:L.error)||"Erreur lors de l'envoi du message")}finally{f(!1)}},I=N=>{switch(N){case"pending":return o.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 rounded-full bg-yellow-500/10 text-yellow-500",children:[o.jsx(hs,{className:"h-3 w-3"}),"En attente"]});case"in_progress":return o.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 rounded-full bg-primary/10 text-primary",children:[o.jsx(Ho,{className:"h-3 w-3"}),"En cours"]});case"resolved":case"closed":return o.jsxs("span",{className:"flex items-center gap-1 text-xs px-2 py-1 rounded-full bg-neon-green/10 text-neon-green",children:[o.jsx(Eh,{className:"h-3 w-3"}),"Rsolu"]})}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(rd,{credits:(t==null?void 0:t.credits_balance)||(t==null?void 0:t.credits)||0}),o.jsx("main",{className:"pt-20 pb-12",children:o.jsxs("div",{className:"container mx-auto px-4 lg:px-8",children:[o.jsxs(Me.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-8",children:[o.jsx("h1",{className:"text-3xl lg:text-4xl font-bold font-orbitron mb-2",children:o.jsx("span",{className:"gradient-text",children:"Support"})}),o.jsx("p",{className:"text-muted-foreground text-lg",children:"Besoin d'aide ? Contactez notre quipe"})]}),o.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[o.jsxs(Me.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},className:"p-6 rounded-2xl bg-card border border-border/50",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center",children:o.jsx($l,{className:"h-5 w-5 text-primary"})}),o.jsx("h2",{className:"text-xl font-semibold",children:"Nouveau message"})]}),o.jsxs("form",{onSubmit:T,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"subject",children:"Sujet *"}),o.jsx(Ue,{id:"subject",placeholder:"Rsumez votre demande",value:e,onChange:N=>r(N.target.value),className:"bg-background/50 border-border/50",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"priority",children:"Priorit"}),o.jsxs(Yl,{value:n,onValueChange:s,children:[o.jsx(Oo,{className:"bg-background/50 border-border/50",children:o.jsx(ql,{})}),o.jsx(Fo,{children:Sie.map(N=>o.jsx(Dr,{value:N.value,children:N.label},N.value))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"message",children:"Message *"}),o.jsx(qo,{id:"message",placeholder:"Dcrivez votre problme ou question en dtail...",value:i,onChange:N=>a(N.target.value),className:"bg-background/50 border-border/50 min-h-[150px] resize-none",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Images (optionnel)"}),o.jsx(Eie,{onImagesChange:d,maxFiles:3,maxSizeMB:5})]}),o.jsx(ve,{type:"submit",variant:"neon",className:"w-full gap-2",disabled:u,children:u?o.jsxs(o.Fragment,{children:[o.jsx(ft,{className:"h-4 w-4 animate-spin"}),"Envoi en cours..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Ch,{className:"h-4 w-4"}),"Envoyer le message"]})})]})]}),o.jsxs(Me.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"p-6 rounded-2xl bg-card border border-border/50",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[o.jsx("div",{className:"w-10 h-10 rounded-xl bg-accent/10 flex items-center justify-center",children:o.jsx(lB,{className:"h-5 w-5 text-accent"})}),o.jsx("h2",{className:"text-xl font-semibold",children:"Mes demandes"})]}),v?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin text-primary"})}):p.length>0?o.jsx("div",{className:"space-y-4 max-h-[600px] overflow-y-auto",children:p.map(N=>o.jsxs(Me.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-xl bg-background/50 border border-border/30 hover:border-primary/30 transition-all",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsx("h3",{className:"font-medium",children:N.subject}),I(N.status)]}),o.jsx("p",{className:"text-sm text-muted-foreground mb-3 whitespace-pre-wrap",children:N.message}),N.admin_response&&o.jsxs("div",{className:"mt-3 p-3 rounded-lg bg-primary/5 border-l-4 border-primary",children:[o.jsx("p",{className:"text-sm font-medium text-primary mb-1",children:"Rponse du support :"}),o.jsx("p",{className:"text-sm whitespace-pre-wrap",children:N.admin_response}),N.admin_name&&o.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["- ",N.admin_name]})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-3 text-xs text-muted-foreground",children:[o.jsx("span",{className:"capitalize",children:n}),o.jsx("span",{children:""}),o.jsx("span",{children:new Date(N.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})})]})]},N.id))}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx($l,{className:"h-12 w-12 mx-auto text-muted-foreground/50 mb-3"}),o.jsx("p",{className:"text-muted-foreground",children:"Aucune demande prcdente"})]})]})]})]})})]})};var Mg="Tabs",[Cie,$ae]=hn(Mg,[td]),TO=td(),[Aie,f2]=Cie(Mg),CO=C.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:l,activationMode:d="automatic",...u}=t,f=rc(l),[p,y]=Ai({prop:n,onChange:s,defaultProp:i??"",caller:Mg});return o.jsx(Aie,{scope:r,baseId:Ti(),value:p,onValueChange:y,orientation:a,dir:f,activationMode:d,children:o.jsx(He.div,{dir:f,"data-orientation":a,...u,ref:e})})});CO.displayName=Mg;var AO="TabsList",NO=C.forwardRef((t,e)=>{const{__scopeTabs:r,loop:n=!0,...s}=t,i=f2(AO,r),a=TO(r);return o.jsx(EE,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:n,children:o.jsx(He.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});NO.displayName=AO;var IO="TabsTrigger",RO=C.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,disabled:s=!1,...i}=t,a=f2(IO,r),l=TO(r),d=PO(a.baseId,n),u=DO(a.baseId,n),f=n===a.value;return o.jsx(SE,{asChild:!0,...l,focusable:!s,active:f,children:o.jsx(He.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":u,"data-state":f?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:d,...i,ref:e,onMouseDown:Re(t.onMouseDown,p=>{!s&&p.button===0&&p.ctrlKey===!1?a.onValueChange(n):p.preventDefault()}),onKeyDown:Re(t.onKeyDown,p=>{[" ","Enter"].includes(p.key)&&a.onValueChange(n)}),onFocus:Re(t.onFocus,()=>{const p=a.activationMode!=="manual";!f&&!s&&p&&a.onValueChange(n)})})})});RO.displayName=IO;var _O="TabsContent",LO=C.forwardRef((t,e)=>{const{__scopeTabs:r,value:n,forceMount:s,children:i,...a}=t,l=f2(_O,r),d=PO(l.baseId,n),u=DO(l.baseId,n),f=n===l.value,p=C.useRef(f);return C.useEffect(()=>{const y=requestAnimationFrame(()=>p.current=!1);return()=>cancelAnimationFrame(y)},[]),o.jsx(fn,{present:s||f,children:({present:y})=>o.jsx(He.div,{"data-state":f?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":d,hidden:!y,id:u,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:p.current?"0s":void 0},children:y&&i})})});LO.displayName=_O;function PO(t,e){return`${t}-trigger-${e}`}function DO(t,e){return`${t}-content-${e}`}var Nie=CO,kO=NO,jO=RO,MO=LO;const Nf=Nie,id=C.forwardRef(({className:t,...e},r)=>o.jsx(kO,{ref:r,className:Ye("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));id.displayName=kO.displayName;const kr=C.forwardRef(({className:t,...e},r)=>o.jsx(jO,{ref:r,className:Ye("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...e}));kr.displayName=jO.displayName;const jr=C.forwardRef(({className:t,...e},r)=>o.jsx(MO,{ref:r,className:Ye("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));jr.displayName=MO.displayName;var Og="Switch",[Iie,Vae]=hn(Og),[Rie,_ie]=Iie(Og),OO=C.forwardRef((t,e)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:i,required:a,disabled:l,value:d="on",onCheckedChange:u,form:f,...p}=t,[y,v]=C.useState(null),E=st(e,A=>v(A)),b=C.useRef(!1),T=y?f||!!y.closest("form"):!0,[I,N]=Ai({prop:s,defaultProp:i??!1,onChange:u,caller:Og});return o.jsxs(Rie,{scope:r,checked:I,disabled:l,children:[o.jsx(He.button,{type:"button",role:"switch","aria-checked":I,"aria-required":a,"data-state":$O(I),"data-disabled":l?"":void 0,disabled:l,value:d,...p,ref:E,onClick:Re(t.onClick,A=>{N(L=>!L),T&&(b.current=A.isPropagationStopped(),b.current||A.stopPropagation())})}),T&&o.jsx(UO,{control:y,bubbles:!b.current,name:n,value:d,checked:I,required:a,disabled:l,form:f,style:{transform:"translateX(-100%)"}})]})});OO.displayName=Og;var FO="SwitchThumb",BO=C.forwardRef((t,e)=>{const{__scopeSwitch:r,...n}=t,s=_ie(FO,r);return o.jsx(He.span,{"data-state":$O(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:e})});BO.displayName=FO;var Lie="SwitchBubbleInput",UO=C.forwardRef(({__scopeSwitch:t,control:e,checked:r,bubbles:n=!0,...s},i)=>{const a=C.useRef(null),l=st(a,i),d=Ig(r),u=Jp(e);return C.useEffect(()=>{const f=a.current;if(!f)return;const p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"checked").set;if(d!==r&&v){const E=new Event("click",{bubbles:n});v.call(f,r),f.dispatchEvent(E)}},[d,r,n]),o.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});UO.displayName=Lie;function $O(t){return t?"checked":"unchecked"}var VO=OO,Pie=BO;const rh=C.forwardRef(({className:t,...e},r)=>o.jsx(VO,{className:Ye("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...e,ref:r,children:o.jsx(Pie,{className:Ye("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));rh.displayName=VO.displayName;const ct=C.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Ye("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));ct.displayName="Card";const wt=C.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Ye("flex flex-col space-y-1.5 p-6",t),...e}));wt.displayName="CardHeader";const bt=C.forwardRef(({className:t,...e},r)=>o.jsx("h3",{ref:r,className:Ye("text-2xl font-semibold leading-none tracking-tight",t),...e}));bt.displayName="CardTitle";const dn=C.forwardRef(({className:t,...e},r)=>o.jsx("p",{ref:r,className:Ye("text-sm text-muted-foreground",t),...e}));dn.displayName="CardDescription";const ut=C.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Ye("p-6 pt-0",t),...e}));ut.displayName="CardContent";const GO=C.forwardRef(({className:t,...e},r)=>o.jsx("div",{ref:r,className:Ye("flex items-center p-6 pt-0",t),...e}));GO.displayName="CardFooter";var Die="Separator",JN="horizontal",kie=["horizontal","vertical"],HO=C.forwardRef((t,e)=>{const{decorative:r,orientation:n=JN,...s}=t,i=jie(n)?n:JN,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return o.jsx(He.div,{"data-orientation":i,...l,...s,ref:e})});HO.displayName=Die;function jie(t){return kie.includes(t)}var zO=HO;const h0=C.forwardRef(({className:t,orientation:e="horizontal",decorative:r=!0,...n},s)=>o.jsx(zO,{ref:s,decorative:r,orientation:e,className:Ye("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...n}));h0.displayName=zO.displayName;const Mie=()=>{const{theme:t,setTheme:e}=pP(),{user:r}=ps(),{toast:n}=la(),[s,i]=C.useState(!1),[a,l]=C.useState({oldPassword:"",newPassword:"",confirmPassword:""}),[d,u]=C.useState({email:!0,marketing:!1,security:!0}),f=async p=>{var y,v;if(p.preventDefault(),a.newPassword!==a.confirmPassword){n({title:"Erreur",description:"Les nouveaux mots de passe ne correspondent pas.",variant:"destructive"});return}if(a.newPassword.length<6){n({title:"Erreur",description:"Le mot de passe doit contenir au moins 6 caractres.",variant:"destructive"});return}i(!0);try{await cn.changePassword({old_password:a.oldPassword,new_password:a.newPassword}),n({title:"Succs",description:"Votre mot de passe a t mis  jour."}),l({oldPassword:"",newPassword:"",confirmPassword:""})}catch(E){n({title:"Erreur",description:((v=(y=E.response)==null?void 0:y.data)==null?void 0:v.error)||"Erreur lors du changement de mot de passe.",variant:"destructive"})}finally{i(!1)}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(hg,{}),o.jsxs("div",{className:"container mx-auto py-10 pt-24 max-w-4xl px-4",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold tracking-tight mb-2",children:"Paramtres"}),o.jsx("p",{className:"text-muted-foreground",children:"Grez vos prfrences de compte et votre scurit."})]}),o.jsxs(Nf,{defaultValue:"general",className:"w-full",children:[o.jsxs(id,{className:"grid w-full grid-cols-3 mb-8",children:[o.jsxs(kr,{value:"general",className:"flex items-center gap-2",children:[o.jsx(Nn,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Gnral"})]}),o.jsxs(kr,{value:"security",className:"flex items-center gap-2",children:[o.jsx(Gu,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Scurit"})]}),o.jsxs(kr,{value:"notifications",className:"flex items-center gap-2",children:[o.jsx(ky,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:"Notifications"})]})]}),o.jsx(jr,{value:"general",children:o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Prfrences Gnrales"}),o.jsx(dn,{children:"Personnalisez l'apparence et consultez vos informations."})]}),o.jsxs(ut,{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx(Ce,{className:"text-base",children:"Apparence"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:"Choisissez entre le mode clair et le mode sombre."})]}),o.jsxs("div",{className:"flex items-center gap-2 bg-muted p-1 rounded-full",children:[o.jsx(ve,{variant:t==="light"?"default":"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",onClick:()=>e("light"),children:o.jsx(qp,{className:"h-4 w-4"})}),o.jsx(ve,{variant:t==="dark"?"default":"ghost",size:"sm",className:"rounded-full h-8 w-8 p-0",onClick:()=>e("dark"),children:o.jsx(Kp,{className:"h-4 w-4"})})]})]}),o.jsx(h0,{}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"text-sm font-medium",children:"Informations du compte"}),o.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nom"}),o.jsx(Ue,{value:(r==null?void 0:r.name)||"",disabled:!0,readOnly:!0,className:"bg-muted"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Email"}),o.jsx(Ue,{value:(r==null?void 0:r.email)||"",disabled:!0,readOnly:!0,className:"bg-muted"})]})]}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Pour modifier ces informations, veuillez contacter le support."})]})]})]})}),o.jsx(jr,{value:"security",children:o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Scurit"}),o.jsx(dn,{children:"Grez votre mot de passe et la scurit de votre compte."})]}),o.jsx(ut,{children:o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"current-password",children:"Mot de passe actuel"}),o.jsxs("div",{className:"relative",children:[o.jsx(Rl,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),o.jsx(Ue,{id:"current-password",type:"password",className:"pl-9",placeholder:"",value:a.oldPassword,onChange:p=>l({...a,oldPassword:p.target.value}),required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"new-password",children:"Nouveau mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(Rl,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),o.jsx(Ue,{id:"new-password",type:"password",className:"pl-9",placeholder:"",value:a.newPassword,onChange:p=>l({...a,newPassword:p.target.value}),required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"confirm-password",children:"Confirmer le nouveau mot de passe"}),o.jsxs("div",{className:"relative",children:[o.jsx(Rl,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),o.jsx(Ue,{id:"confirm-password",type:"password",className:"pl-9",placeholder:"",value:a.confirmPassword,onChange:p=>l({...a,confirmPassword:p.target.value}),required:!0})]})]}),o.jsx("div",{className:"flex justify-end pt-4",children:o.jsx(ve,{type:"submit",disabled:s,children:s?"Modification...":"Mettre  jour le mot de passe"})})]})})]})}),o.jsx(jr,{value:"notifications",children:o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Notifications"}),o.jsx(dn,{children:"Choisissez comment vous souhaitez tre inform."})]}),o.jsxs(ut,{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[o.jsxs(Ce,{htmlFor:"email-notifs",className:"flex flex-col space-y-1",children:[o.jsx("span",{children:"Emails de transaction"}),o.jsx("span",{className:"font-normal text-xs text-muted-foreground",children:"Rejoignez des parties, confirmations d'achat, etc."})]}),o.jsx(rh,{id:"email-notifs",checked:d.email,onCheckedChange:p=>u({...d,email:p})})]}),o.jsx(h0,{}),o.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[o.jsxs(Ce,{htmlFor:"security-notifs",className:"flex flex-col space-y-1",children:[o.jsx("span",{children:"Alertes de scurit"}),o.jsx("span",{className:"font-normal text-xs text-muted-foreground",children:"Connexions suspectes, changements de mot de passe."})]}),o.jsx(rh,{id:"security-notifs",checked:d.security,disabled:!0})]}),o.jsx(h0,{}),o.jsxs("div",{className:"flex items-center justify-between space-x-2",children:[o.jsxs(Ce,{htmlFor:"marketing-notifs",className:"flex flex-col space-y-1",children:[o.jsx("span",{children:"Emails Marketing"}),o.jsx("span",{className:"font-normal text-xs text-muted-foreground",children:"Nouveauts, offres spciales et actualits MySmash."})]}),o.jsx(rh,{id:"marketing-notifs",checked:d.marketing,onCheckedChange:p=>u({...d,marketing:p})})]})]}),o.jsx(GO,{children:o.jsx(ve,{variant:"outline",className:"w-full",onClick:()=>n({title:"Prfrences sauvegardes"}),children:"Enregistrer les prfrences"})})]})})]})]})]})},oc=C.forwardRef(({className:t,...e},r)=>o.jsx("div",{className:"relative w-full overflow-auto",children:o.jsx("table",{ref:r,className:Ye("w-full caption-bottom text-sm",t),...e})}));oc.displayName="Table";const lc=C.forwardRef(({className:t,...e},r)=>o.jsx("thead",{ref:r,className:Ye("[&_tr]:border-b",t),...e}));lc.displayName="TableHeader";const cc=C.forwardRef(({className:t,...e},r)=>o.jsx("tbody",{ref:r,className:Ye("[&_tr:last-child]:border-0",t),...e}));cc.displayName="TableBody";const Oie=C.forwardRef(({className:t,...e},r)=>o.jsx("tfoot",{ref:r,className:Ye("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));Oie.displayName="TableFooter";const Ds=C.forwardRef(({className:t,...e},r)=>o.jsx("tr",{ref:r,className:Ye("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",t),...e}));Ds.displayName="TableRow";const It=C.forwardRef(({className:t,...e},r)=>o.jsx("th",{ref:r,className:Ye("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));It.displayName="TableHead";const Rt=C.forwardRef(({className:t,...e},r)=>o.jsx("td",{ref:r,className:Ye("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Rt.displayName="TableCell";const Fie=C.forwardRef(({className:t,...e},r)=>o.jsx("caption",{ref:r,className:Ye("mt-4 text-sm text-muted-foreground",t),...e}));Fie.displayName="TableCaption";const Bie=({onStatsUpdate:t})=>{const[e,r]=C.useState([]),[n,s]=C.useState(!0),[i,a]=C.useState(""),[l,d]=C.useState(""),[u,f]=C.useState("name"),[p,y]=C.useState("asc"),[v,E]=C.useState(!1),[b,T]=C.useState(!1),[I,N]=C.useState(!1),[A,L]=C.useState(null),[P,k]=C.useState({name:"",email:"",role:"player",phone_number:"",credits_balance:0,password:""}),[D,O]=C.useState(0),[F,$]=C.useState(!1);C.useEffect(()=>{G()},[]);const G=async()=>{try{s(!0);const se=(await yt.getAllUsers()).data.users.filter(oe=>oe.role!=="club");r(se)}catch{a("Erreur lors du chargement des utilisateurs")}finally{s(!1)}},Y=async ie=>{ie.preventDefault(),$(!0);try{await yt.createUser(P),E(!1),Z(),G(),t==null||t()}catch{a("Erreur lors de la cration")}finally{$(!1)}},ne=async ie=>{ie.preventDefault(),$(!0);try{await yt.updateUser(A.id,P),T(!1),Z(),G(),t==null||t()}catch{a("Erreur lors de la mise  jour")}finally{$(!1)}},X=async ie=>{if(confirm("tes-vous sr de vouloir supprimer cet utilisateur ?"))try{await yt.deleteUser(ie),G(),t==null||t()}catch{a("Erreur lors de la suppression")}},z=async ie=>{ie.preventDefault(),$(!0);try{await yt.addCredits(A.id,D),N(!1),O(0),G(),t==null||t()}catch{a("Erreur lors de l'ajout de crdits")}finally{$(!1)}},Z=()=>{k({name:"",email:"",role:"player",phone_number:"",credits_balance:0,password:""}),L(null)},ee=ie=>{L(ie),k({name:ie.name,email:ie.email,role:ie.role,phone_number:ie.phone_number||"",credits_balance:ie.credits_balance,password:""}),T(!0)},q=ie=>{L(ie),O(0),N(!0)},K=ie=>{u===ie?y(p==="asc"?"desc":"asc"):(f(ie),y("asc"))},ae=ie=>u!==ie?o.jsx(af,{className:"h-4 w-4 ml-1 opacity-30"}):p==="asc"?o.jsx(of,{className:"h-4 w-4 ml-1"}):o.jsx(sf,{className:"h-4 w-4 ml-1"}),re=[...e.filter(ie=>ie.name.toLowerCase().includes(l.toLowerCase())||ie.email.toLowerCase().includes(l.toLowerCase()))].sort((ie,se)=>{const oe=ie[u],fe=se[u];return oe==null?1:fe==null?-1:typeof oe=="string"&&typeof fe=="string"?p==="asc"?oe.localeCompare(fe):fe.localeCompare(oe):typeof oe=="number"&&typeof fe=="number"?p==="asc"?oe-fe:fe-oe:0}),Ee=ie=>{const se={super_admin:"destructive",player:"secondary"},oe={super_admin:"Super Admin",player:"Joueur"};return o.jsx(Hr,{variant:se[ie]||"secondary",children:oe[ie]||ie})};return o.jsxs("div",{className:"space-y-6",children:[i&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:i})}),o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Gestion des Utilisateurs"}),o.jsx(dn,{children:"Grez les comptes administrateurs et joueurs."})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(ve,{variant:"outline",onClick:G,disabled:n,children:[o.jsx(db,{className:`h-4 w-4 mr-2 ${n?"animate-spin":""}`}),"Actualiser"]}),o.jsxs(Ir,{open:v,onOpenChange:E,children:[o.jsx(M4,{asChild:!0,children:o.jsxs(ve,{children:[o.jsx(as,{className:"h-4 w-4 mr-2"}),"Nouvel Utilisateur"]})}),o.jsxs(fr,{children:[o.jsx(Rr,{children:o.jsx(_r,{children:"Crer un Utilisateur"})}),o.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nom complet"}),o.jsx(Ue,{value:P.name,onChange:ie=>k(se=>({...se,name:ie.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Email"}),o.jsx(Ue,{type:"email",value:P.email,onChange:ie=>k(se=>({...se,email:ie.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Rle"}),o.jsxs(Yl,{value:P.role,onValueChange:ie=>k(se=>({...se,role:ie})),children:[o.jsx(Oo,{children:o.jsx(ql,{})}),o.jsxs(Fo,{children:[o.jsx(Dr,{value:"player",children:"Joueur"}),o.jsx(Dr,{value:"super_admin",children:"Super Admin"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Crdits initiaux"}),o.jsx(Ue,{type:"number",min:"0",value:P.credits_balance,onChange:ie=>k(se=>({...se,credits_balance:parseInt(ie.target.value)||0}))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Mot de passe"}),o.jsx(Ue,{type:"password",value:P.password,onChange:ie=>k(se=>({...se,password:ie.target.value})),required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>E(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:F,children:[F&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Crer"]})]})]})]})]})]})]})}),o.jsxs(ut,{children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[o.jsx(uf,{className:"h-4 w-4 text-gray-400"}),o.jsx(Ue,{placeholder:"Rechercher par nom ou email...",value:l,onChange:ie=>d(ie.target.value),className:"max-w-sm"})]}),n?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):o.jsxs(oc,{children:[o.jsx(lc,{children:o.jsxs(Ds,{children:[o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>K("name"),children:o.jsxs("div",{className:"flex items-center",children:["Nom ",ae("name")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>K("email"),children:o.jsxs("div",{className:"flex items-center",children:["Email ",ae("email")]})}),o.jsx(It,{children:"Tlphone"}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>K("role"),children:o.jsxs("div",{className:"flex items-center",children:["Rle ",ae("role")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>K("credits_balance"),children:o.jsxs("div",{className:"flex items-center",children:["Crdits ",ae("credits_balance")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>K("video_count"),children:o.jsxs("div",{className:"flex items-center",children:["Vidos ",ae("video_count")]})}),o.jsx(It,{children:"Actions"})]})}),o.jsx(cc,{children:re.map(ie=>o.jsxs(Ds,{children:[o.jsx(Rt,{className:"font-medium",children:ie.name}),o.jsx(Rt,{children:ie.email}),o.jsx(Rt,{children:ie.phone_number||"-"}),o.jsx(Rt,{children:Ee(ie.role)}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center space-x-1",children:[o.jsx(Cn,{className:"h-4 w-4 text-yellow-500"}),o.jsx("span",{children:ie.credits_balance})]})}),o.jsx(Rt,{children:o.jsx("span",{className:"font-medium",children:ie.video_count||0})}),o.jsx(Rt,{children:o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsx(ve,{variant:"ghost",size:"sm",children:o.jsx(lf,{className:"h-4 w-4"})})}),o.jsxs(Qo,{align:"end",children:[o.jsxs(kt,{onClick:()=>ee(ie),children:[o.jsx(Po,{className:"mr-2 h-4 w-4"}),"Modifier"]}),o.jsxs(kt,{onClick:()=>q(ie),children:[o.jsx(Cn,{className:"mr-2 h-4 w-4"}),"Ajouter crdits"]}),o.jsxs(kt,{onClick:()=>X(ie.id),className:"text-red-600",children:[o.jsx(Fa,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})})]},ie.id))})]})]})]}),o.jsx(Ir,{open:b,onOpenChange:T,children:o.jsxs(fr,{children:[o.jsx(Rr,{children:o.jsx(_r,{children:"Modifier l'Utilisateur"})}),o.jsxs("form",{onSubmit:ne,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nom complet"}),o.jsx(Ue,{value:P.name,onChange:ie=>k(se=>({...se,name:ie.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Rle"}),o.jsxs(Yl,{value:P.role,onValueChange:ie=>k(se=>({...se,role:ie})),children:[o.jsx(Oo,{children:o.jsx(ql,{})}),o.jsxs(Fo,{children:[o.jsx(Dr,{value:"player",children:"Joueur"}),o.jsx(Dr,{value:"super_admin",children:"Super Admin"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Crdits"}),o.jsx(Ue,{type:"number",min:"0",value:P.credits_balance,onChange:ie=>k(se=>({...se,credits_balance:parseInt(ie.target.value)||0}))})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>T(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:F,children:[F&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Sauvegarder"]})]})]})]})}),o.jsx(Ir,{open:I,onOpenChange:N,children:o.jsxs(fr,{children:[o.jsx(Rr,{children:o.jsx(_r,{children:"Ajouter des Crdits"})}),o.jsxs("form",{onSubmit:z,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nombre de crdits  ajouter"}),o.jsx(Ue,{type:"number",min:"1",value:D,onChange:ie=>O(parseInt(ie.target.value)||0),required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>N(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:F||D<=0,children:[F&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Ajouter ",D," crdit",D>1?"s":""]})]})]})]})})]})},Uie=({club:t,isOpen:e,onClose:r})=>{const[n,s]=C.useState([]),[i,a]=C.useState(!0),[l,d]=C.useState(""),[u,f]=C.useState(null),[p,y]=C.useState(T()),[v,E]=C.useState(!1),b=C.useRef(null);function T(){return{name:"",image_url:"",position_x:0,position_y:0,width:3,opacity:.2,is_active:!0}}C.useEffect(()=>{e&&t&&(I(),f(null),d(""))},[e,t]);const I=async()=>{if(t)try{a(!0);const D=await yt.getClubOverlays(t.id);s(D.data.overlays||[])}catch(D){console.error("Erreur chargement overlays:",D),d("Impossible de charger les overlays.")}finally{a(!1)}},N=async(D,O)=>{if(t&&confirm(`Supprimer l'overlay "${O}" ?`))try{await yt.deleteClubOverlay(t.id,D),I()}catch(F){console.error("Erreur suppression overlay:",F),d("Erreur lors de la suppression.")}},A=D=>{f(D),y({name:D.name,image_url:D.image_url,position_x:D.position_x,position_y:D.position_y,width:D.width,opacity:D.opacity,is_active:D.is_active})},L=()=>{f({new:!0}),y(T())},P=async()=>{if(t)try{E(!0),d(""),u&&"id"in u?await yt.updateClubOverlay(t.id,u.id,p):await yt.createClubOverlay(t.id,p),await I(),f(null)}catch(D){console.error("Erreur sauvegarde:",D),d("Erreur lors de l'enregistrement.")}finally{E(!1)}},k=async D=>{var F;const O=(F=D.target.files)==null?void 0:F[0];if(O)try{E(!0),y($=>({...$,image_url:URL.createObjectURL(O)}))}catch($){console.error("Erreur upload:",$),d("Erreur lors de l'upload de l'image.")}finally{E(!1)}};return o.jsx(Ir,{open:e,onOpenChange:r,children:o.jsxs(fr,{className:"!max-w-[90vw] w-[90vw] h-[90vh] flex flex-col p-0 gap-0 sm:max-w-[90vw]",children:[o.jsxs(Rr,{className:"p-6 border-b shrink-0 bg-white z-10",children:[o.jsxs(_r,{className:"text-2xl",children:["Gestion des Overlays Vido - ",t==null?void 0:t.name]}),o.jsx(bn,{className:"text-base",children:"Grez les logos et images flottantes qui s'affichent sur les vidos de ce club"})]}),l&&o.jsx("div",{className:"px-6 pt-4",children:o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:l})})}),o.jsxs("div",{className:"flex-1 overflow-hidden flex flex-row",children:[o.jsx("div",{className:"w-[500px] shrink-0 border-r bg-slate-50 flex flex-col overflow-y-auto",children:o.jsx("div",{className:"p-6",children:u?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"font-semibold text-lg",children:"id"in u?"Modifier Overlay":"Nouvel Overlay"}),o.jsx(ve,{variant:"ghost",size:"sm",onClick:()=>f(null),children:o.jsx(tc,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Image de l'overlay"}),o.jsxs("div",{className:"flex gap-4 items-start p-4 bg-white border rounded-lg",children:[o.jsx("div",{className:"border rounded bg-gray-50 w-20 h-20 flex items-center justify-center",children:p.image_url?o.jsx("img",{src:p.image_url,alt:"Preview",className:"w-full h-full object-contain"}):o.jsx(lb,{className:"text-gray-300 h-6 w-6"})}),o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx(Ue,{type:"file",accept:"image/*",ref:b,onChange:k,disabled:v,className:"text-sm"}),o.jsx("p",{className:"text-xs text-blue-600",children:" PNG transparent recommand"})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{className:"text-sm",children:"Nom (Optionnel)"}),o.jsx(Ue,{value:p.name,onChange:D=>y({...p,name:D.target.value}),placeholder:"Logo Sponsor",className:"h-9"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsxs(Ce,{className:"text-sm",children:["Position X (",p.position_x,"%)"]}),o.jsx(yl,{value:[p.position_x],max:100,step:1,onValueChange:([D])=>y({...p,position_x:D})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs(Ce,{className:"text-sm",children:["Position Y (",p.position_y,"%)"]}),o.jsx(yl,{value:[p.position_y],max:100,step:1,onValueChange:([D])=>y({...p,position_y:D})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs(Ce,{className:"text-sm",children:["Largeur (",p.width,"%)"]}),o.jsx(yl,{value:[p.width],max:40,step:1,onValueChange:([D])=>y({...p,width:D})})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs(Ce,{className:"text-sm",children:["Opacit (",p.opacity.toFixed(2),")"]}),o.jsx(yl,{value:[p.opacity],max:1,step:.05,onValueChange:([D])=>y({...p,opacity:D})})]})]}),o.jsxs("div",{className:"flex items-center justify-between pt-3 border-t",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(rh,{checked:p.is_active,onCheckedChange:D=>y({...p,is_active:D})}),o.jsx(Ce,{className:"text-sm",children:"Actif"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ve,{variant:"outline",size:"sm",onClick:()=>f(null),children:"Annuler"}),o.jsxs(ve,{size:"sm",onClick:P,disabled:v||!p.image_url,children:[v&&o.jsx(ft,{className:"mr-2 h-3 w-3 animate-spin"}),"Sauvegarder"]})]})]})]}):i?o.jsx("div",{className:"flex justify-center py-12",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):n.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(yr,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),o.jsx("h3",{className:"text-base font-medium mb-1",children:"Aucun overlay"}),o.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Ajoutez des logos"}),o.jsxs(ve,{onClick:L,size:"sm",children:[o.jsx(as,{className:"h-4 w-4 mr-1"}),"Ajouter"]})]}):o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex justify-between items-center pb-3 border-b",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold",children:"Overlays"}),o.jsxs("p",{className:"text-xs text-gray-500",children:[n.length," lment(s)"]})]}),o.jsxs(ve,{onClick:L,size:"sm",children:[o.jsx(as,{className:"h-4 w-4 mr-1"}),"Ajouter"]})]}),n.map(D=>o.jsx("div",{className:"p-3 border rounded-lg bg-white hover:shadow transition-all",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h4",{className:"font-medium text-sm truncate",children:D.name||"Sans nom"}),o.jsx(Hr,{variant:D.is_active?"default":"secondary",className:`text-xs ${D.is_active?"bg-green-600":""}`,children:D.is_active?"Actif":"Off"})]}),o.jsxs("div",{className:"flex gap-1 text-xs text-gray-600 flex-wrap",children:[o.jsxs("span",{className:"bg-gray-100 px-1.5 py-0.5 rounded font-mono",children:[D.position_x,"%/",D.position_y,"%"]}),o.jsxs("span",{className:"bg-gray-100 px-1.5 py-0.5 rounded font-mono",children:[D.width,"%"]}),o.jsx("span",{className:"bg-gray-100 px-1.5 py-0.5 rounded font-mono",children:D.opacity.toFixed(2)})]})]}),o.jsxs("div",{className:"flex flex-col gap-1 ml-2",children:[o.jsx(ve,{variant:"outline",size:"sm",onClick:()=>A(D),className:"h-7 w-7 p-0",children:o.jsx(Po,{className:"h-3 w-3"})}),o.jsx(ve,{variant:"destructive",size:"sm",onClick:()=>N(D.id,D.name),className:"h-7 w-7 p-0",children:o.jsx(Fa,{className:"h-3 w-3"})})]})]})},D.id))]})})}),o.jsxs("div",{className:"flex-1 bg-black flex flex-col items-center justify-center p-8 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-900 to-black pointer-events-none"}),o.jsxs("h3",{className:"mb-6 text-gray-400 font-medium z-10 flex items-center gap-2",children:[o.jsx("span",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"}),"Prvisualisation Vido (16:9)"]}),o.jsxs("div",{className:"relative w-full max-w-4xl aspect-video bg-gray-900 rounded-lg border border-gray-800 shadow-2xl overflow-hidden z-10",children:[o.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-800 font-bold text-4xl select-none",children:"VIDEO PADEL"}),u&&p.image_url&&o.jsx("img",{src:p.image_url,alt:"Preview",style:{position:"absolute",left:`${p.position_x}%`,top:`${p.position_y}%`,width:`${p.width}%`,opacity:p.opacity,transition:"all 0.15s ease",border:"2px dashed yellow",zIndex:50}}),!u&&n.map(D=>D.is_active&&o.jsx("img",{src:D.image_url,alt:D.name,style:{position:"absolute",left:`${D.position_x}%`,top:`${D.position_y}%`,width:`${D.width}%`,opacity:D.opacity,zIndex:10}},D.id))]}),o.jsx("p",{className:"mt-4 text-sm text-gray-400 max-w-md text-center z-10",children:u?"Ajustez les curseurs pour positionner l'overlay en temps rel":"Aperu de tous les overlays actifs sur la vido"})]})]})]})})},$ie=({clubId:t,clubName:e})=>{const[r,n]=C.useState([]),[s,i]=C.useState([]),[a,l]=C.useState(!1),d=async()=>{l(!0);try{const p=await ye.get(`/admin/clubs/${t}/courts`);n(p.data.courts||[]);const v=((await ye.get("/admin/recordings/active")).data.active_recordings||[]).filter(E=>{var b;return((b=E.club)==null?void 0:b.id)===t});i(v)}catch(p){console.error("Erreur chargement donnes:",p)}finally{l(!1)}};C.useEffect(()=>{t&&d()},[t]);const u=async p=>{try{const y=await ye.post(`/admin/courts/${p}/toggle-status`);await d()}catch(y){console.error("Erreur toggle status:",y)}},f=async(p,y)=>{if(confirm(`Voulez-vous vraiment arrter l'enregistrement de ${y} ?`))try{await ye.post(`/admin/recordings/${p}/stop`),await d()}catch(v){console.error("Erreur arrt enregistrement:",v)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Contrle des Terrains"}),o.jsx("p",{className:"text-muted-foreground",children:e})]}),o.jsxs(ve,{onClick:d,disabled:a,variant:"outline",children:[o.jsx(db,{className:`h-4 w-4 mr-2 ${a?"animate-spin":""}`}),"Actualiser"]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"tat des Terrains"}),o.jsx(dn,{children:"Grer manuellement la disponibilit des terrains"})]}),o.jsx(ut,{children:o.jsx("div",{className:"space-y-4",children:r.length===0?o.jsx("p",{className:"text-center text-muted-foreground py-4",children:"Aucun terrain configur"}):r.map(p=>{var E;const y=p.is_recording,v=s.find(b=>b.court_id===p.id);return o.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("div",{className:`w-3 h-3 rounded-full ${p.available?"bg-green-500":"bg-red-500"}`}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium",children:p.name}),o.jsx("p",{className:"text-sm text-muted-foreground",children:v?o.jsxs(o.Fragment,{children:["Enregistrement en cours  ",(E=v.player)==null?void 0:E.name]}):p.available?"Disponible":"Indisponible"})]})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Hr,{variant:p.available?"default":"destructive",children:p.available?"Disponible":"Occup"}),o.jsx(ve,{onClick:()=>u(p.id),variant:y?"destructive":"outline",size:"sm",children:y?o.jsxs(o.Fragment,{children:[o.jsx(bB,{className:"h-4 w-4 mr-2"}),"Librer"]}):o.jsxs(o.Fragment,{children:[o.jsx(EB,{className:"h-4 w-4 mr-2"}),"Bloquer"]})})]})]},p.id)})})})]}),s.length>0&&o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Enregistrements en Cours"}),o.jsx(dn,{children:"Grer les enregistrements actifs sur ce club"})]}),o.jsx(ut,{children:o.jsx("div",{className:"space-y-4",children:s.map(p=>{var y,v;return o.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-red-50",children:[o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(yr,{className:"h-5 w-5 text-red-600 animate-pulse"}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium",children:(y=p.player)==null?void 0:y.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[(v=p.court)==null?void 0:v.name,"  Depuis ",new Date(p.start_time).toLocaleTimeString()]})]})]}),o.jsxs(ve,{onClick:()=>{var E;return f(p.recording_id,(E=p.player)==null?void 0:E.name)},variant:"destructive",size:"sm",children:[o.jsx(RB,{className:"h-4 w-4 mr-2"}),"Arrter"]})]},p.recording_id)})})})]})]})},Vie=({onStatsUpdate:t,onDataChange:e})=>{const[r,n]=C.useState([]),[s,i]=C.useState(!0),[a,l]=C.useState(""),[d,u]=C.useState("name"),[f,p]=C.useState("asc"),[y,v]=C.useState(!1),[E,b]=C.useState(!1),[T,I]=C.useState(!1),[N,A]=C.useState(!1),[L,P]=C.useState(!1),[k,D]=C.useState(!1),[O,F]=C.useState(!1),[$,G]=C.useState(null),[Y,ne]=C.useState(null),[X,z]=C.useState([]),[Z,ee]=C.useState({name:"",address:"",phone_number:"",email:"",password:""}),[q,K]=C.useState({name:"",camera_url:"",qr_code:""}),[ae,Q]=C.useState(!1);C.useEffect(()=>{re()},[]);const re=async()=>{try{i(!0);const we=await yt.getAllClubs();n(we.data.clubs)}catch{l("Erreur lors du chargement des clubs")}finally{i(!1)}},Ee=async we=>{try{const Ne=await yt.getClubCourts(we);z(Ne.data.courts||[])}catch{l("Erreur lors du chargement des terrains")}},ie=async we=>{we.preventDefault(),Q(!0);try{await yt.createClub(Z),v(!1),Le(),re(),t==null||t(),e==null||e()}catch{l("Erreur lors de la cration du club")}finally{Q(!1)}},se=async we=>{we.preventDefault(),Q(!0);try{await yt.updateClub($.id,Z),b(!1),Le(),re(),t==null||t(),e==null||e()}catch{l("Erreur lors de la mise  jour du club")}finally{Q(!1)}},oe=async we=>{if(confirm("tes-vous sr de vouloir supprimer ce club ?"))try{await yt.deleteClub(we),re(),t==null||t(),e==null||e()}catch{l("Erreur lors de la suppression du club")}},fe=we=>{const Ne=prompt(`Combien de crdits offrir  ${we.name} ?

Solde actuel : ${we.credits_balance||0} crdits`,"100");Ne&&parseInt(Ne)>0&&yt.addCreditsToClub(we.id,parseInt(Ne)).then(()=>{alert(` ${Ne} crdits offerts  ${we.name} !`),re()}).catch(()=>alert("Erreur lors de l'ajout des crdits"))},Le=()=>{ee({name:"",address:"",phone_number:"",email:"",password:""}),G(null)},_e=we=>{G(we),ee({name:we.name,address:we.address||"",phone_number:we.phone_number||"",email:we.email||"",password:""}),b(!0)},ce=async we=>{G(we),await Ee(we.id),I(!0)},Se=we=>new Date(we).toLocaleDateString("fr-FR"),Pe=we=>{d===we?p(f==="asc"?"desc":"asc"):(u(we),p("asc"))},Be=we=>d!==we?o.jsx(af,{className:"h-4 w-4 ml-1 opacity-30"}):f==="asc"?o.jsx(of,{className:"h-4 w-4 ml-1"}):o.jsx(sf,{className:"h-4 w-4 ml-1"}),tt=[...r].sort((we,Ne)=>{const Je=we[d],Xe=Ne[d];return Je==null?1:Xe==null?-1:typeof Je=="string"&&typeof Xe=="string"?f==="asc"?Je.localeCompare(Xe):Xe.localeCompare(Je):typeof Je=="number"&&typeof Xe=="number"?f==="asc"?Je-Xe:Xe-Je:0});return o.jsxs("div",{className:"space-y-6",children:[a&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:a})}),o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Gestion des Clubs"}),o.jsx(dn,{children:"Crez et grez les clubs de padel"})]}),o.jsxs(Ir,{open:y,onOpenChange:v,children:[o.jsx(M4,{asChild:!0,children:o.jsxs(ve,{children:[o.jsx(as,{className:"h-4 w-4 mr-2"}),"Nouveau Club"]})}),o.jsxs(fr,{children:[o.jsxs(Rr,{children:[o.jsx(_r,{children:"Crer un Club"}),o.jsx(bn,{children:"Ajoutez un nouveau club de padel  la plateforme"})]}),o.jsxs("form",{onSubmit:ie,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nom du club"}),o.jsx(Ue,{value:Z.name,onChange:we=>ee(Ne=>({...Ne,name:we.target.value})),placeholder:"Ex: Club de Padel Paris",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Adresse"}),o.jsx(Ue,{value:Z.address,onChange:we=>ee(Ne=>({...Ne,address:we.target.value})),placeholder:"123 Rue de la Paix, 75001 Paris"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Tlphone"}),o.jsx(Ue,{value:Z.phone_number,onChange:we=>ee(Ne=>({...Ne,phone_number:we.target.value})),placeholder:"+33 1 23 45 67 89"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Email"}),o.jsx(Ue,{type:"email",value:Z.email,onChange:we=>ee(Ne=>({...Ne,email:we.target.value})),placeholder:"contact@clubpadel.com",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Mot de passe"}),o.jsx(Ue,{type:"password",value:Z.password,onChange:we=>ee(Ne=>({...Ne,password:we.target.value})),placeholder:"Mot de passe du club",required:!0})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:ae,children:[ae&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Crer le Club"]})]})]})]})]})]})}),o.jsx(ut,{children:s?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):r.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Bl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucun club enregistr"}),o.jsx("p",{className:"text-gray-600 mb-4",children:"Commencez par crer votre premier club"}),o.jsxs(ve,{onClick:()=>v(!0),children:[o.jsx(as,{className:"h-4 w-4 mr-2"}),"Crer un Club"]})]}):o.jsxs(oc,{children:[o.jsx(lc,{children:o.jsxs(Ds,{children:[o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>Pe("name"),children:o.jsxs("div",{className:"flex items-center",children:["Nom ",Be("name")]})}),o.jsx(It,{children:"Adresse"}),o.jsx(It,{children:"Contact"}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>Pe("credits_balance"),children:o.jsxs("div",{className:"flex items-center",children:["Crdits ",Be("credits_balance")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>Pe("created_at"),children:o.jsxs("div",{className:"flex items-center",children:["Date de cration ",Be("created_at")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>Pe("video_count"),children:o.jsxs("div",{className:"flex items-center",children:["Vidos ",Be("video_count")]})}),o.jsx(It,{children:"Actions"})]})}),o.jsx(cc,{children:tt.map(we=>o.jsxs(Ds,{children:[o.jsx(Rt,{className:"font-medium",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Bl,{className:"h-4 w-4 text-blue-500"}),o.jsx("span",{children:we.name})]})}),o.jsx(Rt,{children:we.address?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Oa,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm",children:we.address})]}):o.jsx("span",{className:"text-gray-400",children:"-"})}),o.jsx(Rt,{children:o.jsxs("div",{className:"space-y-1",children:[we.phone_number&&o.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[o.jsx(cf,{className:"h-3 w-3 text-gray-400"}),o.jsx("span",{children:we.phone_number})]}),we.email&&o.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[o.jsx(Lo,{className:"h-3 w-3 text-gray-400"}),o.jsx("span",{children:we.email})]}),!we.phone_number&&!we.email&&o.jsx("span",{className:"text-gray-400",children:"-"})]})}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Cn,{className:"h-4 w-4 text-amber-500"}),o.jsx("span",{className:"font-medium",children:we.credits_balance||0})]})}),o.jsx(Rt,{children:Se(we.created_at)}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(yr,{className:"h-4 w-4 text-blue-500"}),o.jsx("span",{className:"font-medium",children:we.video_count||0})]})}),o.jsx(Rt,{children:o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsx(ve,{variant:"ghost",size:"sm",children:o.jsx(lf,{className:"h-4 w-4"})})}),o.jsxs(Qo,{align:"end",children:[o.jsxs(kt,{onClick:()=>_e(we),children:[o.jsx(Po,{className:"mr-2 h-4 w-4"}),"Modifier"]}),o.jsxs(kt,{onClick:()=>ce(we),children:[o.jsx(Th,{className:"mr-2 h-4 w-4"}),"Voir Terrains"]}),o.jsxs(kt,{onClick:()=>{G(we),A(!0)},children:[o.jsx(Nu,{className:"mr-2 h-4 w-4"}),"Contrler Terrains"]}),o.jsxs(kt,{onClick:()=>{G(we),P(!0)},children:[o.jsx(Nu,{className:"mr-2 h-4 w-4"}),"Grer Overlays"]}),o.jsxs(kt,{onClick:()=>{G(we),D(!0)},children:[o.jsx(as,{className:"mr-2 h-4 w-4"}),"Ajouter Terrain"]}),o.jsxs(kt,{onClick:()=>fe(we),children:[o.jsx(as,{className:"mr-2 h-4 w-4 text-blue-600"}),o.jsx("span",{className:"text-blue-600",children:"Ajouter des Crdits"})]}),o.jsxs(kt,{onClick:()=>oe(we.id),className:"text-red-600",children:[o.jsx(Fa,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]})]})})]},we.id))})]})})]}),o.jsx(Ir,{open:E,onOpenChange:b,children:o.jsxs(fr,{children:[o.jsxs(Rr,{children:[o.jsx(_r,{children:"Modifier le Club"}),o.jsx(bn,{children:"Modifiez les informations du club"})]}),o.jsxs("form",{onSubmit:se,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nom du club"}),o.jsx(Ue,{value:Z.name,onChange:we=>ee(Ne=>({...Ne,name:we.target.value})),required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Adresse"}),o.jsx(Ue,{value:Z.address,onChange:we=>ee(Ne=>({...Ne,address:we.target.value}))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Tlphone"}),o.jsx(Ue,{value:Z.phone_number,onChange:we=>ee(Ne=>({...Ne,phone_number:we.target.value}))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Email"}),o.jsx(Ue,{type:"email",value:Z.email,onChange:we=>ee(Ne=>({...Ne,email:we.target.value}))})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:ae,children:[ae&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Sauvegarder"]})]})]})]})}),o.jsx(Ir,{open:T,onOpenChange:I,children:o.jsxs(fr,{className:"max-w-4xl",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{children:["Terrains de ",$==null?void 0:$.name]}),o.jsx(bn,{children:"Grez les terrains et leurs camras associes"})]}),o.jsx("div",{children:X.length===0?o.jsx("div",{className:"text-center py-8",children:o.jsx("p",{className:"text-gray-600",children:"Aucun terrain enregistr pour ce club"})}):o.jsx("div",{className:"space-y-3",children:X.map(we=>o.jsx("div",{className:"p-4 border rounded-lg bg-gray-50 hover:bg-gray-100 transition-all",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h4",{className:"font-semibold text-lg mb-2",children:we.name}),o.jsxs("div",{className:"space-y-1 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(yr,{className:"h-4 w-4 text-gray-500"}),o.jsx("span",{className:"text-gray-600 font-mono text-xs",children:we.camera_url})]}),we.qr_code&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-gray-500 font-medium",children:"QR Code:"}),o.jsx("span",{className:"text-blue-600 font-mono text-xs bg-blue-50 px-2 py-1 rounded",children:we.qr_code})]})]})]}),o.jsxs(ve,{variant:"outline",size:"sm",onClick:()=>{ne(we),K({name:we.name,camera_url:we.camera_url,qr_code:we.qr_code||""}),F(!0)},children:[o.jsx(Po,{className:"h-4 w-4 mr-1"}),"Modifier"]})]})},we.id))})})]})}),L&&$&&o.jsx(Uie,{club:$,isOpen:L,onClose:()=>P(!1)}),o.jsx(Ir,{open:N,onOpenChange:A,children:o.jsxs(fr,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{children:["Contrler Terrains - ",$==null?void 0:$.name]}),o.jsx(bn,{children:"Grez et contrlez les terrains de ce club"})]}),$&&o.jsx($ie,{clubId:$.id,clubName:$.name})]})}),o.jsx(Ir,{open:k,onOpenChange:D,children:o.jsxs(fr,{children:[o.jsxs(Rr,{children:[o.jsxs(_r,{children:["Ajouter un Terrain - ",$==null?void 0:$.name]}),o.jsx(bn,{children:"Crez un nouveau terrain pour ce club"})]}),o.jsxs("form",{onSubmit:we=>{we.preventDefault();const Ne=new FormData(we.currentTarget),Je={name:Ne.get("court-name"),camera_url:Ne.get("camera-url")};$&&(i(!0),yt.createCourt($.id,Je).then(()=>{D(!1),re()}).catch(Xe=>console.error("Error creating court:",Xe)).finally(()=>i(!1)))},className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"court-name",children:"Nom du terrain"}),o.jsx(Ue,{id:"court-name",name:"court-name",placeholder:"Ex: Terrain 1, Court Central...",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"camera-url",children:"URL de la camra"}),o.jsx(Ue,{id:"camera-url",name:"camera-url",placeholder:"http://212.231.225.55:88/axis-cgi/mjpg/video.cgi",required:!0})]}),o.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[o.jsx(yr,{className:"h-5 w-5 text-blue-600"}),o.jsx("span",{className:"font-medium text-blue-900",children:"QR Code automatique"})]}),o.jsx("p",{className:"text-sm text-blue-700",children:"Un QR code unique sera automatiquement gnr pour ce terrain. Les joueurs pourront le scanner pour dmarrer un enregistrement."})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>D(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:s,children:[s&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Crer le Terrain"]})]})]})]})}),o.jsx(Ir,{open:O,onOpenChange:F,children:o.jsxs(fr,{children:[o.jsxs(Rr,{children:[o.jsxs(_r,{children:["Modifier le Terrain - ",Y==null?void 0:Y.name]}),o.jsxs(bn,{children:["Modifiez les informations du terrain ",Y==null?void 0:Y.name]})]}),o.jsxs("form",{onSubmit:async we=>{if(we.preventDefault(),!(!Y||!$)){Q(!0);try{await yt.updateCourt($.id,Y.id,q),F(!1),await Ee($.id)}catch(Ne){console.error("Error updating court:",Ne),l("Erreur lors de la mise  jour du terrain")}finally{Q(!1)}}},className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"edit-court-name",children:"Nom du terrain"}),o.jsx(Ue,{id:"edit-court-name",value:q.name,onChange:we=>K(Ne=>({...Ne,name:we.target.value})),placeholder:"Ex: Terrain 1, Court Central...",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"edit-camera-url",children:"URL de la camra"}),o.jsx(Ue,{id:"edit-camera-url",value:q.camera_url,onChange:we=>K(Ne=>({...Ne,camera_url:we.target.value})),placeholder:"http://212.231.225.55:88/axis-cgi/mjpg/video.cgi",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"edit-qr-code",children:"QR Code du terrain"}),o.jsx(Ue,{id:"edit-qr-code",value:q.qr_code,onChange:we=>K(Ne=>({...Ne,qr_code:we.target.value})),placeholder:"Ex: terrain-001 ou UUID"}),o.jsx("p",{className:"text-xs text-gray-500",children:"Modifiez le QR code unique de ce terrain. Les joueurs devront scanner ce code pour enregistrer."})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",onClick:()=>F(!1),children:"Annuler"}),o.jsxs(ve,{type:"submit",disabled:ae,children:[ae&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Mettre  jour"]})]})]})]})})]})},Gie=({onStatsUpdate:t})=>{const[e,r]=C.useState([]),[n,s]=C.useState(!0),[i,a]=C.useState(""),[l,d]=C.useState("recorded_at"),[u,f]=C.useState("desc"),[p,y]=C.useState("all"),[v,E]=C.useState(!1),[b,T]=C.useState(null),[I,N]=C.useState(""),[A,L]=C.useState(""),[P,k]=C.useState(!1),[D,O]=C.useState([]),[F,$]=C.useState([]),[G,Y]=C.useState({user_id:"",bunny_video_id:"",bunny_url:"",title:"",description:"",court_id:"",duration:""});C.useEffect(()=>{ne(),X(),z()},[]);const ne=async()=>{try{s(!0);const ce=await yt.getAllVideos();r(ce.data.videos)}catch{a("Erreur lors du chargement des vidos")}finally{s(!1)}},X=async()=>{try{const Se=(await yt.getAllUsers()).data.users.filter(Pe=>Pe.role==="player");O(Se)}catch(ce){console.error("Erreur chargement joueurs:",ce)}},z=async()=>{try{const ce=await yt.getAllClubs(),Se=[];for(const Pe of ce.data.clubs){const tt=(await yt.getClubCourts(Pe.id)).data.courts.map(we=>({...we,club_name:Pe.name}));Se.push(...tt)}$(Se)}catch(ce){console.error("Erreur chargement terrains:",ce)}},Z=async(ce,Se,Pe)=>{const Be={local_only:`Supprimer le fichier local de "${Se}" ?

 La vido restera regardable depuis le cloud`,cloud_only:`Expirer "${Se}" du cloud ?

 La vido ne sera plus regardable
 Les statistiques seront prserves`,local_and_cloud:`Supprimer tous les fichiers de "${Se}" ?

 Fichier local + Cloud supprims
 Les statistiques seront prserves`,database:` SUPPRESSION DFINITIVE de "${Se}" ?

 Tout sera supprim
 Les statistiques seront PERDUES

Cette action est IRRVERSIBLE !`};if(confirm(Be[Pe]))try{await yt.deleteVideo(ce,Pe),Ge.success("Vido supprime avec succs"),ne(),t==null||t()}catch{Ge.error("Erreur lors de la suppression"),a("Erreur lors de la suppression")}},ee=async ce=>{var Se,Pe;try{const Be=await yt.retryBunnyUpload(ce);Ge.success("Upload programm avec succs"),ne()}catch(Be){const tt=((Pe=(Se=Be.response)==null?void 0:Se.data)==null?void 0:Pe.error)||"Erreur lors du retry";Ge.error(tt)}},q=ce=>{T(ce),N(ce.bunny_video_id||""),L(""),E(!0)},K=async()=>{var ce,Se;if(!(!b||!I))try{await yt.updateBunnyUrl(b.id,{bunny_video_id:I,bunny_url:A||void 0}),Ge.success("URL mise  jour avec succs"),E(!1),N(""),L(""),T(null),ne()}catch(Pe){const Be=((Se=(ce=Pe.response)==null?void 0:ce.data)==null?void 0:Se.error)||"Erreur lors de la mise  jour";Ge.error(Be)}},ae=()=>{Y({user_id:"",bunny_video_id:"",bunny_url:"",title:"",description:"",court_id:"",duration:""}),k(!0)},Q=async()=>{var ce,Se;if(!G.user_id||!G.bunny_video_id||!G.title){Ge.error("Veuillez remplir tous les champs requis");return}try{const Pe={user_id:parseInt(G.user_id),bunny_video_id:G.bunny_video_id,title:G.title};G.bunny_url&&(Pe.bunny_url=G.bunny_url),G.description&&(Pe.description=G.description),G.court_id&&(Pe.court_id=parseInt(G.court_id)),G.duration&&(Pe.duration=parseInt(G.duration)*60),await yt.createManualVideo(Pe),Ge.success("Vido cre avec succs"),k(!1),ne(),t==null||t()}catch(Pe){const Be=((Se=(ce=Pe.response)==null?void 0:ce.data)==null?void 0:Se.error)||"Erreur lors de la cration";Ge.error(Be)}},re=ce=>new Date(ce).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),Ee=ce=>ce?`${Math.floor(ce/60)}m`:"N/A",ie=ce=>{l===ce?f(u==="asc"?"desc":"asc"):(d(ce),f("asc"))},se=ce=>l!==ce?o.jsx(af,{className:"h-4 w-4 ml-1 opacity-30"}):u==="asc"?o.jsx(of,{className:"h-4 w-4 ml-1"}):o.jsx(sf,{className:"h-4 w-4 ml-1"}),oe=ce=>{const Pe={ready:{label:" Prte",className:"bg-green-100 text-green-800 border-green-200"},processing:{label:" Traitement",className:"bg-yellow-100 text-yellow-800 border-yellow-200"},uploading:{label:" Upload",className:"bg-blue-100 text-blue-800 border-blue-200"},failed:{label:" chec",className:"bg-red-100 text-red-800 border-red-200"},pending:{label:" En attente",className:"bg-gray-100 text-gray-800 border-gray-200"}}[ce||"pending"]||{label:ce||"Inconnu",className:"bg-gray-100 text-gray-800 border-gray-200"};return o.jsx(Hr,{variant:"outline",className:Pe.className,children:Pe.label})},fe=ce=>{y(ce)},_e=[...e.filter(ce=>p==="all"?!0:ce.processing_status===p)].sort((ce,Se)=>{const Pe=ce[l],Be=Se[l];return Pe==null?1:Be==null?-1:typeof Pe=="string"&&typeof Be=="string"?u==="asc"?Pe.localeCompare(Be):Be.localeCompare(Pe):typeof Pe=="number"&&typeof Be=="number"?u==="asc"?Pe-Be:Be-Pe:0});return o.jsxs("div",{className:"space-y-6",children:[i&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:i})}),o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Gestion des Vidos"}),o.jsx(dn,{children:"Grez toutes les vidos de la plateforme"})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs(ve,{onClick:ae,className:"flex items-center gap-2",children:[o.jsx(as,{className:"h-4 w-4"}),"Nouvelle Vido"]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ce,{className:"text-sm text-gray-600",children:"Filtrer :"}),o.jsxs("select",{value:p,onChange:ce=>fe(ce.target.value),className:"px-3 py-2 border rounded-md text-sm bg-white",children:[o.jsx("option",{value:"all",children:"Toutes les vidos"}),o.jsx("option",{value:"ready",children:" Prtes"}),o.jsx("option",{value:"processing",children:" En traitement"}),o.jsx("option",{value:"failed",children:" checs"}),o.jsx("option",{value:"uploading",children:" Upload"}),o.jsx("option",{value:"pending",children:" En attente"})]})]})]})]})}),o.jsx(ut,{children:n?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):_e.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(yr,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium mb-2",children:p==="all"?"Aucune vido enregistre":`Aucune vido ${p==="failed"?"en chec":p}`}),o.jsx("p",{className:"text-gray-600",children:p==="all"?"Les vidos apparatront ici une fois enregistres":"Changez le filtre pour voir d'autres vidos"})]}):o.jsxs(oc,{children:[o.jsx(lc,{children:o.jsxs(Ds,{children:[o.jsx(It,{className:"w-16",children:"#"}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>ie("title"),children:o.jsxs("div",{className:"flex items-center",children:["Nom ",se("title")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>ie("player_name"),children:o.jsxs("div",{className:"flex items-center",children:["Joueur ",se("player_name")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>ie("club_name"),children:o.jsxs("div",{className:"flex items-center",children:["Club ",se("club_name")]})}),o.jsx(It,{className:"cursor-pointer select-none",onClick:()=>ie("recorded_at"),children:o.jsxs("div",{className:"flex items-center",children:["Date ",se("recorded_at")]})}),o.jsx(It,{children:"Dure"}),o.jsx(It,{children:"Statut"}),o.jsx(It,{children:"Actions"})]})}),o.jsx(cc,{children:_e.map((ce,Se)=>o.jsxs(Ds,{children:[o.jsx(Rt,{className:"text-gray-500 font-mono text-sm",children:Se+1}),o.jsx(Rt,{className:"font-medium",children:ce.title||`Vido ${Se+1}`}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-blue-500"}),o.jsx("span",{className:"font-medium",children:ce.player_name})]})}),o.jsx(Rt,{children:ce.club_name?o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Bl,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{children:ce.club_name})]}):o.jsx("span",{className:"text-gray-400",children:"-"})}),o.jsx(Rt,{children:re(ce.recorded_at)}),o.jsx(Rt,{children:Ee(ce.duration)}),o.jsx(Rt,{children:oe(ce.processing_status)}),o.jsx(Rt,{children:o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsx(ve,{variant:"ghost",size:"sm",children:o.jsx(lf,{className:"h-4 w-4"})})}),o.jsxs(Qo,{align:"end",className:"w-64",children:[o.jsxs(kt,{onClick:()=>q(ce),className:"cursor-pointer text-blue-600",children:[o.jsx(Po,{className:"mr-2 h-4 w-4"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{children:" Modifier Infos / URL Bunny"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Mettre  jour Video ID ou URL"})]})]}),ce.processing_status==="failed"&&o.jsxs(o.Fragment,{children:[o.jsx(Xi,{}),o.jsxs(kt,{onClick:()=>ee(ce.id),disabled:!ce.has_local_file,className:"cursor-pointer text-blue-600",children:[o.jsx(db,{className:"mr-2 h-4 w-4"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{children:" Retry Upload Auto"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:ce.has_local_file?"Re-upload depuis fichier local":"Fichier local introuvable"})]})]})]}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:()=>Z(ce.id,ce.player_name,"local_only"),className:"cursor-pointer",children:[o.jsx(fB,{className:"mr-2 h-4 w-4"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{children:"Supprimer fichier local"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Libre espace serveur"})]})]}),o.jsxs(kt,{onClick:()=>Z(ce.id,ce.player_name,"cloud_only"),className:"cursor-pointer",children:[o.jsx(ob,{className:"mr-2 h-4 w-4"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{children:"Supprimer du cloud"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Expire la vido, garde stats"})]})]}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:()=>Z(ce.id,ce.player_name,"local_and_cloud"),className:"cursor-pointer text-orange-600",children:[o.jsx(Fa,{className:"mr-2 h-4 w-4"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{children:"Tout supprimer (garder stats)"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:"Local + Cloud, stats OK"})]})]}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:()=>Z(ce.id,ce.player_name,"database"),className:"cursor-pointer text-red-600",children:[o.jsx(uL,{className:"mr-2 h-4 w-4"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-semibold",children:"Supprimer dfinitivement"}),o.jsx("div",{className:"text-xs",children:"TOUT disparat, stats perdues"})]})]})]})]})})]},ce.id))})]})})]}),o.jsx(Ir,{open:v,onOpenChange:E,children:o.jsxs(fr,{children:[o.jsxs(Rr,{children:[o.jsx(_r,{children:"Mettre  jour URL Bunny"}),o.jsxs(bn,{children:["Vido : ",(b==null?void 0:b.title)||(b==null?void 0:b.player_name)]})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"bunny-video-id",children:"Bunny Video ID *"}),o.jsx(Ue,{id:"bunny-video-id",value:I,onChange:ce=>N(ce.target.value),placeholder:"e660b8a0-f342-41fb-872e-3824ab90ab66",className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Format GUID (ex: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"bunny-url",children:"URL Bunny (optionnel)"}),o.jsx(Ue,{id:"bunny-url",value:A,onChange:ce=>L(ce.target.value),placeholder:"https://vz-cc4565cd-4e9.b-cdn.net/...",className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Laissez vide pour gnration automatique"})]})]}),o.jsxs(op,{children:[o.jsx(ve,{variant:"outline",onClick:()=>E(!1),children:"Annuler"}),o.jsx(ve,{onClick:K,disabled:!I,children:"Sauvegarder"})]})]})}),o.jsx(Ir,{open:P,onOpenChange:k,children:o.jsxs(fr,{className:"max-w-2xl",children:[o.jsxs(Rr,{children:[o.jsx(_r,{children:" Crer une Nouvelle Vido Manuelle"}),o.jsx(bn,{children:"Ajouter une vido uploade via le dashboard Bunny pour un joueur"})]}),o.jsxs("div",{className:"space-y-4 py-4",children:[o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"user-select",children:"Joueur *"}),o.jsxs("select",{id:"user-select",value:G.user_id,onChange:ce=>Y({...G,user_id:ce.target.value}),className:"w-full mt-1 px-3 py-2 border rounded-md",children:[o.jsx("option",{value:"",children:"Slectionnez un joueur..."}),D.map(ce=>o.jsxs("option",{value:ce.id,children:[ce.name," (",ce.email,")"]},ce.id))]})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"create-bunny-id",children:"Bunny Video ID *"}),o.jsx(Ue,{id:"create-bunny-id",value:G.bunny_video_id,onChange:ce=>Y({...G,bunny_video_id:ce.target.value}),placeholder:"e660b8a0-f342-41fb-872e-3824ab90ab66",className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Format GUID (ex: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"create-title",children:"Titre *"}),o.jsx(Ue,{id:"create-title",value:G.title,onChange:ce=>Y({...G,title:ce.target.value}),placeholder:"Ma vido de padel",className:"mt-1"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"create-description",children:"Description (optionnel)"}),o.jsx(Ue,{id:"create-description",value:G.description,onChange:ce=>Y({...G,description:ce.target.value}),placeholder:"Description de la vido...",className:"mt-1"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"create-duration",children:"Dure en minutes (optionnel)"}),o.jsx(Ue,{id:"create-duration",type:"number",min:"1",value:G.duration,onChange:ce=>Y({...G,duration:ce.target.value}),placeholder:"90",className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Laissez vide pour dtection automatique depuis Bunny"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"court-select",children:"Terrain (optionnel)"}),o.jsxs("select",{id:"court-select",value:G.court_id,onChange:ce=>Y({...G,court_id:ce.target.value}),className:"w-full mt-1 px-3 py-2 border rounded-md",children:[o.jsx("option",{value:"",children:"Aucun terrain..."}),F.map(ce=>o.jsxs("option",{value:ce.id,children:[ce.club_name," - ",ce.name]},ce.id))]})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"create-bunny-url",children:"URL Bunny (optionnel)"}),o.jsx(Ue,{id:"create-bunny-url",value:G.bunny_url,onChange:ce=>Y({...G,bunny_url:ce.target.value}),placeholder:"https://vz-cc4565cd-4e9.b-cdn.net/...",className:"mt-1"}),o.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Laissez vide pour gnration automatique"})]})]}),o.jsxs(op,{children:[o.jsx(ve,{variant:"outline",onClick:()=>k(!1),children:"Annuler"}),o.jsx(ve,{onClick:Q,disabled:!G.user_id||!G.bunny_video_id||!G.title,children:"Crer la Vido"})]})]})})]})},Hie=()=>{const[t,e]=C.useState([]),[r,n]=C.useState([]),[s,i]=C.useState([]),[a,l]=C.useState(!0),[d,u]=C.useState(""),[f,p]=C.useState({clubId:"all",actionType:"all",search:""});C.useEffect(()=>{y()},[]),C.useEffect(()=>{v()},[t,f]);const y=async()=>{try{l(!0);const[A,L]=await Promise.all([yt.getAllClubsHistory(),yt.getAllClubs()]);e(A.data.history||[]),i(L.data.clubs||[])}catch(A){u("Erreur lors du chargement des donnes"),console.error("Error loading data:",A)}finally{l(!1)}},v=()=>{let A=[...t];if(f.clubId&&f.clubId!=="all"){const L=parseInt(f.clubId,10);A=A.filter(P=>P.club_id===L)}if(f.actionType&&f.actionType!=="all"&&(A=A.filter(L=>L.action_type===f.actionType)),f.search){const L=f.search.toLowerCase();A=A.filter(P=>P.player_name&&P.player_name.toLowerCase().includes(L)||P.club_name&&P.club_name.toLowerCase().includes(L)||P.performed_by_name&&P.performed_by_name.toLowerCase().includes(L))}n(A)},E=A=>{switch(A==null?void 0:A.toLowerCase().replace(/\s+/g,"_")){case"follow_club":return o.jsx(sL,{className:"h-4 w-4 text-green-600"});case"unfollow_club":return o.jsx(mB,{className:"h-4 w-4 text-red-600"});case"add_credits":case"buy_credits":return o.jsx(lL,{className:"h-4 w-4 text-blue-600"});case"update_player":return o.jsx(Po,{className:"h-4 w-4 text-blue-600"});case"create_player":return o.jsx(hL,{className:"h-4 w-4 text-green-600"});case"delete_player":return o.jsx(IB,{className:"h-4 w-4 text-red-600"});case"unlock_video":return o.jsx(Th,{className:"h-4 w-4 text-cyan-600"});case"video_upload":return o.jsx(yr,{className:"h-4 w-4 text-green-600"});case"video_delete":return o.jsx(Fa,{className:"h-4 w-4 text-red-600"});default:return o.jsx(jy,{className:"h-4 w-4 text-gray-600"})}},b=A=>{const L={follow_club:"Suivi du club",unfollow_club:"Arrt du suivi",add_credits:"Ajout de crdits",buy_credits:"Achat de crdits",update_player:"Modification joueur",create_player:"Cration joueur",delete_player:"Suppression joueur",unlock_video:"Dblocage vido",video_upload:"Upload vido",video_delete:"Suppression vido"},P=A==null?void 0:A.toLowerCase().replace(/\s+/g,"_");return L[P]||A||"Action inconnue"},T=A=>{switch(A==null?void 0:A.toLowerCase().replace(/\s+/g,"_")){case"follow_club":case"create_player":case"buy_credits":case"video_upload":return"default";case"unfollow_club":case"delete_player":case"video_delete":return"destructive";case"update_player":return"secondary";default:return"outline"}},I=A=>{const L=A.endsWith("Z")?A:A+"Z";return new Date(L).toLocaleString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})},N=()=>{p({clubId:"all",actionType:"all",search:""})};return a?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Historique Global des Clubs"}),o.jsxs("p",{className:"text-muted-foreground mt-2",children:["Suivi de toutes les actions effectues sur la plateforme (",r.length," rsultats)."]})]}),d&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:d})}),o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsxs(bt,{className:"flex items-center gap-2",children:[o.jsx(Wp,{className:"h-5 w-5"}),"Filtres"]})}),o.jsx(ut,{children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Club"}),o.jsxs(Yl,{value:f.clubId,onValueChange:A=>p({...f,clubId:A}),children:[o.jsx(Oo,{children:o.jsx(ql,{placeholder:"Tous les clubs"})}),o.jsxs(Fo,{children:[o.jsx(Dr,{value:"all",children:"Tous les clubs"}),s.map(A=>o.jsx(Dr,{value:A.id.toString(),children:A.name},A.id))]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Type d'action"}),o.jsxs(Yl,{value:f.actionType,onValueChange:A=>p({...f,actionType:A}),children:[o.jsx(Oo,{children:o.jsx(ql,{placeholder:"Toutes les actions"})}),o.jsxs(Fo,{children:[o.jsx(Dr,{value:"all",children:"Toutes les actions"}),o.jsx(Dr,{value:"follow_club",children:"Suivi du club"}),o.jsx(Dr,{value:"unfollow_club",children:"Arrt du suivi"}),o.jsx(Dr,{value:"update_player",children:"Modification du joueur"}),o.jsx(Dr,{value:"add_credits",children:"Ajout de crdits"}),o.jsx(Dr,{value:"create_player",children:"Cration du joueur"}),o.jsx(Dr,{value:"delete_player",children:"Suppression du joueur"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Recherche"}),o.jsxs("div",{className:"relative",children:[o.jsx(uf,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),o.jsx(Ue,{placeholder:"Nom du joueur, club...",value:f.search,onChange:A=>p({...f,search:A.target.value}),className:"pl-10"})]})]}),o.jsx("div",{className:"flex items-end",children:o.jsx(ve,{variant:"outline",onClick:N,className:"w-full",children:"Effacer"})})]})})]}),r.length===0?o.jsx(ct,{children:o.jsxs(ut,{className:"text-center py-12",children:[o.jsx(jy,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium mb-2",children:"Aucun historique trouv"}),o.jsx("p",{className:"text-muted-foreground",children:"Aucune action ne correspond  vos filtres."}),t.length>0&&o.jsx(ve,{variant:"outline",onClick:N,className:"mt-4",children:"Voir tout l'historique"})]})}):o.jsx("div",{className:"space-y-4",children:r.map(A=>o.jsx(ct,{className:"hover:shadow-md transition-shadow",children:o.jsx(ut,{className:"p-4",children:o.jsxs("div",{className:"flex items-start gap-4",children:[o.jsx("div",{className:"flex-shrink-0 mt-1",children:E(A.action_type)}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[o.jsx(Hr,{variant:T(A.action_type),children:b(A.action_type)}),o.jsxs(Hr,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[o.jsx(Bl,{className:"h-3 w-3 mr-1"}),A.club_name]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm flex-wrap",children:[o.jsx(Nn,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"font-medium",children:A.player_name}),o.jsxs("span",{className:"text-muted-foreground",children:["par ",A.performed_by_name]})]}),A.action_summary&&o.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:A.action_summary})]})]}),o.jsx("div",{className:"flex-shrink-0 text-right text-xs text-muted-foreground",children:o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Hp,{className:"h-3 w-3"}),o.jsx("span",{children:I(A.performed_at)})]})})]})})},A.id))})]})},zie=()=>{const[t,e]=C.useState({welcome_credits:1}),[r,n]=C.useState(!0),[s,i]=C.useState(!1),[a,l]=C.useState(""),[d,u]=C.useState("");C.useEffect(()=>{f()},[]);const f=async()=>{try{n(!0);const y=await Jy.getSettings();e({welcome_credits:y.data.welcome_credits||1})}catch{u("Erreur lors du chargement des paramtres")}finally{n(!1)}},p=async()=>{i(!0),u(""),l("");try{await Jy.updateSettings(t),l(" Paramtres enregistrs avec succs")}catch{u("Erreur lors de la sauvegarde")}finally{i(!1)}};return r?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Configuration Gnrale"}),o.jsx(dn,{children:"Paramtres gnraux de l'application"})]}),o.jsxs(ut,{className:"space-y-6",children:[a&&o.jsx(Xt,{children:o.jsx(Qt,{children:a})}),d&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:d})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Crdits Gratuits  l'Inscription"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{htmlFor:"welcome_credits",children:"Nombre de crdits"}),o.jsx(Ue,{id:"welcome_credits",type:"number",min:"0",max:"100",value:t.welcome_credits,onChange:y=>e({...t,welcome_credits:parseInt(y.target.value)||0}),className:"max-w-xs"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Nombre de crdits offerts automatiquement aux nouveaux utilisateurs lors de leur inscription"})]})]}),o.jsxs(ve,{onClick:p,disabled:s,children:[s&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),o.jsx(hb,{className:"h-4 w-4 mr-2"}),"Enregistrer les paramtres"]})]})]})};function Wie(){const[t,e]=C.useState({player:[],club:[]}),[r,n]=C.useState(!0),[s,i]=C.useState(""),[a,l]=C.useState(""),[d,u]=C.useState(!1),[f,p]=C.useState(null),[y,v]=C.useState("player"),[E,b]=C.useState({credits:"",price_dt:"",description:"",is_popular:!1,package_type:"player"});C.useEffect(()=>{T()},[]);const T=async()=>{try{n(!0);const[k,D]=await Promise.all([yt.getCreditPackages("player"),yt.getCreditPackages("club")]);e({player:k.data.packages||[],club:D.data.packages||[]}),i("")}catch(k){i("Erreur lors du chargement des packages"),console.error(k)}finally{n(!1)}},I=(k=null,D="player")=>{k?(p(k),b({credits:k.credits.toString(),price_dt:k.price_dt.toString(),description:k.description||"",is_popular:k.popular||!1,package_type:k.type})):(p(null),b({credits:"",price_dt:"",description:"",is_popular:!1,package_type:D})),u(!0)},N=()=>{u(!1),p(null),b({credits:"",price_dt:"",description:"",is_popular:!1,package_type:"player"})},A=async k=>{var D,O;if(k.preventDefault(),!E.credits||!E.price_dt){i("Veuillez remplir tous les champs obligatoires");return}try{const F={credits:parseInt(E.credits),price_dt:parseInt(E.price_dt),description:E.description,is_popular:E.is_popular,package_type:E.package_type};f?(await yt.updateCreditPackage(f.id,F),l("Package modifi avec succs")):(await yt.createCreditPackage(F),l("Package cr avec succs")),N(),T(),setTimeout(()=>l(""),3e3)}catch(F){i(((O=(D=F.response)==null?void 0:D.data)==null?void 0:O.error)||"Erreur lors de l'enregistrement"),console.error(F)}},L=async k=>{var D,O;if(confirm("tes-vous sr de vouloir supprimer ce package ?"))try{await yt.deleteCreditPackage(k),l("Package supprim avec succs"),T(),setTimeout(()=>l(""),3e3)}catch(F){i(((O=(D=F.response)==null?void 0:D.data)==null?void 0:O.error)||"Erreur lors de la suppression"),console.error(F)}},P=({pkg:k})=>o.jsx(ct,{className:"hover:shadow-md transition-shadow",children:o.jsxs(ut,{className:"p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx(Cn,{className:"h-5 w-5 text-yellow-500"}),o.jsxs("span",{className:"font-bold text-lg",children:[k.credits," crdits"]}),k.popular&&o.jsx(Hr,{className:"bg-blue-500",children:"Populaire"})]}),o.jsx("p",{className:"text-sm text-gray-600",children:k.description})]}),o.jsxs("div",{className:"text-right ml-4",children:[o.jsxs("div",{className:"font-bold text-xl text-green-600",children:[k.price_dt," DT"]}),k.savings_dt&&k.savings_dt>0&&o.jsxs("div",{className:"text-sm text-green-500",children:["conomie: ",k.savings_dt," DT"]})]})]}),o.jsxs("div",{className:"flex gap-2 mt-3 pt-3 border-t",children:[o.jsxs(ve,{size:"sm",variant:"outline",onClick:()=>I(k),className:"flex-1",children:[o.jsx(Po,{className:"h-4 w-4 mr-1"}),"Modifier"]}),o.jsxs(ve,{size:"sm",variant:"destructive",onClick:()=>L(k.id),className:"flex-1",children:[o.jsx(Fa,{className:"h-4 w-4 mr-1"}),"Supprimer"]})]})]})});return r?o.jsx(ct,{children:o.jsx(ut,{className:"p-8 text-center",children:o.jsx("div",{className:"text-gray-500",children:"Chargement des packages..."})})}):o.jsxs("div",{className:"space-y-4",children:[s&&o.jsxs(Xt,{variant:"destructive",children:[o.jsx(Ho,{className:"h-4 w-4"}),o.jsx(Qt,{children:s})]}),a&&o.jsxs(Xt,{className:"bg-green-50 text-green-800 border-green-200",children:[o.jsx(Ts,{className:"h-4 w-4"}),o.jsx(Qt,{children:a})]}),o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsx(bt,{className:"flex items-center justify-between",children:o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Cn,{className:"h-6 w-6 text-yellow-500"}),"Gestion des Packages de Crdits"]})})}),o.jsx(ut,{children:o.jsxs(Nf,{value:y,onValueChange:v,children:[o.jsxs(id,{className:"grid w-full grid-cols-2 mb-4",children:[o.jsxs(kr,{value:"player",children:["Packages Joueurs (",t.player.length,")"]}),o.jsxs(kr,{value:"club",children:["Packages Clubs (",t.club.length,")"]})]}),o.jsxs(jr,{value:"player",className:"space-y-4",children:[o.jsx("div",{className:"flex justify-end mb-4",children:o.jsxs(ve,{onClick:()=>I(null,"player"),children:[o.jsx(as,{className:"h-4 w-4 mr-2"}),"Nouveau Package Joueur"]})}),t.player.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:'Aucun package joueur. Cliquez sur "Nouveau Package Joueur" pour en crer un.'}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.player.map(k=>o.jsx(P,{pkg:k},k.id))})]}),o.jsxs(jr,{value:"club",className:"space-y-4",children:[o.jsx("div",{className:"flex justify-end mb-4",children:o.jsxs(ve,{onClick:()=>I(null,"club"),children:[o.jsx(as,{className:"h-4 w-4 mr-2"}),"Nouveau Package Club"]})}),t.club.length===0?o.jsx("div",{className:"text-center py-8 text-gray-500",children:'Aucun package club. Cliquez sur "Nouveau Package Club" pour en crer un.'}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.club.map(k=>o.jsx(P,{pkg:k},k.id))})]})]})})]}),o.jsx(Ir,{open:d,onOpenChange:u,children:o.jsxs(fr,{children:[o.jsx(Rr,{children:o.jsx(_r,{children:f?"Modifier le Package":"Nouveau Package"})}),o.jsxs("form",{onSubmit:A,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"credits",children:"Nombre de Crdits *"}),o.jsx(Ue,{id:"credits",type:"number",value:E.credits,onChange:k=>b({...E,credits:k.target.value}),placeholder:"Ex: 100",required:!0,min:"1"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"price_dt",children:"Prix en DT *"}),o.jsx(Ue,{id:"price_dt",type:"number",value:E.price_dt,onChange:k=>b({...E,price_dt:k.target.value}),placeholder:"Ex: 700",required:!0,min:"1"})]}),o.jsxs("div",{children:[o.jsx(Ce,{htmlFor:"description",children:"Description"}),o.jsx(Ue,{id:"description",value:E.description,onChange:k=>b({...E,description:k.target.value}),placeholder:"Ex: Pack populaire"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("input",{type:"checkbox",id:"is_popular",checked:E.is_popular,onChange:k=>b({...E,is_popular:k.target.checked}),className:"h-4 w-4"}),o.jsx(Ce,{htmlFor:"is_popular",className:"cursor-pointer",children:"Marquer comme populaire"})]}),o.jsxs(op,{children:[o.jsx(ve,{type:"button",variant:"outline",onClick:N,children:"Annuler"}),o.jsx(ve,{type:"submit",children:f?"Modifier":"Crer"})]})]})]})})]})}const Kie=()=>{const[t,e]=C.useState({library_id:"",api_key:"",hostname:"",cdn_hostname:""}),[r,n]=C.useState(!0),[s,i]=C.useState(!1),[a,l]=C.useState(!1),[d,u]=C.useState(""),[f,p]=C.useState("");C.useEffect(()=>{y()},[]);const y=async()=>{try{n(!0);const b=await yt.getBunnyCDNConfig();e(b.data)}catch{p("Erreur lors du chargement de la configuration")}finally{n(!1)}},v=async()=>{i(!0),p(""),u("");try{await yt.updateBunnyCDNConfig(t),u(" Configuration sauvegarde avec succs")}catch{p("Erreur lors de la sauvegarde")}finally{i(!1)}},E=async()=>{l(!0),p(""),u("");try{const b=await yt.testBunnyCDN(t);u(` Test russi ! ${b.data.message||"Connexion tablie"}`)}catch{p(" Test chou - Vrifiez vos identifiants")}finally{l(!1)}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold",children:"Configuration Systme"}),o.jsx("p",{className:"text-muted-foreground mt-1",children:"Grez les paramtres de configuration de la plateforme"})]}),o.jsxs(Nf,{defaultValue:"bunny-cdn",className:"w-full",children:[o.jsxs(id,{className:"grid w-full grid-cols-3",children:[o.jsxs(kr,{value:"bunny-cdn",children:[o.jsx(ob,{className:"h-4 w-4 mr-2"}),"Bunny CDN"]}),o.jsxs(kr,{value:"credit-packages",children:[o.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Prix des Crdits"]}),o.jsxs(kr,{value:"general",children:[o.jsx(oL,{className:"h-4 w-4 mr-2"}),"Gnral"]})]}),o.jsx(jr,{value:"bunny-cdn",children:o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Nu,{className:"h-5 w-5"}),o.jsx(bt,{children:"Configuration Bunny CDN"})]}),o.jsx(dn,{children:"Configurez les paramtres de connexion  Bunny CDN pour le stockage vido"})]}),o.jsx(ut,{children:r?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):o.jsxs("div",{className:"space-y-4",children:[d&&o.jsx(Xt,{children:o.jsx(Qt,{children:d})}),f&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:f})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Library ID"}),o.jsx(Ue,{value:t.library_id,onChange:b=>e(T=>({...T,library_id:b.target.value})),placeholder:"12345"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"API Key"}),o.jsx(Ue,{type:"password",value:t.api_key,onChange:b=>e(T=>({...T,api_key:b.target.value})),placeholder:"your-api-key-here"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Hostname"}),o.jsx(Ue,{value:t.hostname,onChange:b=>e(T=>({...T,hostname:b.target.value})),placeholder:"video.bunnycdn.com"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"CDN Hostname"}),o.jsx(Ue,{value:t.cdn_hostname,onChange:b=>e(T=>({...T,cdn_hostname:b.target.value})),placeholder:"vz-xxxxx.b-cdn.net"})]}),o.jsxs("div",{className:"flex space-x-2 pt-4",children:[o.jsxs(ve,{onClick:E,variant:"outline",disabled:a,children:[a&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),o.jsx(CB,{className:"h-4 w-4 mr-2"}),"Tester la connexion"]}),o.jsxs(ve,{onClick:v,disabled:s,children:[s&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),o.jsx(hb,{className:"h-4 w-4 mr-2"}),"Sauvegarder"]})]})]})})]})}),o.jsx(jr,{value:"credit-packages",children:o.jsx(Wie,{})}),o.jsx(jr,{value:"general",children:o.jsx(zie,{})})]})]})},Yie=()=>{const[t,e]=C.useState([]),[r,n]=C.useState(!0),[s,i]=C.useState("");C.useEffect(()=>{a()},[]);const a=async()=>{try{n(!0);const u=s?{level:s}:{},f=await yt.getLogs(u);e(f.data.logs||[])}catch(u){console.error("Error loading logs:",u)}finally{n(!1)}},l=async()=>{try{const u=await yt.downloadLogs(),f=window.URL.createObjectURL(new Blob([u.data])),p=document.createElement("a");p.href=f,p.setAttribute("download",`logs_${new Date().toISOString()}.txt`),document.body.appendChild(p),p.click(),p.remove()}catch{alert("Erreur lors du tlchargement des logs")}},d=u=>({ERROR:"text-red-600 bg-red-100",WARNING:"text-yellow-600 bg-yellow-100",INFO:"text-blue-600 bg-blue-100",DEBUG:"text-gray-600 bg-gray-100"})[u]||"text-gray-600 bg-gray-100";return o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Logs Systme"}),o.jsx(dn,{children:"Consultez et tlchargez les logs du systme"})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsxs(ve,{variant:"outline",onClick:a,children:[o.jsx(Wp,{className:"h-4 w-4 mr-2"}),"Filtrer"]}),o.jsxs(ve,{onClick:l,children:[o.jsx(Sh,{className:"h-4 w-4 mr-2"}),"Tlcharger"]})]})]})}),o.jsxs(ut,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsx(Ce,{children:"Niveau de log"}),o.jsx(Ue,{placeholder:"ERROR, WARNING, INFO, DEBUG...",value:s,onChange:u=>i(u.target.value),className:"max-w-xs"})]}),r?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):t.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(eL,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600",children:"Aucun log disponible"})]}):o.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:t.map((u,f)=>o.jsxs("div",{className:"p-3 border rounded text-sm",children:[o.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${d(u.level)}`,children:u.level}),o.jsx("span",{className:"text-gray-500 text-xs",children:u.timestamp})]}),o.jsx("p",{className:"text-gray-700",children:u.message})]},f))})]})]})},qie=()=>{const[t,e]=C.useState([]),[r,n]=C.useState(!1),[s,i]=C.useState("all"),[a,l]=C.useState(null),[d,u]=C.useState(""),[f,p]=C.useState(!1),[y,v]=C.useState("");C.useEffect(()=>{E()},[s]);const E=async()=>{try{n(!0);const A=s==="all"?{}:{status:s},L=await iu.getAllMessages(A);e(L.data.messages||[])}catch(A){console.error("Error loading messages:",A),v("Erreur lors du chargement des messages")}finally{n(!1)}},b=async(A,L)=>{var P,k;if(!d.trim()){v("Veuillez entrer une rponse");return}try{p(!0),v(""),await iu.updateMessage(A,{admin_response:d,status:L||"in_progress"}),u(""),l(null),E()}catch(D){v(((k=(P=D.response)==null?void 0:P.data)==null?void 0:k.error)||"Erreur lors de la mise  jour")}finally{p(!1)}},T=async(A,L)=>{try{await iu.updateMessage(A,{status:L}),E()}catch{v("Erreur lors de la mise  jour du statut")}},I=A=>{const L={pending:{color:"bg-yellow-100 text-yellow-800",icon:hs,label:"En attente"},in_progress:{color:"bg-blue-100 text-blue-800",icon:Ho,label:"En cours"},resolved:{color:"bg-green-100 text-green-800",icon:Eh,label:"Rsolu"},closed:{color:"bg-gray-100 text-gray-800",icon:Eh,label:"Ferm"}},P=L[A]||L.pending,k=P.icon;return o.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${P.color}`,children:[o.jsx(k,{className:"h-3 w-3"}),P.label]})},N=A=>{const L={low:"bg-gray-100 text-gray-700",medium:"bg-blue-100 text-blue-700",high:"bg-red-100 text-red-700"};return o.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${L[A]||L.medium}`,children:A==="low"?"Basse":A==="medium"?"Moyenne":"Haute"})};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestion du Support"}),o.jsx("p",{className:"text-gray-600 mt-1",children:"Grez les messages des utilisateurs"})]}),y&&o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:y})}),o.jsxs(ct,{children:[o.jsx(wt,{children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx(bt,{children:"Messages Support"}),o.jsxs(dn,{children:[t.length," message",t.length>1?"s":""]})]}),o.jsxs(Yl,{value:s,onValueChange:i,children:[o.jsx(Oo,{className:"w-40",children:o.jsx(ql,{})}),o.jsxs(Fo,{children:[o.jsx(Dr,{value:"all",children:"Tous"}),o.jsx(Dr,{value:"pending",children:"En attente"}),o.jsx(Dr,{value:"in_progress",children:"En cours"}),o.jsx(Dr,{value:"resolved",children:"Rsolus"}),o.jsx(Dr,{value:"closed",children:"Ferms"})]})]})]})}),o.jsx(ut,{children:r?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin text-gray-400"})}):t.length===0?o.jsxs("div",{className:"text-center py-8 text-gray-500",children:[o.jsx($l,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),o.jsx("p",{children:"Aucun message"})]}):o.jsx("div",{className:"space-y-4",children:t.map(A=>o.jsxs("div",{className:"border rounded-lg p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsx("h3",{className:"font-semibold text-gray-900",children:A.subject}),N(A.priority)]}),o.jsxs("p",{className:"text-sm text-gray-600",children:["De: ",A.user_name," (",A.user_email,")"]}),o.jsx("p",{className:"text-xs text-gray-500",children:new Date(A.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),o.jsx("div",{className:"flex items-center gap-2",children:I(A.status)})]}),o.jsx("p",{className:"text-gray-700 mb-3 whitespace-pre-wrap bg-gray-50 p-3 rounded",children:A.message}),A.images&&A.images.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(lb,{className:"h-4 w-4 text-gray-500"}),o.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Images jointes (",A.images.length,")"]})]}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:A.images.map((L,P)=>o.jsx("a",{href:Lu(L),target:"_blank",rel:"noopener noreferrer",className:"block aspect-square rounded-lg overflow-hidden border border-gray-200 hover:border-blue-500 transition-colors",children:o.jsx("img",{src:Lu(L),alt:`Image ${P+1}`,className:"w-full h-full object-cover"})},P))})]}),A.admin_response?o.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-3 mb-3",children:[o.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Votre rponse :"}),o.jsx("p",{className:"text-sm text-blue-800 whitespace-pre-wrap",children:A.admin_response})]}):a===A.id?o.jsxs("div",{className:"space-y-3 mt-3 bg-blue-50 p-4 rounded",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h4",{className:"font-medium",children:"Rpondre"}),o.jsx("button",{onClick:()=>l(null),children:o.jsx(tc,{className:"h-4 w-4"})})]}),o.jsx(qo,{value:d,onChange:L=>u(L.target.value),placeholder:"Votre rponse...",rows:4}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(ve,{onClick:()=>b(A.id,"resolved"),disabled:f,size:"sm",children:f?o.jsx(ft,{className:"h-4 w-4 animate-spin"}):"Rpondre et rsoudre"}),o.jsx(ve,{onClick:()=>b(A.id,"in_progress"),disabled:f,variant:"outline",size:"sm",children:"Rpondre (en cours)"})]})]}):o.jsxs("div",{className:"flex gap-2 mt-3",children:[o.jsx(ve,{onClick:()=>l(A.id),size:"sm",variant:"outline",children:"Rpondre"}),A.status!=="resolved"&&o.jsx(ve,{onClick:()=>T(A.id,"resolved"),size:"sm",variant:"outline",children:"Marquer rsolu"}),A.status!=="closed"&&o.jsx(ve,{onClick:()=>T(A.id,"closed"),size:"sm",variant:"ghost",children:"Fermer"})]})]},A.id))})})]})]})},Xie=()=>{var k,D,O,F,$,G,Y,ne;const[t,e]=C.useState(null),[r,n]=C.useState(null),[s,i]=C.useState(null),[a,l]=C.useState([]),[d,u]=C.useState(null),[f,p]=C.useState(!0),[y,v]=C.useState("");C.useEffect(()=>{E();const X=setInterval(()=>{b()},3e4);return()=>clearInterval(X)},[]);const E=async()=>{try{p(!0),await Promise.all([b(),T(),I(),N(),A()])}catch(X){v("Erreur lors du chargement des analytics"),console.error("Analytics error:",X)}finally{p(!1)}},b=async()=>{try{const X=await Ic.getSystemHealth();e(X.data)}catch(X){console.error("System health error:",X)}},T=async()=>{try{const X=await Ic.getPlatformOverview();n(X.data)}catch(X){console.error("Platform overview error:",X)}},I=async()=>{try{const X=await Ic.getUserEngagement();i(X.data)}catch(X){console.error("User engagement error:",X)}},N=async()=>{try{const X=await Ic.getTopClubs(10);l(X.data.clubs||[])}catch(X){console.error("Top clubs error:",X)}},A=async()=>{try{const X=await Ic.getFinancialOverview();u(X.data)}catch(X){console.error("Financial overview error:",X)}},L=(X,z)=>X<z.good?"text-green-600":X<z.warning?"text-yellow-600":"text-red-600",P=X=>X>0?o.jsxs("span",{className:"inline-flex items-center gap-1 text-sm text-green-600",children:[o.jsx(O0,{className:"h-4 w-4"}),"+",X.toFixed(1),"%"]}):X<0?o.jsxs("span",{className:"inline-flex items-center gap-1 text-sm text-red-600",children:[o.jsx(AB,{className:"h-4 w-4"}),X.toFixed(1),"%"]}):o.jsx("span",{className:"text-sm text-gray-500",children:"0%"});return f?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):y?o.jsx(Xt,{variant:"destructive",children:o.jsx(Qt,{children:y})}):o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"tat du Systme"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Temps de Rponse API"}),o.jsx(nb,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:`text-2xl font-bold ${t?L(t.api_response_time_ms||0,{good:100,warning:500}):""}`,children:[((k=t==null?void 0:t.api_response_time_ms)==null?void 0:k.toFixed(0))||"0","ms"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:(t==null?void 0:t.api_response_time_ms)<100?"Excellent":(t==null?void 0:t.api_response_time_ms)<500?"Bon":"Lent"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Performance BDD"}),o.jsx(dB,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:`text-2xl font-bold ${t?L(t.db_performance_ms||0,{good:50,warning:200}):""}`,children:[((D=t==null?void 0:t.db_performance_ms)==null?void 0:D.toFixed(0))||"0","ms"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requtes database"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Disponibilit Serveur"}),o.jsx(oL,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[((O=t==null?void 0:t.server_uptime_percentage)==null?void 0:O.toFixed(1))||"99.9","%"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Uptime"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Taux d'Erreurs"}),o.jsx(uL,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:`text-2xl font-bold ${t?L(t.error_rate_percentage||0,{good:1,warning:5}):""}`,children:[((F=t==null?void 0:t.error_rate_percentage)==null?void 0:F.toFixed(1))||"0","%"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Erreurs systme"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Vue d'Ensemble de la Plateforme"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Utilisateurs"}),o.jsx(ru,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.total_users)||0}),o.jsx("div",{className:"mt-1",children:P((r==null?void 0:r.user_growth_percentage)||0)})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Clubs"}),o.jsx(Bl,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(r==null?void 0:r.total_clubs)||0}),o.jsx("div",{className:"mt-1",children:P((r==null?void 0:r.club_growth_percentage)||0)})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Revenus Mensuels"}),o.jsx(Lx,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:"text-2xl font-bold",children:[(($=r==null?void 0:r.monthly_revenue_euros)==null?void 0:$.toFixed(2))||"0.00"," DTN"]}),o.jsx("div",{className:"mt-1",children:P((r==null?void 0:r.revenue_growth_percentage)||0)})]})]})]})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Engagement des Utilisateurs"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Utilisateurs Actifs (Aujourd'hui)"}),o.jsx(ru,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.daily_active_users)||0}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"DAU"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Sessions d'Enregistrement"}),o.jsx(Ps,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.recording_sessions_today)||0}),o.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(s==null?void 0:s.recording_sessions_this_week)||0," cette semaine"]})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Rservations Terrains"}),o.jsx(yr,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.court_bookings_today)||0}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Aujourd'hui"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Vues Vidos"}),o.jsx(Th,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(s==null?void 0:s.total_video_views)||0}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total"})]})]})]})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Top 10 Clubs Performants"}),o.jsx(ct,{children:o.jsx(ut,{className:"pt-6",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"w-full",children:[o.jsx("thead",{children:o.jsxs("tr",{className:"border-b",children:[o.jsx("th",{className:"text-left py-3 px-4 font-medium",children:"Club"}),o.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Vidos"}),o.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Revenus"}),o.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Utilisateurs Actifs"}),o.jsx("th",{className:"text-right py-3 px-4 font-medium",children:"Score d'Engagement"})]})}),o.jsx("tbody",{children:a.length>0?a.map((X,z)=>o.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[o.jsx("td",{className:"py-3 px-4",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"font-medium text-gray-500 w-6",children:["#",z+1]}),o.jsx("span",{children:X.club_name})]})}),o.jsx("td",{className:"text-right py-3 px-4",children:X.total_videos}),o.jsxs("td",{className:"text-right py-3 px-4 font-medium text-green-600",children:[X.total_revenue_euros.toFixed(2)," DTN"]}),o.jsx("td",{className:"text-right py-3 px-4",children:X.active_users}),o.jsx("td",{className:"text-right py-3 px-4",children:o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:X.engagement_score.toFixed(1)})})]},X.club_id)):o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"text-center py-8 text-gray-500",children:"Aucun club trouv"})})})]})})})})]}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Vue Financire"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Revenus (Ce Mois)"}),o.jsx(Lx,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[((G=d==null?void 0:d.total_revenue_euros)==null?void 0:G.toFixed(2))||"0.00"," DTN"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:(d==null?void 0:d.month)||"Ce mois"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Commission Gagne"}),o.jsx(O0,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:"text-2xl font-bold",children:[((Y=d==null?void 0:d.commission_earned_euros)==null?void 0:Y.toFixed(2))||"0.00"," DTN"]}),o.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(d==null?void 0:d.commission_rate_percentage)||20,"% de commission"]})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Abonnements Actifs"}),o.jsx(ru,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:(d==null?void 0:d.active_subscriptions)||0}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Utilisateurs avec crdits"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Paiements en Attente"}),o.jsx(Lx,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsxs("div",{className:"text-2xl font-bold",children:[((ne=d==null?void 0:d.pending_payouts_euros)==null?void 0:ne.toFixed(2))||"0.00"," DTN"]}),o.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:" traiter"})]})]})]})]})]})},Qie=()=>{const{logout:t}=ps(),[e,r]=C.useState({totalRealUsers:0,totalClubs:0,totalVideos:0,totalCredits:0}),[n,s]=C.useState(!0),[i,a]=C.useState(""),[l,d]=C.useState(!1),[u,f]=C.useState("overview"),[p,y]=C.useState(!1);C.useEffect(()=>{v()},[]);const v=async()=>{try{s(!0);const[b,T,I]=await Promise.all([yt.getAllUsers(),yt.getAllClubs(),yt.getAllVideos()]),N=b.data.users||[],A=T.data.clubs||[],L=I.data.videos||[],P=N.filter(D=>D.role!=="club"),k=N.reduce((D,O)=>D+(O.credits_balance||0),0);r({totalRealUsers:P.length,totalClubs:A.length,totalVideos:L.length,totalCredits:k})}catch(b){a("Erreur lors du chargement des statistiques"),console.error("Error loading stats:",b)}finally{s(!1)}},E=async()=>{await t(),window.location.href="/auth"};return o.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[o.jsx("nav",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 sticky top-0 z-50",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"flex items-center justify-between h-16",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(Gu,{className:"h-8 w-8 text-blue-600"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"MySmash"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Administration"})]})]}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx(ve,{variant:"outline",size:"icon",onClick:()=>y(!p),className:"rounded-full",children:p?o.jsx(qp,{className:"h-5 w-5"}):o.jsx(Kp,{className:"h-5 w-5"})}),o.jsxs(ic,{children:[o.jsx(ac,{asChild:!0,children:o.jsx(ve,{variant:"ghost",size:"icon",className:"rounded-full bg-blue-600 hover:bg-blue-700 text-white",children:o.jsx(Nn,{className:"h-5 w-5"})})}),o.jsxs(Qo,{align:"end",className:"w-56",children:[o.jsx(s4,{children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsx("p",{className:"text-sm font-medium",children:"Super Admin"}),o.jsx("p",{className:"text-xs text-gray-500",children:"admin@mysmash.com"})]})}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:()=>d(!0),children:[o.jsx(Nn,{className:"mr-2 h-4 w-4"}),"Mon Profil"]}),o.jsxs(kt,{onClick:()=>f("configuration"),children:[o.jsx(Nu,{className:"mr-2 h-4 w-4"}),"Paramtres"]}),o.jsx(Xi,{}),o.jsxs(kt,{onClick:E,className:"text-red-600",children:[o.jsx(cb,{className:"mr-2 h-4 w-4"}),"Dconnexion"]})]})]})]})]})})}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Tableau de bord administrateur"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Grez les utilisateurs, clubs et vidos de la plateforme"})]}),n?o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):i?o.jsx(Xt,{variant:"destructive",className:"mb-8",children:o.jsx(Qt,{children:i})}):o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Total Utilisateurs"}),o.jsx(ru,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:e.totalRealUsers}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Joueurs et admins"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Total Clubs"}),o.jsx(Bl,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:e.totalClubs}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Clubs enregistrs"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Total Vidos"}),o.jsx(yr,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:e.totalVideos}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Matchs enregistrs"})]})]}),o.jsxs(ct,{children:[o.jsxs(wt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(bt,{className:"text-sm font-medium",children:"Crdits Distribus"}),o.jsx(O0,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(ut,{children:[o.jsx("div",{className:"text-2xl font-bold",children:e.totalCredits}),o.jsx("p",{className:"text-xs text-muted-foreground",children:"Crdits en circulation"})]})]})]}),o.jsxs(Nf,{value:u,onValueChange:f,className:"w-full",children:[o.jsxs(id,{className:"grid w-full grid-cols-8",children:[o.jsx(kr,{value:"overview",children:"Vue d'Ensemble"}),o.jsx(kr,{value:"users",children:"Utilisateurs"}),o.jsx(kr,{value:"clubs",children:"Clubs"}),o.jsx(kr,{value:"videos",children:"Vidos"}),o.jsx(kr,{value:"history",children:o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx(jy,{className:"h-4 w-4"}),"Historique"]})}),o.jsx(kr,{value:"configuration",children:o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx(Nu,{className:"h-4 w-4"}),"Configuration"]})}),o.jsx(kr,{value:"logs",children:o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx(eL,{className:"h-4 w-4"}),"Logs"]})}),o.jsx(kr,{value:"support",children:o.jsxs("span",{className:"inline-flex items-center gap-1",children:[o.jsx($l,{className:"h-4 w-4"}),"Support"]})})]}),o.jsx(jr,{value:"overview",className:"mt-6",children:o.jsx(Xie,{})}),o.jsx(jr,{value:"users",className:"mt-6",children:o.jsx(Bie,{onStatsUpdate:v})}),o.jsx(jr,{value:"clubs",className:"mt-6",children:o.jsx(Vie,{onStatsUpdate:v})}),o.jsx(jr,{value:"videos",className:"mt-6",children:o.jsx(Gie,{onStatsUpdate:v})}),o.jsx(jr,{value:"history",className:"mt-6",children:o.jsx(Hie,{})}),o.jsx(jr,{value:"configuration",className:"mt-6",children:o.jsx(Kie,{})}),o.jsx(jr,{value:"logs",className:"mt-6",children:o.jsx(Yie,{})}),o.jsx(jr,{value:"support",className:"mt-6",children:o.jsx(qie,{})})]})]})]})},Zie=()=>o.jsx(Qie,{}),Jie=({players:t,videos:e,onPlayersUpdated:r})=>{const[n,s]=C.useState(!1),[i,a]=C.useState(null),[l,d]=C.useState(0),[u,f]=C.useState(null),[p,y]=C.useState(null),v=C.useMemo(()=>t.map(A=>{const L=e.filter(P=>P.user_id===A.id).length;return{...A,video_count:L}}),[t,e]),E=C.useMemo(()=>!u||!p?v:[...v].sort((A,L)=>{let P,k;return u==="name"?(P=A.name.toLowerCase(),k=L.name.toLowerCase()):u==="videos"&&(P=A.video_count||0,k=L.video_count||0),P<k?p==="asc"?-1:1:P>k?p==="asc"?1:-1:0}),[v,u,p]),b=A=>{u===A?p==="asc"?y("desc"):p==="desc"&&(y(null),f(null)):(f(A),y("asc"))},T=A=>u!==A?o.jsx(af,{className:"h-4 w-4 ml-1"}):p==="asc"?o.jsx(of,{className:"h-4 w-4 ml-1"}):o.jsx(sf,{className:"h-4 w-4 ml-1"}),I=async()=>{if(!(!i||l<=0))try{await ra.addCreditsToPlayer(i.id,l),s(!1),d(0),r&&r()}catch(A){console.error("Error adding credits:",A)}},N=A=>{a(A),d(0),s(!0)};return o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Joueurs du Club"}),o.jsxs(dn,{children:[E.length," joueur(s) inscrit(s)"]})]}),o.jsxs(ut,{children:[E.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(Nn,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Aucun joueur inscrit"})]}):o.jsxs(oc,{children:[o.jsx(lc,{children:o.jsxs(Ds,{children:[o.jsx(It,{children:o.jsxs("button",{className:"flex items-center hover:text-gray-900 dark:hover:text-gray-100",onClick:()=>b("name"),children:["Nom",T("name")]})}),o.jsx(It,{children:"ID"}),o.jsx(It,{children:o.jsxs("button",{className:"flex items-center hover:text-gray-900 dark:hover:text-gray-100",onClick:()=>b("videos"),children:["Vidos",T("videos")]})}),o.jsx(It,{children:"Actions"})]})}),o.jsx(cc,{children:E.map(A=>o.jsxs(Ds,{children:[o.jsx(Rt,{className:"font-medium",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-blue-500"}),o.jsx("span",{children:A.name})]})}),o.jsxs(Rt,{className:"text-sm text-gray-600 dark:text-gray-400",children:["#",A.id]}),o.jsx(Rt,{children:A.video_count||0}),o.jsx(Rt,{children:o.jsxs(ve,{variant:"outline",size:"sm",onClick:()=>N(A),children:[o.jsx(as,{className:"h-4 w-4 mr-2"}),"Offrir crdits"]})})]},A.id))})]}),o.jsx(Ir,{open:n,onOpenChange:s,children:o.jsxs(fr,{children:[o.jsx(Rr,{children:o.jsx(_r,{children:"Offrir des Crdits"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Joueur: ",o.jsx("span",{className:"font-medium",children:i==null?void 0:i.name})]}),o.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Solde actuel: ",o.jsxs("span",{className:"font-medium",children:[(i==null?void 0:i.credits_balance)||0," crdits"]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Nombre de crdits  offrir"}),o.jsx(Ue,{type:"number",min:"1",value:l,onChange:A=>d(parseInt(A.target.value)||0)})]}),o.jsxs("div",{className:"flex justify-end space-x-2",children:[o.jsx(ve,{variant:"outline",onClick:()=>s(!1),children:"Annuler"}),o.jsxs(ve,{onClick:I,disabled:l<=0,children:[o.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Offrir ",l," crdit",l>1?"s":""]})]})]})]})})]})]})},eae=({courts:t,onCourtUpdated:e})=>{const[r,n]=C.useState(""),[s,i]=C.useState(!1),a=async l=>{var d,u;try{n(""),i(!0),await ra.stopRecording(l),e&&e()}catch(f){n(((u=(d=f.response)==null?void 0:d.data)==null?void 0:u.error)||"Erreur lors de l'arrt de l'enregistrement")}finally{i(!1)}};return o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Terrains du Club"}),o.jsxs(dn,{children:[t.length," terrain(x) configur(s)"]})]}),o.jsxs(ut,{children:[r&&o.jsx(Xt,{variant:"destructive",className:"mb-4",children:o.jsx(Qt,{children:r})}),t.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(bh,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Aucun terrain configur"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>o.jsxs(ct,{className:`border-l-4 ${l.is_occupied?"border-l-red-500":"border-l-green-500"}`,children:[o.jsx(wt,{className:"pb-3",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx(bt,{className:"text-lg",children:l.name}),o.jsxs(Hr,{variant:l.is_occupied?"destructive":"secondary",className:"flex items-center gap-1",children:[o.jsx(ab,{className:`h-3 w-3 ${l.is_occupied?"fill-current animate-pulse":""}`}),l.is_occupied?"Occup":"Libre"]})]})}),o.jsxs(ut,{className:"space-y-3",children:[l.is_occupied&&(l.recording_player||l.current_player)&&o.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-3 rounded-lg border border-red-200 dark:border-red-800",children:[o.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-900 dark:text-red-100 mb-1",children:[o.jsx(Nn,{className:"h-4 w-4"}),o.jsx("span",{className:"font-medium",children:l.recording_player||l.current_player})]}),l.recording_remaining&&o.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-700 dark:text-red-300",children:[o.jsx(hs,{className:"h-4 w-4"}),o.jsxs("span",{children:[l.recording_remaining,"min restant"]})]})]}),l.qr_code&&o.jsxs("div",{className:"text-sm",children:[o.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"QR Code:"})," ",o.jsx("span",{className:"font-mono text-xs font-medium",children:l.qr_code})]}),o.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[o.jsx(bh,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-gray-600 dark:text-gray-400 text-xs truncate",children:l.camera_url||"Non configur"})]}),l.is_occupied&&o.jsxs(ve,{variant:"destructive",size:"sm",className:"w-full",onClick:()=>a(l.id),disabled:s,children:[o.jsx(J_,{className:"h-4 w-4 mr-2"}),"Arrter l'Enregistrement"]})]})]},l.id))})]})]})},tae=({videos:t})=>{const[e,r]=C.useState(null),[n,s]=C.useState(null),i=f=>new Date(f).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),a=f=>{if(!f)return"N/A";const p=Math.floor(f/60),y=f%60;return`${p}:${y.toString().padStart(2,"0")}`},l=C.useMemo(()=>!e||!n?t:[...t].sort((f,p)=>{let y,v;return e==="title"?(y=(f.title||"Sans titre").toLowerCase(),v=(p.title||"Sans titre").toLowerCase()):e==="player"?(y=f.player_name.toLowerCase(),v=p.player_name.toLowerCase()):e==="date"?(y=new Date(f.recorded_at).getTime(),v=new Date(p.recorded_at).getTime()):e==="duration"&&(y=f.duration||0,v=p.duration||0),y<v?n==="asc"?-1:1:y>v?n==="asc"?1:-1:0}),[t,e,n]),d=f=>{e===f?n==="asc"?s("desc"):n==="desc"&&(s(null),r(null)):(r(f),s("asc"))},u=f=>e!==f?o.jsx(af,{className:"h-4 w-4 ml-1"}):n==="asc"?o.jsx(of,{className:"h-4 w-4 ml-1"}):o.jsx(sf,{className:"h-4 w-4 ml-1"});return o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsx(bt,{children:"Vidos du Club"}),o.jsxs(dn,{children:[l.length," vido(s) enregistre(s)"]})]}),o.jsx(ut,{children:l.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(yr,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Aucune vido enregistre"})]}):o.jsxs(oc,{children:[o.jsx(lc,{children:o.jsxs(Ds,{children:[o.jsx(It,{children:o.jsxs("button",{className:"flex items-center hover:text-gray-900 dark:hover:text-gray-100",onClick:()=>d("title"),children:["Titre",u("title")]})}),o.jsx(It,{children:o.jsxs("button",{className:"flex items-center hover:text-gray-900 dark:hover:text-gray-100",onClick:()=>d("player"),children:["Joueur",u("player")]})}),o.jsx(It,{children:"Terrain"}),o.jsx(It,{children:o.jsxs("button",{className:"flex items-center hover:text-gray-900 dark:hover:text-gray-100",onClick:()=>d("date"),children:["Date",u("date")]})}),o.jsx(It,{children:o.jsxs("button",{className:"flex items-center hover:text-gray-900 dark:hover:text-gray-100",onClick:()=>d("duration"),children:["Dure",u("duration")]})})]})}),o.jsx(cc,{children:l.map(f=>o.jsxs(Ds,{children:[o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(yr,{className:"h-4 w-4 text-purple-500"}),o.jsx("span",{className:"font-medium",children:f.title||"Sans titre"})]})}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-blue-500"}),o.jsx("span",{children:f.player_name})]})}),o.jsx(Rt,{children:f.court_name||"-"}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Hp,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm",children:i(f.recorded_at)})]})}),o.jsx(Rt,{children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(hs,{className:"h-4 w-4 text-gray-400"}),o.jsx("span",{className:"text-sm",children:a(f.duration)})]})})]},f.id))})]})})]})},rae=()=>{const[t,e]=C.useState([]),[r,n]=C.useState(!0);C.useEffect(()=>{s()},[]);const s=async()=>{try{n(!0);const u=((await ra.getClubHistory()).data.history||[]).filter(f=>f.action_type==="add_credits");e(u)}catch(l){console.error("Error loading history:",l)}finally{n(!1)}},i=l=>{const d=l.endsWith("Z")?l:l+"Z";return new Date(d).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})},a=(l,d)=>{try{const u=JSON.parse(d);if(l==="receive_credits_from_admin"){const f=u.credits_added||u.credits||0;return{text:`+${f} crdits reus`,color:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",amount:f}}if(l==="add_credits"){const f=u.credits_added||u.credits||0;return{text:`+${f} crdits offerts`,color:"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400",amount:f}}if(l==="buy_credits"){const f=u.credits_bought||u.credits||0;return{text:`+${f} crdits achets`,color:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-400",amount:f}}if(l==="add_player")return{text:"Joueur ajout",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-400",amount:null};if(l==="update_player")return{text:"Infos modifies",color:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",amount:null};if(l==="follow_club")return{text:"Suivi activ",color:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/20 dark:text-indigo-400",amount:null};if(l==="unfollow_club")return{text:"Suivi dsactiv",color:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",amount:null};if(l==="stop_recording")return{text:"Enregistrement arrt",color:"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400",amount:null}}catch{}return{text:l.replace(/_/g," "),color:"bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-400",amount:null}};return o.jsxs(ct,{children:[o.jsxs(wt,{children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Hp,{className:"h-5 w-5"}),o.jsx(bt,{children:"Historique des Crdits"})]}),o.jsx(dn,{children:"Historique des crdits offerts aux joueurs du club"})]}),o.jsx(ut,{children:r?o.jsx("div",{className:"flex items-center justify-center py-8",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})}):t.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(rL,{className:"h-12 w-12 text-gray-400 dark:text-gray-600 mx-auto mb-4"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Aucun historique de crdits"})]}):o.jsxs(oc,{children:[o.jsx(lc,{children:o.jsxs(Ds,{children:[o.jsx(It,{children:"Joueur"}),o.jsx(It,{children:"Action"}),o.jsx(It,{children:"Crdits"}),o.jsx(It,{children:"Date"})]})}),o.jsx(cc,{children:t.map(l=>{const d=a(l.action_type,l.action_details);return o.jsxs(Ds,{children:[o.jsx(Rt,{className:"font-medium",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Nn,{className:"h-4 w-4 text-blue-500"}),o.jsx("span",{children:l.player_name})]})}),o.jsx(Rt,{children:o.jsx("span",{className:`text-sm px-2 py-1 rounded ${d.color}`,children:d.text})}),o.jsx(Rt,{children:d.amount!==null&&o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Cn,{className:"h-4 w-4 text-amber-500"}),o.jsx("span",{className:"font-medium",children:d.amount})]})}),o.jsx(Rt,{className:"text-sm text-gray-600 dark:text-gray-400",children:i(l.performed_at)})]},l.id)})})]})})]})},Pm=({icon:t,title:e,value:r,subtitle:n,iconBgColor:s="bg-blue-100",iconColor:i="text-blue-600"})=>o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-5 border border-gray-200 dark:border-gray-700 shadow-sm hover:shadow-md transition-all",children:o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400 mb-1",children:e}),o.jsx("p",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:r}),n&&o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:n})]}),o.jsx("div",{className:`p-3 rounded-lg ${s}`,children:o.jsx(t,{className:`h-6 w-6 ${i}`})})]})});var m2="Radio",[nae,WO]=hn(m2),[sae,iae]=nae(m2),KO=C.forwardRef((t,e)=>{const{__scopeRadio:r,name:n,checked:s=!1,required:i,disabled:a,value:l="on",onCheck:d,form:u,...f}=t,[p,y]=C.useState(null),v=st(e,T=>y(T)),E=C.useRef(!1),b=p?u||!!p.closest("form"):!0;return o.jsxs(sae,{scope:r,checked:s,disabled:a,children:[o.jsx(He.button,{type:"button",role:"radio","aria-checked":s,"data-state":QO(s),"data-disabled":a?"":void 0,disabled:a,value:l,...f,ref:v,onClick:Re(t.onClick,T=>{s||d==null||d(),b&&(E.current=T.isPropagationStopped(),E.current||T.stopPropagation())})}),b&&o.jsx(XO,{control:p,bubbles:!E.current,name:n,value:l,checked:s,required:i,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});KO.displayName=m2;var YO="RadioIndicator",qO=C.forwardRef((t,e)=>{const{__scopeRadio:r,forceMount:n,...s}=t,i=iae(YO,r);return o.jsx(fn,{present:n||i.checked,children:o.jsx(He.span,{"data-state":QO(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e})})});qO.displayName=YO;var aae="RadioBubbleInput",XO=C.forwardRef(({__scopeRadio:t,control:e,checked:r,bubbles:n=!0,...s},i)=>{const a=C.useRef(null),l=st(a,i),d=Ig(r),u=Jp(e);return C.useEffect(()=>{const f=a.current;if(!f)return;const p=window.HTMLInputElement.prototype,v=Object.getOwnPropertyDescriptor(p,"checked").set;if(d!==r&&v){const E=new Event("click",{bubbles:n});v.call(f,r),f.dispatchEvent(E)}},[d,r,n]),o.jsx(He.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});XO.displayName=aae;function QO(t){return t?"checked":"unchecked"}var oae=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Fg="RadioGroup",[lae,Gae]=hn(Fg,[td,WO]),ZO=td(),JO=WO(),[cae,uae]=lae(Fg),e8=C.forwardRef((t,e)=>{const{__scopeRadioGroup:r,name:n,defaultValue:s,value:i,required:a=!1,disabled:l=!1,orientation:d,dir:u,loop:f=!0,onValueChange:p,...y}=t,v=ZO(r),E=rc(u),[b,T]=Ai({prop:i,defaultProp:s??null,onChange:p,caller:Fg});return o.jsx(cae,{scope:r,name:n,required:a,disabled:l,value:b,onValueChange:T,children:o.jsx(EE,{asChild:!0,...v,orientation:d,dir:E,loop:f,children:o.jsx(He.div,{role:"radiogroup","aria-required":a,"aria-orientation":d,"data-disabled":l?"":void 0,dir:E,...y,ref:e})})})});e8.displayName=Fg;var t8="RadioGroupItem",r8=C.forwardRef((t,e)=>{const{__scopeRadioGroup:r,disabled:n,...s}=t,i=uae(t8,r),a=i.disabled||n,l=ZO(r),d=JO(r),u=C.useRef(null),f=st(e,u),p=i.value===s.value,y=C.useRef(!1);return C.useEffect(()=>{const v=b=>{oae.includes(b.key)&&(y.current=!0)},E=()=>y.current=!1;return document.addEventListener("keydown",v),document.addEventListener("keyup",E),()=>{document.removeEventListener("keydown",v),document.removeEventListener("keyup",E)}},[]),o.jsx(SE,{asChild:!0,...l,focusable:!a,active:p,children:o.jsx(KO,{disabled:a,required:i.required,checked:p,...d,...s,name:i.name,ref:f,onCheck:()=>i.onValueChange(s.value),onKeyDown:Re(v=>{v.key==="Enter"&&v.preventDefault()}),onFocus:Re(s.onFocus,()=>{var v;y.current&&((v=u.current)==null||v.click())})})})});r8.displayName=t8;var dae="RadioGroupIndicator",n8=C.forwardRef((t,e)=>{const{__scopeRadioGroup:r,...n}=t,s=JO(r);return o.jsx(qO,{...s,...n,ref:e})});n8.displayName=dae;var s8=e8,i8=r8,hae=n8;const tw=C.forwardRef(({className:t,...e},r)=>o.jsx(s8,{className:Ye("grid gap-2",t),...e,ref:r}));tw.displayName=s8.displayName;const rw=C.forwardRef(({className:t,...e},r)=>o.jsx(i8,{ref:r,className:Ye("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...e,children:o.jsx(hae,{className:"flex items-center justify-center",children:o.jsx(ab,{className:"h-2.5 w-2.5 fill-current text-current"})})}));rw.displayName=i8.displayName;const fae=({open:t,onClose:e,onSuccess:r,club:n})=>{var k,D;const[s,i]=C.useState("pack_500"),[a,l]=C.useState("konnect"),[d,u]=C.useState([]),[f,p]=C.useState([]),[y,v]=C.useState(!1),[E,b]=C.useState(""),[T,I]=C.useState("");C.useEffect(()=>{t&&N()},[t]);const N=async()=>{try{const[O,F]=await Promise.all([ra.getCreditPackages(),ra.getPaymentMethods()]);u(O.data.packages||[]),p(F.data.payment_methods||[]),l(F.data.default_method||"konnect")}catch(O){console.error("Erreur chargement packages/paiements:",O),b("Erreur lors du chargement des donnes")}},A=()=>d.find(O=>O.id===s),L=O=>{switch(O.id){case"konnect":return o.jsx(cL,{className:"h-4 w-4"});case"flouci":return o.jsx(My,{className:"h-4 w-4"});case"carte_bancaire":return o.jsx(Ul,{className:"h-4 w-4"});default:return o.jsx(cf,{className:"h-4 w-4"})}},P=async()=>{var F,$;const O=A();if(!O){b("Veuillez slectionner un package");return}v(!0),b(""),I("");try{await ra.buyCredits({credits_amount:O.credits,payment_method:a,package_type:O.type,package_id:O.id}),I(`${O.credits} crdits achets avec succs pour ${O.price_dt} DT !`),r&&r(),setTimeout(e,2e3)}catch(G){b((($=(F=G.response)==null?void 0:F.data)==null?void 0:$.error)||"Erreur lors de l'achat")}finally{v(!1)}};return o.jsx(Ir,{open:t,onOpenChange:e,children:o.jsxs(fr,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto rounded-2xl",children:[o.jsxs(Rr,{children:[o.jsxs(_r,{className:"flex items-center text-xl font-semibold",children:[o.jsx(Cn,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Acheter des Crdits pour le Club"]}),o.jsx(bn,{className:"text-gray-600",children:"Rechargez le solde de votre club pour offrir des crdits  vos joueurs. Paiement scuris en Dinars Tunisiens (DT)."})]}),o.jsxs("div",{className:"space-y-6",children:[E&&o.jsx(Xt,{variant:"destructive",className:"rounded-xl",children:o.jsx(Qt,{children:E})}),T&&o.jsxs(Xt,{className:"bg-green-50 text-green-800 border-green-200 rounded-xl",children:[o.jsx(Ts,{className:"h-4 w-4"}),o.jsx(Qt,{children:T})]}),o.jsx("div",{className:"bg-gradient-to-br from-yellow-50 to-white dark:from-yellow-900/20 dark:to-transparent border-2 border-yellow-200 dark:border-yellow-800 rounded-xl p-4",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Solde actuel du club:"}),o.jsxs("span",{className:"font-bold text-xl flex items-center text-yellow-900 dark:text-yellow-100",children:[o.jsx(Cn,{className:"h-5 w-5 mr-1.5 text-yellow-500"}),(n==null?void 0:n.credits_balance)||0," crdits"]})]})}),o.jsxs("div",{children:[o.jsx(Ce,{className:"text-base font-semibold mb-3 block text-gray-900 dark:text-gray-100",children:"Choisissez votre package"}),o.jsx(tw,{value:s,onValueChange:i,className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:d.map(O=>o.jsx("div",{className:`rounded-xl p-4 cursor-pointer transition-all hover:shadow-lg border-2 ${s===O.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600"}`,onClick:()=>i(O.id),children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx(rw,{value:O.id,id:O.id,className:"mt-1 flex-shrink-0"}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-start justify-between gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"font-semibold text-base mb-1 flex items-center gap-2 flex-wrap",children:[O.credits," crdits",O.popular&&o.jsx(Hr,{className:"bg-blue-500 rounded-full px-2 text-xs",children:"Populaire"}),O.badge&&o.jsx(Hr,{variant:"outline",className:"text-green-600 rounded-full text-xs",children:O.badge})]}),o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:O.description})]}),o.jsxs("div",{className:"text-right flex-shrink-0 min-w-[100px]",children:[o.jsxs("div",{className:"font-bold text-xl text-gray-900 dark:text-gray-100 whitespace-nowrap",children:[O.price_dt," DT"]}),O.original_price_dt&&o.jsxs("div",{className:"text-xs text-gray-400 line-through whitespace-nowrap",children:[O.original_price_dt," DT"]}),O.savings_dt>0&&o.jsxs("div",{className:"text-xs text-green-600 font-medium mt-1 whitespace-nowrap",children:["conomie: ",O.savings_dt," DT"]})]})]})})]})},O.id))})]}),o.jsxs("div",{children:[o.jsx(Ce,{className:"text-base font-semibold mb-3 block",children:"Mthode de paiement"}),o.jsx(tw,{value:a,onValueChange:l,className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.map(O=>o.jsx(ct,{className:`cursor-pointer transition-all hover:shadow-md ${a===O.id?"ring-2 ring-blue-500":""} ${O.enabled?"":"opacity-50"}`,children:o.jsx(ut,{className:"p-4",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(rw,{value:O.id,id:O.id,disabled:!O.enabled}),o.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[L(O),o.jsxs("div",{children:[o.jsx("div",{className:"font-medium",children:O.name}),o.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:O.description}),o.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["Traitement: ",O.processing_time]})]})]})]})})},O.id))})]}),A()&&o.jsx(ct,{className:"bg-blue-50 dark:bg-blue-900/20",children:o.jsx(ut,{className:"pt-4",children:o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Package slectionn:"}),o.jsxs("span",{className:"font-medium",children:[A().credits," crdits"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Prix:"}),o.jsxs("span",{className:"font-medium",children:[A().price_dt," DT"]})]}),A().savings_dt>0&&o.jsxs("div",{className:"flex justify-between text-green-600",children:[o.jsx("span",{children:"conomie:"}),o.jsxs("span",{className:"font-medium",children:[A().savings_dt," DT"]})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{children:"Mthode de paiement:"}),o.jsx("span",{className:"font-medium",children:(k=f.find(O=>O.id===a))==null?void 0:k.name})]})]})})}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[o.jsx("button",{onClick:e,className:"px-6 py-2 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:"Annuler"}),o.jsx("button",{onClick:P,disabled:y||!A(),className:"px-6 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:y?o.jsxs(o.Fragment,{children:[o.jsx(ft,{className:"h-4 w-4 animate-spin"}),o.jsx("span",{children:"Traitement..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(lL,{className:"h-4 w-4"}),o.jsxs("span",{children:["Acheter ",(D=A())==null?void 0:D.price_dt," DT"]})]})})]})]})]})})},mae=({user:t,credits:e,onBuyCredits:r,onProfile:n,onSettings:s,onLogout:i})=>{var f,p;const[a,l]=C.useState(!1),d=C.useRef(null);C.useEffect(()=>{const y=v=>{d.current&&!d.current.contains(v.target)&&l(!1)};return a&&document.addEventListener("mousedown",y),()=>{document.removeEventListener("mousedown",y)}},[a]);const u=y=>{y&&y(),l(!1)};return o.jsxs("div",{className:"relative",ref:d,children:[o.jsxs("button",{id:"profile-button",onClick:()=>l(!a),className:"flex items-center gap-2 px-3 py-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Menu utilisateur","aria-expanded":a,children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white font-semibold",children:((p=(f=t==null?void 0:t.name)==null?void 0:f.charAt(0))==null?void 0:p.toUpperCase())||"U"}),o.jsx(zp,{className:`h-4 w-4 text-gray-600 dark:text-gray-400 transition-transform ${a?"rotate-180":""}`})]}),a&&o.jsxs("div",{className:"absolute right-0 top-full mt-2 z-10 min-w-[240px] bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[o.jsxs("div",{className:"px-3 py-2 border-b border-gray-100 dark:border-gray-700",children:[o.jsx("p",{className:"font-semibold text-gray-900 dark:text-white",children:(t==null?void 0:t.name)||"Utilisateur"}),o.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize",children:(t==null?void 0:t.role)||"Club"})]}),e!==void 0&&o.jsx("div",{className:"px-3 py-2 border-b border-gray-100 dark:border-gray-700",children:o.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300 mb-1",children:[o.jsx(Cn,{className:"h-4 w-4 text-yellow-500"}),o.jsxs("span",{className:"font-semibold",children:[e," crdits"]})]})}),o.jsxs("div",{className:"py-1",children:[r&&o.jsxs("button",{id:"buy-credits-button",onClick:()=>u(r),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left",children:[o.jsx(Cn,{className:"h-4 w-4"}),o.jsx("span",{children:"Acheter des crdits"})]}),n&&o.jsxs("button",{onClick:()=>u(n),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left",children:[o.jsx(Nn,{className:"h-4 w-4"}),o.jsx("span",{children:"Mon Profil"})]}),s&&o.jsxs("button",{onClick:()=>u(s),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left",children:[o.jsx(Nu,{className:"h-4 w-4"}),o.jsx("span",{children:"Paramtres"})]})]}),i&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"border-t border-gray-100 dark:border-gray-700"}),o.jsx("div",{className:"py-1",children:o.jsxs("button",{onClick:()=>u(i),className:"w-full flex items-center gap-2 px-3 py-2 hover:bg-red-50 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 transition-colors text-left",children:[o.jsx(cb,{className:"h-4 w-4"}),o.jsx("span",{children:"Dconnexion"})]})})]})]})]})},eI=({title:t})=>{const{user:e,logout:r}=ps(),n=ni(),[s,i]=Fe.useState("light"),a=()=>{i(s==="light"?"dark":"light"),document.documentElement.classList.toggle("dark")},l=async()=>{await r(),n("/auth")},d=()=>{n("/profile")};return o.jsx("nav",{className:"sticky top-0 z-50 bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-b border-gray-200/30 dark:border-gray-700/30",children:o.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-6",children:o.jsxs("div",{className:"flex justify-between items-center h-14",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("h1",{className:"text-xl font-bold flex items-center gap-2",children:[o.jsx(Yp,{className:"w-5 h-5 text-blue-600 dark:text-cyan-400"}),o.jsx("span",{className:"hidden sm:inline bg-gradient-to-r from-blue-600 to-cyan-500 dark:from-blue-400 dark:to-cyan-300 bg-clip-text text-transparent",children:"MySmash"})]}),t&&o.jsx("h2",{className:"text-sm font-medium hidden md:block text-gray-700 dark:text-gray-300",children:t})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:a,className:"p-2 rounded-lg transition-all hover:scale-110 bg-gray-100 dark:bg-gray-800 border-2 border-blue-500 dark:border-cyan-400","aria-label":"Changer le thme",children:s==="dark"?o.jsx(qp,{className:"h-5 w-5 text-yellow-400"}):o.jsx(Kp,{className:"h-5 w-5 text-indigo-600"})}),o.jsx(mae,{user:e,credits:(e==null?void 0:e.role)==="player"?e==null?void 0:e.credits_balance:void 0,onProfile:d,onLogout:l})]})]})})})},pae=()=>{var u,f,p,y,v,E;const[t,e]=C.useState({club:null,players:[],videos:[],courts:[],stats:{total_videos:0,total_players:0,total_credits_offered:0,total_courts:0}}),[r,n]=C.useState(!0),[s,i]=C.useState(""),[a,l]=C.useState(!1);C.useEffect(()=>{d()},[]);const d=async()=>{try{n(!0),i("");const b=await ra.getDashboard();e(b.data)}catch(b){i("Erreur lors du chargement du tableau de bord"),console.error("Error loading dashboard:",b)}finally{n(!1)}};return r?o.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[o.jsx(eI,{title:"Tableau de bord Club"}),o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(ft,{className:"h-8 w-8 animate-spin"})})]}):o.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[o.jsx(eI,{title:"Tableau de bord Club"}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[s&&o.jsx(Xt,{variant:"destructive",className:"mb-6",children:o.jsx(Qt,{children:s})}),o.jsxs("div",{className:"mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:((u=t.club)==null?void 0:u.name)||"Club"}),o.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Grez vos joueurs et suivez l'activit de votre club"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[o.jsx(Pm,{icon:ru,title:"Joueurs Inscrits",value:((f=t.stats)==null?void 0:f.total_players)??0,iconBgColor:"bg-blue-100",iconColor:"text-blue-600"}),o.jsx(Pm,{icon:yr,title:"Vidos Enregistres",value:((p=t.stats)==null?void 0:p.total_videos)??0,iconBgColor:"bg-purple-100",iconColor:"text-purple-600"}),o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-5 border-2 border-blue-200 dark:border-blue-700",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-1",children:" Solde du Club"}),o.jsx("p",{className:"text-3xl font-bold text-blue-900 dark:text-blue-100",children:((y=t.club)==null?void 0:y.credits_balance)??0}),o.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400 mt-1",children:"crdits disponibles"})]}),o.jsx("div",{className:"p-3 rounded-lg bg-blue-200 dark:bg-blue-800",children:o.jsx(Cn,{className:"h-5 w-5 text-blue-700 dark:text-blue-300"})})]}),o.jsxs("button",{onClick:()=>l(!0),className:"w-full px-4 py-2 text-sm font-medium text-blue-700 dark:text-blue-300 bg-white dark:bg-blue-900/50 border border-blue-300 dark:border-blue-600 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-800/50 transition-colors flex items-center justify-center gap-2",children:[o.jsx(as,{className:"h-4 w-4"}),o.jsx("span",{children:"Acheter"})]})]}),o.jsx(Pm,{icon:rL,title:"Crdits Offerts",value:((v=t.stats)==null?void 0:v.total_credits_offered)??0,subtitle:"par le club",iconBgColor:"bg-green-100",iconColor:"text-green-600"}),o.jsx(Pm,{icon:wh,title:"Terrains",value:((E=t.stats)==null?void 0:E.total_courts)??0,iconBgColor:"bg-orange-100",iconColor:"text-orange-600"})]}),o.jsxs(Nf,{defaultValue:"joueurs",className:"w-full",children:[o.jsxs(id,{className:"grid w-full grid-cols-4",children:[o.jsx(kr,{value:"joueurs",children:"Joueurs"}),o.jsx(kr,{value:"terrains",children:"Terrains"}),o.jsx(kr,{value:"videos",children:"Vidos"}),o.jsx(kr,{value:"historique",children:"Historique"})]}),o.jsx(jr,{value:"joueurs",className:"mt-6",children:o.jsx(Jie,{players:t.players,videos:t.videos,onPlayersUpdated:d})}),o.jsx(jr,{value:"terrains",className:"mt-6",children:o.jsx(eae,{courts:t.courts,onCourtUpdated:d})}),o.jsx(jr,{value:"videos",className:"mt-6",children:o.jsx(tae,{videos:t.videos})}),o.jsx(jr,{value:"historique",className:"mt-6",children:o.jsx(rae,{})})]})]}),o.jsx(fae,{open:a,onClose:()=>l(!1),onSuccess:()=>d(),club:t.club})]})},gae=()=>o.jsx(pae,{}),xae=()=>{const t=ni(),[e,r]=C.useState({email:"",password:"",code:""}),[n,s]=C.useState("login"),[i,a]=C.useState(!1),[l,d]=C.useState(""),u=async p=>{var y,v;p.preventDefault(),a(!0),d("");try{(await cn.superAdminLogin({email:e.email,password:e.password})).data.requires_2fa?s("2fa"):t("/admin")}catch(E){d(((v=(y=E.response)==null?void 0:y.data)==null?void 0:v.error)||"Erreur de connexion")}finally{a(!1)}},f=async p=>{p.preventDefault(),a(!0),d("");try{t("/admin")}catch{d("Code invalide")}finally{a(!1)}};return o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:o.jsxs(ct,{className:"w-full max-w-md",children:[o.jsxs(wt,{className:"text-center",children:[o.jsx("div",{className:"mx-auto mb-4 w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:o.jsx(Gu,{className:"h-8 w-8 text-white"})}),o.jsx(bt,{className:"text-2xl",children:"Super Admin Login"}),o.jsx(dn,{children:n==="login"?"Accs rserv aux super administrateurs":"Authentification  deux facteurs"})]}),o.jsxs(ut,{children:[l&&o.jsx(Xt,{variant:"destructive",className:"mb-4",children:o.jsx(Qt,{children:l})}),n==="login"?o.jsxs("form",{onSubmit:u,className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Email"}),o.jsx(Ue,{type:"email",value:e.email,onChange:p=>r(y=>({...y,email:p.target.value})),placeholder:"admin@example.com",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Mot de passe"}),o.jsx(Ue,{type:"password",value:e.password,onChange:p=>r(y=>({...y,password:p.target.value})),placeholder:"",required:!0})]}),o.jsxs(ve,{type:"submit",className:"w-full",disabled:i,children:[i&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Se connecter"]})]}):o.jsxs("form",{onSubmit:f,className:"space-y-4",children:[o.jsxs("div",{className:"text-center mb-4",children:[o.jsx(gB,{className:"h-12 w-12 text-blue-600 mx-auto mb-2"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Entrez le code de votre application d'authentification"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Ce,{children:"Code  6 chiffres"}),o.jsx(Ue,{type:"text",value:e.code,onChange:p=>r(y=>({...y,code:p.target.value})),placeholder:"000000",maxLength:6,className:"text-center text-2xl tracking-widest",required:!0})]}),o.jsxs("div",{className:"flex space-x-2",children:[o.jsx(ve,{type:"button",variant:"outline",className:"w-full",onClick:()=>s("login"),children:"Retour"}),o.jsxs(ve,{type:"submit",className:"w-full",disabled:i||e.code.length!==6,children:[i&&o.jsx(ft,{className:"h-4 w-4 mr-2 animate-spin"}),"Vrifier"]})]})]})]})]})})},yae=new r$,vae=()=>o.jsx(s$,{client:yae,children:o.jsx(jG,{children:o.jsx(aV,{children:o.jsxs(PU,{children:[o.jsx(h7,{}),o.jsx(Y7,{}),o.jsx(tV,{children:o.jsxs(K$,{children:[o.jsx($r,{path:"/",element:o.jsx(IY,{})}),o.jsx($r,{path:"/ai-features",element:o.jsx(RY,{})}),o.jsx($r,{path:"/how-it-works",element:o.jsx(_Y,{})}),o.jsx($r,{path:"/about",element:o.jsx(LY,{})}),o.jsx($r,{path:"/contact",element:o.jsx(DY,{})}),o.jsx($r,{path:"/auth",element:o.jsx(OY,{})}),o.jsx($r,{path:"/verify-email",element:o.jsx(FY,{})}),o.jsx($r,{path:"/google-auth-callback",element:o.jsx(BY,{})}),o.jsx($r,{path:"/super-secret-login",element:o.jsx(xae,{})}),o.jsx($r,{path:"/admin",element:o.jsx(fa,{requiredRole:"super_admin",children:o.jsx(Zie,{})})}),o.jsx($r,{path:"/club",element:o.jsx(fa,{requiredRole:"club",children:o.jsx(gae,{})})}),o.jsx($r,{path:"/dashboard",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(iie,{})})}),o.jsx($r,{path:"/my-clips",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(die,{})})}),o.jsx($r,{path:"/clubs",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(mie,{})})}),o.jsx($r,{path:"/credits",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(yie,{})})}),o.jsx($r,{path:"/profile",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(vie,{})})}),o.jsx($r,{path:"/support",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(Tie,{})})}),o.jsx($r,{path:"/settings",element:o.jsx(fa,{requiredRole:"player",children:o.jsx(Mie,{})})}),o.jsx($r,{path:"*",element:o.jsx(kY,{})})]})})]})})})});function wae({children:t,...e}){return o.jsx(g7,{...e,children:t})}S_(document.getElementById("root")).render(o.jsx(wae,{attribute:"class",defaultTheme:"dark",enableSystem:!0,children:o.jsx(vae,{})}));
